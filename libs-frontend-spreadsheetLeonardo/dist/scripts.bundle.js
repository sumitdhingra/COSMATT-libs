var Leonardo=Leonardo||{};Leonardo["scripts"]=function(e){var t={};function r(n){if(t[n]){return t[n].exports}var o=t[n]={i:n,l:false,exports:{}};e[n].call(o.exports,o,o.exports,r);o.l=true;return o.exports}r.m=e;r.c=t;r.i=function(e){return e};r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.n=function(e){var t=e&&e.__esModule?function n(){return e["default"]}:function o(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=7)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.VIEWIDs={DEFAULT:"",GRID:"Grid",TOPBAR:"Topbar",RIBBON:"Ribbon"};t.Events={ViewEvents:{SELECTED_CELL_CHANGED:"Selected_Cell_Changed",SELECTED_CELL_VALUE_CHANGED:"Selected_Cell_Value_Changed",INCORRECT_CELL_REFERENCE:"Incorrect_Cell_Reference",EDITING_EVENTt:"EditingEvent",GRIDKEYPRESSED:"GridKeyPressed",RESET_GRID:"ResetGrid",UPDATE_DATA:"UpdateData"},DataModelEvents:{BROADCAST_EVENT:"Broadcast_Event"},GradingEvents:{RENDER_RESULT:"Render_Result",TRY_AGAIN:"Try_Again"},RIBBON_EVENTS:{STYLE_EVENT:"Style_Event",RENDER_GRID:"Render_Grid",RIBBON_COLLAPSED:"Ribbon_Collapsed"},HintEvents:{RENDER_HINT:"Render_Hint"},LeonardoManagerEvents:{FORMULAMODE_OPEN_EVENT:"Fulleditopen_Event",FORMULAMODE_CLOSE_EVENT:"Fulleditclose_Event",FORMULAMODE_CHANGE_EVENT:"Fulleditchange_Event",GETCELLVALUE_EVENT:"Getcellvalue_Event",REMOTECELLVAL_CHANGED_EVENT:"Remotecellval_Changed_Event"},SpreadsheetEvents:{MANAGER_BROADCAST_EVENT:"Manager_Broadcast_Event"},GRID_EVENTS:{MESSAGE:"message",COL_RESIZE:"col_resize"}};t.GradingUIConfig={CORRECT:{color:"#f0fff0",border:"solid 1px #7dc27d"},INCORRECT:{color:"#fff0f0",border:"double 1px #A90329"},MISSING:{color:"#fff0f0",border:"double 1px #A90329"}};t.GRADINGCODES={CORRECT:0,INCORRECT:1,MISSING:2,BLANK:3};t.RIBBON_OPTIONS={1:{property:{name:"fontWeight",value:"bold"},type:"cellStyle",attribute:"HIGHLIGHT_BOLD"},61:{property:{name:"mergedranges"},type:"other",attribute:"MERGE_AND_CENTER"}};t.PROPERTY_ATTRIBUTE_MAP={HIGHLIGHT_BOLD:"fontWeight",MERGE_AND_CENTER:"mergedranges"};t.KEYCODES={tabKey:9,enterKey:13,shiftKey:16,ctrlKey:17,altKey:18,escKey:27,leftKey:37,upKey:38,rightKey:39,downKey:40,_equalKey:61,_equalKeyChrome:187,f2Key:113}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(0);var o=function(){function e(){this.COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.COLUMN_LABEL_BASE_LENGTH=this.COLUMN_LABEL_BASE.length;this.viewId=n.VIEWIDs.DEFAULT}e.prototype.init=function(){this.registerEventListeners();this.attachDOMEvents()};e.prototype.getViewId=function(){return this.viewId};e.prototype.registerEventListeners=function(){};e.prototype.attachDOMEvents=function(){};e.prototype.spreadsheetColumnLabel=function(e){var t=e+1;var r="";var n;while(t>0){n=(t-1)%this.COLUMN_LABEL_BASE_LENGTH;r=String.fromCharCode(65+n)+r;t=Math.floor((t-n)/this.COLUMN_LABEL_BASE_LENGTH)}return r};e.prototype.spreadsheetColumnIndex=function(e){var t=0;if(e){for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1){t+=Math.pow(this.COLUMN_LABEL_BASE_LENGTH,n)*(this.COLUMN_LABEL_BASE.indexOf(e[r])+1)}}--t;return t};return e}();t.BaseView=o},function(module,exports,__webpack_require__){"use strict";(function(Handsontable,global,process){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var require;var require;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
Copyright (c) Handsoncode sp. z o.o. <hello@handsoncode.net>

This Handsontable Pro is a commercial software distributed by Handsoncode Sp. z o.o. with
its registered seat in Gdynia, Aleja Zwyciestwa 96/98 (81-451 Gdynia) Poland, entered into the Entrepreneurs
Register of the National Court Register under number 0000538651, hereinafter referred to as "HANDSONCODE".

By installing, copying, or otherwise using this software, you agree to be bound by the terms
of its EULA (End-User License Agreement). This software is copyrighted and protected by copyright laws
and international treaties.

YOU EXPRESSLY ACKNOWLEDGE AND AGREE THAT USE OF THE SOFTWARE IS AT YOUR OWN RISK AND THAT THE SOFTWARE
IS PROVIDED "AS IS" WITHOUT ANY WARRANTIES OR CONDITIONS WHATSOEVER. HANDSONCODE EXPRESSLY DISCLAIMS ANY WARRANTY,
EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
FITNESS FORA PARTICULAR PURPOSE, OR NONINFRINGMENT. HANDSONCODE DOES NOT WARRANT THAT THE SOFTWARE AND ITS FUNCTIONALITY,
RELIABILITY AND PERFORMANCE WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE SOFTWARE WILL BE
UNINTERRUPTED OR ERROR FREE.

YOU SHALL OBTAIN A COMMERCIAL LICENSE FOR THIS SOFTWARE AT HANDSONTABLE.COM.

*/
(function(e){if((false?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"){module.exports=e()}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=e,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Handsontable=e()}})(function(){var define,module,exports;return function e(t,r,n){var o=typeof require=="function"&&require;var i=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","numbro":"numbro","pikaday":"Pikaday","hot-formula-parser":"formulaParser"}')||{};function a(s,l){if(!r[s]){if(!t[s]){var u=typeof require=="function"&&require;if(!l&&u)return require(s,true);if(o)return require(s,true);if(i[s]&&typeof window[i[s]]!=="undefined"){return window[i[s]]}var d=new Error("Cannot find module '"+s+"'");d.code="MODULE_NOT_FOUND";throw d}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return a(r?r:e)},f,f.exports,e,t,r,n)}return r[s].exports}for(var s=0;s<n.length;s++){a(n[s])}return a}({1:[function(e,t,r){},{}],2:[function(e,t,r){if(window.jQuery){(function(e){e.fn.handsontable=function(e){var t,r,n,o,i,a=this.first(),s=a.data("handsontable");if(typeof e!=="string"){i=e||{};if(s){s.updateSettings(i)}else{s=new Handsontable.Core(a[0],i);a.data("handsontable",s);s.init()}return a}else{n=[];if(arguments.length>1){for(t=1,r=arguments.length;t<r;t++){n.push(arguments[t])}}if(s){if(typeof s[e]!=="undefined"){o=s[e].apply(s,n);if(e==="destroy"){a.removeData()}}else{throw new Error("Handsontable do not provide action: "+e)}}return o}}})(window.jQuery)}},{}],3:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableBorder:{get:function E(){return _}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),d=u.getComputedStyle,f=u.getTrimmingContainer,c=u.innerWidth,h=u.innerHeight,m=u.offset,p=u.outerHeight,v=u.outerWidth;var g=(o=e("helpers/dom/event"),o&&o.__esModule&&o||{"default":o}).stopImmediatePropagation;var w=(i=e("helpers/browser"),i&&i.__esModule&&i||{"default":i}).isMobileBrowser;var b=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).EventManager;var y=(s=e("cell/coords"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords;var C=(l=e("overlay/_base.js"),l&&l.__esModule&&l||{"default":l}).WalkontableOverlay;var _=function R(e,t){if(!t){return}this.eventManager=new b(e);this.instance=e;this.wot=e;this.settings=t;this.mouseDown=false;this.main=null;this.top=null;this.left=null;this.bottom=null;this.right=null;this.topStyle=null;this.leftStyle=null;this.bottomStyle=null;this.rightStyle=null;this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"};this.corner=null;this.cornerStyle=null;this.createBorders(t);this.registerListeners()};$traceurRuntime.createClass(_,{registerListeners:function M(){var e=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return e.onMouseDown()});this.eventManager.addEventListener(document.body,"mouseup",function(){return e.onMouseUp()});var t=this,r=function i(r,n){t.eventManager.addEventListener(t.main.childNodes[r],"mouseenter",function(t){return e.onMouseEnter(t,e.main.childNodes[r])})};for(var n=0,o=this.main.childNodes.length;n<o;n++){r(n,o)}},onMouseDown:function S(){this.mouseDown=true},onMouseUp:function O(){this.mouseDown=false},onMouseEnter:function T(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver")){return}e.preventDefault();g(e);var r=this;var n=t.getBoundingClientRect();t.style.display="none";function o(e){if(e.clientY<Math.floor(n.top)){return true}if(e.clientY>Math.ceil(n.top+n.height)){return true}if(e.clientX<Math.floor(n.left)){return true}if(e.clientX>Math.ceil(n.left+n.width)){return true}}function i(e){if(o(e)){r.eventManager.removeEventListener(document.body,"mousemove",i);t.style.display="block"}}this.eventManager.addEventListener(document.body,"mousemove",i)},createBorders:function A(e){this.main=document.createElement("div");var t=["top","left","bottom","right","corner"];var r=this.main.style;r.position="absolute";r.top=0;r.left=0;for(var n=0;n<5;n++){var o=t[n];var i=document.createElement("div");i.className="wtBorder "+(this.settings.className||"");if(this.settings[o]&&this.settings[o].hide){i.className+=" hidden"}r=i.style;r.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color;r.height=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":e.border.width+"px";r.width=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":e.border.width+"px";this.main.appendChild(i)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");if(w()){this.createMultipleSelectorHandles()}this.disappear();if(!this.wot.wtTable.bordersHolder){this.wot.wtTable.bordersHolder=document.createElement("div");this.wot.wtTable.bordersHolder.className="htBorders";this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)}this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)},createMultipleSelectorHandles:function N(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var e=10;var t=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var r={position:"absolute",height:t+"px",width:t+"px","border-radius":parseInt(t/1.5,10)+"px"};for(var n in r){if(r.hasOwnProperty(n)){this.selectionHandles.styles.bottomRightHitArea[n]=r[n];this.selectionHandles.styles.topLeftHitArea[n]=r[n]}}var o={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var i in o){if(o.hasOwnProperty(i)){this.selectionHandles.styles.bottomRight[i]=o[i];this.selectionHandles.styles.topLeft[i]=o[i]}}this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)},isPartRange:function D(e,t){if(this.wot.selections.area.cellRange){if(e!=this.wot.selections.area.cellRange.to.row||t!=this.wot.selections.area.cellRange.to.col){return true}}return false},updateMultipleSelectionHandlesPosition:function k(e,t,r,n,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10);var s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(r-a,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(n-a,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(r-s/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(n-s/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(r+i,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(n+o,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(r+i-s/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(n+o-s/4,10)+"px";if(this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()){this.selectionHandles.styles.topLeft.display="block";this.selectionHandles.styles.topLeftHitArea.display="block";if(this.isPartRange(e,t)){this.selectionHandles.styles.bottomRight.display="none";this.selectionHandles.styles.bottomRightHitArea.display="none"}else{this.selectionHandles.styles.bottomRight.display="block";this.selectionHandles.styles.bottomRightHitArea.display="block"}}else{this.selectionHandles.styles.topLeft.display="none";this.selectionHandles.styles.bottomRight.display="none";this.selectionHandles.styles.topLeftHitArea.display="none";this.selectionHandles.styles.bottomRightHitArea.display="none"}if(e==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")){this.selectionHandles.styles.topLeft.zIndex="9999";this.selectionHandles.styles.topLeftHitArea.zIndex="9999"}else{this.selectionHandles.styles.topLeft.zIndex="";this.selectionHandles.styles.topLeftHitArea.zIndex=""}},appear:function x(e){if(this.disabled){return}var t,r,n,o,i,a,s,l,u,g,b,C,_,E,R,M,S,O,T;T=this.wot.wtTable.getRenderedRowsCount();for(var A=0;A<T;A++){var N=this.wot.wtTable.rowFilter.renderedToSource(A);if(N>=e[0]&&N<=e[2]){_=N;break}}for(var D=T-1;D>=0;D--){var k=this.wot.wtTable.rowFilter.renderedToSource(D);if(k>=e[0]&&k<=e[2]){R=k;break}}T=this.wot.wtTable.getRenderedColumnsCount();for(var x=0;x<T;x++){var I=this.wot.wtTable.columnFilter.renderedToSource(x);if(I>=e[1]&&I<=e[3]){E=I;break}}for(var P=T-1;P>=0;P--){var L=this.wot.wtTable.columnFilter.renderedToSource(P);if(L>=e[1]&&L<=e[3]){M=L;break}}if(_===void 0||E===void 0){this.disappear();return}t=_!==R||E!==M;r=this.wot.wtTable.getCell(new y(_,E));n=t?this.wot.wtTable.getCell(new y(R,M)):r;o=m(r);i=t?m(n):o;a=m(this.wot.wtTable.TABLE);l=o.top;b=i.top+p(n)-l;g=o.left;C=i.left+v(n)-g;s=l-a.top-1;u=g-a.left-1;var H=d(r);if(parseInt(H.borderTopWidth,10)>0){s+=1;b=b>0?b-1:0}if(parseInt(H.borderLeftWidth,10)>0){u+=1;C=C>0?C-1:0}this.topStyle.top=s+"px";this.topStyle.left=u+"px";this.topStyle.width=C+"px";this.topStyle.display="block";this.leftStyle.top=s+"px";this.leftStyle.left=u+"px";this.leftStyle.height=b+"px";this.leftStyle.display="block";var V=Math.floor(this.settings.border.width/2);this.bottomStyle.top=s+b-V+"px";this.bottomStyle.left=u+"px";this.bottomStyle.width=C+"px";this.bottomStyle.display="block";this.rightStyle.top=s+"px";this.rightStyle.left=u+C-V+"px";this.rightStyle.height=b+1+"px";this.rightStyle.display="block";if(w()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(R,M)){this.cornerStyle.display="none"}else{this.cornerStyle.top=s+b-4+"px";this.cornerStyle.left=u+C-4+"px";this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.display="none";S=f(this.wot.wtTable.TABLE);if(M===this.wot.getSetting("totalColumns")-1){O=n.offsetLeft+v(n)+parseInt(this.cornerDefaultStyle.width)/2>=c(S);if(O){this.cornerStyle.left=Math.floor(u+C-3-parseInt(this.cornerDefaultStyle.width)/2)+"px";this.cornerStyle.borderRightWidth=0}}if(R===this.wot.getSetting("totalRows")-1){O=n.offsetTop+p(n)+parseInt(this.cornerDefaultStyle.height)/2>=h(S);if(O){this.cornerStyle.top=Math.floor(s+b-3-parseInt(this.cornerDefaultStyle.height)/2)+"px";this.cornerStyle.borderBottomWidth=0}}this.cornerStyle.display="block"}if(w()){this.updateMultipleSelectionHandlesPosition(_,E,s,u,C,b)}},disappear:function I(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";if(w()){this.selectionHandles.styles.topLeft.display="none";this.selectionHandles.styles.bottomRight.display="none"}},hasSetting:function P(e){if(typeof e==="function"){return e()}return!!e}},{});window.WalkontableBorder=_},{"cell/coords":6,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/dom/event":48,"overlay/_base.js":12}],4:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableViewportColumnsCalculator:{get:function a(){return o}},__esModule:{value:true}});var n=new WeakMap;var o=function s(e,t,r,o,i,a,l){var u=arguments[7]!==void 0?arguments[7]:function(e){return e};n.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:r,columnWidthFn:o,overrideFn:i,onlyFullyVisible:a,stretchingColumnWidthFn:u});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=l;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=true;this.stretchAllColumnsWidth=[];this.calculate()};var i=o;$traceurRuntime.createClass(o,{calculate:function l(){var e=0;var t=true;var r=[];var o;var i=n.get(this);var a=i.onlyFullyVisible;var s=i.overrideFn;var l=i.scrollOffset;var u=i.totalColumns;var d=i.viewportWidth;for(var f=0;f<u;f++){o=this._getColumnWidth(f);if(e<=l&&!a){this.startColumn=f}var c=l>0?d+1:d;if(e>=l&&e+o<=l+c){if(this.startColumn==null){this.startColumn=f}this.endColumn=f}r.push(e);e+=o;if(!a){this.endColumn=f}if(e>=l+d){t=false;break}}if(this.endColumn===u-1&&t){this.startColumn=this.endColumn;while(this.startColumn>0){var h=r[this.endColumn]+o-r[this.startColumn-1];if(h<=d||!a){this.startColumn--}if(h>d){break}}}if(this.startColumn!==null&&s){s(this)}this.startPosition=r[this.startColumn];if(this.startPosition==void 0){this.startPosition=null}if(this.startColumn!==null){this.count=this.endColumn-this.startColumn+1}},refreshStretching:function u(e){if(this.stretch==="none"){return}this.totalTargetWidth=e;var t=n.get(this);var r=t.totalColumns;var o=0;for(var i=0;i<r;i++){var a=this._getColumnWidth(i);var s=t.stretchingColumnWidthFn(void 0,i);if(typeof s==="number"){e-=s}else{o+=a}}var l=e-o;if(this.stretch==="all"&&l>0){this.stretchAllRatio=e/o;this.stretchAllColumnsWidth=[];this.needVerifyLastColumnWidth=true}else if(this.stretch==="last"&&e!==Infinity){var u=this._getColumnWidth(r-1);var d=l+u;this.stretchLastWidth=d>=0?d:u}},getStretchedColumnWidth:function d(e,t){var r=null;if(this.stretch==="all"&&this.stretchAllRatio!==0){r=this._getStretchedAllColumnWidth(e,t)}else if(this.stretch==="last"&&this.stretchLastWidth!==0){r=this._getStretchedLastColumnWidth(e)}return r},_getStretchedAllColumnWidth:function f(e,t){var r=0;var o=n.get(this);var i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){var a=Math.round(t*this.stretchAllRatio);var s=o.stretchingColumnWidthFn(a,e);if(s===void 0){this.stretchAllColumnsWidth[e]=a}else{this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=false;for(var l=0;l<this.stretchAllColumnsWidth.length;l++){r+=this.stretchAllColumnsWidth[l]}if(r!==this.totalTargetWidth){this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r}}return this.stretchAllColumnsWidth[e]},_getStretchedLastColumnWidth:function c(e){var t=n.get(this);var r=t.totalColumns;if(e===r-1){return this.stretchLastWidth}return null},_getColumnWidth:function h(e){var t=n.get(this).columnWidthFn(e);if(t===void 0){t=i.DEFAULT_WIDTH}return t}},{get DEFAULT_WIDTH(){return 50}});window.WalkontableViewportColumnsCalculator=o},{}],5:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableViewportRowsCalculator:{get:function a(){return o}},__esModule:{value:true}});var n=new WeakMap;var o=function s(e,t,r,o,i,a,l){n.set(this,{viewportHeight:e,scrollOffset:t,totalRows:r,rowHeightFn:o,overrideFn:i,onlyFullyVisible:a,horizontalScrollbarHeight:l});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()};var i=o;$traceurRuntime.createClass(o,{calculate:function l(){var e=0;var t=true;var r=[];var o=n.get(this);var a=o.onlyFullyVisible;var s=o.overrideFn;var l=o.rowHeightFn;var u=o.scrollOffset;var d=o.totalRows;var f=o.viewportHeight;var c=o.horizontalScrollbarHeight||0;for(var h=0;h<d;h++){var m=l(h);if(m===undefined){m=i.DEFAULT_HEIGHT}if(e<=u&&!a){this.startRow=h}if(e>=u&&e+m<=u+f-c){if(this.startRow===null){this.startRow=h}this.endRow=h}r.push(e);e+=m;if(!a){this.endRow=h}if(e>=u+f-c){t=false;break}}if(this.endRow===d-1&&t){this.startRow=this.endRow;while(this.startRow>0){var p=r[this.endRow]+m-r[this.startRow-1];if(p<=f-c||!a){this.startRow--}if(p>=f-c){break}}}if(this.startRow!==null&&s){s(this)}this.startPosition=r[this.startRow];if(this.startPosition==void 0){this.startPosition=null}if(this.startRow!==null){this.count=this.endRow-this.startRow+1}}},{get DEFAULT_HEIGHT(){return 23}});window.WalkontableViewportRowsCalculator=o},{}],6:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableCellCoords:{get:function o(){return n}},__esModule:{value:true}});var n=function i(e,t){if(typeof e!=="undefined"&&typeof t!=="undefined"){this.row=e;this.col=t}else{this.row=null;this.col=null}};$traceurRuntime.createClass(n,{isValid:function a(e){if(this.row<0||this.col<0){return false}if(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")){return false}return true},isEqual:function s(e){if(e===this){return true}return this.row===e.row&&this.col===e.col},isSouthEastOf:function l(e){return this.row>=e.row&&this.col>=e.col},isNorthWestOf:function u(e){return this.row<=e.row&&this.col<=e.col},isSouthWestOf:function d(e){return this.row>=e.row&&this.col<=e.col},isNorthEastOf:function f(e){return this.row<=e.row&&this.col>=e.col}},{});window.WalkontableCellCoords=n},{}],7:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableCellRange:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("cell/coords"),n&&n.__esModule&&n||{"default":n}).WalkontableCellCoords;var i=function l(e,t,r){this.highlight=e;this.from=t;this.to=r};var a=i;$traceurRuntime.createClass(i,{isValid:function u(e){return this.from.isValid(e)&&this.to.isValid(e)},isSingle:function d(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function f(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function c(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function h(e){var t=e,r=t.row,n=t.col;var o=this.getTopLeftCorner();var i=this.getBottomRightCorner();return o.row<=r&&i.row>=r&&o.col<=n&&i.col>=n},includesRange:function m(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},isEqual:function p(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},overlaps:function v(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function g(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},isNorthWestOf:function w(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},expand:function b(e){var t=this.getTopLeftCorner();var r=this.getBottomRightCorner();if(e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col){this.from=new o(Math.min(t.row,e.row),Math.min(t.col,e.col));this.to=new o(Math.max(r.row,e.row),Math.max(r.col,e.col));return true}return false},expandByRange:function y(e){if(this.includesRange(e)||!this.overlaps(e)){return false}var t=this.getTopLeftCorner();var r=this.getBottomRightCorner();var n=this.getTopRightCorner();var i=this.getBottomLeftCorner();var s=e.getTopLeftCorner();var l=e.getBottomRightCorner();var u=Math.min(t.row,s.row);var d=Math.min(t.col,s.col);var f=Math.max(r.row,l.row);var c=Math.max(r.col,l.col);var h=new o(u,d),m=new o(f,c);var p=new a(h,h,m).isCorner(this.from,e),v=e.isEqual(new a(h,h,m));if(p&&!v){if(this.from.col>h.col){h.col=c;m.col=d}if(this.from.row>h.row){h.row=f;m.row=u}}this.from=h;this.to=m;return true},getDirection:function C(){if(this.from.isNorthWestOf(this.to)){return"NW-SE"}else if(this.from.isNorthEastOf(this.to)){return"NE-SW"}else if(this.from.isSouthEastOf(this.to)){return"SE-NW"}else if(this.from.isSouthWestOf(this.to)){return"SW-NE"}},setDirection:function _(e){var t,r,n,o;switch(e){case"NW-SE":t=[this.getTopLeftCorner(),this.getBottomRightCorner()],this.from=t[0],this.to=t[1],t;break;case"NE-SW":r=[this.getTopRightCorner(),this.getBottomLeftCorner()],this.from=r[0],this.to=r[1],r;break;case"SE-NW":n=[this.getBottomRightCorner(),this.getTopLeftCorner()],this.from=n[0],this.to=n[1],n;break;case"SW-NE":o=[this.getBottomLeftCorner(),this.getTopRightCorner()],this.from=o[0],this.to=o[1],o;break}},getTopLeftCorner:function E(){return new o(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function R(){return new o(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function M(){return new o(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function S(){return new o(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function O(e,t){if(t){if(t.includes(e)){if(this.getTopLeftCorner().isEqual(new o(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new o(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new o(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new o(t.to.row,t.to.col))){return true}}}return e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())},getOppositeCorner:function T(e,t){if(!(e instanceof o)){return false}if(t){if(t.includes(e)){if(this.getTopLeftCorner().isEqual(new o(t.from.row,t.from.col))){return this.getBottomRightCorner()}if(this.getTopRightCorner().isEqual(new o(t.from.row,t.to.col))){return this.getBottomLeftCorner()}if(this.getBottomLeftCorner().isEqual(new o(t.to.row,t.from.col))){return this.getTopRightCorner()}if(this.getBottomRightCorner().isEqual(new o(t.to.row,t.to.col))){return this.getTopLeftCorner()}}}if(e.isEqual(this.getBottomRightCorner())){return this.getTopLeftCorner()}else if(e.isEqual(this.getTopLeftCorner())){return this.getBottomRightCorner()}else if(e.isEqual(this.getTopRightCorner())){return this.getBottomLeftCorner()}else if(e.isEqual(this.getBottomLeftCorner())){return this.getTopRightCorner()}},getBordersSharedWith:function A(e){if(!this.includesRange(e)){return[]}var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)};var r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)};var n=[];if(t.top==r.top){n.push("top")}if(t.right==r.right){n.push("right")}if(t.bottom==r.bottom){n.push("bottom")}if(t.left==r.left){n.push("left")}return n},getInner:function N(){var e=this.getTopLeftCorner();var t=this.getBottomRightCorner();var r=[];for(var n=e.row;n<=t.row;n++){for(var i=e.col;i<=t.col;i++){if(!(this.from.row===n&&this.from.col===i)&&!(this.to.row===n&&this.to.col===i)){r.push(new o(n,i))}}}return r},getAll:function D(){var e=this.getTopLeftCorner();var t=this.getBottomRightCorner();var r=[];for(var n=e.row;n<=t.row;n++){for(var i=e.col;i<=t.col;i++){if(e.row===n&&e.col===i){r.push(e)}else if(t.row===n&&t.col===i){r.push(t)}else{r.push(new o(n,i))}}}return r},forAll:function k(e){var t=this.getTopLeftCorner();var r=this.getBottomRightCorner();for(var n=t.row;n<=r.row;n++){for(var o=t.col;o<=r.col;o++){var i=e(n,o);if(i===false){return}}}}},{});window.WalkontableCellRange=i},{"cell/coords":6}],8:[function(e,t,r){"use strict";Object.defineProperties(r,{Walkontable:{get:function V(){return H}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h,m,p,v;var g=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),w=g.addClass,b=g.fastInnerText,y=g.isVisible,C=g.removeClass;var _=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}).objectEach;var E=(i=e("helpers/string"),i&&i.__esModule&&i||{"default":i}),R=E.toUpperCaseFirst,M=E.randomString;var S=(a=e("event"),a&&a.__esModule&&a||{"default":a}).WalkontableEvent;var O=(s=e("overlays"),s&&s.__esModule&&s||{"default":s}).WalkontableOverlays;var T=(l=e("scroll"),l&&l.__esModule&&l||{"default":l}).WalkontableScroll;var A=(u=e("settings"),u&&u.__esModule&&u||{"default":u}).WalkontableSettings;var N=(d=e("table"),d&&d.__esModule&&d||{"default":d}).WalkontableTable;var D=(f=e("viewport"),f&&f.__esModule&&f||{"default":f}).WalkontableViewport;var k=(c=e("overlay/_base.js"),c&&c.__esModule&&c||{"default":c}).WalkontableOverlay;var x=(h=e("overlay/top.js"),h&&h.__esModule&&h||{"default":h}).WalkontableTopOverlay;var I=(m=e("overlay/left.js"),m&&m.__esModule&&m||{"default":m}).WalkontableLeftOverlay;var P=(p=e("overlay/debug.js"),p&&p.__esModule&&p||{"default":p}).WalkontableDebugOverlay;var L=(v=e("overlay/topLeftCorner.js"),v&&v.__esModule&&v||{"default":v}).WalkontableTopLeftCornerOverlay;var H=function F(e){var t=[];this.guid="wt_"+M();if(e.cloneSource){this.cloneSource=e.cloneSource;this.cloneOverlay=e.cloneOverlay;this.wtSettings=e.cloneSource.wtSettings;this.wtTable=new N(this,e.table,e.wtRootElement);this.wtScroll=new T(this);this.wtViewport=e.cloneSource.wtViewport;this.wtEvent=new S(this);this.selections=this.cloneSource.selections}else{this.wtSettings=new A(this,e);this.wtTable=new N(this,e.table);this.wtScroll=new T(this);this.wtViewport=new D(this);this.wtEvent=new S(this);this.selections=this.getSetting("selections");this.wtOverlays=new O(this);this.exportSettingsAsClassNames()}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++){t.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(e,r){b(r,t[e])}])}}this.drawn=false;this.drawInterrupted=false};$traceurRuntime.createClass(H,{draw:function B(){var e=arguments[0]!==void 0?arguments[0]:false;this.drawInterrupted=false;if(!e&&!y(this.wtTable.TABLE)){this.drawInterrupted=true}else{this.wtTable.draw(e)}return this},getCell:function j(e){var t=arguments[1]!==void 0?arguments[1]:false;if(!t){return this.wtTable.getCell(e)}var r=this.wtSettings.getSetting("totalRows");var n=this.wtSettings.getSetting("fixedRowsTop");var o=this.wtSettings.getSetting("fixedRowsBottom");var i=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<n&&e.col<i){return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e)}else if(e.row<n){return this.wtOverlays.topOverlay.clone.wtTable.getCell(e)}else if(e.col<i&&e.row>=r-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone){return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}}else if(e.col<i){return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e)}else if(e.row<r&&e.row>r-o){if(this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone){return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}}return this.wtTable.getCell(e)},update:function W(e,t){return this.wtSettings.update(e,t)},scrollVertical:function $(e){this.wtOverlays.topOverlay.scrollTo(e);this.getSetting("onScrollVertically");return this},scrollHorizontal:function U(e){this.wtOverlays.leftOverlay.scrollTo(e);this.getSetting("onScrollHorizontally");return this},scrollViewport:function G(e){this.wtScroll.scrollViewport(e);return this},getViewport:function Y(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function z(){return this.cloneOverlay?this.cloneOverlay.type:"master"},isOverlayName:function K(e){if(this.cloneOverlay){return this.cloneOverlay.type===e}return false},exportSettingsAsClassNames:function q(){var e=this;var t={rowHeaders:["array"],columnHeaders:["array"]};var r=[];var n=[];_(t,function(t,o){if(t.indexOf("array")>-1&&e.getSetting(o).length){n.push("ht"+R(o))}r.push("ht"+R(o))});C(this.wtTable.wtRootElement.parentNode,r);w(this.wtTable.wtRootElement.parentNode,n)},getSetting:function X(e,t,r,n,o){return this.wtSettings.getSetting(e,t,r,n,o)},hasSetting:function J(e){return this.wtSettings.has(e)},destroy:function Z(){this.wtOverlays.destroy();this.wtEvent.destroy()}},{});window.Walkontable=H},{event:9,"helpers/dom/element":47,"helpers/object":53,"helpers/string":55,"overlay/_base.js":12,"overlay/debug.js":13,"overlay/left.js":14,"overlay/top.js":15,"overlay/topLeftCorner.js":16,overlays:17,scroll:18,settings:20,table:21,viewport:23}],9:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableEvent:{get:function v(){return p}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),l=s.closestDown,u=s.hasClass,d=s.isChildOf,f=s.getParent;var c=(o=e("helpers/function"),o&&o.__esModule&&o||{"default":o}).partial;var h=(i=e("helpers/browser"),i&&i.__esModule&&i||{"default":i}).isMobileBrowser;var m=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).eventManager;function p(e){var t=this;var r=m(e);this.instance=e;var n=[null,null];this.dblClickTimeout=[null,null];var o=function y(e){var r=document.activeElement;var o=c(f,e.realTarget);var i=e.realTarget;if(i===r||o(0)===r||o(1)===r){return}var a=t.parentCell(i);if(u(i,"corner")){t.instance.getSetting("onCellCornerMouseDown",e,i)}else if(a.TD){if(t.instance.hasSetting("onCellMouseDown")){t.instance.getSetting("onCellMouseDown",e,a.coords,a.TD,t.instance)}}if(e.button!==2){if(a.TD){n[0]=a.TD;clearTimeout(t.dblClickTimeout[0]);t.dblClickTimeout[0]=setTimeout(function(){n[0]=null},1e3)}}};var i=function C(e){t.instance.touchMoving=true};var a;var s=function _(e){var n=this;r.addEventListener(this,"touchmove",i);t.checkIfTouchMove=setTimeout(function(){if(t.instance.touchMoving===true){t.instance.touchMoving=void 0;r.removeEventListener("touchmove",i,false);return}else{o(e)}},30)};var p=function E(e){var r,n,o;if(t.instance.hasSetting("onCellMouseOver")){r=t.instance.wtTable.TABLE;n=l(e.realTarget,["TD","TH"],r);o=t.instance.cloneSource||t.instance;if(n&&n!==o.lastMouseOver&&d(n,r)){o.lastMouseOver=n;t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(n),n,t.instance)}}};var v=function R(e){var r,n,o;if(t.instance.hasSetting("onCellMouseOut")){r=t.instance.wtTable.TABLE;n=l(e.realTarget,["TD","TH"],r);o=l(e.relatedTarget,["TD","TH"],r);if(n&&n!==o&&d(n,r)){t.instance.getSetting("onCellMouseOut",e,t.instance.wtTable.getCoords(n),n,t.instance)}}};var g=function M(e){if(e.button!==2){var r=t.parentCell(e.realTarget);if(r.TD===n[0]&&r.TD===n[1]){if(u(e.realTarget,"corner")){t.instance.getSetting("onCellCornerDblClick",e,r.coords,r.TD,t.instance)}else{t.instance.getSetting("onCellDblClick",e,r.coords,r.TD,t.instance)}n[0]=null;n[1]=null}else if(r.TD===n[0]){t.instance.getSetting("onCellMouseUp",e,r.coords,r.TD,t.instance);n[1]=r.TD;clearTimeout(t.dblClickTimeout[1]);t.dblClickTimeout[1]=setTimeout(function(){n[1]=null},500)}else if(r.TD&&t.instance.hasSetting("onCellMouseUp")){
t.instance.getSetting("onCellMouseUp",e,r.coords,r.TD,t.instance)}}};var w=function S(e){clearTimeout(a);e.preventDefault();g(e)};r.addEventListener(this.instance.wtTable.holder,"mousedown",o);r.addEventListener(this.instance.wtTable.TABLE,"mouseover",p);r.addEventListener(this.instance.wtTable.TABLE,"mouseout",v);r.addEventListener(this.instance.wtTable.holder,"mouseup",g);if(this.instance.wtTable.holder.parentNode.parentNode&&h()&&!t.instance.wtTable.isWorkingOnClone()){var b="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");r.addEventListener(this.instance.wtTable.holder,"touchstart",function(e){t.instance.touchApplied=true;if(d(e.target,b)){s.call(e.target,e)}});r.addEventListener(this.instance.wtTable.holder,"touchend",function(e){t.instance.touchApplied=false;if(d(e.target,b)){w.call(e.target,e)}});if(!t.instance.momentumScrolling){t.instance.momentumScrolling={}}r.addEventListener(this.instance.wtTable.holder,"scroll",function(e){clearTimeout(t.instance.momentumScrolling._timeout);if(!t.instance.momentumScrolling.ongoing){t.instance.getSetting("onBeforeTouchScroll")}t.instance.momentumScrolling.ongoing=true;t.instance.momentumScrolling._timeout=setTimeout(function(){if(!t.instance.touchApplied){t.instance.momentumScrolling.ongoing=false;t.instance.getSetting("onAfterMomentumScroll")}},200)})}r.addEventListener(window,"resize",function(){if(t.instance.getSetting("stretchH")!=="none"){t.instance.draw()}});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);r.destroy()}}p.prototype.parentCell=function(e){var t={};var r=this.instance.wtTable.TABLE;var n=l(e,["TD","TH"],r);if(n){t.coords=this.instance.wtTable.getCoords(n);t.TD=n}else if(u(e,"wtBorder")&&u(e,"current")){t.coords=this.instance.selections.current.cellRange.highlight;t.TD=this.instance.wtTable.getCell(t.coords)}else if(u(e,"wtBorder")&&u(e,"area")){if(this.instance.selections.area.cellRange){t.coords=this.instance.selections.area.cellRange.to;t.TD=this.instance.wtTable.getCell(t.coords)}}return t};window.WalkontableEvent=p},{eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/function":50}],10:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableColumnFilter:{get:function o(){return n}},__esModule:{value:true}});var n=function i(e,t,r){this.offset=e;this.total=t;this.countTH=r};$traceurRuntime.createClass(n,{offsetted:function a(e){return e+this.offset},unOffsetted:function s(e){return e-this.offset},renderedToSource:function l(e){return this.offsetted(e)},sourceToRendered:function u(e){return this.unOffsetted(e)},offsettedTH:function d(e){return e-this.countTH},unOffsettedTH:function f(e){return e+this.countTH},visibleRowHeadedColumnToSourceColumn:function c(e){return this.renderedToSource(this.offsettedTH(e))},sourceColumnToVisibleRowHeadedColumn:function h(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{});window.WalkontableColumnFilter=n},{}],11:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableRowFilter:{get:function o(){return n}},__esModule:{value:true}});var n=function i(e,t,r){this.offset=e;this.total=t;this.countTH=r};$traceurRuntime.createClass(n,{offsetted:function a(e){return e+this.offset},unOffsetted:function s(e){return e-this.offset},renderedToSource:function l(e){return this.offsetted(e)},sourceToRendered:function u(e){return this.unOffsetted(e)},offsettedTH:function d(e){return e-this.countTH},unOffsettedTH:function f(e){return e+this.countTH},visibleColHeadedRowToSourceRow:function c(e){return this.renderedToSource(this.offsettedTH(e))},sourceRowToVisibleColHeadedRow:function h(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{});window.WalkontableRowFilter=n},{}],12:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableOverlay:{get:function v(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),l=s.getScrollableElement,u=s.getTrimmingContainer;var d=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}).defineGetter;var f=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var c=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).eventManager;var h={};var m=function g(e){d(this,"wot",e,{writable:false});this.instance=this.wot;this.type="";this.mainTableScrollableElement=null;this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=u(this.hider.parentNode.parentNode);this.areElementSizesAdjusted=false;this.updateStateOfRendering()};var p=m;$traceurRuntime.createClass(m,{updateStateOfRendering:function w(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;if(t&&!this.needFullRender){this.reset()}return t},shouldBeRendered:function b(){return true},updateTrimmingContainer:function y(){this.trimmingContainer=u(this.hider.parentNode.parentNode)},updateMainScrollableElement:function C(){this.mainTableScrollableElement=l(this.wot.wtTable.TABLE)},makeClone:function _(e){if(p.CLONE_TYPES.indexOf(e)===-1){throw new Error('Clone type "'+e+'" is not supported.')}var t=document.createElement("DIV");var r=document.createElement("TABLE");t.className="ht_clone_"+e+" handsontable";t.style.position="absolute";t.style.top=0;t.style.left=0;t.style.overflow="hidden";r.className=this.wot.wtTable.TABLE.className;t.appendChild(r);this.type=e;this.wot.wtTable.wtRootElement.parentNode.appendChild(t);var n=this.wot.getSetting("preventOverflow");if(n===true||n==="horizontal"&&this.type===p.CLONE_TOP||n==="vertical"&&this.type===p.CLONE_LEFT){this.mainTableScrollableElement=window}else{this.mainTableScrollableElement=l(this.wot.wtTable.TABLE)}return new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:r})},refresh:function E(){var e=arguments[0]!==void 0?arguments[0]:false;var t=this.shouldBeRendered();if(this.clone&&(this.needFullRender||t)){this.clone.draw(e)}this.needFullRender=t},reset:function R(){if(!this.clone){return}var e=this.clone.wtTable.holder;var t=this.clone.wtTable.hider;var r=e.style;var n=t.style;var o=e.parentNode.style;f([r,n,o],function(e){e.width="";e.height=""})},destroy:function M(){c(this.clone).destroy()}},{get CLONE_TOP(){return"top"},get CLONE_BOTTOM(){return"bottom"},get CLONE_LEFT(){return"left"},get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"},get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[p.CLONE_TOP,p.CLONE_BOTTOM,p.CLONE_LEFT,p.CLONE_TOP_LEFT_CORNER,p.CLONE_BOTTOM_LEFT_CORNER,p.CLONE_DEBUG]},registerOverlay:function S(e,t){if(p.CLONE_TYPES.indexOf(e)===-1){throw new Error("Unsupported overlay ("+e+").")}h[e]=t},createOverlay:function O(e,t){return new h[e](t)},isOverlayTypeOf:function T(e,t){if(!e||!h[t]){return false}return e instanceof h[t]}});window.WalkontableOverlay=m},{eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/object":53}],13:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableDebugOverlay:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).addClass;var a=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlay;var s=function d(e){$traceurRuntime.superConstructor(l).call(this,e);this.clone=this.makeClone(a.CLONE_DEBUG);this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";i(this.clone.wtTable.holder.parentNode,"wtDebugVisible")};var l=s;$traceurRuntime.createClass(s,{},{},a);window.WalkontableDebugOverlay=s;a.registerOverlay(a.CLONE_DEBUG,s)},{_base:12,"helpers/dom/element":47}],14:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableLeftOverlay:{get:function b(){return g}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.addClass,s=i.getScrollbarWidth,l=i.getScrollLeft,u=i.getWindowScrollTop,d=i.hasClass,f=i.outerWidth,c=i.innerHeight,h=i.removeClass,m=i.setOverlayPosition,p=i.resetCssTransform;var v=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlay;var g=function y(e){$traceurRuntime.superConstructor(w).call(this,e);this.clone=this.makeClone(v.CLONE_LEFT)};var w=g;$traceurRuntime.createClass(g,{shouldBeRendered:function C(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?true:false},resetFixedPosition:function _(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=0;var r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window&&(!r||r!=="horizontal")){var n=this.wot.wtTable.hider.getBoundingClientRect();var o=Math.ceil(n.left);var i=Math.ceil(n.right);var a;var s;s=this.wot.wtTable.hider.style.top;s=s===""?0:s;if(o<0&&i-e.offsetWidth>0){a=-o}else{a=0}t=a;a=a+"px";m(e,a,s)}else{t=this.getScrollPosition();p(e)}this.adjustHeaderBordersPosition(t);this.adjustElementsSize()},setScrollPosition:function E(e){if(this.mainTableScrollableElement===window){window.scrollTo(e,u())}else{this.mainTableScrollableElement.scrollLeft=e}},onScroll:function R(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function M(e,t){var r=0;var n=this.wot.wtSettings.defaultColumnWidth;while(e<t){r+=this.wot.wtTable.getStretchedColumnWidth(e)||n;e++}return r},adjustElementsSize:function S(){var e=arguments[0]!==void 0?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||e){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!e){this.areElementSizesAdjusted=true}}},adjustRootElementSize:function O(){var e=this.wot.wtTable.holder;var t=e.clientHeight===e.offsetHeight?0:s();var r=this.clone.wtTable.holder.parentNode;var n=r.style;var o=this.wot.getSetting("preventOverflow");var i;if(this.trimmingContainer!==window||o==="vertical"){var a=this.wot.wtViewport.getWorkspaceHeight()-t;a=Math.min(a,c(this.wot.wtTable.wtRootElement));n.height=a+"px"}else{n.height=""}this.clone.wtTable.holder.style.height=n.height;i=f(this.clone.wtTable.TABLE);n.width=(i===0?i:i+4)+"px"},adjustRootChildrenSize:function T(){var e=s();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;if(e===0){e=30}this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+e+"px"},applyToDOM:function A(){var e=this.wot.getSetting("totalColumns");if(!this.areElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px"}else if(e===0){this.spreader.style.left="0"}else{throw new Error("Incorrect value of the columnsRenderCalculator")}this.spreader.style.right="";if(this.needFullRender){this.syncOverlayOffset()}},syncOverlayOffset:function N(){if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px"}else{this.clone.wtTable.spreader.style.top=""}},scrollTo:function D(e,t){var r=this.getTableParentOffset();var n=this.wot.cloneSource?this.wot.cloneSource:this.wot;var o=n.wtTable.holder;var i=0;if(t&&o.offsetWidth!==o.clientWidth){i=s()}if(t){r+=this.sumCellSizes(0,e+1);r-=this.wot.wtViewport.getViewportWidth()}else{r+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e)}r+=i;this.setScrollPosition(r)},getTableParentOffset:function k(){var e=this.wot.getSetting("preventOverflow");var t=0;if(!e&&this.trimmingContainer===window){t=this.wot.wtTable.holderOffset.left}return t},getScrollPosition:function x(){return l(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function I(e){var t=this.wot.wtTable.holder.parentNode;var r=this.wot.getSetting("rowHeaders");var n=this.wot.getSetting("fixedColumnsLeft");var o=this.wot.getSetting("totalRows");if(o){h(t,"emptyRows")}else{a(t,"emptyRows")}if(n&&!r.length){a(t,"innerBorderLeft")}else if(!n&&r.length){var i=d(t,"innerBorderLeft");if(e){a(t,"innerBorderLeft")}else{h(t,"innerBorderLeft")}if(!i&&e||i&&!e){this.wot.wtOverlays.adjustElementsSize()}}}},{},v);window.WalkontableLeftOverlay=g;v.registerOverlay(v.CLONE_LEFT,g)},{_base:12,"helpers/dom/element":47}],15:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableTopOverlay:{get:function b(){return g}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.addClass,s=i.getScrollbarWidth,l=i.getScrollTop,u=i.getWindowScrollLeft,d=i.hasClass,f=i.outerHeight,c=i.innerWidth,h=i.removeClass,m=i.setOverlayPosition,p=i.resetCssTransform;var v=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlay;var g=function y(e){$traceurRuntime.superConstructor(w).call(this,e);this.clone=this.makeClone(v.CLONE_TOP)};var w=g;$traceurRuntime.createClass(g,{shouldBeRendered:function C(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?true:false},resetFixedPosition:function _(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=0;var r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window&&(!r||r!=="vertical")){var n=this.wot.wtTable.hider.getBoundingClientRect();var o=Math.ceil(n.top);var i=Math.ceil(n.bottom);var a;var s;a=this.wot.wtTable.hider.style.left;a=a===""?0:a;if(o<0&&i-e.offsetHeight>0){s=-o}else{s=0}t=s;s=s+"px";m(e,a,s)}else{t=this.getScrollPosition();p(e)}this.adjustHeaderBordersPosition(t);this.adjustElementsSize()},setScrollPosition:function E(e){if(this.mainTableScrollableElement===window){window.scrollTo(u(),e)}else{this.mainTableScrollableElement.scrollTop=e}},onScroll:function R(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function M(e,t){var r=0;var n=this.wot.wtSettings.settings.defaultRowHeight;while(e<t){var o=this.wot.wtTable.getRowHeight(e);r+=o===void 0?n:o;e++}return r},adjustElementsSize:function S(){var e=arguments[0]!==void 0?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||e){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!e){this.areElementSizesAdjusted=true}}},adjustRootElementSize:function O(){var e=this.wot.wtTable.holder;var t=e.clientWidth===e.offsetWidth?0:s();var r=this.clone.wtTable.holder.parentNode;var n=r.style;var o=this.wot.getSetting("preventOverflow");var i;if(this.trimmingContainer!==window||o==="horizontal"){var a=this.wot.wtViewport.getWorkspaceWidth()-t;a=Math.min(a,c(this.wot.wtTable.wtRootElement));n.width=a+"px"}else{n.width=""}this.clone.wtTable.holder.style.width=n.width;i=f(this.clone.wtTable.TABLE);n.height=(i===0?i:i+4)+"px"},adjustRootChildrenSize:function T(){var e=s();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(e===0){e=30}this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"},applyToDOM:function A(){var e=this.wot.getSetting("totalRows");if(!this.areElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px"}else if(e===0){this.spreader.style.top="0"}else{throw new Error("Incorrect value of the rowsRenderCalculator")}this.spreader.style.bottom="";if(this.needFullRender){this.syncOverlayOffset()}},syncOverlayOffset:function N(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px"}else{this.clone.wtTable.spreader.style.left=""}},scrollTo:function D(e,t){var r=this.getTableParentOffset();var n=this.wot.cloneSource?this.wot.cloneSource:this.wot;var o=n.wtTable.holder;var i=0;if(t&&o.offsetHeight!==o.clientHeight){i=s()}if(t){var a=this.wot.getSetting("fixedRowsBottom");var l=this.wot.getSetting("fixedRowsTop");var u=this.wot.getSetting("totalRows");r+=this.sumCellSizes(0,e+1);r-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(u-a,u);r+=1}else{r+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),e)}r+=i;this.setScrollPosition(r)},getTableParentOffset:function k(){if(this.mainTableScrollableElement===window){return this.wot.wtTable.holderOffset.top}else{return 0}},getScrollPosition:function x(){return l(this.mainTableScrollableElement)},redrawSelectionBorders:function I(e){if(e&&e.cellRange){var t=e.getBorder(this.wot);if(t){var r=e.getCorners();t.disappear();t.appear(r)}}},redrawAllSelectionsBorders:function P(){var e=this.wot.selections;this.redrawSelectionBorders(e.current);this.redrawSelectionBorders(e.area);this.redrawSelectionBorders(e.fill);this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()},adjustHeaderBordersPosition:function L(e){var t=this.wot.wtTable.holder.parentNode;var r=this.wot.getSetting("totalColumns");if(r){h(t,"emptyColumns")}else{a(t,"emptyColumns")}if(this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0){var n=d(t,"innerBorderTop");if(e||this.wot.getSetting("totalRows")===0){a(t,"innerBorderTop")}else{h(t,"innerBorderTop")}if(!n&&e||n&&!e){this.wot.wtOverlays.adjustElementsSize();this.redrawAllSelectionsBorders()}}if(this.wot.getSetting("rowHeaders").length===0){var o=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(o){for(var i=0;i<o.length;i++){o[i].style["border-left-width"]=0}}}}},{},v);window.WalkontableTopOverlay=g;v.registerOverlay(v.CLONE_TOP,g)},{_base:12,"helpers/dom/element":47}],16:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableTopLeftCornerOverlay:{get:function h(){return f}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.outerHeight,s=i.outerWidth,l=i.setOverlayPosition,u=i.resetCssTransform;var d=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlay;var f=function m(e){$traceurRuntime.superConstructor(c).call(this,e);this.clone=this.makeClone(d.CLONE_TOP_LEFT_CORNER)};var c=f;$traceurRuntime.createClass(f,{shouldBeRendered:function p(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?true:false},resetFixedPosition:function v(){this.updateTrimmingContainer();if(!this.wot.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=a(this.clone.wtTable.TABLE);var r=s(this.clone.wtTable.TABLE);var n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect();var i=Math.ceil(o.top);var d=Math.ceil(o.left);var f=Math.ceil(o.bottom);var c=Math.ceil(o.right);var h="0";var m="0";if(!n||n==="vertical"){if(d<0&&c-e.offsetWidth>0){h=-d+"px"}}if(!n||n==="horizontal"){if(i<0&&f-e.offsetHeight>0){m=-i+"px"}}l(e,h,m)}else{u(e)}e.style.height=(t===0?t:t+4)+"px";e.style.width=(r===0?r:r+4)+"px"}},{},d);window.WalkontableTopLeftCornerOverlay=f;d.registerOverlay(d.CLONE_TOP_LEFT_CORNER,f)},{_base:12,"helpers/dom/element":47}],17:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableOverlays:{get:function w(){return g}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),u=l.getScrollableElement,d=l.getScrollbarWidth,f=l.getScrollLeft,c=l.getScrollTop;var h=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var m=(i=e("helpers/unicode"),i&&i.__esModule&&i||{"default":i}).isKey;var p=(a=e("helpers/browser"),a&&a.__esModule&&a||{"default":a}).isMobileBrowser;var v=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager;var g=function b(e){this.wot=e;this.instance=this.wot;this.eventManager=new v(this.wot);this.wot.update("scrollbarWidth",d());this.wot.update("scrollbarHeight",d());this.scrollableElement=u(this.wot.wtTable.TABLE);this.prepareOverlays();this.destroyed=false;this.keyPressed=false;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}};this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}};this.verticalScrolling=false;this.horizontalScrolling=false;this.delegatedScrollCallback=false;this.registeredListeners=[];this.registerListeners()};$traceurRuntime.createClass(g,{prepareOverlays:function y(){var e=false;if(this.topOverlay){e=this.topOverlay.updateStateOfRendering()||e}else{this.topOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP,this.wot)}if(typeof WalkontableBottomOverlay==="undefined"){this.bottomOverlay={needFullRender:false,updateStateOfRendering:function t(){return false}}}if(typeof WalkontableBottomLeftCornerOverlay==="undefined"){this.bottomLeftCornerOverlay={needFullRender:false,updateStateOfRendering:function r(){return false}}}if(this.bottomOverlay){e=this.bottomOverlay.updateStateOfRendering()||e}else{this.bottomOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM,this.wot)}if(this.leftOverlay){e=this.leftOverlay.updateStateOfRendering()||e}else{this.leftOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT,this.wot)}if(this.topOverlay.needFullRender&&this.leftOverlay.needFullRender){if(this.topLeftCornerOverlay){e=this.topLeftCornerOverlay.updateStateOfRendering()||e}else{this.topLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,this.wot)}}if(this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender){if(this.bottomLeftCornerOverlay){e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e}else{this.bottomLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER,this.wot)}}if(this.wot.getSetting("debug")&&!this.debug){this.debug=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG,this.wot)}return e},refreshAll:function C(){if(!this.wot.drawn){return}if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(true);if(this.verticalScrolling){this.leftOverlay.onScroll()}if(this.horizontalScrolling){this.topOverlay.onScroll()}this.verticalScrolling=false;this.horizontalScrolling=false},registerListeners:function _(){var e=this;var t=this.topOverlay.mainTableScrollableElement;var r=this.leftOverlay.mainTableScrollableElement;var n=[];n.push([document.documentElement,"keydown",function(t){return e.onKeyDown(t)}]);n.push([document.documentElement,"keyup",function(){return e.onKeyUp()}]);n.push([document,"visibilitychange",function(){return e.onKeyUp()}]);n.push([t,"scroll",function(t){return e.onTableScroll(t)}]);if(t!==r){n.push([r,"scroll",function(t){return e.onTableScroll(t)}])}if(this.topOverlay.needFullRender){n.push([this.topOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]);n.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])}if(this.bottomOverlay.needFullRender){n.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]);n.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])}if(this.leftOverlay.needFullRender){n.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]);n.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])}if(this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender){n.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])}if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender){n.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])}if(this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window){n.push([window,"wheel",function(t){var r;var n=t.wheelDeltaY||t.deltaY;var o=t.wheelDeltaX||t.deltaX;if(e.topOverlay.clone.wtTable.holder.contains(t.realTarget)){r="top"}else if(e.bottomOverlay.clone&&e.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)){r="bottom"}else if(e.leftOverlay.clone.wtTable.holder.contains(t.realTarget)){r="left"}else if(e.topLeftCornerOverlay&&e.topLeftCornerOverlay.clone&&e.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)){r="topLeft"}else if(e.bottomLeftCornerOverlay&&e.bottomLeftCornerOverlay.clone&&e.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)){r="bottomLeft"}if(r=="top"&&n!==0||r=="left"&&o!==0||r=="bottom"&&n!==0||(r==="topLeft"||r==="bottomLeft")&&(n!==0||o!==0)){t.preventDefault()}}])}while(n.length){var o=n.pop();this.eventManager.addEventListener(o[0],o[1],o[2]);this.registeredListeners.push(o)}},deregisterListeners:function E(){while(this.registeredListeners.length){var e=this.registeredListeners.pop();this.eventManager.removeEventListener(e[0],e[1],e[2])}},onTableScroll:function R(e){if(p()){return}var t=this.leftOverlay.mainTableScrollableElement;var r=this.topOverlay.mainTableScrollableElement;var n=e.target;if(this.keyPressed){if(r!==window&&n!==window&&!e.target.contains(r)||t!==window&&n!==window&&!e.target.contains(t)){return}}if(e.type==="scroll"){this.syncScrollPositions(e)}else{this.translateMouseWheelToScroll(e)}},onKeyDown:function M(e){this.keyPressed=m(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")},onKeyUp:function S(){this.keyPressed=false},translateMouseWheelToScroll:function O(e){var t=this.topOverlay.clone.wtTable.holder;var r=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null;var n=this.leftOverlay.clone.wtTable.holder;var o=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null;var i=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null;var a=-.2;var s=e.wheelDeltaY||-1*e.deltaY;var l=e.wheelDeltaX||-1*e.deltaX;var u=null;var d={type:"wheel"};var f=e.target;var c=null;if(e.deltaMode===1){s=s*120;l=l*120}while(f!=document&&f!=null){if(f.className.indexOf("wtHolder")>-1){u=f;break}f=f.parentNode}d.target=u;if(u===o||u===i){this.syncScrollPositions(d,a*l,"x");this.syncScrollPositions(d,a*s,"y")}else{if(u===t||u===r){c=s}else if(u===n){c=l}this.syncScrollPositions(d,a*c)}return false},syncScrollPositions:function T(e){var t=arguments[1]!==void 0?arguments[1]:null;var r=arguments[2]!==void 0?arguments[2]:null;if(this.destroyed){return}if(arguments.length===0){this.syncScrollWithMaster();return}var n=this.leftOverlay.mainTableScrollableElement;var o=this.topOverlay.mainTableScrollableElement;var i=e.target;var a=0;var s=false;var l;var u;var d;var h;var m;var p=false;var v=this.wot.getSetting("preventOverflow");if(this.topOverlay.needFullRender){l=this.topOverlay.clone.wtTable.holder}if(this.bottomOverlay.needFullRender){m=this.bottomOverlay.clone.wtTable.holder}if(this.leftOverlay.needFullRender){u=this.leftOverlay.clone.wtTable.holder}if(this.leftOverlay.needFullRender&&this.topOverlay.needFullRender){d=this.topLeftCornerOverlay.clone.wtTable.holder}if(this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender){h=this.bottomLeftCornerOverlay.clone.wtTable.holder}if(i===document){i=window}if(i===n||i===o){if(v){a=f(this.scrollableElement)}else{a=f(i)}this.horizontalScrolling=true;this.overlayScrollPositions.master.left=a;s=true;if(this.pendingScrollCallbacks.master.left>0){this.pendingScrollCallbacks.master.left--}else{if(l&&l.scrollLeft!==a){if(t==null){this.pendingScrollCallbacks.top.left++}l.scrollLeft=a;p=n!==window}if(m&&m.scrollLeft!==a){if(t==null){this.pendingScrollCallbacks.bottom.left++}m.scrollLeft=a;p=n!==window}}a=c(i);this.verticalScrolling=true;this.overlayScrollPositions.master.top=a;s=true;if(this.pendingScrollCallbacks.master.top>0){this.pendingScrollCallbacks.master.top--}else{if(u&&u.scrollTop!==a){if(t==null){this.pendingScrollCallbacks.left.top++}u.scrollTop=a;p=o!==window}}}else if(i===m){a=f(i);this.horizontalScrolling=true;this.overlayScrollPositions.bottom.left=a;s=true;if(this.pendingScrollCallbacks.bottom.left>0){this.pendingScrollCallbacks.bottom.left--}else{if(t==null){this.pendingScrollCallbacks.master.left++}n.scrollLeft=a;if(l&&l.scrollLeft!==a){if(t==null){this.pendingScrollCallbacks.top.left++}l.scrollLeft=a;p=o!==window}}if(t!==null){s=true;o.scrollTop+=t}}else if(i===l){a=f(i);this.horizontalScrolling=true;this.overlayScrollPositions.top.left=a;s=true;if(this.pendingScrollCallbacks.top.left>0){this.pendingScrollCallbacks.top.left--}else{if(t==null){this.pendingScrollCallbacks.master.left++}n.scrollLeft=a}if(t!==null){s=true;o.scrollTop+=t}if(m&&m.scrollLeft!==a){if(t==null){this.pendingScrollCallbacks.bottom.left++}m.scrollLeft=a;p=o!==window}}else if(i===u){a=c(i);if(this.overlayScrollPositions.left.top!==a){this.verticalScrolling=true;this.overlayScrollPositions.left.top=a;s=true;if(this.pendingScrollCallbacks.left.top>0){this.pendingScrollCallbacks.left.top--}else{if(t==null){this.pendingScrollCallbacks.master.top++}o.scrollTop=a}}if(t!==null){s=true;o.scrollLeft+=t}}else if(i===d||i===h){if(t!==null){s=true;if(r==="x"){o.scrollLeft+=t}else if(r==="y"){o.scrollTop+=t}}}if(!this.keyPressed&&s&&e.type==="scroll"){if(this.delegatedScrollCallback){this.delegatedScrollCallback=false}else{this.refreshAll()}if(p){this.delegatedScrollCallback=true}}},syncScrollWithMaster:function A(){var e=this.topOverlay.mainTableScrollableElement;var t=e,r=t.scrollLeft,n=t.scrollTop;if(this.topOverlay.needFullRender){this.topOverlay.clone.wtTable.holder.scrollLeft=r}if(this.bottomOverlay.needFullRender){this.bottomOverlay.clone.wtTable.holder.scrollLeft=r}if(this.leftOverlay.needFullRender){this.leftOverlay.clone.wtTable.holder.scrollTop=n}},updateMainScrollableElements:function N(){this.deregisterListeners();this.leftOverlay.updateMainScrollableElement();this.topOverlay.updateMainScrollableElement();if(this.bottomOverlay.needFullRender){this.bottomOverlay.updateMainScrollableElement()}this.scrollableElement=u(this.wot.wtTable.TABLE);this.registerListeners()},destroy:function D(){this.eventManager.destroy();this.topOverlay.destroy();if(this.bottomOverlay.clone){this.bottomOverlay.destroy()}this.leftOverlay.destroy();if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.destroy()}if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone){this.bottomLeftCornerOverlay.destroy()}if(this.debug){this.debug.destroy()}this.destroyed=true},refresh:function k(){var e=arguments[0]!==void 0?arguments[0]:false;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement;var r=t.clientWidth;var n=t.clientHeight;if(r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height){this.spreaderLastSize.width=r;this.spreaderLastSize.height=n;this.adjustElementsSize()}}if(this.bottomOverlay.clone){this.bottomOverlay.refresh(e)}this.leftOverlay.refresh(e);this.topOverlay.refresh(e);if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.refresh(e)}if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone){this.bottomLeftCornerOverlay.refresh(e)}if(this.debug){this.debug.refresh(e)}},adjustElementsSize:function x(){var e=arguments[0]!==void 0?arguments[0]:false;var t=this.wot.getSetting("totalColumns");var r=this.wot.getSetting("totalRows");var n=this.wot.wtViewport.getRowHeaderWidth();var o=this.wot.wtViewport.getColumnHeaderHeight();var i=this.wot.wtTable.hider.style;i.width=n+this.leftOverlay.sumCellSizes(0,t)+"px";
i.height=o+this.topOverlay.sumCellSizes(0,r)+1+"px";this.topOverlay.adjustElementsSize(e);this.leftOverlay.adjustElementsSize(e);if(this.bottomOverlay.clone){this.bottomOverlay.adjustElementsSize(e)}},applyToDOM:function I(){if(!this.topOverlay.areElementSizesAdjusted||!this.leftOverlay.areElementSizesAdjusted){this.adjustElementsSize()}this.topOverlay.applyToDOM();if(this.bottomOverlay.clone){this.bottomOverlay.applyToDOM()}this.leftOverlay.applyToDOM()},getParentOverlay:function P(e){if(!e){return null}var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];var r=null;h(t,function(t,n){if(!t){return}if(t.clone&&t.clone.wtTable.TABLE.contains(e)){r=t.clone}});return r}},{});window.WalkontableOverlays=g},{eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/dom/element":47,"helpers/unicode":56}],18:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableScroll:{get:function p(){return m}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.innerHeight,s=i.innerWidth,l=i.getScrollLeft,u=i.getScrollTop,d=i.offset;var f=(o=e("helpers/number"),o&&o.__esModule&&o||{"default":o}),c=f.rangeEach,h=f.rangeEachReverse;var m=function v(e){this.wot=e;this.instance=e};$traceurRuntime.createClass(m,{scrollViewport:function g(e){if(!this.wot.drawn){return}var t=this._getVariables(),r=t.topOverlay,n=t.leftOverlay,o=t.totalRows,i=t.totalColumns,a=t.fixedRowsTop,s=t.fixedRowsBottom,l=t.fixedColumnsLeft;if(e.row<0||e.row>Math.max(o-1,0)){throw new Error("row "+e.row+" does not exist")}if(e.col<0||e.col>Math.max(i-1,0)){throw new Error("column "+e.col+" does not exist")}if(e.row>=a&&e.row<this.getFirstVisibleRow()){r.scrollTo(e.row)}else if(e.row>this.getLastVisibleRow()&&e.row<o-s){r.scrollTo(e.row,true)}if(e.col>=l&&e.col<this.getFirstVisibleColumn()){n.scrollTo(e.col)}else if(e.col>this.getLastVisibleColumn()){n.scrollTo(e.col,true)}},getFirstVisibleRow:function w(){var e=this._getVariables(),t=e.topOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalRows,i=e.fixedRowsTop;var s=r.getFirstVisibleRow();if(t.mainTableScrollableElement===window){var l=d(r.wtRootElement);var f=a(r.hider);var c=a(window);var m=u(window);if(l.top+f-c<=m){var p=n.getColumnHeaderHeight();p+=t.sumCellSizes(0,i);h(o,1,function(e){p+=t.sumCellSizes(e-1,e);if(l.top+f-p<=m){s=e;return false}})}}return s},getLastVisibleRow:function b(){var e=this._getVariables(),t=e.topOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalRows;var i=r.getLastVisibleRow();if(t.mainTableScrollableElement===window){var s=d(r.wtRootElement);var l=a(window);var f=u(window);if(s.top>f){var h=n.getColumnHeaderHeight();c(1,o,function(e){h+=t.sumCellSizes(e-1,e);if(s.top+h-f>=l){i=e-2;return false}})}}return i},getFirstVisibleColumn:function y(){var e=this._getVariables(),t=e.leftOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalColumns,i=e.fixedColumnsLeft;var a=r.getFirstVisibleColumn();if(t.mainTableScrollableElement===window){var u=d(r.wtRootElement);var f=s(r.hider);var c=s(window);var m=l(window);if(u.left+f-c<=m){var p=n.getRowHeaderWidth();h(o,1,function(e){p+=t.sumCellSizes(e-1,e);if(u.left+f-p<=m){a=e;return false}})}}return a},getLastVisibleColumn:function C(){var e=this._getVariables(),t=e.leftOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalColumns;var i=r.getLastVisibleColumn();if(t.mainTableScrollableElement===window){var a=d(r.wtRootElement);var u=s(window);var f=l(window);if(a.left>f){var h=n.getRowHeaderWidth();c(1,o,function(e){h+=t.sumCellSizes(e-1,e);if(a.left+h-f>=u){i=e-2;return false}})}}return i},_getVariables:function _(){var e=this.wot;var t=e.wtOverlays.topOverlay;var r=e.wtOverlays.leftOverlay;var n=e.wtTable;var o=e.wtViewport;var i=e.getSetting("totalRows");var a=e.getSetting("totalColumns");var s=e.getSetting("fixedRowsTop");var l=e.getSetting("fixedRowsBottom");var u=e.getSetting("fixedColumnsLeft");return{topOverlay:t,leftOverlay:r,wtTable:n,wtViewport:o,totalRows:i,totalColumns:a,fixedRowsTop:s,fixedRowsBottom:l,fixedColumnsLeft:u}}},{});window.WalkontableScroll=m},{"helpers/dom/element":47,"helpers/number":52}],19:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableSelection:{get:function c(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).addClass;var l=(o=e("border"),o&&o.__esModule&&o||{"default":o}).WalkontableBorder;var u=(i=e("cell/coords"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords;var d=(a=e("cell/range"),a&&a.__esModule&&a||{"default":a}).WalkontableCellRange;var f=function h(e,t){this.settings=e;this.cellRange=t||null;this.instanceBorders={}};$traceurRuntime.createClass(f,{getBorder:function m(e){if(this.instanceBorders[e.guid]){return this.instanceBorders[e.guid]}this.instanceBorders[e.guid]=new l(e,this.settings)},isEmpty:function p(){return this.cellRange===null},add:function v(e){if(this.isEmpty()){this.cellRange=new d(e,e,e)}else{this.cellRange.expand(e)}},replace:function g(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e)){this.cellRange.from=t;return true}if(this.cellRange.to.isEqual(e)){this.cellRange.to=t;return true}}return false},clear:function w(){this.cellRange=null},getCorners:function b(){var e=this.cellRange.getTopLeftCorner();var t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},addClassAtCoords:function y(e,t,r,n){var o=e.wtTable.getCell(new u(t,r));if((typeof o==="undefined"?"undefined":_typeof(o))==="object"){s(o,n)}},draw:function C(e){if(this.isEmpty()){if(this.settings.border){var t=this.getBorder(e);if(t){t.disappear()}}return}var r=e.wtTable.getRenderedRowsCount();var n=e.wtTable.getRenderedColumnsCount();var o=this.getCorners();var i,a,l;for(var u=0;u<n;u++){a=e.wtTable.columnFilter.renderedToSource(u);if(a>=o[1]&&a<=o[3]){l=e.wtTable.getColumnHeader(a);if(l){var d=[];if(this.settings.highlightHeaderClassName){d.push(this.settings.highlightHeaderClassName)}if(this.settings.highlightColumnClassName){d.push(this.settings.highlightColumnClassName)}s(l,d)}}}for(var f=0;f<r;f++){i=e.wtTable.rowFilter.renderedToSource(f);if(i>=o[0]&&i<=o[2]){l=e.wtTable.getRowHeader(i);if(l){var c=[];if(this.settings.highlightHeaderClassName){c.push(this.settings.highlightHeaderClassName)}if(this.settings.highlightRowClassName){c.push(this.settings.highlightRowClassName)}s(l,c)}}for(var h=0;h<n;h++){a=e.wtTable.columnFilter.renderedToSource(h);if(i>=o[0]&&i<=o[2]&&a>=o[1]&&a<=o[3]){if(this.settings.className){this.addClassAtCoords(e,i,a,this.settings.className)}}else if(i>=o[0]&&i<=o[2]){if(this.settings.highlightRowClassName){this.addClassAtCoords(e,i,a,this.settings.highlightRowClassName)}}else if(a>=o[1]&&a<=o[3]){if(this.settings.highlightColumnClassName){this.addClassAtCoords(e,i,a,this.settings.highlightColumnClassName)}}}}e.getSetting("onBeforeDrawBorders",o,this.settings.className);if(this.settings.border){var m=this.getBorder(e);if(m){m.appear(o)}}}},{});window.WalkontableSelection=f},{border:3,"cell/coords":6,"cell/range":7,"helpers/dom/element":47}],20:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableSettings:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).fastInnerText;var i=function s(e,t){var r=this;this.wot=e;this.instance=e;this.defaults={table:void 0,debug:false,externalRowCalculator:false,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function i(){return false},data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function a(){return[]},columnHeaders:function s(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function l(e,t,n){var i=r.getSetting("data",e,t);o(n,i===void 0||i===null?"":i)},columnWidth:function u(e){return},rowHeight:function d(e){return},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:false,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function f(e){return e},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:false,groups:false,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null};this.settings={};for(var n in this.defaults){if(this.defaults.hasOwnProperty(n)){if(t[n]!==void 0){this.settings[n]=t[n]}else if(this.defaults[n]===void 0){throw new Error('A required setting "'+n+'" was not provided')}else{this.settings[n]=this.defaults[n]}}}};$traceurRuntime.createClass(i,{update:function l(e,t){if(t===void 0){for(var r in e){if(e.hasOwnProperty(r)){this.settings[r]=e[r]}}}else{this.settings[e]=t}return this.wot},getSetting:function u(e,t,r,n,o){if(typeof this.settings[e]==="function"){return this.settings[e](t,r,n,o)}else if(t!==void 0&&Array.isArray(this.settings[e])){return this.settings[e][t]}else{return this.settings[e]}},has:function d(e){return!!this.settings[e]}},{});window.WalkontableSettings=i},{"helpers/dom/element":47}],21:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableTable:{get:function O(){return S}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),f=d.getStyle,c=d.getTrimmingContainer,h=d.hasClass,m=d.index,p=d.offset,v=d.removeClass,g=d.removeTextNodes,w=d.overlayContainsElement,b=d.closest;var y=(o=e("helpers/function"),o&&o.__esModule&&o||{"default":o}).isFunction;var C=(i=e("cell/coords"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords;var _=(a=e("cell/range"),a&&a.__esModule&&a||{"default":a}).WalkontableCellRange;var E=(s=e("filter/column"),s&&s.__esModule&&s||{"default":s}).WalkontableColumnFilter;var R=(l=e("filter/row"),l&&l.__esModule&&l||{"default":l}).WalkontableRowFilter;var M=(u=e("tableRenderer"),u&&u.__esModule&&u||{"default":u}).WalkontableTableRenderer;var S=function T(e,t){var r=this;this.wot=e;this.instance=this.wot;this.TABLE=t;this.TBODY=null;this.THEAD=null;this.COLGROUP=null;this.tableOffset=0;this.holderOffset=0;g(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.fixTableDomTree();this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null;this.correctHeaderWidth=false;var n=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return r._modifyRowHeaderWidth(n)}};$traceurRuntime.createClass(S,{fixTableDomTree:function A(){this.TBODY=this.TABLE.querySelector("tbody");if(!this.TBODY){this.TBODY=document.createElement("tbody");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.querySelector("thead");if(!this.THEAD){this.THEAD=document.createElement("thead");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.querySelector("colgroup");if(!this.COLGROUP){this.COLGROUP=document.createElement("colgroup");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){this.THEAD.appendChild(document.createElement("TR"))}},createSpreader:function N(e){var t=e.parentNode;var r;if(!t||t.nodeType!==1||!h(t,"wtHolder")){r=document.createElement("div");r.className="wtSpreader";if(t){t.insertBefore(r,e)}r.appendChild(e)}r.style.position="relative";return r},createHider:function D(e){var t=e.parentNode;var r;if(!t||t.nodeType!==1||!h(t,"wtHolder")){r=document.createElement("div");r.className="wtHider";if(t){t.insertBefore(r,e)}r.appendChild(e)}return r},createHolder:function k(e){var t=e.parentNode;var r;if(!t||t.nodeType!==1||!h(t,"wtHolder")){r=document.createElement("div");r.style.position="relative";r.className="wtHolder";if(t){t.insertBefore(r,e)}if(!this.isWorkingOnClone()){r.parentNode.className+="ht_master handsontable"}r.appendChild(e)}return r},alignOverlaysWithTrimmingContainer:function x(){var e=c(this.wtRootElement);if(!this.isWorkingOnClone()){this.holder.parentNode.style.position="relative";if(e===window){var t=this.wot.getSetting("preventOverflow");if(!t){this.holder.style.overflow="visible";this.wtRootElement.style.overflow="visible"}}else{this.holder.style.width=f(e,"width");this.holder.style.height=f(e,"height");this.holder.style.overflow=""}}},isWorkingOnClone:function I(){return!!this.wot.cloneSource},draw:function P(e){var t=this.wot,r=t.wtOverlays,n=t.wtViewport;var o=this.instance.getSetting("totalRows");var i=this.wot.getSetting("rowHeaders").length;var a=this.wot.getSetting("columnHeaders").length;var s=false;if(!this.isWorkingOnClone()){this.holderOffset=p(this.holder);e=n.createRenderCalculators(e);if(i&&!this.wot.getSetting("fixedColumnsLeft")){var l=r.leftOverlay.getScrollPosition();var u=this.correctHeaderWidth;this.correctHeaderWidth=l>0;if(u!==this.correctHeaderWidth){e=false}}}if(!this.isWorkingOnClone()){s=r.prepareOverlays()}if(e){if(!this.isWorkingOnClone()){n.createVisibleCalculators()}if(r){r.refresh(true)}}else{if(this.isWorkingOnClone()){this.tableOffset=this.wot.cloneSource.wtTable.tableOffset}else{this.tableOffset=p(this.TABLE)}var d;if(WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)){d=0}else if(WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)){d=Math.max(o-this.wot.getSetting("fixedRowsBottom"),0)}else{d=n.rowsRenderCalculator.startRow}var f;if(WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)){f=0}else{f=n.columnsRenderCalculator.startColumn}this.rowFilter=new R(d,o,a);this.columnFilter=new E(f,this.wot.getSetting("totalColumns"),i);this.alignOverlaysWithTrimmingContainer();this._doDraw()}this.refreshSelections(e);if(!this.isWorkingOnClone()){r.topOverlay.resetFixedPosition();if(r.bottomOverlay.clone){r.bottomOverlay.resetFixedPosition()}r.leftOverlay.resetFixedPosition();if(r.topLeftCornerOverlay){r.topLeftCornerOverlay.resetFixedPosition()}if(r.bottomLeftCornerOverlay&&r.bottomLeftCornerOverlay.clone){r.bottomLeftCornerOverlay.resetFixedPosition()}}if(s){r.syncScrollWithMaster()}this.wot.drawn=true;return this},_doDraw:function L(){var e=new M(this);e.render()},removeClassFromCells:function H(e){var t=this.TABLE.querySelectorAll("."+e);for(var r=0,n=t.length;r<n;r++){v(t[r],e)}},refreshSelections:function V(e){if(!this.wot.selections){return}var t=this.wot.selections.length;if(e){for(var r=0;r<t;r++){if(this.wot.selections[r].settings.className){this.removeClassFromCells(this.wot.selections[r].settings.className)}if(this.wot.selections[r].settings.highlightHeaderClassName){this.removeClassFromCells(this.wot.selections[r].settings.highlightHeaderClassName)}if(this.wot.selections[r].settings.highlightRowClassName){this.removeClassFromCells(this.wot.selections[r].settings.highlightRowClassName)}if(this.wot.selections[r].settings.highlightColumnClassName){this.removeClassFromCells(this.wot.selections[r].settings.highlightColumnClassName)}}}for(var n=0;n<t;n++){this.wot.selections[n].draw(this.wot,e)}},getCell:function F(e){if(this.isRowBeforeRenderedRows(e.row)){return-1}else if(this.isRowAfterRenderedRows(e.row)){return-2}var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];if(t){return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]}},getColumnHeader:function B(e){var t=arguments[1]!==void 0?arguments[1]:0;var r=this.THEAD.childNodes[t];if(r){return r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},getRowHeader:function j(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0){return null}var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];if(t){return t.childNodes[0]}},getCoords:function W(e){if(e.nodeName!=="TD"&&e.nodeName!=="TH"){e=b(e,["TD","TH"])}var t=e.parentNode;var r=t.parentNode;var n=m(t);var o=e.cellIndex;if(w(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,e)||w(WalkontableOverlay.CLONE_TOP,e)){if(r.nodeName==="THEAD"){n-=r.childNodes.length}}else{if(r===this.THEAD){n=this.rowFilter.visibleColHeadedRowToSourceRow(n)}else{n=this.rowFilter.renderedToSource(n)}}if(w(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,e)||w(WalkontableOverlay.CLONE_LEFT,e)){o=this.columnFilter.offsettedTH(o)}else{o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o)}return new C(n,o)},getTrForRow:function $(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},getFirstRenderedRow:function U(){return this.wot.wtViewport.rowsRenderCalculator.startRow},getFirstVisibleRow:function G(){return this.wot.wtViewport.rowsVisibleCalculator.startRow},getFirstRenderedColumn:function Y(){return this.wot.wtViewport.columnsRenderCalculator.startColumn},getFirstVisibleColumn:function z(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn},getLastRenderedRow:function K(){return this.wot.wtViewport.rowsRenderCalculator.endRow},getLastVisibleRow:function q(){return this.wot.wtViewport.rowsVisibleCalculator.endRow},getLastRenderedColumn:function X(){return this.wot.wtViewport.columnsRenderCalculator.endColumn},getLastVisibleColumn:function J(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn},isRowBeforeRenderedRows:function Z(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)<0&&e>=0},isRowAfterViewport:function Q(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastVisibleRow()},isRowAfterRenderedRows:function ee(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastRenderedRow()},isColumnBeforeViewport:function te(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0},isColumnAfterViewport:function re(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)>this.getLastVisibleColumn()},isLastRowFullyVisible:function ne(){return this.getLastVisibleRow()===this.getLastRenderedRow()},isLastColumnFullyVisible:function oe(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()},getRenderedColumnsCount:function ie(){var e=this.wot.wtViewport.columnsRenderCalculator.count;var t=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)){e=t}else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_LEFT)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)){return Math.min(this.wot.getSetting("fixedColumnsLeft"),t)}return e},getRenderedRowsCount:function ae(){var e=this.wot.wtViewport.rowsRenderCalculator.count;var t=this.wot.getSetting("totalRows");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)){e=t}else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)){e=Math.min(this.wot.getSetting("fixedRowsTop"),t)}else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)){e=Math.min(this.wot.getSetting("fixedRowsBottom"),t)}return e},getVisibleRowsCount:function se(){return this.wot.wtViewport.rowsVisibleCalculator.count},allRowsInViewport:function le(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()},getRowHeight:function ue(e){var t=this.wot.wtSettings.settings.rowHeight(e);var r=this.wot.wtViewport.oversizedRows[e];if(r!==void 0){t=t===void 0?r:Math.max(t,r)}return t},getColumnHeaderHeight:function de(e){var t=this.wot.wtSettings.settings.defaultRowHeight;var r=this.wot.wtViewport.oversizedColumnHeaders[e];if(r!==void 0){t=t?Math.max(t,r):r}return t},getVisibleColumnsCount:function fe(){return this.wot.wtViewport.columnsVisibleCalculator.count},allColumnsInViewport:function ce(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()},getColumnWidth:function he(e){var t=this.wot.wtSettings.settings.columnWidth;if(typeof t==="function"){t=t(e)}else if((typeof t==="undefined"?"undefined":_typeof(t))==="object"){t=t[e]}return t||this.wot.wtSettings.settings.defaultColumnWidth},getStretchedColumnWidth:function me(e){var t=this.getColumnWidth(e);var r=t==null?this.instance.wtSettings.settings.defaultColumnWidth:t;var n=this.wot.wtViewport.columnsRenderCalculator;if(n){var o=n.getStretchedColumnWidth(e,r);if(o){r=o}}return r},_modifyRowHeaderWidth:function pe(e){var t=y(e)?e():null;if(Array.isArray(t)){t=$traceurRuntime.spread(t);t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])}else{t=this._correctRowHeaderWidth(t)}return t},_correctRowHeaderWidth:function ve(e){if(typeof e!=="number"){e=this.wot.getSetting("defaultColumnWidth")}if(this.correctHeaderWidth){e++}return e}},{});window.WalkontableTable=S},{"cell/coords":6,"cell/range":7,"filter/column":10,"filter/row":11,"helpers/dom/element":47,"helpers/function":50,tableRenderer:22}],22:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableTableRenderer:{get:function p(){return c}},__esModule:{value:true}});var n;var o=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),i=o.addClass,a=o.empty,s=o.getScrollbarWidth,l=o.hasClass,u=o.innerHeight,d=o.outerWidth;var f=false;var c=function v(e){this.wtTable=e;this.wot=e.instance;this.instance=e.instance;this.rowFilter=e.rowFilter;this.columnFilter=e.columnFilter;this.TABLE=e.TABLE;this.THEAD=e.THEAD;this.TBODY=e.TBODY;this.COLGROUP=e.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0;this.fixedRowsBottom=0};$traceurRuntime.createClass(c,{render:function g(){if(!this.wtTable.isWorkingOnClone()){var e={};this.wot.getSetting("beforeDraw",true,e);if(e.skipRender===true){return}}this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var t=this.wtTable.getRenderedColumnsCount();var r=this.wtTable.getRenderedRowsCount();var n=this.wot.getSetting("totalColumns");var o=this.wot.getSetting("totalRows");var i;var a=false;if(WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)){this.columnHeaders=[];this.columnHeaderCount=0}if(n>=0){this.adjustAvailableNodes();a=true;this.renderColumnHeaders();this.renderRows(o,r,t);if(!this.wtTable.isWorkingOnClone()){i=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtViewport.containerWidth=null}this.adjustColumnWidths(t);this.markOversizedColumnHeaders();this.adjustColumnHeaderHeights()}if(!a){this.adjustAvailableNodes()}this.removeRedundantRows(r);if(!this.wtTable.isWorkingOnClone()||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)){this.markOversizedRows()}if(!this.wtTable.isWorkingOnClone()){this.wot.wtViewport.createVisibleCalculators();this.wot.wtOverlays.refresh(false);this.wot.wtOverlays.applyToDOM();var s=d(this.wtTable.hider);var l=d(this.wtTable.TABLE);if(s!==0&&l!==s){this.adjustColumnWidths(t)}if(i!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var u=this.wtTable.getFirstRenderedColumn();var f=this.wtTable.getLastRenderedColumn();var c=this.wot.getSetting("defaultColumnWidth");var h=this.wot.getSetting("rowHeaderWidth");h=this.instance.getSetting("onModifyRowHeaderWidth",h);if(h!=null){for(var m=0;m<this.rowHeaderCount;m++){var p=Array.isArray(h)?h[m]:h;p=p==null?c:p;this.COLGROUP.childNodes[m].style.width=p+"px"}}for(var v=u;v<f;v++){var g=this.wtTable.getStretchedColumnWidth(v);var w=this.columnFilter.sourceToRendered(v);this.COLGROUP.childNodes[w+this.rowHeaderCount].style.width=g+"px"}}this.wot.getSetting("onDraw",true)}else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)){this.wot.cloneSource.wtOverlays.adjustElementsSize()}},removeRedundantRows:function w(e){while(this.wtTable.tbodyChildrenLength>e){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength--}},renderRows:function b(e,t,r){var n,o;var i=0;var a=this.rowFilter.renderedToSource(i);var s=this.wtTable.isWorkingOnClone();while(a<e&&a>=0){if(!f&&i>1e3){f=true;console.warn("Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number "+'of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')}if(t!==void 0&&i===t){break}o=this.getOrCreateTrForRow(i,o);this.renderRowHeaders(a,o);this.adjustColumns(o,r+this.rowHeaderCount);n=this.renderCells(a,o,r);if(!s||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)){this.resetOversizedRow(a)}if(o.firstChild){var l=this.wot.wtTable.getRowHeight(a);if(l){l--;o.firstChild.style.height=l+"px"}else{o.firstChild.style.height=""}}i++;a=this.rowFilter.renderedToSource(i)}},resetOversizedRow:function y(e){if(this.wot.getSetting("externalRowCalculator")){return}if(this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[e]){this.wot.wtViewport.oversizedRows[e]=void 0}},markOversizedRows:function C(){if(this.wot.getSetting("externalRowCalculator")){return}var e=this.instance.wtTable.TBODY.childNodes.length;var t=e*this.instance.wtSettings.settings.defaultRowHeight;var r=u(this.instance.wtTable.TBODY)-1;var n;var o;var i;var a;var s;var l=this.instance.getSetting("totalRows");if(t===r&&!this.instance.getSetting("fixedRowsBottom")){return}while(e){e--;i=this.instance.wtTable.rowFilter.renderedToSource(e);n=this.instance.wtTable.getRowHeight(i);a=this.instance.wtTable.getTrForRow(i);s=a.querySelector("th");if(s){o=u(s)}else{o=u(a)-1}if(!n&&this.instance.wtSettings.settings.defaultRowHeight<o||n<o){this.instance.wtViewport.oversizedRows[i]=++o}}},markOversizedColumnHeaders:function _(){var e=this.wot.getOverlayName();if(!this.columnHeaderCount||this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]||this.wtTable.isWorkingOnClone()){return}var t=this.wtTable.getRenderedColumnsCount();for(var r=0;r<this.columnHeaderCount;r++){for(var n=-1*this.rowHeaderCount;n<t;n++){this.markIfOversizedColumnHeader(n)}}this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]=true},adjustColumnHeaderHeights:function E(){var e=this.wot.getSetting("columnHeaders");var t=this.wot.wtTable.THEAD.childNodes;var r=this.wot.wtViewport.oversizedColumnHeaders;for(var n=0,o=e.length;n<o;n++){if(r[n]){if(!t[n]||t[n].childNodes.length===0){return}t[n].childNodes[0].style.height=r[n]+"px"}}},markIfOversizedColumnHeader:function R(e){var t=this.wot.wtTable.columnFilter.renderedToSource(e);var r=this.columnHeaderCount;var n=this.wot.wtSettings.settings.defaultRowHeight;var o;var i;var a;var s=this.wot.getSetting("columnHeaderHeight")||[];while(r){r--;o=this.wot.wtTable.getColumnHeaderHeight(r);i=this.wot.wtTable.getColumnHeader(t,r);if(!i){continue}a=u(i);if(!o&&n<a||o<a){this.wot.wtViewport.oversizedColumnHeaders[r]=a}if(Array.isArray(s)){if(s[r]!=null){this.wot.wtViewport.oversizedColumnHeaders[r]=s[r]}}else if(!isNaN(s)){this.wot.wtViewport.oversizedColumnHeaders[r]=s}if(this.wot.wtViewport.oversizedColumnHeaders[r]<(s[r]||s)){this.wot.wtViewport.oversizedColumnHeaders[r]=s[r]||s}}},renderCells:function M(e,t,r){var n;var o;for(var i=0;i<r;i++){o=this.columnFilter.renderedToSource(i);if(i===0){n=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]}else{n=n.nextSibling}if(n.nodeName=="TH"){n=m(n,t)}if(!l(n,"hide")){n.className=""}n.removeAttribute("style");this.wot.wtSettings.settings.cellRenderer(e,o,n)}return n},adjustColumnWidths:function S(e){var t=0;var r=this.wot.cloneSource?this.wot.cloneSource:this.wot;var n=r.wtTable.holder;var o=this.wot.getSetting("defaultColumnWidth");var i=this.wot.getSetting("rowHeaderWidth");if(n.offsetHeight<n.scrollHeight){t=s()}this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-t);i=this.instance.getSetting("onModifyRowHeaderWidth",i);if(i!=null){for(var a=0;a<this.rowHeaderCount;a++){var l=Array.isArray(i)?i[a]:i;l=l==null?o:l;this.COLGROUP.childNodes[a].style.width=l+"px"}}for(var u=0;u<e;u++){var d=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(u));this.COLGROUP.childNodes[u+this.rowHeaderCount].style.width=d+"px"}},appendToTbody:function O(e){this.TBODY.appendChild(e);this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function T(e,t){var r;if(e>=this.wtTable.tbodyChildrenLength){r=this.createRow();this.appendToTbody(r)}else if(e===0){r=this.TBODY.firstChild}else{r=t.nextSibling}if(r.className){r.removeAttribute("class")}return r},createRow:function A(){var e=document.createElement("TR");for(var t=0;t<this.rowHeaderCount;t++){e.appendChild(document.createElement("TH"))}return e},renderRowHeader:function N(e,t,r){r.className="";r.removeAttribute("style");this.rowHeaders[t](e,r,t)},renderRowHeaders:function D(e,t){for(var r=t.firstChild,n=0;n<this.rowHeaderCount;n++){if(!r){r=document.createElement("TH");t.appendChild(r)}else if(r.nodeName=="TD"){r=h(r,t)}this.renderRowHeader(e,n,r);r=r.nextSibling}},adjustAvailableNodes:function k(){this.adjustColGroups();this.adjustThead()},renderColumnHeaders:function x(){if(!this.columnHeaderCount){return}var e=this.wtTable.getRenderedColumnsCount();for(var t=0;t<this.columnHeaderCount;t++){var r=this.getTrForColumnHeaders(t);for(var n=-1*this.rowHeaderCount;n<e;n++){var o=this.columnFilter.renderedToSource(n);this.renderColumnHeader(t,o,r.childNodes[n+this.rowHeaderCount])}}},adjustColGroups:function I(){var e=this.wtTable.getRenderedColumnsCount();while(this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount){this.COLGROUP.appendChild(document.createElement("COL"));this.wtTable.colgroupChildrenLength++}while(this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.wtTable.colgroupChildrenLength--}if(this.rowHeaderCount){i(this.COLGROUP.childNodes[0],"rowHeader")}},adjustThead:function P(){var e=this.wtTable.getRenderedColumnsCount();var t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var r=0,n=this.columnHeaders.length;r<n;r++){t=this.THEAD.childNodes[r];if(!t){t=document.createElement("TR");this.THEAD.appendChild(t)}this.theadChildrenLength=t.childNodes.length;while(this.theadChildrenLength<e+this.rowHeaderCount){t.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>e+this.rowHeaderCount){t.removeChild(t.lastChild);this.theadChildrenLength--}}var o=this.THEAD.childNodes.length;if(o>this.columnHeaders.length){for(var i=this.columnHeaders.length;i<o;i++){this.THEAD.removeChild(this.THEAD.lastChild)}}}else if(t){a(t)}},getTrForColumnHeaders:function L(e){return this.THEAD.childNodes[e]},renderColumnHeader:function H(e,t,r){r.className="";r.removeAttribute("style");return this.columnHeaders[e](t,r,e);
},adjustColumns:function V(e,t){var r=e.childNodes.length;while(r<t){var n=document.createElement("TD");e.appendChild(n);r++}while(r>t){e.removeChild(e.lastChild);r--}},removeRedundantColumns:function F(e){while(this.wtTable.tbodyChildrenLength>e){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength--}}},{});function h(e,t){var r=document.createElement("TH");t.insertBefore(r,e);t.removeChild(e);return r}function m(e,t){var r=document.createElement("TD");t.insertBefore(r,e);t.removeChild(e);return r}window.WalkontableTableRenderer=c},{"helpers/dom/element":47}],23:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableViewport:{get:function _(){return C}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),f=d.getScrollbarWidth,c=d.getScrollTop,h=d.getStyle,m=d.offset,p=d.outerHeight,v=d.outerWidth;var g=(i=e("helpers/object"),i&&i.__esModule&&i||{"default":i}).objectEach;var w=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).EventManager;var b=(s=e("calculator/viewportColumns"),s&&s.__esModule&&s||{"default":s}).WalkontableViewportColumnsCalculator;var y=(l=e("calculator/viewportRows"),l&&l.__esModule&&l||{"default":l}).WalkontableViewportRowsCalculator;var C=function E(e){var t=this;this.wot=e;this.instance=this.wot;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.hasOversizedColumnHeadersMarked={};this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;this.eventManager=new w(this.wot);this.eventManager.addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})};$traceurRuntime.createClass(C,{getWorkspaceHeight:function R(){var e=this.instance.wtOverlays.topOverlay.trimmingContainer;var t;var r=0;if(e===window){r=document.documentElement.clientHeight}else{t=p(e);r=t>0&&e.clientHeight>0?e.clientHeight:Infinity}return r},getWorkspaceWidth:function M(){var e;var t=this.wot.getSetting("totalColumns");var r=this.instance.wtOverlays.leftOverlay.trimmingContainer;var n;var o=this.wot.getSetting("stretchH");var i=document.documentElement.offsetWidth;var a=this.wot.getSetting("preventOverflow");if(a){return v(this.instance.wtTable.wtRootElement)}if(u.freezeOverlays){e=Math.min(i-this.getWorkspaceOffset().left,i)}else{e=Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i)}if(r===window&&t>0&&this.sumColumnWidths(0,t-1)>e){return document.documentElement.clientWidth}if(r!==window){n=h(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow");if(n=="scroll"||n=="hidden"||n=="auto"){return Math.max(e,r.clientWidth)}}if(o==="none"||!o){return Math.max(e,v(this.instance.wtTable.TABLE))}else{return e}},hasVerticalScroll:function S(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function O(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function T(e,t){var r=0;while(e<t){r+=this.wot.wtTable.getColumnWidth(e);e++}return r},getContainerFillWidth:function A(){if(this.containerWidth){return this.containerWidth}var e=this.instance.wtTable.holder;var t;var r;r=document.createElement("div");r.style.width="100%";r.style.height="1px";e.appendChild(r);t=r.offsetWidth;this.containerWidth=t;e.removeChild(r);return t},getWorkspaceOffset:function N(){return m(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function D(){return p(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function k(){return v(this.wot.wtTable.TABLE)||v(this.wot.wtTable.TBODY)||v(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function x(){if(isNaN(this.columnHeaderHeight)){this.columnHeaderHeight=p(this.wot.wtTable.THEAD)}return this.columnHeaderHeight},getViewportHeight:function I(){var e=this.getWorkspaceHeight();var t;if(e===Infinity){return e}t=this.getColumnHeaderHeight();if(t>0){e-=t}return e},getRowHeaderWidth:function P(){var e=this.instance.getSetting("rowHeaderWidth");var t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var r=0,n=t.length;r<n;r++){this.rowHeaderWidth+=e[r]||e}}if(this.wot.cloneSource){return this.wot.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){if(t.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=t.length;i<a;i++){if(o){this.rowHeaderWidth+=v(o);o=o.nextSibling}else{this.rowHeaderWidth+=50}}}else{this.rowHeaderWidth=0}}this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth;return this.rowHeaderWidth},getViewportWidth:function L(){var e=this.getWorkspaceWidth();var t;if(e===Infinity){return e}t=this.getRowHeaderWidth();if(t>0){return e-t}return e},createRowsCalculator:function H(){var e=arguments[0]!==void 0?arguments[0]:false;var t=this;var r;var n;var o;var i;var a;var s;var l;this.rowHeaderWidth=NaN;if(this.wot.wtSettings.settings.renderAllRows){r=Infinity}else{r=this.getViewportHeight()}n=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();if(n<0){n=0}o=this.wot.getSetting("fixedRowsTop");a=this.wot.getSetting("fixedRowsBottom");l=this.wot.getSetting("totalRows");if(o){s=this.wot.wtOverlays.topOverlay.sumCellSizes(0,o);n+=s;r-=s}if(a&&this.wot.wtOverlays.bottomOverlay.clone){s=this.wot.wtOverlays.bottomOverlay.sumCellSizes(l-a,l);r-=s}if(this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight){i=0}else{i=f()}return new y(r,n,this.wot.getSetting("totalRows"),function(e){return t.wot.wtTable.getRowHeight(e)},e?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,e,i)},createColumnsCalculator:function V(){var e=arguments[0]!==void 0?arguments[0]:false;var t=this;var r=this.getViewportWidth();var n;var o;this.columnHeaderHeight=NaN;n=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset();if(n<0){n=0}o=this.wot.getSetting("fixedColumnsLeft");if(o){var i=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,o);n+=i;r-=i}if(this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth){r-=f()}return new b(r,n,this.wot.getSetting("totalColumns"),function(e){return t.wot.wtTable.getColumnWidth(e)},e?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,e,this.wot.getSetting("stretchH"),function(e,r){return t.wot.getSetting("onBeforeStretchingColumnWidth",e,r)})},createRenderCalculators:function F(){var e=arguments[0]!==void 0?arguments[0]:false;if(e){var t=this.createRowsCalculator(true);var r=this.createColumnsCalculator(true);if(!(this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(r))){e=false}}if(!e){this.rowsRenderCalculator=this.createRowsCalculator();this.columnsRenderCalculator=this.createColumnsCalculator()}this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;return e},createVisibleCalculators:function B(){this.rowsVisibleCalculator=this.createRowsCalculator(true);this.columnsVisibleCalculator=this.createColumnsCalculator(true)},areAllProposedVisibleRowsAlreadyRendered:function j(e){if(this.rowsVisibleCalculator){if(e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0){return false}else if(e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.wot.getSetting("totalRows")-1){return false}else{return true}}return false},areAllProposedVisibleColumnsAlreadyRendered:function W(e){if(this.columnsVisibleCalculator){if(e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0){return false}else if(e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.wot.getSetting("totalColumns")-1){return false}else{return true}}return false},resetHasOversizedColumnHeadersMarked:function $(){g(this.hasOversizedColumnHeadersMarked,function(e,t,r){r[t]=void 0})}},{});window.WalkontableViewport=C},{browser:24,"calculator/viewportColumns":4,"calculator/viewportRows":5,eventManager:42,"helpers/dom/element":47,"helpers/object":53}],24:[function(e,t,r){"use strict";var n,o,i,a,s,l,u,d,f,c,h,m,p,v,g,w,b,y,C,_,E,R,M,S;function O(e,t,r){var n=new O.Core(e,t||{});n.gridRef=r;n.init();return n}t.exports=O;O.utils={};n=e("shims/runtime"),n&&n.__esModule&&n||{"default":n};o=e("es6collections"),o&&o.__esModule&&o||{"default":o};var T=(i=e("pluginHooks"),i&&i.__esModule&&i||{"default":i}).Hooks;var A=(a=e("numbro"),a&&a.__esModule&&a||{"default":a}).default;var N=(s=e("moment"),s&&s.__esModule&&s||{"default":s}).default;if((typeof window==="undefined"?"undefined":_typeof(window))==="object"){if(typeof window.numbro==="undefined"){window.numbro=A}if(typeof window.moment==="undefined"){window.moment=N}}if(!O.hooks){O.hooks=new T}O.utils.Hooks=T;l=e("core"),l&&l.__esModule&&l||{"default":l};u=e("renderers/_cellDecorator"),u&&u.__esModule&&u||{"default":u};d=e("cellTypes"),d&&d.__esModule&&d||{"default":d};f=e("plugins/jqueryHandsontable"),f&&f.__esModule&&f||{"default":f};var D=(c=e("helpers/array"),c&&c.__esModule&&c||{"default":c});var k=(h=e("helpers/browser"),h&&h.__esModule&&h||{"default":h});var x=(m=e("helpers/data"),m&&m.__esModule&&m||{"default":m});var I=(p=e("helpers/date"),p&&p.__esModule&&p||{"default":p});var P=(v=e("helpers/feature"),v&&v.__esModule&&v||{"default":v});var L=(g=e("helpers/function"),g&&g.__esModule&&g||{"default":g});var H=(w=e("helpers/mixed"),w&&w.__esModule&&w||{"default":w});var V=(b=e("helpers/number"),b&&b.__esModule&&b||{"default":b});var F=(y=e("helpers/object"),y&&y.__esModule&&y||{"default":y});var B=(C=e("helpers/setting"),C&&C.__esModule&&C||{"default":C});var j=(_=e("helpers/string"),_&&_.__esModule&&_||{"default":_});var W=(E=e("helpers/unicode"),E&&E.__esModule&&E||{"default":E});var $=(R=e("helpers/dom/element"),R&&R.__esModule&&R||{"default":R});var U=(M=e("helpers/dom/event"),M&&M.__esModule&&M||{"default":M});var G=[D,k,x,I,P,L,H,V,F,B,j,W];var Y=[$,U];O.buildDate="Mon Apr 03 2017 15:02:25 GMT+0200 (CEST)";O.packageName="handsontable-pro";O.version="1.10.2";var z="0.31.2";if(!/^@@/.test(z)){O.baseVersion=z}O.plugins={};var K=(S=e("plugins"),S&&S.__esModule&&S||{"default":S}).registerPlugin;O.plugins.registerPlugin=K;O.helper={};O.dom={};O.Dom=O.dom;D.arrayEach(G,function(e){D.arrayEach(Object.getOwnPropertyNames(e),function(t){if(t.charAt(0)!=="_"){O.helper[t]=e[t]}})});D.arrayEach(Y,function(e){D.arrayEach(Object.getOwnPropertyNames(e),function(t){if(t.charAt(0)!=="_"){O.dom[t]=e[t]}})})},{cellTypes:25,core:26,es6collections:"es6collections","helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/date":46,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,"helpers/unicode":56,moment:"moment",numbro:"numbro",pluginHooks:61,plugins:62,"plugins/jqueryHandsontable":2,"renderers/_cellDecorator":119,"shims/runtime":126}],25:[function(e,t,r){"use strict";var n,o,i,a,s,l,u,d,f,c,h,m,p,v,g,w,b,y,C,_,E,R,M,S;var O=(n=e("helpers/browser"),n&&n.__esModule&&n||{"default":n}).isMobileBrowser;var T=(o=e("editors"),o&&o.__esModule&&o||{"default":o}).getEditorConstructor;var A=(i=e("renderers"),i&&i.__esModule&&i||{"default":i}).getRenderer;var N=(a=e("editors/autocompleteEditor"),a&&a.__esModule&&a||{"default":a}).AutocompleteEditor;var D=(s=e("editors/checkboxEditor"),s&&s.__esModule&&s||{"default":s}).CheckboxEditor;var k=(l=e("editors/dateEditor"),l&&l.__esModule&&l||{"default":l}).DateEditor;var x=(u=e("editors/dropdownEditor"),u&&u.__esModule&&u||{"default":u}).DropdownEditor;var I=(d=e("editors/handsontableEditor"),d&&d.__esModule&&d||{"default":d}).HandsontableEditor;var P=(f=e("editors/mobileTextEditor"),f&&f.__esModule&&f||{"default":f}).MobileTextEditor;var L=(c=e("editors/numericEditor"),c&&c.__esModule&&c||{"default":c}).NumericEditor;var H=(h=e("editors/passwordEditor"),h&&h.__esModule&&h||{"default":h}).PasswordEditor;var V=(m=e("editors/selectEditor"),m&&m.__esModule&&m||{"default":m}).SelectEditor;var F=(p=e("editors/textEditor"),p&&p.__esModule&&p||{"default":p}).TextEditor;var B=(v=e("renderers/autocompleteRenderer"),v&&v.__esModule&&v||{"default":v}).AutocompleteRenderer;var j=(g=e("renderers/checkboxRenderer"),g&&g.__esModule&&g||{"default":g}).CheckboxRenderer;var W=(w=e("renderers/htmlRenderer"),w&&w.__esModule&&w||{"default":w}).HtmlRenderer;var $=(b=e("renderers/numericRenderer"),b&&b.__esModule&&b||{"default":b}).NumericRenderer;var U=(y=e("renderers/passwordRenderer"),y&&y.__esModule&&y||{"default":y}).PasswordRenderer;var G=(C=e("renderers/textRenderer"),C&&C.__esModule&&C||{"default":C}).TextRenderer;var Y=(_=e("validators/autocompleteValidator"),_&&_.__esModule&&_||{"default":_}).AutocompleteValidator;var z=(E=e("validators/dateValidator"),E&&E.__esModule&&E||{"default":E}).DateValidator;var K=(R=e("validators/timeValidator"),R&&R.__esModule&&R||{"default":R}).TimeValidator;var q=(M=e("validators/numericValidator"),M&&M.__esModule&&M||{"default":M}).NumericValidator;var X=(S=e("browser"),S&&S.__esModule&&S||{"default":S}).default;X.AutocompleteCell={editor:T("autocomplete"),renderer:A("autocomplete"),validator:X.AutocompleteValidator};X.CheckboxCell={editor:T("checkbox"),renderer:A("checkbox")};X.TextCell={editor:O()?T("mobile"):T("text"),renderer:A("text")};X.NumericCell={editor:T("numeric"),renderer:A("numeric"),validator:X.NumericValidator,dataType:"number"};X.DateCell={editor:T("date"),validator:X.DateValidator,renderer:A("autocomplete")};X.TimeCell={editor:T("text"),validator:X.TimeValidator,renderer:A("text")};X.HandsontableCell={editor:T("handsontable"),renderer:A("autocomplete")};X.PasswordCell={editor:T("password"),renderer:A("password"),copyable:false};X.DropdownCell={editor:T("dropdown"),renderer:A("autocomplete"),validator:X.AutocompleteValidator};X.cellTypes={text:X.TextCell,date:X.DateCell,time:X.TimeCell,numeric:X.NumericCell,checkbox:X.CheckboxCell,autocomplete:X.AutocompleteCell,handsontable:X.HandsontableCell,password:X.PasswordCell,dropdown:X.DropdownCell};X.cellLookup={validator:{numeric:X.NumericValidator,autocomplete:X.AutocompleteValidator}}},{browser:24,editors:30,"editors/autocompleteEditor":32,"editors/checkboxEditor":33,"editors/dateEditor":34,"editors/dropdownEditor":35,"editors/handsontableEditor":36,"editors/mobileTextEditor":37,"editors/numericEditor":38,"editors/passwordEditor":39,"editors/selectEditor":40,"editors/textEditor":41,"helpers/browser":44,renderers:118,"renderers/autocompleteRenderer":120,"renderers/checkboxRenderer":121,"renderers/htmlRenderer":122,"renderers/numericRenderer":123,"renderers/passwordRenderer":124,"renderers/textRenderer":125,"validators/autocompleteValidator":135,"validators/dateValidator":136,"validators/numericValidator":137,"validators/timeValidator":138}],26:[function(e,t,r){"use strict";var n,o,i,a,s,l,u,d,f,c,h,m,p,v,g,w,b,y,C,_,E,R,M;var S=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var O=(o=e("numbro"),o&&o.__esModule&&o||{"default":o}).default;var T=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}),A=T.addClass,N=T.empty,D=T.isChildOfWebComponentTable,k=T.removeClass;var x=(a=e("helpers/setting"),a&&a.__esModule&&a||{"default":a}).columnFactory;var I=(s=e("helpers/function"),s&&s.__esModule&&s||{"default":s}).isFunction;var P=(l=e("helpers/mixed"),l&&l.__esModule&&l||{"default":l}),L=P.isDefined,H=P.isUndefined;var V=(u=e("helpers/browser"),u&&u.__esModule&&u||{"default":u}).isMobileBrowser;var F=(d=e("dataMap"),d&&d.__esModule&&d||{"default":d}).DataMap;var B=(f=e("editorManager"),f&&f.__esModule&&f||{"default":f}).EditorManager;var j=(c=e("eventManager"),c&&c.__esModule&&c||{"default":c}).eventManager;var W=(h=e("helpers/object"),h&&h.__esModule&&h||{"default":h}),$=W.deepClone,U=W.duckSchema,G=W.extend,Y=W.isObject,z=W.isObjectEquals,K=W.deepObjectSize,q=W.createObjectPropListener;var X=(m=e("helpers/array"),m&&m.__esModule&&m||{"default":m}),J=X.arrayFlatten,Z=X.arrayMap;var Q=(p=e("plugins"),p&&p.__esModule&&p||{"default":p}).getPlugin;var ee=(v=e("renderers"),v&&v.__esModule&&v||{"default":v}).getRenderer;var te=(g=e("helpers/string"),g&&g.__esModule&&g||{"default":g}).randomString;var re=(w=e("helpers/number"),w&&w.__esModule&&w||{"default":w}).rangeEach;var ne=(b=e("tableView"),b&&b.__esModule&&b||{"default":b}).TableView;var oe=(y=e("dataSource"),y&&y.__esModule&&y||{"default":y}).DataSource;var ie=(C=e("helpers/data"),C&&C.__esModule&&C||{"default":C}),ae=ie.translateRowsToColumns,se=ie.cellMethodLookupFactory,le=ie.spreadsheetColumnLabel;var ue=(_=e("utils/recordTranslator"),_&&_.__esModule&&_||{"default":_}).getTranslator;var de=(E=e("3rdparty/walkontable/src/cell/coords"),E&&E.__esModule&&E||{"default":E}).WalkontableCellCoords;var fe=(R=e("3rdparty/walkontable/src/cell/range"),R&&R.__esModule&&R||{"default":R}).WalkontableCellRange;var ce=(M=e("3rdparty/walkontable/src/calculator/viewportColumns"),M&&M.__esModule&&M||{"default":M}).WalkontableViewportColumnsCalculator;S.activeGuid=null;S.Core=function me(e,t){var r,n,o,i,a,s,l=this,u=function b(){},d=j(l);var f=ue(l);G(u.prototype,he.prototype);G(u.prototype,t);G(u.prototype,v(t));this.rootElement=e;this.isHotTableEnv=D(this.rootElement);S.eventManager.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("DIV");this.renderCall=false;e.insertBefore(this.container,e.firstChild);this.guid="ht_"+te();o=new oe(l);if(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_"){this.rootElement.id=this.guid}r={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new u,selRange:null,isPopulated:null,scrollable:null,firstRun:true};i={alter:function y(e,t,o,s,u){var d;o=o||1;function c(e,t,r,n){var o=function a(){var e;if(n==="array"){e=[]}else if(n==="object"){e={}}return e};var i=Z(new Array(r),function(){return o()});i.unshift(t,0);e.splice.apply(e,i)}switch(e){case"insert_row":var h=l.countSourceRows();if(l.getSettings().maxRows===h){return}t=L(t)?t:h;d=n.createRow(t,o,s);c(r.cellSettings,t,o,"array");if(d){if(a.isSelected()&&r.selRange.from.row>=t){r.selRange.from.row=r.selRange.from.row+d;a.transformEnd(d,0)}else{a.refreshBorders()}}break;case"insert_col":d=n.createCol(t,o,s);for(var m=0,p=l.countSourceRows();m<p;m++){if(r.cellSettings[m]){c(r.cellSettings[m],t,o)}}if(d){if(Array.isArray(l.getSettings().colHeaders)){var v=[t,0];v.length+=d;Array.prototype.splice.apply(l.getSettings().colHeaders,v)}if(a.isSelected()&&r.selRange.from.col>=t){r.selRange.from.col=r.selRange.from.col+d;a.transformEnd(0,d)}else{a.refreshBorders()}}break;case"remove_row":n.removeRow(t,o,s);r.cellSettings.splice(t,o);var g=l.countRows();var w=l.getSettings().fixedRowsTop;if(w>=t+1){l.getSettings().fixedRowsTop-=Math.min(o,w-t)}var b=l.getSettings().fixedRowsBottom;if(b&&t>=g-b){l.getSettings().fixedRowsBottom-=Math.min(o,b)}i.adjustRowsAndCols();a.refreshBorders();break;case"remove_col":var y=f.toPhysicalColumn(t);n.removeCol(t,o,s);for(var C=0,_=l.countSourceRows();C<_;C++){if(r.cellSettings[C]){r.cellSettings[C].splice(y,o)}}var E=l.getSettings().fixedColumnsLeft;if(E>=t+1){l.getSettings().fixedColumnsLeft-=Math.min(o,E-t)}if(Array.isArray(l.getSettings().colHeaders)){if(typeof y=="undefined"){y=-1}l.getSettings().colHeaders.splice(y,o)}i.adjustRowsAndCols();a.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}if(!u){i.adjustRowsAndCols()}},adjustRowsAndCols:function C(){if(r.settings.minRows){var e=l.countRows();if(e<r.settings.minRows){for(var t=0,o=r.settings.minRows;t<o-e;t++){n.createRow(l.countRows(),1,"auto")}}}if(r.settings.minSpareRows){var i=l.countEmptyRows(true);if(i<r.settings.minSpareRows){for(;i<r.settings.minSpareRows&&l.countSourceRows()<r.settings.maxRows;i++){n.createRow(l.countRows(),1,"auto")}}}{var s;if(r.settings.minCols||r.settings.minSpareCols){s=l.countEmptyCols(true)}if(r.settings.minCols&&!r.settings.columns&&l.countCols()<r.settings.minCols){for(;l.countCols()<r.settings.minCols;s++){n.createCol(l.countCols(),1,"auto")}}if(r.settings.minSpareCols&&!r.settings.columns&&l.dataType==="array"&&s<r.settings.minSpareCols){for(;s<r.settings.minSpareCols&&l.countCols()<r.settings.maxCols;s++){n.createCol(l.countCols(),1,"auto")}}}var u=l.countRows();var d=l.countCols();if(u===0||d===0){a.deselect()}if(a.isSelected()){var f=false;var c=r.selRange.from.row;var h=r.selRange.from.col;var m=r.selRange.to.row;var p=r.selRange.to.col;if(c>u-1){c=u-1;f=true;if(m>c){m=c}}else if(m>u-1){m=u-1;f=true;if(c>m){c=m}}if(h>d-1){h=d-1;f=true;if(p>h){p=h}}else if(p>d-1){p=d-1;f=true;if(h>p){h=p}}if(f){l.selectCell(c,h,m,p)}}if(l.view){l.view.wt.wtOverlays.adjustElementsSize()}},populateFromArray:function _(e,t,n,o,i,a,s){var u,d,f,c,h=[],m={};d=t.length;if(d===0){return false}var p,v,g,w,b={row:n===null?null:n.row,col:n===null?null:n.col};switch(i){case"shift_down":p=n?n.col-e.col+1:0;v=n?n.row-e.row+1:0;t=ae(t);for(f=0,c=t.length,g=Math.max(c,p);f<g;f++){if(f<c){for(u=0,d=t[f].length;u<v-d;u++){t[f].push(t[f][u%d])}t[f].unshift(e.col+f,e.row,0);l.spliceCol.apply(l,t[f])}else{t[f%c][0]=e.col+f;l.spliceCol.apply(l,t[f%c])}}break;case"shift_right":p=n?n.col-e.col+1:0;v=n?n.row-e.row+1:0;for(u=0,d=t.length,w=Math.max(d,v);u<w;u++){if(u<d){for(f=0,c=t[u].length;f<p-c;f++){t[u].push(t[u][f%c])}t[u].unshift(e.row+u,e.col,0);l.spliceRow.apply(l,t[u])}else{t[u%d][0]=e.row+u;l.spliceRow.apply(l,t[u%d])}}break;case"overwrite":default:m.row=e.row;m.col=e.col;var y={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1};var C=0;var _=0;var E=true;var R;var M=function F(e){var r=arguments[1]!==void 0?arguments[1]:null;var n=t[e%t.length];if(r!==null){return n[r%n.length]}return n};var S=t.length;var O=n?n.row-e.row+1:0;if(n){d=O}else{d=Math.max(S,O)}for(u=0;u<d;u++){if(n&&m.row>n.row&&O>S||!r.settings.allowInsertRow&&m.row>l.countRows()-1||m.row>=r.settings.maxRows){break}var T=u-C;var A=M(T).length;var N=n?n.col-e.col+1:0;if(n){c=N}else{c=Math.max(A,N)}m.col=e.col;R=l.getCellMeta(m.row,m.col);if((o==="CopyPaste.paste"||o==="Autofill.autofill")&&R.skipRowOnPaste){C++;m.row++;d++;continue}_=0;for(f=0;f<c;f++){if(n&&m.col>n.col&&N>A||!r.settings.allowInsertColumn&&m.col>l.countCols()-1||m.col>=r.settings.maxCols){break}R=l.getCellMeta(m.row,m.col);if((o==="CopyPaste.paste"||o==="Autofill.fill")&&R.skipColumnOnPaste){_++;m.col++;c++;continue}if(R.readOnly){m.col++;continue}var D=f-_;var k=M(T,D);var x=l.getDataAtCell(m.row,m.col);var I={row:T,col:D};if(o==="Autofill.fill"){var P=l.runHooks("beforeAutofillInsidePopulate",I,a,t,s,{},y);if(P){k=H(P.value)?k:P.value}}if(k!==null&&(typeof k==="undefined"?"undefined":_typeof(k))==="object"){if(x===null||(typeof x==="undefined"?"undefined":_typeof(x))!=="object"){E=false}else{var L=U(x[0]||x);var V=U(k[0]||k);if(z(L,V)){k=$(k)}else{E=false}}}else if(x!==null&&(typeof x==="undefined"?"undefined":_typeof(x))==="object"){E=false}if(E){h.push([m.row,m.col,k])}E=true;m.col++}m.row++}l.setDataAtCell(h,null,null,o||"populateFromArray");break}}};this.selection=a={inProgress:false,selectedHeader:{cols:false,rows:false},setSelectedHeaders:function E(){var e=arguments[0]!==void 0?arguments[0]:false;var t=arguments[1]!==void 0?arguments[1]:false;var r=arguments[2]!==void 0?arguments[2]:false;l.selection.selectedHeader.rows=e;l.selection.selectedHeader.cols=t;l.selection.selectedHeader.corner=r},begin:function R(){l.selection.inProgress=true},finish:function M(){var e=l.getSelected();S.hooks.run(l,"afterSelectionEnd",e[0],e[1],e[2],e[3]);S.hooks.run(l,"afterSelectionEndByProp",e[0],l.colToProp(e[1]),e[2],l.colToProp(e[3]));l.selection.inProgress=false},isInProgress:function T(){return l.selection.inProgress},setRangeStart:function P(e,t){S.hooks.run(l,"beforeSetRangeStart",e);r.selRange=new fe(e,e,e);a.setRangeEnd(e,null,t)},setRangeStartOnly:function W(e){S.hooks.run(l,"beforeSetRangeStartOnly",e);r.selRange=new fe(e,e,e)},setRangeEnd:function X(e,t,o){if(r.selRange===null){return}var i,s=false,u=true;var d=l.view.wt.wtTable.getFirstVisibleRow();var f=l.view.wt.wtTable.getFirstVisibleColumn();var c={row:null,col:null};S.hooks.run(l,"beforeSetRangeEnd",e);l.selection.begin();c.row=e.row<0?d:e.row;c.col=e.col<0?f:e.col;r.selRange.to=new de(c.row,c.col);if(!r.settings.multiSelect){r.selRange.from=e}l.view.wt.selections.current.clear();i=l.getCellMeta(r.selRange.highlight.row,r.selRange.highlight.col).disableVisualSelection;if(typeof i==="string"){i=[i]}if(i===false||Array.isArray(i)&&i.indexOf("current")===-1){l.view.wt.selections.current.add(r.selRange.highlight)}l.view.wt.selections.area.clear();if((i===false||Array.isArray(i)&&i.indexOf("area")===-1)&&a.isMultiple()){l.view.wt.selections.area.add(r.selRange.from);l.view.wt.selections.area.add(r.selRange.to)}if(r.settings.currentHeaderClassName||r.settings.currentRowClassName||r.settings.currentColClassName){l.view.wt.selections.highlight.clear();l.view.wt.selections.highlight.add(r.selRange.from);l.view.wt.selections.highlight.add(r.selRange.to)}var h=q("value");S.hooks.run(l,"afterSelection",r.selRange.from.row,r.selRange.from.col,r.selRange.to.row,r.selRange.to.col,h);S.hooks.run(l,"afterSelectionByProp",r.selRange.from.row,n.colToProp(r.selRange.from.col),r.selRange.to.row,n.colToProp(r.selRange.to.col),h);if(r.selRange.from.row===0&&r.selRange.to.row===l.countRows()-1&&l.countRows()>1||r.selRange.from.col===0&&r.selRange.to.col===l.countCols()-1&&l.countCols()>1){s=true}if(e.row<0||e.col<0){u=false}if(h.isTouched()){t=!h.value}if(t!==false&&!s&&u){if(r.selRange.from&&!a.isMultiple()){l.view.scrollViewport(r.selRange.from)}else{l.view.scrollViewport(e)}}if(a.selectedHeader.rows&&a.selectedHeader.cols){A(l.rootElement,["ht__selection--rows","ht__selection--columns"])}else if(a.selectedHeader.rows){k(l.rootElement,"ht__selection--columns");A(l.rootElement,"ht__selection--rows")}else if(a.selectedHeader.cols){k(l.rootElement,"ht__selection--rows");A(l.rootElement,"ht__selection--columns")}else{k(l.rootElement,["ht__selection--rows","ht__selection--columns"])}a.refreshBorders(null,o)},refreshBorders:function ie(e,t){if(!t){s.destroyEditor(e)}l.view.render();if(a.isSelected()&&!t){s.prepareEditor()}},isMultiple:function me(){var me=!(r.selRange.to.col===r.selRange.from.col&&r.selRange.to.row===r.selRange.from.row),e=S.hooks.run(l,"afterIsMultipleSelection",me);if(me){return e}},transformStart:function pe(e,t,n,o){var i=new de(e,t),s=0,u=0,d,f,c,h;l.runHooks("modifyTransformStart",i);d=l.countRows();f=l.countCols();h=l.getSettings().fixedRowsBottom;if(r.selRange.highlight.row+e>d-1){if(n&&r.settings.minSpareRows>0&&!(h&&r.selRange.highlight.row>=d-h-1)){l.alter("insert_row",d);d=l.countRows()}else if(r.settings.autoWrapCol){i.row=1-d;i.col=r.selRange.highlight.col+i.col==f-1?1-f:1}}else if(r.settings.autoWrapCol&&r.selRange.highlight.row+i.row<0&&r.selRange.highlight.col+i.col>=0){i.row=d-1;i.col=r.selRange.highlight.col+i.col==0?f-1:-1}if(r.selRange.highlight.col+i.col>f-1){if(n&&r.settings.minSpareCols>0){l.alter("insert_col",f);f=l.countCols()}else if(r.settings.autoWrapRow){i.row=r.selRange.highlight.row+i.row==d-1?1-d:1;i.col=1-f}}else if(r.settings.autoWrapRow&&r.selRange.highlight.col+i.col<0&&r.selRange.highlight.row+i.row>=0){i.row=r.selRange.highlight.row+i.row==0?d-1:-1;i.col=f-1}c=new de(r.selRange.highlight.row+i.row,r.selRange.highlight.col+i.col);if(c.row<0){s=-1;c.row=0}else if(c.row>0&&c.row>=d){s=1;c.row=d-1}if(c.col<0){u=-1;c.col=0}else if(c.col>0&&c.col>=f){u=1;c.col=f-1}l.runHooks("afterModifyTransformStart",c,s,u);a.setRangeStart(c,o)},transformEnd:function ve(e,t){var n=new de(e,t),o=0,i=0,s,u,d;l.runHooks("modifyTransformEnd",n);s=l.countRows();u=l.countCols();d=new de(r.selRange.to.row+n.row,r.selRange.to.col+n.col);if(d.row<0){o=-1;d.row=0}else if(d.row>0&&d.row>=s){o=1;d.row=s-1}if(d.col<0){i=-1;d.col=0}else if(d.col>0&&d.col>=u){i=1;d.col=u-1}l.runHooks("afterModifyTransformEnd",d,o,i);a.setRangeEnd(d,true)},isSelected:function ge(){return r.selRange!==null},inInSelection:function we(e){if(!a.isSelected()){return false}return r.selRange.includes(e)},deselect:function be(){if(!a.isSelected()){return}l.selection.inProgress=false;r.selRange=null;l.view.wt.selections.current.clear();l.view.wt.selections.area.clear();if(r.settings.currentHeaderClassName||r.settings.currentRowClassName||r.settings.currentColClassName){l.view.wt.selections.highlight.clear()}s.destroyEditor();a.refreshBorders();k(l.rootElement,["ht__selection--rows","ht__selection--columns"]);S.hooks.run(l,"afterDeselect")},selectAll:function ye(){if(!r.settings.multiSelect){return}a.setSelectedHeaders(true,true,true);a.setRangeStart(new de(0,0));a.setRangeEnd(new de(l.countRows()-1,l.countCols()-1),false)},empty:function Ce(){if(!a.isSelected()){return}var e=r.selRange.getTopLeftCorner();var t=r.selRange.getBottomRightCorner();var n,o,i=[];for(n=e.row;n<=t.row;n++){for(o=e.col;o<=t.col;o++){if(!l.getCellMeta(n,o).readOnly){i.push([n,o,""])}}}l.setDataAtCell(i)}};this.init=function(){o.setData(r.settings.data);S.hooks.run(l,"beforeInit");if(V()){A(l.rootElement,"mobile")}this.updateSettings(r.settings,true);this.view=new ne(this);s=new B(l,r,a,n);this.forceFullRender=true;S.hooks.run(l,"init");this.view.render();if(_typeof(r.firstRun)==="object"){S.hooks.run(l,"afterChange",r.firstRun[0],r.firstRun[1]);r.firstRun=false}S.hooks.run(l,"afterInit")};function c(){var e=false;return{validatorsInQueue:0,valid:true,addValidatorToQueue:function t(){this.validatorsInQueue++;e=false},removeValidatorFormQueue:function r(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function n(e){},checkIfQueueIsEmpty:function o(){if(this.validatorsInQueue==0&&e==false){e=true;this.onQueueEmpty(this.valid)}}}}function h(e,t,r){var o=new c;o.onQueueEmpty=h;for(var i=e.length-1;i>=0;i--){if(e[i]===null){e.splice(i,1)}else{var a=e[i][0];var s=n.propToCol(e[i][1]);var u=l.getCellMeta(a,s);if(u.type==="numeric"&&typeof e[i][3]==="string"){if(e[i][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[i][3])||u.format)){var d=e[i][3].length;if(H(u.language)){O.culture("en-US")}else if(e[i][3].indexOf(".")===d-3&&e[i][3].indexOf(",")===-1){O.culture("en-US")}else{O.culture(u.language)}var f=O.cultureData(O.culture()).delimiters;if(O.validate(e[i][3])&&!isNaN(e[i][3])){e[i][3]=parseFloat(e[i][3])}else{e[i][3]=O().unformat(e[i][3])||e[i][3]}}}if(l.getCellValidator(u)){o.addValidatorToQueue();l.validateCell(e[i][3],u,function(t,r){return function(n){if(typeof n!=="boolean"){throw new Error("Validation error: result is not boolean")}if(n===false&&r.allowInvalid===false){e.splice(t,1);r.valid=true;var i=l.getCell(r.row,r.col);k(i,l.getSettings().invalidCellClassName);--t}o.removeValidatorFormQueue()}}(i,u),t)}}}o.checkIfQueueIsEmpty();function h(){var n;if(e.length){n=S.hooks.run(l,"beforeChange",e,t);if(I(n)){console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed).")}else if(n===false){e.splice(0,e.length)}}r()}}function m(e,t){var o=e.length-1;if(o<0){return}for(;0<=o;o--){var s=false;if(e[o]===null){e.splice(o,1);continue}if(e[o][2]==null&&e[o][3]==null){continue}if(r.settings.allowInsertRow){while(e[o][0]>l.countRows()-1){var u=n.createRow(void 0,void 0,t);if(u===0){s=true;break}}}if(s){continue}if(l.dataType==="array"&&(!r.settings.columns||r.settings.columns.length===0)&&r.settings.allowInsertColumn){while(n.propToCol(e[o][1])>l.countCols()-1){n.createCol(void 0,void 0,t)}}n.set(e[o][0],e[o][1],e[o][3])}l.forceFullRender=true;i.adjustRowsAndCols();S.hooks.run(l,"beforeChangeRender",e,t);
a.refreshBorders(null,true);l.view.wt.wtOverlays.adjustElementsSize();S.hooks.run(l,"afterChange",e,t||"edit");var d=l.getActiveEditor();if(d&&L(d.refreshValue)){d.refreshValue()}}this.validateCell=function(e,t,r,n){var o=l.getCellValidator(t);function i(e){var n=t.visualCol,o=t.visualRow,i=l.getCell(o,n,true);if(i&&i.nodeName!="TH"){l.view.wt.wtSettings.settings.cellRenderer(o,n,i)}r(e)}if(Object.prototype.toString.call(o)==="[object RegExp]"){o=function(e){return function(t,r){r(e.test(t))}}(o)}if(I(o)){e=S.hooks.run(l,"beforeValidate",e,t.visualRow,t.prop,n);l._registerTimeout(setTimeout(function(){o.call(t,e,function(r){r=S.hooks.run(l,"afterValidate",r,e,t.visualRow,t.prop,n);t.valid=r;i(r);S.hooks.run(l,"postAfterValidate",r,e,t.visualRow,t.prop,n)})},0))}else{l._registerTimeout(setTimeout(function(){t.valid=true;i(t.valid)},0))}};function p(e,t,r){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){return e}else{return[[e,t,r]]}}this.setDataAtCell=function(e,t,r,i){var a=p(e,t,r),s,u,d=[],c;for(s=0,u=a.length;s<u;s++){if(_typeof(a[s])!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof a[s][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}c=n.colToProp(a[s][1]);d.push([a[s][0],c,o.getAtCell(f.toPhysicalRow(a[s][0]),a[s][1]),a[s][2]])}if(!i&&(typeof e==="undefined"?"undefined":_typeof(e))==="object"){i=t}l.runHooks("afterSetDataAtCell",d,i);h(d,i,function(){m(d,i)})};this.setDataAtRowProp=function(e,t,r,n){var i=p(e,t,r),a,s,u=[];for(a=0,s=i.length;a<s;a++){u.push([i[a][0],i[a][1],o.getAtCell(f.toPhysicalRow(i[a][0]),i[a][1]),i[a][2]])}if(!n&&(typeof e==="undefined"?"undefined":_typeof(e))==="object"){n=t}l.runHooks("afterSetDataAtRowProp",u,n);h(u,n,function(){m(u,n)})};this.listen=function(){S.activeGuid=l.guid};this.unlisten=function(){S.activeGuid=null};this.isListening=function(){return S.activeGuid===l.guid&&(l.rootElement===document.activeElement||document.activeElement.classList.contains("handsontableInput")||document.activeElement.classList.contains("copyPaste")||document.activeElement.classList.contains("htCommentTextArea"))};this.destroyEditor=function(e){a.refreshBorders(e)};this.populateFromArray=function(e,t,r,n,o,a,s,l,u){var d;if(!((typeof r==="undefined"?"undefined":_typeof(r))==="object"&&_typeof(r[0])==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}d=typeof n==="number"?new de(n,o):null;return i.populateFromArray(new de(e,t),r,d,a,s,l,u)};this.spliceCol=function(e,t,r){return n.spliceCol.apply(n,arguments)};this.spliceRow=function(e,t,r){return n.spliceRow.apply(n,arguments)};this.getSelected=function(){if(a.isSelected()){return[r.selRange.from.row,r.selRange.from.col,r.selRange.to.row,r.selRange.to.col]}};this.getSelectedRange=function(){if(a.isSelected()){return r.selRange}};this.render=function(){if(l.view){l.renderCall=true;l.forceFullRender=true;a.refreshBorders(null,true)}};this.loadData=function(e){if(Array.isArray(r.settings.dataSchema)){l.dataType="array"}else if(I(r.settings.dataSchema)){l.dataType="function"}else{l.dataType="object"}if(n){n.destroy()}n=new F(l,r,u);if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e!==null){if(!(e.push&&e.splice)){e=[e]}}else if(e===null){e=[];var t;var a=0;var s=0;var d=n.getSchema();for(a=0,s=r.settings.startRows;a<s;a++){if((l.dataType==="object"||l.dataType==="function")&&r.settings.dataSchema){t=$(d);e.push(t)}else if(l.dataType==="array"){t=$(d[0]);e.push(t)}else{t=[];for(var f=0,c=r.settings.startCols;f<c;f++){t.push(null)}e.push(t)}}}else{throw new Error("loadData only accepts array of objects or array of arrays ("+(typeof e==="undefined"?"undefined":_typeof(e))+" given)")}r.isPopulated=false;u.prototype.data=e;if(Array.isArray(e[0])){l.dataType="array"}n.dataSource=e;o.data=e;o.dataType=l.dataType;o.colToProp=n.colToProp.bind(n);o.propToCol=n.propToCol.bind(n);h();i.adjustRowsAndCols();S.hooks.run(l,"afterLoadData",r.firstRun);if(r.firstRun){r.firstRun=[null,"loadData"]}else{S.hooks.run(l,"afterChange",null,"loadData");l.render()}r.isPopulated=true;function h(){r.cellSettings.length=0}};this.getData=function(e,t,r,o){if(H(e)){return n.getAll()}else{return n.getRange(new de(e,t),new de(r,o),n.DESTINATION_RENDERER)}};this.getCopyableText=function(e,t,r,o){return n.getCopyableText(new de(e,t),new de(r,o))};this.getCopyableData=function(e,t){return n.getCopyable(e,n.colToProp(t))};this.getSchema=function(){return n.getSchema()};this.updateSettings=function(e,t){var o=false;var s;var d;var f;if(L(e.rows)){throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?')}if(L(e.cols)){throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?')}for(s in e){if(s==="data"){continue}else{if(S.hooks.getRegistered().indexOf(s)>-1){if(I(e[s])||Array.isArray(e[s])){e[s].initialHook=true;l.addHook(s,e[s])}}else{if(!t&&e.hasOwnProperty(s)){u.prototype[s]=e[s]}}}}if(e.data===void 0&&r.settings.data===void 0){l.loadData(null)}else if(e.data!==void 0){l.loadData(e.data)}else if(e.columns!==void 0){n.createMap()}f=l.countCols();var c=e.columns||u.prototype.columns;if(c&&I(c)){f=l.countSourceCols();o=true}if(e.cell!==void 0||e.cells!==void 0||e.columns!==void 0){r.cellSettings.length=0}if(f>0){var h;var m;for(s=0,d=0;s<f;s++){if(o&&!c(s)){continue}r.columnSettings[d]=x(u,r.columnsSettingConflicts);h=r.columnSettings[d].prototype;if(c){if(o){m=c(s)}else{m=c[d]}if(m){G(h,m);G(h,v(m))}}d++}}if(L(e.cell)){for(var p in e.cell){if(e.cell.hasOwnProperty(p)){var g=e.cell[p];l.setCellMetaObject(g.row,g.col,g)}}}S.hooks.run(l,"afterCellMetaReset");if(L(e.className)){if(u.prototype.className){k(l.rootElement,u.prototype.className)}if(e.className){A(l.rootElement,e.className)}}var w=l.rootElement.style.height;if(w!==""){w=parseInt(l.rootElement.style.height,10)}var b=e.height;if(I(b)){b=b()}if(t){var y=l.rootElement.getAttribute("style");if(y){l.rootElement.setAttribute("data-initialstyle",l.rootElement.getAttribute("style"))}}if(b===null){var C=l.rootElement.getAttribute("data-initialstyle");if(C&&(C.indexOf("height")>-1||C.indexOf("overflow")>-1)){l.rootElement.setAttribute("style",C)}else{l.rootElement.style.height="";l.rootElement.style.overflow=""}}else if(b!==void 0){l.rootElement.style.height=b+"px";l.rootElement.style.overflow="hidden"}if(typeof e.width!="undefined"){var _=e.width;if(I(_)){_=_()}l.rootElement.style.width=_+"px"}if(!t){n.clearLengthCache();if(l.view){l.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}S.hooks.run(l,"afterUpdateSettings")}i.adjustRowsAndCols();if(l.view&&!r.firstRun){l.forceFullRender=true;a.refreshBorders(null,true)}if(!t&&l.view&&(w===""||b===""||b===void 0)&&w!==b){l.view.wt.wtOverlays.updateMainScrollableElements()}};this.getValue=function(){var e=l.getSelected();if(u.prototype.getValue){if(I(u.prototype.getValue)){return u.prototype.getValue.call(l)}else if(e){return l.getData()[e[0]][u.prototype.getValue]}}else if(e){return l.getDataAtCell(e[0],e[1])}};function v(e){if(!e.hasOwnProperty("type")){return}var t,r={};if(_typeof(e.type)==="object"){t=e.type}else if(typeof e.type==="string"){t=S.cellTypes[e.type];if(t===void 0){throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}for(var n in t){if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n)){r[n]=t[n]}}return r}this.getSettings=function(){return r.settings};this.clear=function(){a.selectAll();a.empty()};this.alter=function(e,t,r,n,o){i.alter(e,t,r,n,o)};this.getCell=function(e,t,r){return l.view.getCellAtCoords(new de(e,t),r)};this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)};this.colToProp=function(e){return n.colToProp(e)};this.propToCol=function(e){return n.propToCol(e)};this.toVisualRow=function(e){return f.toVisualRow(e)};this.toVisualColumn=function(e){return f.toVisualColumn(e)};this.toPhysicalRow=function(e){return f.toPhysicalRow(e)};this.toPhysicalColumn=function(e){return f.toPhysicalColumn(e)};this.getDataAtCell=function(e,t){return n.get(e,n.colToProp(t))};this.getDataAtRowProp=function(e,t){return n.get(e,t)};this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,n.getRange(new de(0,e),new de(r.settings.data.length-1,e),n.DESTINATION_RENDERER))};this.getDataAtProp=function(e){var t=[],o;o=n.getRange(new de(0,n.propToCol(e)),new de(r.settings.data.length-1,n.propToCol(e)),n.DESTINATION_RENDERER);return t.concat.apply(t,o)};this.getSourceData=function(e,t,r,n){var i;if(e===void 0){i=o.getData()}else{i=o.getByRange(new de(e,t),new de(r,n))}return i};this.getSourceDataArray=function(e,t,r,n){var i;if(e===void 0){i=o.getData(true)}else{i=o.getByRange(new de(e,t),new de(r,n),true)}return i};this.getSourceDataAtCol=function(e){return o.getAtColumn(e)};this.getSourceDataAtRow=function(e){return o.getAtRow(e)};this.getSourceDataAtCell=function(e,t){return o.getAtCell(e,t)};this.getDataAtRow=function(e){var t=n.getRange(new de(e,0),new de(e,this.countCols()-1),n.DESTINATION_RENDERER);return t[0]};this.getDataType=function(e,t,r,n){var o=this;var i=null;var a=null;if(e===void 0){e=0;r=this.countRows();t=0;n=this.countCols()}if(r===void 0){r=e}if(n===void 0){n=t}var s="mixed";re(Math.min(e,r),Math.max(e,r),function(e){var r=true;re(Math.min(t,n),Math.max(t,n),function(t){var n=o.getCellMeta(e,t);a=n.type;if(i){r=i===a}else{i=a}return r});s=r?a:"mixed";return r});return s};this.removeCellMeta=function(e,t,n){var o=l.getCellMeta(e,t);if(o[n]!=undefined){delete r.cellSettings[e][t][n]}};this.spliceCellsMeta=function(e,t){var n;for(var o=[],i=2;i<arguments.length;i++){o[i-2]=arguments[i]}(n=r.cellSettings).splice.apply(n,$traceurRuntime.spread([e,t],o))};this.setCellMetaObject=function(e,t,r){if((typeof r==="undefined"?"undefined":_typeof(r))==="object"){for(var n in r){if(r.hasOwnProperty(n)){var o=r[n];this.setCellMeta(e,t,n,o)}}}};this.setCellMeta=function(e,t,n,o){var i;i=f.toPhysical(e,t),e=i[0],t=i[1],i;if(!r.cellSettings[e]){r.cellSettings[e]=[]}if(!r.cellSettings[e][t]){r.cellSettings[e][t]=new r.columnSettings[t]}r.cellSettings[e][t][n]=o;S.hooks.run(l,"afterSetCellMeta",e,t,n,o)};this.getCellsMeta=function(){return J(r.cellSettings)};this.getCellMeta=function(e,t){var o;var i=n.colToProp(t),a;var s=e;var d=t;o=f.toPhysical(e,t),e=o[0],t=o[1],o;if(!r.columnSettings[t]){r.columnSettings[t]=x(u,r.columnsSettingConflicts)}if(!r.cellSettings[e]){r.cellSettings[e]=[]}if(!r.cellSettings[e][t]){r.cellSettings[e][t]=new r.columnSettings[t]}a=r.cellSettings[e][t];a.row=e;a.col=t;a.visualRow=s;a.visualCol=d;a.prop=i;a.instance=l;S.hooks.run(l,"beforeGetCellMeta",e,t,a);G(a,v(a));if(a.cells){var c=a.cells.call(a,e,t,i);if(c){G(a,c);G(a,v(c))}}S.hooks.run(l,"afterGetCellMeta",e,t,a);return a};this.getCellMetaAtRow=function(e){return r.cellSettings[e]};this.isColumnModificationAllowed=function(){return!(l.dataType==="object"||l.getSettings().columns)};var g=se("renderer");this.getCellRenderer=function(e,t){var r=g.call(this,e,t);return ee(r)};this.getCellEditor=se("editor");this.getCellValidator=se("validator");this.validateCells=function(e){var t=new c;if(e){t.onQueueEmpty=e}var r=l.countRows()-1;while(r>=0){var n=l.countCols()-1;while(n>=0){t.addValidatorToQueue();l.validateCell(l.getDataAtCell(r,n),l.getCellMeta(r,n),function(e){if(typeof e!=="boolean"){throw new Error("Validation error: result is not boolean")}if(e===false){t.valid=false}t.removeValidatorFormQueue()},"validateCells");n--}r--}t.checkIfQueueIsEmpty()};this.getRowHeader=function(e){var t=r.settings.rowHeaders;if(e!==void 0){e=S.hooks.run(l,"modifyRowHeader",e)}if(e===void 0){t=[];re(l.countRows()-1,function(e){t.push(l.getRowHeader(e))})}else if(Array.isArray(t)&&t[e]!==void 0){t=t[e]}else if(I(t)){t=t(e)}else if(t&&typeof t!=="string"&&typeof t!=="number"){t=e+1}return t};this.hasRowHeaders=function(){return!!r.settings.rowHeaders};this.hasColHeaders=function(){if(r.settings.colHeaders!==void 0&&r.settings.colHeaders!==null){return!!r.settings.colHeaders}for(var e=0,t=l.countCols();e<t;e++){if(l.getColHeader(e)){return true}}return false};this.getColHeader=function(e){var t=r.settings.columns&&I(r.settings.columns);var n=r.settings.colHeaders;e=S.hooks.run(l,"modifyColHeader",e);if(e===void 0){var o=[];var i=t?l.countSourceCols():l.countCols();for(var a=0;a<i;a++){o.push(l.getColHeader(a))}n=o}else{var s=function f(e){var t=[];var r=l.countSourceCols();var n=0;for(;n<r;n++){if(I(l.getSettings().columns)&&l.getSettings().columns(n)){t.push(n)}}return t[e]};var u=e;e=S.hooks.run(l,"modifyCol",e);var d=s(e);if(r.settings.columns&&I(r.settings.columns)&&r.settings.columns(d)&&r.settings.columns(d).title){n=r.settings.columns(d).title}else if(r.settings.columns&&r.settings.columns[e]&&r.settings.columns[e].title){n=r.settings.columns[e].title}else if(Array.isArray(r.settings.colHeaders)&&r.settings.colHeaders[e]!==void 0){n=r.settings.colHeaders[e]}else if(I(r.settings.colHeaders)){n=r.settings.colHeaders(e)}else if(r.settings.colHeaders&&typeof r.settings.colHeaders!=="string"&&typeof r.settings.colHeaders!=="number"){n=le(u)}}return n};this._getColWidthFromSettings=function(e){var t=l.getCellMeta(0,e);var n=t.width;if(n===void 0||n===r.settings.width){n=t.colWidths}if(n!==void 0&&n!==null){switch(typeof n==="undefined"?"undefined":_typeof(n)){case"object":n=n[e];break;case"function":n=n(e);break}if(typeof n==="string"){n=parseInt(n,10)}}return n};this.getColWidth=function(e){var t=l._getColWidthFromSettings(e);t=S.hooks.run(l,"modifyColWidth",t,e);if(t===void 0){t=ce.DEFAULT_WIDTH}return t};this._getRowHeightFromSettings=function(e){var t=r.settings.rowHeights;if(t!==void 0&&t!==null){switch(typeof t==="undefined"?"undefined":_typeof(t)){case"object":t=t[e];break;case"function":t=t(e);break}if(typeof t==="string"){t=parseInt(t,10)}}return t};this.getRowHeight=function(e){var t=l._getRowHeightFromSettings(e);t=S.hooks.run(l,"modifyRowHeight",t,e);return t};this.countSourceRows=function(){var e=S.hooks.run(l,"modifySourceLength");return e||(l.getSourceData()?l.getSourceData().length:0)};this.countSourceCols=function(){var e=0;var t=l.getSourceData()&&l.getSourceData()[0]?l.getSourceData()[0]:[];if(Y(t)){e=K(t)}else{e=t.length||0}return e};this.countRows=function(){return n.getLength()};this.countCols=function(){var e=false;var t=0;if(l.dataType==="array"){e=r.settings.data&&r.settings.data[0]&&r.settings.data[0].length}if(e){t=r.settings.data[0].length}if(r.settings.columns){var o=I(r.settings.columns);if(o){if(l.dataType==="array"){var i=0;for(var a=0;a<t;a++){if(r.settings.columns(a)){i++}}t=i}else if(l.dataType==="object"||l.dataType==="function"){t=n.colToPropCache.length}}else{t=r.settings.columns.length}}else{if(l.dataType==="object"||l.dataType==="function"){t=n.colToPropCache.length}}return t};this.rowOffset=function(){return l.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return l.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return l.view.wt.drawn?l.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return l.view.wt.drawn?l.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return l.view.wt.drawn?l.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return l.view.wt.drawn?l.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(e){var t=l.countRows()-1,r=0,n;while(t>=0){n=S.hooks.run(this,"modifyRow",t);if(l.isEmptyRow(n)){r++}else if(e){break}t--}return r};this.countEmptyCols=function(e){if(l.countRows()<1){return 0}var t=l.countCols()-1,r=0;while(t>=0){if(l.isEmptyCol(t)){r++}else if(e){break}t--}return r};this.isEmptyRow=function(e){return r.settings.isEmptyRow.call(l,e)};this.isEmptyCol=function(e){return r.settings.isEmptyCol.call(l,e)};this.selectCell=function(e,t,n,o,i,s){var u;s=H(s)||s===true;if(typeof e!=="number"||e<0||e>=l.countRows()){return false}if(typeof t!=="number"||t<0||t>=l.countCols()){return false}if(L(n)){if(typeof n!=="number"||n<0||n>=l.countRows()){return false}if(typeof o!=="number"||o<0||o>=l.countCols()){return false}}u=new de(e,t);r.selRange=new fe(u,u,u);if(s){l.listen()}if(H(n)){a.setRangeEnd(r.selRange.from,i)}else{a.setRangeEnd(new de(n,o),i)}l.selection.finish();return true};this.selectCellByProp=function(e,t,r,o,i){arguments[1]=n.propToCol(arguments[1]);if(L(arguments[3])){arguments[3]=n.propToCol(arguments[3])}return l.selectCell.apply(l,arguments)};this.deselectCell=function(){a.deselect()};this.scrollViewportTo=function(e,t){var r=arguments[2]!==void 0?arguments[2]:false;var n=arguments[3]!==void 0?arguments[3]:false;if(e!==void 0&&(e<0||e>=l.countRows())){return false}if(t!==void 0&&(t<0||t>=l.countCols())){return false}var o=false;if(e!==void 0&&t!==void 0){l.view.wt.wtOverlays.topOverlay.scrollTo(e,r);l.view.wt.wtOverlays.leftOverlay.scrollTo(t,n);o=true}if(typeof e==="number"&&typeof t!=="number"){l.view.wt.wtOverlays.topOverlay.scrollTo(e,r);o=true}if(typeof t==="number"&&typeof e!=="number"){l.view.wt.wtOverlays.leftOverlay.scrollTo(t,n);o=true}return o};this.destroy=function(){l._clearTimeouts();if(l.view){l.view.destroy()}if(o){o.destroy()}o=null;N(l.rootElement);d.destroy();S.hooks.run(l,"afterDestroy");S.hooks.destroy(l);for(var e in l){if(l.hasOwnProperty(e)){if(I(l[e])){l[e]=w}else if(e!=="guid"){l[e]=null}}}if(n){n.destroy()}n=null;r=null;i=null;a=null;s=null;l=null;u=null};function w(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}this.getActiveEditor=function(){return s.getActiveEditor()};this.getPlugin=function(e){return Q(this,e)};this.getInstance=function(){return l};this.addHook=function(e,t){S.hooks.add(e,t,l)};this.hasHook=function(e){return S.hooks.has(e,l)};this.addHookOnce=function(e,t){S.hooks.once(e,t,l)};this.removeHook=function(e,t){S.hooks.remove(e,t,l)};this.runHooks=function(e,t,r,n,o,i,a){return S.hooks.run(l,e,t,r,n,o,i,a)};this.timeouts=[];this._registerTimeout=function(e){this.timeouts.push(e)};this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++){clearTimeout(this.timeouts[e])}};this.version=S.version;S.hooks.run(l,"construct")};var he=function pe(){};he.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:false,customBorders:false,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:true,allowInsertColumn:true,allowRemoveRow:true,allowRemoveColumn:true,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,selectedAreaBorderColor:"#89AFF9",selectedCellBorderColor:"#5292F7",selectedFillBorderColor:"red",tableClassName:void 0,stretchH:"none",isEmptyRow:function ve(e){var t,r,n,o;for(t=0,r=this.countCols();t<r;t++){n=this.getDataAtCell(e,t);if(n!==""&&n!==null&&L(n)){if((typeof n==="undefined"?"undefined":_typeof(n))==="object"){o=this.getCellMeta(e,t);return z(this.getSchema()[o.prop],n)}return false}}return true},isEmptyCol:function ge(e){var t,r,n;for(t=0,r=this.countRows();t<r;t++){n=this.getDataAtCell(t,e);if(n!==""&&n!==null&&L(n)){return false}}return true},observeDOMVisibility:true,allowInvalid:true,allowEmpty:true,invalidCellClassName:"htInvalid",placeholder:false,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:false,readOnly:false,skipColumnOnPaste:false,search:false,type:"text",copyable:true,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:true,debug:false,wordWrap:true,noWordWrapClassName:"htNoWrap",contextMenu:void 0,contextMenuCopyPaste:void 0,copyPaste:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:false,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:false,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:true,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:false,defaultDate:void 0,strict:void 0,allowHtml:false,renderAllRows:void 0,preventOverflow:false,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:true,filter:true,filteringCaseSensitive:false};S.DefaultSettings=he},{"3rdparty/walkontable/src/calculator/viewportColumns":4,"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,browser:24,dataMap:27,dataSource:28,editorManager:29,eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/dom/element":47,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,numbro:"numbro",plugins:62,renderers:118,tableView:127,"utils/recordTranslator":132}],27:[function(e,t,r){"use strict";Object.defineProperties(r,{DataMap:{get:function D(){return A}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f;var c=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var h=(o=e("SheetClip"),o&&o.__esModule&&o||{"default":o}).default;var m=(i=e("helpers/data"),i&&i.__esModule&&i||{"default":i}).cellMethodLookupFactory;var p=(a=e("helpers/setting"),a&&a.__esModule&&a||{"default":a}).columnFactory;var v=(s=e("helpers/object"),s&&s.__esModule&&s||{"default":s}),g=v.createObjectPropListener,w=v.duckSchema,b=v.deepExtend,y=v.deepClone,C=v.isObject,_=v.deepObjectSize;var E=(l=e("helpers/array"),l&&l.__esModule&&l||{"default":l}),R=E.extendArray,M=E.to2dArray;var S=(u=e("utils/interval"),u&&u.__esModule&&u||{"default":u}).Interval;var O=(d=e("helpers/number"),d&&d.__esModule&&d||{"default":d}).rangeEach;var T=(f=e("multiMap"),f&&f.__esModule&&f||{"default":f}).MultiMap;function A(e,t,r){var n=this;this.instance=e;this.priv=t;this.GridSettings=r;this.dataSource=this.instance.getSettings().data;this.cachedLength=null;this.skipCache=false;this.latestSourceRowsCount=0;if(this.dataSource&&this.dataSource[0]){this.duckSchema=this.recursiveDuckSchema(this.dataSource[0])}else{this.duckSchema={}}this.createMap();this.interval=S.create(function(){return n.clearLengthCache()},"15fps");this.instance.addHook("skipLengthCache",function(e){return n.onSkipLengthCache(e)});this.onSkipLengthCache(500)}A.prototype.DESTINATION_RENDERER=1;A.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;A.prototype.recursiveDuckSchema=function(e){return w(e)};A.prototype.recursiveDuckColumns=function(e,t,r){var n,o;if(typeof t==="undefined"){t=0;r=""}if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&!Array.isArray(e)){for(o in e){if(e.hasOwnProperty(o)){if(e[o]===null){n=r+o;this.colToPropCache.push(n);this.propToColCache.set(n,t);t++}else{t=this.recursiveDuckColumns(e[o],t,o+".")}}}}return t};A.prototype.createMap=function(){var e;var t=this.getSchema();if(typeof t==="undefined"){throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`")}this.colToPropCache=[];this.propToColCache=new T;var r=this.instance.getSettings().columns;if(r){var n=r.length;var o=0;var i=false;var a=_(t);if(typeof r==="function"){n=a>0?a:this.instance.countSourceCols();i=true}for(e=0;e<n;e++){var s=i?r(e):r[e];if(C(s)){if(typeof s.data!=="undefined"){var l=i?o:e;this.colToPropCache[l]=s.data;this.propToColCache.set(s.data,l)}o++}}}else{this.recursiveDuckColumns(t)}};A.prototype.colToProp=function(e){e=c.hooks.run(this.instance,"modifyCol",e);if(this.colToPropCache&&typeof this.colToPropCache[e]!=="undefined"){return this.colToPropCache[e]}return e};A.prototype.propToCol=function(e){var t;if(typeof this.propToColCache.get(e)==="undefined"){t=e}else{t=this.propToColCache.get(e)}t=c.hooks.run(this.instance,"unmodifyCol",t);return t};A.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;if(e){if(typeof e==="function"){return e()}return e}return this.duckSchema};A.prototype.createRow=function(e,t,r){var n,o=this.instance.countCols(),i=0,a;if(!t){t=1}if(typeof e!=="number"||e>=this.instance.countSourceRows()){e=this.instance.countSourceRows()}c.hooks.run(this.instance,"beforeCreateRow",e,t,r);a=e;var s=this.instance.getSettings().maxRows;while(i<t&&this.instance.countSourceRows()<s){if(this.instance.dataType==="array"){if(this.instance.getSettings().dataSchema){n=y(this.getSchema())}else{n=[];O(o-1,function(){return n.push(null)})}}else if(this.instance.dataType==="function"){n=this.instance.getSettings().dataSchema(e)}else{n={};b(n,this.getSchema())}if(e===this.instance.countSourceRows()){this.dataSource.push(n)}else{this.spliceData(e,0,n)}i++;a++}c.hooks.run(this.instance,"afterCreateRow",e,i,r);this.instance.forceFullRender=true;return i};A.prototype.createCol=function(e,t,r){if(!this.instance.isColumnModificationAllowed()){throw new Error("Cannot create new column. When data source in an object, "+"you can only have as much columns as defined in first data row, data schema or in the 'columns' setting."+"If you want to be able to add new columns, you have to use array datasource.")}var n=this.instance.countSourceRows(),o=this.dataSource,i,a=0,s;if(!t){t=1}if(typeof e!=="number"||e>=this.instance.countCols()){e=this.instance.countCols()}c.hooks.run(this.instance,"beforeCreateCol",e,t,r);s=e;var l=this.instance.getSettings().maxCols;while(a<t&&this.instance.countCols()<l){i=p(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof e!=="number"||e>=this.instance.countCols()){if(n>0){for(var u=0;u<n;u++){if(typeof o[u]==="undefined"){o[u]=[]}o[u].push(null)}}else{o.push([null])}this.priv.columnSettings.push(i)}else{for(var u=0;u<n;u++){o[u].splice(s,0,null)}this.priv.columnSettings.splice(s,0,i)}a++;s++}c.hooks.run(this.instance,"afterCreateCol",e,a,r);this.instance.forceFullRender=true;return a};A.prototype.removeRow=function(e,t,r){if(!t){t=1}if(typeof e!=="number"){e=-t}t=c.hooks.run(this.instance,"modifyRemovedAmount",t,e);e=(this.instance.countSourceRows()+e)%this.instance.countSourceRows();var n=this.physicalRowsToLogical(e,t);var o=c.hooks.run(this.instance,"beforeRemoveRow",e,t,n,r);if(o===false){return}var i=this.dataSource;var a;a=this.filterData(e,t);if(a){i.length=0;Array.prototype.push.apply(i,a)}c.hooks.run(this.instance,"afterRemoveRow",e,t,n,r);this.instance.forceFullRender=true};A.prototype.removeCol=function(e,t,r){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!t){t=1}if(typeof e!=="number"){e=-t}e=(this.instance.countCols()+e)%this.instance.countCols();var n=this.physicalColumnsToLogical(e,t);var o=n.slice(0).sort(function(e,t){return t-e});var i=c.hooks.run(this.instance,"beforeRemoveCol",e,t,n,r);if(i===false){return}var a=true;var s=o.length;var l=this.dataSource;for(var u=0;u<s;u++){if(a&&n[0]!==n[u]-u){a=false}}if(a){for(var d=0,f=this.instance.countSourceRows();d<f;d++){l[d].splice(n[0],t)}}else{for(var h=0,m=this.instance.countSourceRows();h<m;h++){for(var p=0;p<s;p++){l[h].splice(o[p],1)}}for(var v=0;v<s;v++){this.priv.columnSettings.splice(n[v],1)}}c.hooks.run(this.instance,"afterRemoveCol",e,t,n,r);this.instance.forceFullRender=true};A.prototype.spliceCol=function(e,t,r){var n=4<=arguments.length?[].slice.call(arguments,3):[];var o=this.instance.getDataAtCol(e);var i=o.slice(t,t+r);var a=o.slice(t+r);R(n,a);var s=0;while(s<r){n.push(null);s++}M(n);this.instance.populateFromArray(t,e,n,null,null,"spliceCol");return i};A.prototype.spliceRow=function(e,t,r){var n=4<=arguments.length?[].slice.call(arguments,3):[];var o=this.instance.getSourceDataAtRow(e);var i=o.slice(t,t+r);var a=o.slice(t+r);R(n,a);var s=0;while(s<r){n.push(null);s++}this.instance.populateFromArray(e,t,[n],null,null,"spliceRow");return i};A.prototype.spliceData=function(e,t,r){var n=c.hooks.run(this.instance,"beforeDataSplice",e,t,r);if(n!==false){this.dataSource.splice(e,t,r)}};A.prototype.filterData=function(e,t){var r=this.physicalRowsToLogical(e,t);var n=c.hooks.run(this.instance,"beforeDataFilter",e,t,r);if(n!==false){var o=this.dataSource.filter(function(e,t){return r.indexOf(t)==-1});return o}};A.prototype.get=function(e,t){e=c.hooks.run(this.instance,"modifyRow",e);var r=this.dataSource[e];var n=c.hooks.run(this.instance,"modifyRowData",e);r=isNaN(n)?n:r;var o=null;if(r&&r.hasOwnProperty&&r.hasOwnProperty(t)){o=r[t]}else if(typeof t==="string"&&t.indexOf(".")>-1){var i=t.split(".");var a=r;if(!a){return null}for(var s=0,l=i.length;s<l;s++){a=a[i[s]];if(typeof a==="undefined"){return null}}o=a}else if(typeof t==="function"){o=t(this.dataSource.slice(e,e+1)[0])}if(c.hooks.has("modifyData",this.instance)){var u=g(o);c.hooks.run(this.instance,"modifyData",e,this.propToCol(t),u,"get");if(u.isTouched()){o=u.value}}return o};var N=m("copyable",false);A.prototype.getCopyable=function(e,t){if(N.call(this.instance,e,this.propToCol(t))){return this.get(e,t)}return""};A.prototype.set=function(e,t,r,n){e=c.hooks.run(this.instance,"modifyRow",e,n||"datamapGet");var o=this.dataSource[e];var i=c.hooks.run(this.instance,"modifyRowData",e);o=isNaN(i)?i:o;if(c.hooks.has("modifyData",this.instance)){var a=g(r);c.hooks.run(this.instance,"modifyData",e,this.propToCol(t),a,"set");if(a.isTouched()){r=a.value}}if(o&&o.hasOwnProperty&&o.hasOwnProperty(t)){o[t]=r}else if(typeof t==="string"&&t.indexOf(".")>-1){var s=t.split(".");var l=o;for(var u=0,d=s.length-1;u<d;u++){if(typeof l[s[u]]==="undefined"){l[s[u]]={}}l=l[s[u]]}l[s[u]]=r}else if(typeof t==="function"){t(this.dataSource.slice(e,e+1)[0],r)}else{o[t]=r}};A.prototype.physicalRowsToLogical=function(e,t){var r=this.instance.countSourceRows();var n=(r+e)%r;var o=[];var i=t;var a;while(n<r&&i){a=c.hooks.run(this.instance,"modifyRow",n);o.push(a);i--;n++}return o};A.prototype.physicalColumnsToLogical=function(e,t){var r=this.instance.countCols();var n=(r+e)%r;var o=[];var i=t;while(n<r&&i){var a=c.hooks.run(this.instance,"modifyCol",n);o.push(a);i--;n++}return o};A.prototype.clear=function(){for(var e=0;e<this.instance.countSourceRows();e++){for(var t=0;t<this.instance.countCols();t++){this.set(e,this.colToProp(t),"")}}};A.prototype.clearLengthCache=function(){this.cachedLength=null};A.prototype.getLength=function(){var e=this;var t,r=this.instance.getSettings().maxRows;if(r<0||r===0){t=0}else{t=r||Infinity}var n=this.instance.countSourceRows();if(c.hooks.has("modifyRow",this.instance)){var o=this.skipCache;this.interval.start();if(n!==this.latestSourceRowsCount){o=true}this.latestSourceRowsCount=n;if(this.cachedLength===null||o){O(n-1,function(t){t=c.hooks.run(e.instance,"modifyRow",t);if(t===null){--n}});this.cachedLength=n}else{n=this.cachedLength}}else{this.interval.stop()}return Math.min(n,t)};A.prototype.getAll=function(){var e={row:0,col:0};var t=this.instance.getSettings().maxRows;
if(t===0){return[]}var r={row:Math.min(Math.max(t-1,0),Math.max(this.instance.countSourceRows()-1,0)),col:Math.max(this.instance.countCols()-1,0)};if(e.row-r.row===0&&!this.instance.countSourceRows()){return[]}return this.getRange(e,r,A.prototype.DESTINATION_RENDERER)};A.prototype.getRange=function(e,t,r){var n,o,i,a,s=[],l;var u=r===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;o=Math.max(e.row,t.row);a=Math.max(e.col,t.col);for(n=Math.min(e.row,t.row);n<=o;n++){l=[];var d=c.hooks.run(this.instance,"modifyRow",n);for(i=Math.min(e.col,t.col);i<=a;i++){if(d===null){break}l.push(u.call(this,n,this.colToProp(i)))}if(d!==null){s.push(l)}}return s};A.prototype.getText=function(e,t){return h.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))};A.prototype.getCopyableText=function(e,t){return h.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))};A.prototype.onSkipLengthCache=function(e){var t=this;this.skipCache=true;setTimeout(function(){t.skipCache=false},e)};A.prototype.destroy=function(){this.interval.stop();this.interval=null;this.instance=null;this.priv=null;this.GridSettings=null;this.dataSource=null;this.cachedLength=null;this.duckSchema=null}},{SheetClip:"SheetClip",browser:24,"helpers/array":43,"helpers/data":45,"helpers/number":52,"helpers/object":53,"helpers/setting":54,multiMap:60,"utils/interval":131}],28:[function(e,t,r){"use strict";Object.defineProperties(r,{DataSource:{get:function d(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("helpers/object"),n&&n.__esModule&&n||{"default":n}).getProperty;var s=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var l=(i=e("helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var u=function f(e){var t=arguments[1]!==void 0?arguments[1]:[];this.hot=e;this.data=t;this.dataType="array";this.colToProp=function(){};this.propToCol=function(){}};$traceurRuntime.createClass(u,{getData:function c(){var e=arguments[0]!==void 0?arguments[0]:false;var t=this.data;if(e){t=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},true)}return t},setData:function h(e){this.data=e},getAtColumn:function m(e){var t=this;var r=[];s(this.data,function(n){var o=t.colToProp(e);if(typeof o==="string"){n=a(n,o)}else{n=n[o]}r.push(n)});return r},getAtRow:function p(e){return this.data[e]},getAtCell:function v(e,t){var r=null;var n=this.hot.runHooks("modifyRowData",e);var o=isNaN(n)?n:this.data[e];if(o){var i=this.colToProp(t);if(typeof i==="string"){r=a(o,i)}else if(typeof i==="function"){r=i(this.data.slice(e,e+1)[0])}else{r=o[i]}}return r},getByRange:function g(e,t){var r=arguments[2]!==void 0?arguments[2]:false;var n=this;var o=Math.min(e.row,t.row);var i=Math.min(e.col,t.col);var a=Math.max(e.row,t.row);var s=Math.max(e.col,t.col);var u=[];l(o,a,function(e){var t=n.getAtRow(e);var o;if(n.dataType==="array"){o=t.slice(i,s+1)}else if(n.dataType==="object"){o=r?[]:{};l(i,s,function(e){var i=n.colToProp(e);if(r){o.push(t[i])}else{o[i]=t[i]}})}u.push(o)});return u},countRows:function w(){return Array.isArray(this.data)?this.data.length:0},countColumns:function b(){var e=0;if(Array.isArray(this.data)){if(this.dataType==="array"){e=this.data[0].length}else if(this.dataType==="object"){e=Object.keys(this.data[0]).length}}return e},destroy:function y(){this.data=null;this.hot=null}},{})},{"helpers/array":43,"helpers/number":52,"helpers/object":53}],29:[function(e,t,r){"use strict";Object.defineProperties(r,{EditorManager:{get:function _(){return C}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("3rdparty/walkontable/src/cell/coords"),o&&o.__esModule&&o||{"default":o}).WalkontableCellCoords;var f=(i=e("helpers/unicode"),i&&i.__esModule&&i||{"default":i}),c=f.KEY_CODES,h=f.isMetaKey,m=f.isCtrlKey;var p=(a=e("helpers/dom/event"),a&&a.__esModule&&a||{"default":a}),v=p.stopPropagation,g=p.stopImmediatePropagation,w=p.isImmediatePropagationStopped;var b=(s=e("editors"),s&&s.__esModule&&s||{"default":s}).getEditor;var y=(l=e("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager;u.EditorManager=C;function C(e,t,r){var n=this,o=false,i,a;i=y(e);function s(e){r.setSelectedHeaders(false,false,false);var n=typeof t.settings.enterMoves==="function"?t.settings.enterMoves(event):t.settings.enterMoves;if(e){r.transformStart(-n.row,-n.col)}else{r.transformStart(n.row,n.col,true)}}function l(e){if(e){if(r.selectedHeader.cols){r.setSelectedHeaders(r.selectedHeader.rows,false,false)}r.transformEnd(-1,0)}else{r.setSelectedHeaders(false,false,false);r.transformStart(-1,0)}}function f(e){if(e){r.transformEnd(1,0)}else{r.setSelectedHeaders(false,false,false);r.transformStart(1,0)}}function p(e){if(e){r.transformEnd(0,1)}else{r.setSelectedHeaders(false,false,false);r.transformStart(0,1)}}function b(e){if(e){if(r.selectedHeader.rows){r.setSelectedHeaders(false,r.selectedHeader.cols,false)}r.transformEnd(0,-1)}else{r.setSelectedHeaders(false,false,false);r.transformStart(0,-1)}}function C(i){console.log(" in onKeyDown");var y,C;if(!e.isListening()){return}u.hooks.run(e,"beforeKeyDown",i);if(o){return}if(w(i)){return}t.lastKeyCode=i.keyCode;if(!r.isSelected()){return}y=(i.ctrlKey||i.metaKey)&&!i.altKey;if(a&&!a.isWaiting()){if(!h(i.keyCode)&&!m(i.keyCode)&&!y&&!n.isEditorOpened()){n.openEditor("",i);return}}C=i.shiftKey?r.setRangeEnd:r.setRangeStart;switch(i.keyCode){case c.A:if(!n.isEditorOpened()&&y){r.selectAll();i.preventDefault();v(i)}break;case c.ARROW_UP:if(n.isEditorOpened()&&!a.isWaiting()){n.closeEditorAndSaveChanges(y)}l(i.shiftKey);i.preventDefault();v(i);break;case c.ARROW_DOWN:if(n.isEditorOpened()&&!a.isWaiting()){n.closeEditorAndSaveChanges(y)}f(i.shiftKey);i.preventDefault();v(i);break;case c.ARROW_RIGHT:if(n.isEditorOpened()&&!a.isWaiting()){n.closeEditorAndSaveChanges(y)}p(i.shiftKey);i.preventDefault();v(i);break;case c.ARROW_LEFT:if(n.isEditorOpened()&&!a.isWaiting()){n.closeEditorAndSaveChanges(y)}b(i.shiftKey);i.preventDefault();v(i);break;case c.TAB:r.setSelectedHeaders(false,false,false);var _=typeof t.settings.tabMoves==="function"?t.settings.tabMoves(i):t.settings.tabMoves;if(i.shiftKey){r.transformStart(-_.row,-_.col)}else{r.transformStart(_.row,_.col,true)}i.preventDefault();v(i);break;case c.BACKSPACE:case c.DELETE:r.empty(i);n.prepareEditor();i.preventDefault();break;case c.F2:n.openEditor(null,i);if(a){a.enableFullEditMode()}i.preventDefault();break;case c.ENTER:console.log("*** at 7477");if(n.isEditorOpened()){if(a&&a.state!==u.EditorState.WAITING){n.closeEditorAndSaveChanges(y)}s(i.shiftKey)}else{if(e.getSettings().enterBeginsEditing){n.openEditor(null,i);if(a){a.enableFullEditMode()}}else{s(i.shiftKey)}}i.preventDefault();g(i);break;case c.ESCAPE:if(n.isEditorOpened()){n.closeEditorAndRestoreOriginalValue(y)}i.preventDefault();break;case c.HOME:r.setSelectedHeaders(false,false,false);if(i.ctrlKey||i.metaKey){C(new d(0,t.selRange.from.col))}else{C(new d(t.selRange.from.row,0))}i.preventDefault();v(i);break;case c.END:r.setSelectedHeaders(false,false,false);if(i.ctrlKey||i.metaKey){C(new d(e.countRows()-1,t.selRange.from.col))}else{C(new d(t.selRange.from.row,e.countCols()-1))}i.preventDefault();v(i);break;case c.PAGE_UP:r.setSelectedHeaders(false,false,false);r.transformStart(-e.countVisibleRows(),0);i.preventDefault();v(i);break;case c.PAGE_DOWN:r.setSelectedHeaders(false,false,false);r.transformStart(e.countVisibleRows(),0);i.preventDefault();v(i);break}}function _(){e.addHook("afterDocumentKeyDown",C);i.addEventListener(document.documentElement,"keydown",function(t){if(!o){e.runHooks("afterDocumentKeyDown",t)}});function t(e,t,r){if(r.nodeName=="TD"){n.openEditor();if(a){a.enableFullEditMode()}}}e.view.wt.update("onCellDblClick",t);e.addHook("afterDestroy",function(){o=true})}this.destroyEditor=function(e){this.closeEditor(e)};this.getActiveEditor=function(){return a};this.prepareEditor=function(){var r,o,i,s,l,d,f;if(a&&a.isWaiting()){this.closeEditor(false,false,function(e){if(e){n.prepareEditor()}});return}r=t.selRange.highlight.row;o=t.selRange.highlight.col;i=e.colToProp(o);s=e.getCell(r,o);l=e.getSourceDataAtCell(e.runHooks("modifyRow",r),o);d=e.getCellMeta(r,o);f=e.getCellEditor(d);if(f){a=u.editors.getEditor(f,e);a.prepare(r,o,i,s,l,d)}else{a=void 0}};this.isEditorOpened=function(){return a&&a.isOpened()};this.openEditor=function(e,t){console.log("activeEditor: ",a);if(a&&!a.cellProperties.readOnly){a.beginEditing(e,t)}else if(a&&a.cellProperties.readOnly){if(t&&t.keyCode===c.ENTER){s()}}};this.closeEditor=function(e,t,r){if(a){a.finishEditing(e,t,r)}else{if(r){r(false)}}};this.closeEditorAndSaveChanges=function(e){return this.closeEditor(false,e)};this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(true,e)};_()}},{"3rdparty/walkontable/src/cell/coords":6,browser:24,editors:30,eventManager:42,"helpers/dom/event":48,"helpers/unicode":56}],30:[function(e,t,r){"use strict";Object.defineProperties(r,{registerEditor:{get:function m(){return d}},getEditor:{get:function p(){return f}},hasEditor:{get:function v(){return h}},getEditorConstructor:{get:function g(){return c}},__esModule:{value:true}});var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("helpers/string"),o&&o.__esModule&&o||{"default":o}).toUpperCaseFirst;var s={},l=new WeakMap;i.editors=i.editors||{};i.editors.registerEditor=d;i.editors.getEditor=f;function u(e){var t,r;r={};t=e;this.getConstructor=function(){return e};this.getInstance=function(e){if(!(e.guid in r)){r[e.guid]=new t(e)}return r[e.guid]};i.hooks.add("afterDestroy",function(){r={}})}function d(e,t){var r=new u(t);if(typeof e==="string"){s[e]=r;i.editors[a(e)+"Editor"]=t}l.set(t,r)}function f(e,t){var r;if(typeof e=="function"){if(!l.get(e)){d(null,e)}r=l.get(e)}else if(typeof e=="string"){r=s[e]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!r){throw Error('No editor registered under name "'+e+'"')}return r.getInstance(t)}function c(e){var t;if(typeof e=="string"){t=s[e]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!t){throw Error('No editor registered under name "'+e+'"')}return t.getConstructor()}function h(e){return s[e]?true:false}},{browser:24,"helpers/string":55}],31:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseEditor:{get:function d(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("helpers/mixed"),o&&o.__esModule&&o||{"default":o}).stringify;var l=(i=e("3rdparty/walkontable/src/cell/coords"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords;a.editors=a.editors||{};a.editors.BaseEditor=u;a.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};function u(e){this.instance=e;this.state=a.EditorState.VIRGIN;this._opened=false;this._fullEditMode=false;this._closeCallback=null;this.init()}u.prototype._fireCallbacks=function(e){if(this._closeCallback){this._closeCallback(e);this._closeCallback=null}};u.prototype.init=function(){};u.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};u.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")};u.prototype.open=function(){throw Error("Editor open() method unimplemented")};u.prototype.close=function(){throw Error("Editor close() method unimplemented")};u.prototype.prepare=function(e,t,r,n,o,i){this.TD=n;this.row=e;this.col=t;this.prop=r;this.originalValue=o;this.cellProperties=i;var s=!document.activeElement||document.activeElement&&document.activeElement.nodeName===void 0;if(this.instance.view.isMouseDown()&&document.activeElement&&document.activeElement!==document.body&&!s){document.activeElement.blur()}else if(s){document.body.focus()}this.state=a.EditorState.VIRGIN};u.prototype.extend=function(){var e=this.constructor;function t(){e.apply(this,arguments)}function r(e,t){function r(){}r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e;return e}return r(t,e)};u.prototype.saveValue=function(e,t){var r,n;if(t){r=this.instance.getSelected();if(r[0]>r[2]){n=r[0];r[0]=r[2];r[2]=n}if(r[1]>r[3]){n=r[1];r[1]=r[3];r[3]=n}}else{r=[this.row,this.col,null,null]}this.instance.populateFromArray(r[0],r[1],e,r[2],r[3],"edit")};u.prototype.beginEditing=function(e,t){if(this.state!=a.EditorState.VIRGIN){return}this.instance.view.scrollViewport(new l(this.row,this.col));this.instance.view.render();this.state=a.EditorState.EDITING;e=typeof e=="string"?e:this.originalValue;this.setValue(s(e));this.open(t);this._opened=true;this.focus();this.instance.view.render();this.instance.runHooks("afterBeginEditing",this.row,this.col)};u.prototype.finishEditing=function(e,t,r){var n=this,o;if(r){var i=this._closeCallback;this._closeCallback=function(e){if(i){i(e)}r(e);n.instance.view.render()}}if(this.isWaiting()){return}if(this.state==a.EditorState.VIRGIN){this.instance._registerTimeout(setTimeout(function(){n._fireCallbacks(true)},0));return}if(this.state==a.EditorState.EDITING){if(e){this.cancelChanges();this.instance.view.render();return}var s=this.getValue();if(this.instance.getSettings().trimWhitespace){o=[[typeof s==="string"?String.prototype.trim.call(s||""):s]]}else{o=[[s]]}this.state=a.EditorState.WAITING;this.saveValue(o,t);if(this.instance.getCellValidator(this.cellProperties)){this.instance.addHookOnce("postAfterValidate",function(e){n.state=a.EditorState.FINISHED;n.discardEditor(e)})}else{this.state=a.EditorState.FINISHED;this.discardEditor(true)}}};u.prototype.cancelChanges=function(){this.state=a.EditorState.FINISHED;this.discardEditor()};u.prototype.discardEditor=function(e){if(this.state!==a.EditorState.FINISHED){return}if(e===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=a.EditorState.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this._fullEditMode=false;this.state=a.EditorState.VIRGIN;this._fireCallbacks(true)}};u.prototype.enableFullEditMode=function(){this._fullEditMode=true};u.prototype.isInFullEditMode=function(){return this._fullEditMode};u.prototype.isOpened=function(){return this._opened};u.prototype.isWaiting=function(){return this.state===a.EditorState.WAITING};u.prototype.checkEditorSection=function(){var e=this.instance.countRows();var t="";if(this.row<this.instance.getSettings().fixedRowsTop){if(this.col<this.instance.getSettings().fixedColumnsLeft){t="top-left-corner"}else{t="top"}}else if(this.instance.getSettings().fixedRowsBottom&&this.row>=e-this.instance.getSettings().fixedRowsBottom){if(this.col<this.instance.getSettings().fixedColumnsLeft){t="bottom-left-corner"}else{t="bottom"}}else{if(this.col<this.instance.getSettings().fixedColumnsLeft){t="left"}}return t}},{"3rdparty/walkontable/src/cell/coords":6,browser:24,"helpers/mixed":51}],32:[function(e,t,r){"use strict";Object.defineProperties(r,{AutocompleteEditor:{get:function I(){return D}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("helpers/unicode"),n&&n.__esModule&&n||{"default":n}),f=d.KEY_CODES,c=d.isPrintableChar;var h=(o=e("helpers/mixed"),o&&o.__esModule&&o||{"default":o}).stringify;var m=(i=e("helpers/string"),i&&i.__esModule&&i||{"default":i}).stripTags;var p=(a=e("helpers/array"),a&&a.__esModule&&a||{"default":a}),v=p.pivot,g=p.arrayFilter,w=p.arrayMap;var b=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{"default":s}),y=b.addClass,C=b.getCaretPosition,_=b.getScrollbarWidth,E=b.getSelectionEndPosition,R=b.outerWidth,M=b.outerHeight,S=b.offset,O=b.getTrimmingContainer,T=b.setCaretPosition;var A=(l=e("editors"),l&&l.__esModule&&l||{"default":l}).registerEditor;var N=(u=e("handsontableEditor"),u&&u.__esModule&&u||{"default":u}).HandsontableEditor;var D=N.prototype.extend();D.prototype.init=function(){N.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};D.prototype.createElements=function(){N.prototype.createElements.apply(this,arguments);y(this.htContainer,"autocompleteEditor");y(this.htContainer,window.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")};var k=false;function x(e){k=false;var t=this.getActiveEditor();if(c(e.keyCode)||e.keyCode===f.BACKSPACE||e.keyCode===f.DELETE||e.keyCode===f.INSERT){var r=0;if(e.keyCode===f.C&&(e.ctrlKey||e.metaKey)){return}if(!t.isOpened()){r+=10}if(t.htEditor){t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value);k=true},r))}}}D.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",x);N.prototype.prepare.apply(this,arguments)};D.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto";N.prototype.open.apply(this,arguments);this.TEXTAREA_PARENT.style.overflow="";var e=this.htEditor.getInstance();var t=this;var r=this.cellProperties.trimDropdown===void 0?true:this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible";this.focus();e.updateSettings({colWidths:r?[R(this.TEXTAREA)-2]:void 0,width:r?R(this.TEXTAREA)+_()+2:void 0,afterRenderer:function n(e,r,o,i,a,s){var l=t.cellProperties,u=l.filteringCaseSensitive,d=l.allowHtml;var f;var c;a=h(a);if(a&&!d){f=u===true?a.indexOf(this.query):a.toLowerCase().indexOf(t.query.toLowerCase());if(f!==-1){c=a.substr(f,t.query.length);a=a.replace(c,"<strong>"+c+"</strong>")}}e.innerHTML=a},autoColumnSize:true,modifyColWidth:function o(e,t){var n=this.getPlugin("autoColumnSize").widths;if(n[t]){e=n[t]}return r?e:e+15}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=_()+2+"px";if(k){k=false}t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value)},0))};D.prototype.close=function(){N.prototype.close.apply(this,arguments)};D.prototype.queryChoices=function(e){var t=this;this.query=e;var r=this.cellProperties,n=r.source,o=r.filter,i=r.filteringCaseSensitive,a=r.allowHtml;var s=function l(e){return w(e,function(e){return m(e)})};if(typeof n=="function"){n.call(this.cellProperties,e,function(e){t.updateChoicesList(a?e:s(e))})}else if(Array.isArray(n)){this.updateChoicesList(a?n:s(n))}else{this.updateChoicesList([])}};D.prototype.updateChoicesList=function(e){var t=C(this.TEXTAREA);var r=E(this.TEXTAREA);var n=this.cellProperties.sortByRelevance;var o=this.cellProperties.filter;var i=null;var a=null;var s=null;if(n){i=D.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive)}var l=Array.isArray(i)?i.length:0;if(o===false){if(l){a=i[0]}}else{var u=[];for(var d=0,f=e.length;d<f;d++){if(n&&l<=d){break}if(l){u.push(e[i[d]])}else{u.push(e[d])}}a=0;e=u}this.choices=e;this.htEditor.loadData(v([e]));this.updateDropdownHeight();this.flipDropdownIfNeeded();if(this.cellProperties.strict===true){this.highlightBestMatchingChoice(a)}this.instance.listen();this.TEXTAREA.focus();T(this.TEXTAREA,t,t===r?void 0:r)};D.prototype.flipDropdownIfNeeded=function(){var e=S(this.TEXTAREA);var t=M(this.TEXTAREA);var r=this.getDropdownHeight();var n=O(this.instance.view.wt.wtTable.TABLE);var o=n.scrollTop;var i=M(this.instance.view.wt.wtTable.THEAD);var a={row:0,col:0};if(n!==window){a=S(n)}var s=e.top-a.top-i+o;var l=n.scrollHeight-s-i-t;var u=r>l&&s>l;if(u){this.flipDropdown(r)}else{this.unflipDropdown()}this.limitDropdownIfNeeded(u?s:l,r);return u};D.prototype.limitDropdownIfNeeded=function(e,t){if(t>e){var r=0;var n=0;var o=0;var i=null;do{o=this.htEditor.getRowHeight(n)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;r+=o;n++}while(r<e);i=r-o;if(this.htEditor.flipped){this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-i+"px"}this.setDropdownHeight(r-o)}};D.prototype.flipDropdown=function(e){var t=this.htEditor.rootElement.style;t.position="absolute";t.top=-e+"px";this.htEditor.flipped=true};D.prototype.unflipDropdown=function(){var e=this.htEditor.rootElement.style;if(e.position==="absolute"){e.position="";e.top=""}this.htEditor.flipped=void 0};D.prototype.updateDropdownHeight=function(){var e=this.htEditor.getColWidth(0)+_()+2;var t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};D.prototype.setDropdownHeight=function(e){this.htEditor.updateSettings({height:e})};D.prototype.finishEditing=function(e){if(!e){this.instance.removeHook("beforeKeyDown",x)}N.prototype.finishEditing.apply(this,arguments)};D.prototype.highlightBestMatchingChoice=function(e){if(typeof e==="number"){this.htEditor.selectCell(e,0)}else{this.htEditor.deselectCell()}};D.sortByRelevance=function(e,t,r){var n=[];var o;var i=e.length;var a;var s;var l=[];var u;var d=t.length;if(i===0){for(u=0;u<d;u++){l.push(u)}return l}for(u=0;u<d;u++){o=m(h(t[u]));if(r){a=o.indexOf(e)}else{a=o.toLowerCase().indexOf(e.toLowerCase())}if(a==-1){continue}s=o.length-a-i;n.push({baseIndex:u,index:a,charsLeft:s,value:o})}n.sort(function(e,t){if(t.index===-1){return-1}if(e.index===-1){return 1}if(e.index<t.index){return-1}else if(t.index<e.index){return 1}else if(e.index===t.index){if(e.charsLeft<t.charsLeft){return-1}else if(e.charsLeft>t.charsLeft){return 1}else{return 0}}});for(u=0,d=n.length;u<d;u++){l.push(n[u].baseIndex)}return l};D.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;var t=this.cellProperties.visibleRows;return this.choices.length>=t?t*e:this.choices.length*e+8};D.prototype.allowKeyEventPropagation=function(e){var t={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1};var r=false;if(e===f.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1){r=true}if(e===f.ARROW_UP&&t.row>-1){r=true}return r};D.prototype.discardEditor=function(e){N.prototype.discardEditor.apply(this,arguments);this.instance.view.render()};A("autocomplete",D)},{editors:30,handsontableEditor:36,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/string":55,"helpers/unicode":56}],33:[function(e,t,r){"use strict";Object.defineProperties(r,{CheckboxEditor:{get:function f(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("editors"),n&&n.__esModule&&n||{"default":n}).registerEditor;var s=(o=e("_baseEditor"),o&&o.__esModule&&o||{"default":o}).BaseEditor;var l=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}).hasClass;var u=function c(){$traceurRuntime.superConstructor(d).apply(this,arguments)};var d=u;$traceurRuntime.createClass(u,{beginEditing:function h(e,t){if(t===void 0){var r=this.TD.querySelector('input[type="checkbox"]');if(!l(r,"htBadValue")){r.click()}}},finishEditing:function m(){},init:function p(){},open:function v(){},close:function g(){},getValue:function w(){},setValue:function b(){},focus:function y(){}},{},s);a("checkbox",u)},{_baseEditor:31,editors:30,"helpers/dom/element":47}],34:[function(e,t,r){"use strict";Object.defineProperties(r,{DateEditor:{get:function A(){return O}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c;var h=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var m=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),p=m.addClass,v=m.outerHeight;var g=(i=e("helpers/object"),i&&i.__esModule&&i||{"default":i}).deepExtend;var w=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).EventManager;var b=(s=e("editors"),s&&s.__esModule&&s||{"default":s}),y=b.getEditor,C=b.registerEditor;var _=(l=e("helpers/unicode"),l&&l.__esModule&&l||{"default":l}).isMetaKey;var E=(u=e("helpers/dom/event"),u&&u.__esModule&&u||{"default":u}).stopPropagation;var R=(d=e("textEditor"),d&&d.__esModule&&d||{"default":d}).TextEditor;var M=(f=e("moment"),f&&f.__esModule&&f||{"default":f}).default;var S=(c=e("pikaday"),c&&c.__esModule&&c||{"default":c}).default;var O=function N(e){this.$datePicker=null;this.datePicker=null;this.datePickerStyle=null;this.defaultDateFormat="DD/MM/YYYY";this.isCellEdited=false;this.parentDestroyed=false;$traceurRuntime.superConstructor(T).call(this,e)};var T=O;$traceurRuntime.createClass(O,{init:function D(){var e=this;if(typeof M!=="function"){throw new Error("You need to include moment.js to your project.")}if(typeof S!=="function"){throw new Error("You need to include Pikaday to your project.")}$traceurRuntime.superGet(this,T.prototype,"init").call(this);this.instance.addHook("afterDestroy",function(){e.parentDestroyed=true;e.destroyElements()})},createElements:function k(){$traceurRuntime.superGet(this,T.prototype,"createElements").call(this);this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;p(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);this.$datePicker=new S(this.getDatePickerConfig());var e=new w(this);e.addEventListener(this.datePicker,"mousedown",function(e){return E(e)});this.hideDatepicker()},destroyElements:function x(){this.$datePicker.destroy()},prepare:function I(e,t,r,n,o,i){this._opened=false;$traceurRuntime.superGet(this,T.prototype,"prepare").call(this,e,t,r,n,o,i)},open:function P(){var e=arguments[0]!==void 0?arguments[0]:null;$traceurRuntime.superGet(this,T.prototype,"open").call(this);this.showDatepicker(e)},close:function L(){var e=this;this._opened=false;this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0));$traceurRuntime.superGet(this,T.prototype,"close").call(this)},finishEditing:function H(){var e=arguments[0]!==void 0?arguments[0]:false;var t=arguments[1]!==void 0?arguments[1]:false;if(e){var r=this.originalValue;if(r!==void 0){this.setValue(r)}}this.hideDatepicker();$traceurRuntime.superGet(this,T.prototype,"finishEditing").call(this,e,t)},showDatepicker:function V(e){this.$datePicker.config(this.getDatePickerConfig());var t=this.TD.getBoundingClientRect();var r=this.cellProperties.dateFormat||this.defaultDateFormat;var n=this.$datePicker.config();var o;var i=this.instance.view.isMouseDown();var a=e?_(e.keyCode):false;this.datePickerStyle.top=window.pageYOffset+t.top+v(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+t.left+"px";this.$datePicker._onInputFocus=function(){};n.format=r;if(this.originalValue){o=this.originalValue;if(M(o,r,true).isValid()){this.$datePicker.setMoment(M(o,r),true)}if(this.getValue()!==this.originalValue){this.setValue(this.originalValue)}if(!a&&!i){this.setValue("")}}else{if(this.cellProperties.defaultDate){o=this.cellProperties.defaultDate;n.defaultDate=o;if(M(o,r,true).isValid()){this.$datePicker.setMoment(M(o,r),true)}if(!a&&!i){this.setValue("")}}else{this.$datePicker.gotoToday()}}this.datePickerStyle.display="block";this.$datePicker.show()},hideDatepicker:function F(){this.datePickerStyle.display="none";this.$datePicker.hide()},getDatePickerConfig:function B(){var e=this;var t=this.TEXTAREA;var r={};if(this.cellProperties&&this.cellProperties.datePickerConfig){g(r,this.cellProperties.datePickerConfig)}var n=r.onSelect;var o=r.onClose;r.field=t;r.trigger=t;r.container=this.datePicker;r.bound=false;r.format=r.format||this.defaultDateFormat;r.reposition=r.reposition||false;r.onSelect=function(t){if(!isNaN(t.getTime())){t=M(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)}e.setValue(t);e.hideDatepicker();if(n){n()}};r.onClose=function(){if(!e.parentDestroyed){e.finishEditing(false)}if(o){o()}};return r}},{},R);h.editors=h.editors||{};h.editors.DateEditor=O;C("date",O)},{browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,moment:"moment",pikaday:"pikaday",textEditor:41}],35:[function(e,t,r){"use strict";Object.defineProperties(r,{DropdownEditor:{get:function m(){return c}},__esModule:{value:true}});var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("editors"),o&&o.__esModule&&o||{"default":o}),l=s.getEditor,u=s.registerEditor,d=s.getEditorConstructor;var f=(i=e("autocompleteEditor"),i&&i.__esModule&&i||{"default":i}).AutocompleteEditor;var c=function p(){$traceurRuntime.superConstructor(h).apply(this,arguments)};var h=c;$traceurRuntime.createClass(c,{prepare:function v(e,t,r,n,o,i){$traceurRuntime.superGet(this,h.prototype,"prepare").call(this,e,t,r,n,o,i);this.cellProperties.filter=false;this.cellProperties.strict=true}},{},f);a.hooks.add("beforeValidate",function(e,t,r,n){var o=this.getCellMeta(t,this.propToCol(r));if(o.editor===a.editors.DropdownEditor){if(o.strict===void 0){o.filter=false;o.strict=true}}});u("dropdown",c)},{autocompleteEditor:32,browser:24,editors:30}],36:[function(e,t,r){"use strict";Object.defineProperties(r,{HandsontableEditor:{get:function E(){return C}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var f=(o=e("helpers/unicode"),o&&o.__esModule&&o||{"default":o}).KEY_CODES;var c=(i=e("helpers/object"),i&&i.__esModule&&i||{"default":i}).extend;var h=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}).setCaretPosition;var m=(s=e("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}),p=m.stopImmediatePropagation,v=m.isImmediatePropagationStopped;var g=(l=e("editors"),l&&l.__esModule&&l||{"default":l}),w=g.getEditor,b=g.registerEditor;var y=(u=e("textEditor"),u&&u.__esModule&&u||{"default":u}).TextEditor;var C=y.prototype.extend();C.prototype.createElements=function(){y.prototype.createElements.apply(this,arguments);var e=document.createElement("DIV");e.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(e);this.htContainer=e;this.assignHooks()};C.prototype.prepare=function(e,t,r,n,o,i){y.prototype.prepare.apply(this,arguments);var a=this;var s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:false,autoColumnSize:false,autoRowSize:false,readOnly:true,fillHandle:false,afterOnCellMouseDown:function l(){var e=this.getValue();if(e!==void 0){a.setValue(e)}a.instance.destroyEditor()}};if(this.cellProperties.handsontable){c(s,i.handsontable)}this.htOptions=s};var _=function R(e){if(v(e)){return}var t=this.getActiveEditor();var r=t.htEditor.getInstance();var n;if(e.keyCode==f.ARROW_DOWN){if(!r.getSelected()&&!r.flipped){n=0}else if(r.getSelected()){if(r.flipped){n=r.getSelected()[0]+1}else if(!r.flipped){var o=r.getSelected()[0];var i=r.countRows()-1;n=Math.min(i,o+1)}}}else if(e.keyCode==f.ARROW_UP){if(!r.getSelected()&&r.flipped){n=r.countRows()-1}else if(r.getSelected()){if(r.flipped){var o=r.getSelected()[0];n=Math.max(0,o-1)}else{var o=r.getSelected()[0];n=o-1}}}if(n!==void 0){if(n<0||r.flipped&&n>r.countRows()-1){r.deselectCell()}else{r.selectCell(n,0)}if(r.getData().length){e.preventDefault();p(e);t.instance.listen();t.TEXTAREA.focus()}}};C.prototype.open=function(){this.instance.addHook("beforeKeyDown",_);y.prototype.open.apply(this,arguments);if(this.htEditor){this.htEditor.destroy()}this.htEditor=new d(this.htContainer,this.htOptions);if(this.cellProperties.strict){this.htEditor.selectCell(0,0);this.TEXTAREA.style.visibility="hidden"}else{this.htEditor.deselectCell();this.TEXTAREA.style.visibility="visible"}h(this.TEXTAREA,0,this.TEXTAREA.value.length)};C.prototype.close=function(){this.instance.removeHook("beforeKeyDown",_);this.instance.listen();y.prototype.close.apply(this,arguments)};C.prototype.focus=function(){this.instance.listen();y.prototype.focus.apply(this,arguments)};C.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;if(t&&t()===false){return}y.prototype.beginEditing.apply(this,arguments)};C.prototype.finishEditing=function(e,t){if(this.htEditor&&this.htEditor.isListening()){this.instance.listen()}if(this.htEditor&&this.htEditor.getSelected()){var r=this.htEditor.getInstance().getValue();if(r!==void 0){this.setValue(r)}}return y.prototype.finishEditing.apply(this,arguments)};C.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){
if(e.htEditor){e.htEditor.destroy()}})};b("handsontable",C)},{browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,textEditor:41}],37:[function(e,t,r){"use strict";Object.defineProperties(r,{MobileTextEditor:{get:function I(){return D}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var f=(o=e("helpers/unicode"),o&&o.__esModule&&o||{"default":o}).KEY_CODES;var c=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{"default":i}),h=c.stopImmediatePropagation,m=c.isImmediatePropagationStopped;var p=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}),v=p.addClass,g=p.getScrollLeft,w=p.getScrollTop,b=p.hasClass,y=p.isChildOf,C=p.offset,_=p.outerHeight,E=p.outerWidth,R=p.removeClass,M=p.setCaretPosition;var S=(s=e("editors"),s&&s.__esModule&&s||{"default":s}),O=S.getEditor,T=S.registerEditor;var A=(l=e("_baseEditor"),l&&l.__esModule&&l||{"default":l}).BaseEditor;var N=(u=e("eventManager"),u&&u.__esModule&&u||{"default":u}).eventManager;var D=A.prototype.extend(),k={};var x=function P(){this.controls={};this.controls.leftButton=document.createElement("DIV");this.controls.leftButton.className="leftButton";this.controls.rightButton=document.createElement("DIV");this.controls.rightButton.className="rightButton";this.controls.upButton=document.createElement("DIV");this.controls.upButton.className="upButton";this.controls.downButton=document.createElement("DIV");this.controls.downButton.className="downButton";for(var e in this.controls){if(this.controls.hasOwnProperty(e)){this.positionControls.appendChild(this.controls[e])}}};D.prototype.valueChanged=function(){return this.initValue!=this.getValue()};D.prototype.init=function(){var e=this;this.eventManager=N(this.instance);this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){e.destroy()})};D.prototype.getValue=function(){return this.TEXTAREA.value};D.prototype.setValue=function(e){this.initValue=e;this.TEXTAREA.value=e};D.prototype.createElements=function(){this.editorContainer=document.createElement("DIV");this.editorContainer.className="htMobileEditorContainer";this.cellPointer=document.createElement("DIV");this.cellPointer.className="cellPointer";this.moveHandle=document.createElement("DIV");this.moveHandle.className="moveHandle";this.inputPane=document.createElement("DIV");this.inputPane.className="inputs";this.positionControls=document.createElement("DIV");this.positionControls.className="positionControls";this.TEXTAREA=document.createElement("TEXTAREA");v(this.TEXTAREA,"handsontableInput");this.inputPane.appendChild(this.TEXTAREA);this.editorContainer.appendChild(this.cellPointer);this.editorContainer.appendChild(this.moveHandle);this.editorContainer.appendChild(this.inputPane);this.editorContainer.appendChild(this.positionControls);x.call(this);document.body.appendChild(this.editorContainer)};D.prototype.onBeforeKeyDown=function(e){var t=this;var r=t.getActiveEditor();if(e.target!==r.TEXTAREA||m(e)){return}switch(e.keyCode){case f.ENTER:r.close();e.preventDefault();break;case f.BACKSPACE:h(e);break}};D.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);v(this.editorContainer,"active");R(this.cellPointer,"hidden");this.updateEditorPosition()};D.prototype.focus=function(){this.TEXTAREA.focus();M(this.TEXTAREA,this.TEXTAREA.value.length)};D.prototype.close=function(){this.TEXTAREA.blur();this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown);R(this.editorContainer,"active")};D.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)};D.prototype.hideCellPointer=function(){if(!b(this.cellPointer,"hidden")){v(this.cellPointer,"hidden")}};D.prototype.updateEditorPosition=function(e,t){if(e&&t){e=parseInt(e,10);t=parseInt(t,10);this.editorContainer.style.top=t+"px";this.editorContainer.style.left=e+"px"}else{var r=this.instance.getSelected(),n=this.instance.getCell(r[0],r[1]);if(!k.cellPointer){k.cellPointer={height:_(this.cellPointer),width:E(this.cellPointer)}}if(!k.editorContainer){k.editorContainer={width:E(this.editorContainer)}}if(n!==undefined){var o=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:g(this.instance.view.wt.wtOverlays.leftOverlay.holder);var i=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:w(this.instance.view.wt.wtOverlays.topOverlay.holder);var a=C(n),s=E(n),l={x:o,y:i};this.editorContainer.style.top=parseInt(a.top+_(n)-l.y+k.cellPointer.height,10)+"px";this.editorContainer.style.left=parseInt(window.innerWidth/2-k.editorContainer.width/2,10)+"px";if(a.left+s/2>parseInt(this.editorContainer.style.left,10)+k.editorContainer.width){this.editorContainer.style.left=window.innerWidth-k.editorContainer.width+"px"}else if(a.left+s/2<parseInt(this.editorContainer.style.left,10)+20){this.editorContainer.style.left=0+"px"}this.cellPointer.style.left=parseInt(a.left-k.cellPointer.width/2-C(this.editorContainer).left+s/2-l.x,10)+"px"}}};D.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0];this.col=e[1];this.setValue(t);this.updateEditorPosition()};D.prototype.prepareAndSave=function(){var e;if(!this.valueChanged()){return true}if(this.instance.getSettings().trimWhitespace){e=[[String.prototype.trim.call(this.getValue())]]}else{e=[[this.getValue()]]}this.saveValue(e)};D.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){e.prepareAndSave();e.instance.selection.transformStart(0,-1,null,true);e.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){e.prepareAndSave();e.instance.selection.transformStart(0,1,null,true);e.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){e.prepareAndSave();e.instance.selection.transformStart(-1,0,null,true);e.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){e.prepareAndSave();e.instance.selection.transformStart(1,0,null,true);e.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(t.touches.length==1){var r=t.touches[0],n={x:e.editorContainer.offsetLeft,y:e.editorContainer.offsetTop},o={x:r.pageX-n.x,y:r.pageY-n.y};e.eventManager.addEventListener(this,"touchmove",function(t){var r=t.touches[0];e.updateEditorPosition(r.pageX-o.x,r.pageY-o.y);e.hideCellPointer();t.preventDefault()})}});this.eventManager.addEventListener(document.body,"touchend",function(t){if(!y(t.target,e.editorContainer)&&!y(t.target,e.instance.rootElement)){e.close()}});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(t){if(e.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window){e.hideCellPointer()}});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(t){if(e.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window){e.hideCellPointer()}})};D.prototype.destroy=function(){this.eventManager.clear();this.editorContainer.parentNode.removeChild(this.editorContainer)};T("mobile",D)},{_baseEditor:31,browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],38:[function(e,t,r){"use strict";Object.defineProperties(r,{NumericEditor:{get:function f(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("numbro"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("editors"),o&&o.__esModule&&o||{"default":o}).registerEditor;var l=(i=e("textEditor"),i&&i.__esModule&&i||{"default":i}).TextEditor;var u=function c(){$traceurRuntime.superConstructor(d).apply(this,arguments)};var d=u;$traceurRuntime.createClass(u,{beginEditing:function h(e){if(typeof e==="undefined"&&this.originalValue){if(typeof this.cellProperties.language!=="undefined"){a.culture(this.cellProperties.language)}var t=a.cultureData().delimiters.decimal;e=(""+this.originalValue).replace(".",t)}$traceurRuntime.superGet(this,d.prototype,"beginEditing").call(this,e)}},{},l);s("numeric",u)},{editors:30,numbro:"numbro",textEditor:41}],39:[function(e,t,r){"use strict";Object.defineProperties(r,{PasswordEditor:{get:function p(){return h}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).empty;var u=(i=e("editors"),i&&i.__esModule&&i||{"default":i}),d=u.getEditor,f=u.registerEditor;var c=(a=e("textEditor"),a&&a.__esModule&&a||{"default":a}).TextEditor;var h=function v(){$traceurRuntime.superConstructor(m).apply(this,arguments)};var m=h;$traceurRuntime.createClass(h,{createElements:function g(){$traceurRuntime.superGet(this,m.prototype,"createElements").call(this);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;l(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},c);f("password",h)},{browser:24,editors:30,"helpers/dom/element":47,textEditor:41}],40:[function(e,t,r){"use strict";Object.defineProperties(r,{SelectEditor:{get:function A(){return O}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),f=d.addClass,c=d.empty,h=d.fastInnerHTML,m=d.getComputedStyle,p=d.getCssTransform,v=d.getScrollableElement,g=d.offset,w=d.outerHeight,b=d.outerWidth,y=d.resetCssTransform;var C=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{"default":i}).stopImmediatePropagation;var _=(a=e("helpers/unicode"),a&&a.__esModule&&a||{"default":a}).KEY_CODES;var E=(s=e("editors"),s&&s.__esModule&&s||{"default":s}),R=E.getEditor,M=E.registerEditor;var S=(l=e("_baseEditor"),l&&l.__esModule&&l||{"default":l}).BaseEditor;var O=S.prototype.extend();O.prototype.init=function(){this.select=document.createElement("SELECT");f(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select);this.registerHooks()};O.prototype.registerHooks=function(){var e=this;this.instance.addHook("afterScrollHorizontally",function(){return e.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){return e.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){return e.refreshDimensions()});this.instance.addHook("afterRowResize",function(){return e.refreshDimensions()})};O.prototype.prepare=function(){S.prototype.prepare.apply(this,arguments);var e=this.cellProperties.selectOptions;var t;if(typeof e=="function"){t=this.prepareOptions(e(this.row,this.col,this.prop))}else{t=this.prepareOptions(e)}c(this.select);for(var r in t){if(t.hasOwnProperty(r)){var n=document.createElement("OPTION");n.value=r;h(n,t[r]);this.select.appendChild(n)}}};O.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e)){for(var r=0,n=e.length;r<n;r++){t[e[r]]=e[r]}}else if((typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=e}return t};O.prototype.getValue=function(){return this.select.value};O.prototype.setValue=function(e){this.select.value=e};var T=function N(e){var t=this;var r=t.getActiveEditor();switch(e.keyCode){case _.ARROW_UP:var n=r.select.selectedIndex-1;if(n>=0){r.select[n].selected=true}C(e);e.preventDefault();break;case _.ARROW_DOWN:var o=r.select.selectedIndex+1;if(o<=r.select.length-1){r.select[o].selected=true}C(e);e.preventDefault();break}};O.prototype.open=function(){this._opened=true;this.refreshDimensions();this.select.style.display="";this.instance.addHook("beforeKeyDown",T)};O.prototype.close=function(){this._opened=false;this.select.style.display="none";this.instance.removeHook("beforeKeyDown",T)};O.prototype.focus=function(){this.select.focus()};O.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e;this.setValue(e);this.refreshDimensions()};O.prototype.refreshDimensions=function(){if(this.state!==u.EditorState.EDITING){return}this.TD=this.getEditedCell();if(!this.TD){this.close();return}var e=b(this.TD)+1,t=w(this.TD)+1,r=g(this.TD),n=g(this.instance.rootElement),o=v(this.TD),i=r.top-n.top-1-(o.scrollTop||0),a=r.left-n.left-1-(o.scrollLeft||0),s=this.checkEditorSection(),l;var d=this.instance.getSettings();var f=d.rowHeaders?1:0;var c=d.colHeaders?1:0;switch(s){case"top":l=p(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":l=p(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":l=p(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":l=p(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":l=p(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);break}if(this.instance.getSelected()[0]===0){i+=1}if(this.instance.getSelected()[1]===0){a+=1}var h=this.select.style;if(l&&l!=-1){h[l[0]]=l[1]}else{y(this.select)}var C=m(this.TD);if(parseInt(C.borderTopWidth,10)>0){t-=1}if(parseInt(C.borderLeftWidth,10)>0){e-=1}h.height=t+"px";h.minWidth=e+"px";h.top=i+"px";h.left=a+"px";h.margin="0px"};O.prototype.getEditedCell=function(){var e=this.checkEditorSection(),t;switch(e){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=101;break;case"corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col);this.select.style.zIndex="";break}return t!=-1&&t!=-2?t:void 0};M("select",O)},{_baseEditor:31,browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],41:[function(e,t,r){"use strict";Object.defineProperties(r,{TextEditor:{get:function V(){return L}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),h=c.addClass,m=c.getCaretPosition,p=c.getComputedStyle,v=c.getCssTransform,g=c.getScrollableElement,w=c.getScrollbarWidth,b=c.innerWidth,y=c.offset,C=c.resetCssTransform,_=c.setCaretPosition,E=c.hasVerticalScrollbar,R=c.hasHorizontalScrollbar;var M=(i=e("autoResize"),i&&i.__esModule&&i||{"default":i}).default;var S=(a=e("_baseEditor"),a&&a.__esModule&&a||{"default":a}).BaseEditor;var O=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).eventManager;var T=(l=e("editors"),l&&l.__esModule&&l||{"default":l}),A=T.getEditor,N=T.registerEditor;var D=(u=e("helpers/unicode"),u&&u.__esModule&&u||{"default":u}).KEY_CODES;var k=(d=e("helpers/dom/event"),d&&d.__esModule&&d||{"default":d}),x=k.stopPropagation,I=k.stopImmediatePropagation,P=k.isImmediatePropagationStopped;var L=S.prototype.extend();L.prototype.init=function(){var e=this;this.createElements();this.eventManager=O(this);this.bindEvents();this.autoResize=M();this.instance.addHook("afterDestroy",function(){e.destroy()})};L.prototype.getValue=function(){return this.TEXTAREA.value};L.prototype.setValue=function(e){this.TEXTAREA.value=e};var H=function F(e){console.log(" in text editor kwydown");var t=this,r=t.getActiveEditor(),n;n=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target!==r.TEXTAREA||P(e)){return}if(e.keyCode===17||e.keyCode===224||e.keyCode===91||e.keyCode===93){I(e);return}switch(e.keyCode){case D.ARROW_RIGHT:if(r.isInFullEditMode()){if(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode)){I(e)}}break;case D.ARROW_LEFT:if(r.isInFullEditMode()){if(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode)){I(e)}}break;case D.ARROW_UP:case D.ARROW_DOWN:if(r.isInFullEditMode()){if(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode)){I(e)}}break;case D.ENTER:console.log("*** at 9370");var o=r.instance.getSelected();var i=!(o[0]===o[2]&&o[1]===o[3]);if(n&&!i||e.altKey){if(r.isOpened()){var a=m(r.TEXTAREA),s=r.getValue();var l=s.slice(0,a)+"\n"+s.slice(a);r.setValue(l);_(r.TEXTAREA,a+1)}else{r.beginEditing(r.originalValue+"\n")}I(e)}e.preventDefault();break;case D.A:case D.X:case D.C:case D.V:if(n){I(e)}break;case D.BACKSPACE:case D.DELETE:case D.HOME:case D.END:I(e);break}if([D.ARROW_UP,D.ARROW_RIGHT,D.ARROW_DOWN,D.ARROW_LEFT].indexOf(e.keyCode)===-1){r.autoResize.resize(String.fromCharCode(e.keyCode))}};L.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",H)};L.prototype.close=function(e){this.textareaParentStyle.display="none";this.autoResize.unObserve();if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.instance.removeHook("beforeKeyDown",H)};L.prototype.focus=function(){this.TEXTAREA.focus();_(this.TEXTAREA,this.TEXTAREA.value.length)};L.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");h(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");h(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))};L.prototype.getEditedCell=function(){var e=this.checkEditorSection(),t;switch(e){case"top":t=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"top-left-corner":t=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":t=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":t=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;case"bottom":t=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:t=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex="";break}return t!=-1&&t!=-2?t:void 0};L.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e;this.setValue(e);this.refreshDimensions()};L.prototype.refreshDimensions=function(){if(this.state!==f.EditorState.EDITING){return}this.TD=this.getEditedCell();if(!this.TD){this.close(true);return}var e=y(this.TD),t=y(this.instance.rootElement),r=g(this.TD),n=this.instance.countRows(),o=e.top===t.top?0:1,i=e.top-t.top-o-(r.scrollTop||0),a=e.left-t.left-1-(r.scrollLeft||0),s=this.instance.getSettings(),l=this.instance.hasRowHeaders(),u=this.instance.hasColHeaders(),d=this.checkEditorSection(),c=this.TD.style.backgroundColor,h;switch(d){case"top":h=v(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":h=v(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":h=v(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":h=v(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":h=v(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);break}if(u&&this.instance.getSelected()[0]===0||s.fixedRowsBottom&&this.instance.getSelected()[0]===n-s.fixedRowsBottom){i+=1}if(this.instance.getSelected()[1]===0){a+=1}if(h&&h!=-1){this.textareaParentStyle[h[0]]=h[1]}else{C(this.TEXTAREA_PARENT)}this.textareaParentStyle.top=i+"px";this.textareaParentStyle.left=a+"px";var m=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition;var _=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition;var M=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition();var S=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition();var O=w();var T=this.TD.offsetTop+m-S;var A=this.TD.offsetLeft+_-M;var N=b(this.TD)-8;var D=E(r)?O:0;var k=R(r)?O:0;var x=this.instance.view.maximumVisibleElementWidth(A)-9-D;var I=this.TD.scrollHeight+1;var P=Math.max(this.instance.view.maximumVisibleElementHeight(T)-k,23);var L=p(this.TD);this.TEXTAREA.style.fontSize=L.fontSize;this.TEXTAREA.style.fontFamily=L.fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=c?c:p(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(I,P),maxHeight:P,minWidth:Math.min(N,x),maxWidth:x},true);this.textareaParentStyle.display="block"};L.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){x(e)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){x(e)});this.instance.addHook("afterScrollHorizontally",function(){e.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){e.refreshDimensions();e.focus()});this.instance.addHook("afterRowResize",function(){e.refreshDimensions();e.focus()});this.instance.addHook("afterDestroy",function(){e.eventManager.destroy()})};L.prototype.destroy=function(){this.eventManager.destroy()};N("text",L)},{_baseEditor:31,autoResize:"autoResize",browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],42:[function(e,t,r){"use strict";Object.defineProperties(r,{EventManager:{get:function v(){return h}},eventManager:{get:function g(){return p}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),u=l.polymerWrap,d=l.closest;var f=(i=e("helpers/feature"),i&&i.__esModule&&i||{"default":i}).isWebComponentSupportedNatively;var c=(a=e("helpers/dom/event"),a&&a.__esModule&&a||{"default":a}).stopImmediatePropagation;var h=function w(){var e=arguments[0]!==void 0?arguments[0]:null;this.context=e||this;if(!this.context.eventListeners){this.context.eventListeners=[]}};$traceurRuntime.createClass(h,{addEventListener:function b(e,t,r){var n=this;var o=this.context;function i(e){e=m(o,e);r.call(this,e)}this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:i});if(window.addEventListener){e.addEventListener(t,i,false)}else{e.attachEvent("on"+t,i)}s.countEventManagerListeners++;return function(){n.removeEventListener(e,t,r)}},removeEventListener:function y(e,t,r){var n=this.context.eventListeners.length;var o;while(n--){o=this.context.eventListeners[n];if(o.event==t&&o.element==e){if(r&&r!=o.callback){continue}this.context.eventListeners.splice(n,1);if(o.element.removeEventListener){o.element.removeEventListener(o.event,o.callbackProxy,false)}else{o.element.detachEvent("on"+o.event,o.callbackProxy)}s.countEventManagerListeners--}}},clearEvents:function C(){if(!this.context){return}var e=this.context.eventListeners.length;while(e--){var t=this.context.eventListeners[e];if(t){this.removeEventListener(t.element,t.event,t.callback)}}},clear:function _(){this.clearEvents()},destroy:function E(){this.clearEvents();this.context=null},fireEvent:function R(e,t){var r={bubbles:true,cancelable:t!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:undefined};var n;if(document.createEvent){n=document.createEvent("MouseEvents");n.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||document.body.parentNode)}else{n=document.createEventObject()}if(e.dispatchEvent){e.dispatchEvent(n)}else{e.fireEvent("on"+t,n)}}},{});function m(e,t){var r="HOT-TABLE";var n;var o;var i;var a;var l;var h;t.isTargetWebComponent=false;t.realTarget=t.target;h=t.stopImmediatePropagation;t.stopImmediatePropagation=function(){h.apply(this);c(this)};if(!s.eventManager.isHotTableEnv){return t}t=u(t);l=t.path?t.path.length:0;while(l--){if(t.path[l].nodeName===r){n=true}else if(n&&t.path[l].shadowRoot){a=t.path[l];break}if(l===0&&!a){a=t.path[l]}}if(!a){a=t.target}t.isTargetWebComponent=true;if(f()){t.realTarget=t.srcElement||t.toElement}else if(e instanceof s.Core||e instanceof Walkontable){if(e instanceof s.Core){o=e.view?e.view.wt.wtTable.TABLE:null}else if(e instanceof Walkontable){o=e.wtTable.TABLE.parentNode.parentNode}i=d(t.target,[r],o);if(i){t.realTarget=o.querySelector(r)||t.target}else{t.realTarget=t.target}}Object.defineProperty(t,"target",{get:function m(){return u(a)},enumerable:true,configurable:true});return t}s.countEventManagerListeners=0;s.eventManager=p;function p(e){return new h(e)}},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49}],43:[function(e,t,r){"use strict";Object.defineProperties(r,{to2dArray:{get:function g(){return n}},extendArray:{get:function w(){return o}},pivot:{get:function b(){return i}},arrayReduce:{get:function y(){return a}},arrayFilter:{get:function C(){return s}},arrayMap:{get:function _(){return l}},arrayEach:{get:function E(){return u}},arraySum:{get:function R(){return d}},arrayMax:{get:function M(){return f}},arrayMin:{get:function S(){return c}},arrayAvg:{get:function O(){return h}},arrayFlatten:{get:function T(){return m}},arrayUnique:{get:function A(){return p}},arrayIncludes:{get:function N(){return v}},__esModule:{value:true}});function n(e){var t=0,r=e.length;while(t<r){e[t]=[e[t]];t++}}function o(e,t){var r=0,n=t.length;while(r<n){e.push(t[r]);r++}}function i(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0){return t}var r=e.length;var n=e[0].length;for(var o=0;o<r;o++){for(var i=0;i<n;i++){if(!t[i]){t[i]=[]}t[i][o]=e[o][i]}}return t}function a(e,t,r,n){var o=-1,i=e.length;if(n&&i){r=e[++o]}while(++o<i){r=t(r,e[o],o,e)}return r}function s(e,t){var r=-1,n=e.length,o=-1,i=[];while(++r<n){var a=e[r];if(t(a,r,e)){i[++o]=a}}return i}function l(e,t){var r=-1,n=e.length,o=-1,i=[];while(++r<n){var a=e[r];i[++o]=t(a,r,e)}return i}function u(e,t){var r=-1,n=e.length;while(++r<n){if(t(e[r],r,e)===false){break}}return e}function d(e){return a(e,function(e,t){return e+t},0)}function f(e){return a(e,function(e,t){return e>t?e:t},Array.isArray(e)?e[0]:void 0)}function c(e){return a(e,function(e,t){return e<t?e:t},Array.isArray(e)?e[0]:void 0)}function h(e){if(!e.length){return 0}return d(e)/e.length}function m(e){return a(e,function(e,t){return e.concat(Array.isArray(t)?m(t):t)},[])}function p(e){var t=[];u(e,function(e){if(t.indexOf(e)===-1){t.push(e)}});return t}function v(e,t,r){if(e==null){throw new TypeError('"array" is null or not defined')}var n=Object(e);var o=n.length>>>0;if(o===0){return false}var i=r|0;var a=Math.max(i>=0?i:o-Math.abs(i),0);while(a<o){if(n[a]===t){return true}a++}return false}},{}],44:[function(e,t,r){"use strict";Object.defineProperties(r,{isIE8:{get:function c(){return o}},isIE9:{get:function h(){return a}},isSafari:{get:function m(){return l}},isChrome:{get:function p(){return d}},isMobileBrowser:{get:function v(){return f}},__esModule:{value:true}});var n=!document.createTextNode("test").textContent;function o(){return n}var i=!!document.documentMode;function a(){return i}var s=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);function l(){return s}var u=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor);function d(){return u}function f(e){if(!e){e=navigator.userAgent}return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}},{}],45:[function(e,t,r){"use strict";Object.defineProperties(r,{spreadsheetColumnLabel:{get:function v(){return u}},spreadsheetColumnIndex:{get:function g(){return d}},createSpreadsheetData:{get:function w(){return f}},createSpreadsheetObjectData:{get:function b(){return c}},createEmptySpreadsheetData:{get:function y(){return h}},translateRowsToColumns:{get:function C(){return m}},cellMethodLookupFactory:{get:function _(){return p}},__esModule:{value:true}});var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("object"),o&&o.__esModule&&o||{"default":o}).getPrototypeOf;var s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var l=s.length;function u(e){var t=e+1;var r="";var n;while(t>0){n=(t-1)%l;r=String.fromCharCode(65+n)+r;t=parseInt((t-n)/l,10)}return r}function d(e){var t=0;if(e){for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1){t+=Math.pow(l,n)*(s.indexOf(e[r])+1)}}--t;return t}function f(){var e=arguments[0]!==void 0?arguments[0]:100;var t=arguments[1]!==void 0?arguments[1]:4;var r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++){i.push(u(o)+(n+1))}r.push(i)}return r}function c(){var e=arguments[0]!==void 0?arguments[0]:100;var t=arguments[1]!==void 0?arguments[1]:4;var r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++){i["prop"+o]=u(o)+(n+1)}r.push(i)}return r}function h(e,t){var r=[];var n;for(var o=0;o<e;o++){n=[];for(var i=0;i<t;i++){n.push("")}r.push(n)}return r}function m(e){var t,r,n,o,i=[],a=0;for(t=0,r=e.length;t<r;t++){for(n=0,o=e[t].length;n<o;n++){if(n==a){i.push([]);a++}i[n].push(e[t][n])}}return i}function p(e,t){t=typeof t=="undefined"?true:t;return function n(o,i){return function s(n){if(!n){return}else if(n.hasOwnProperty(e)&&n[e]!==void 0){return n[e]}else if(n.hasOwnProperty("type")&&n.type){var o;if(typeof n.type!="string"){throw new Error("Cell type must be a string ")}o=r(n.type);if(o.hasOwnProperty(e)){return o[e]}else if(t){return}}return s(a(n))}(typeof o=="number"?this.getCellMeta(o,i):o)};function r(e){var t=i.cellTypes[e];if(typeof t=="undefined"){throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. '+"Cell type must be an object or a string mapped to an object in Handsontable.cellTypes")}return t}}},{browser:24,object:53}],46:[function(e,t,r){"use strict";Object.defineProperties(r,{getNormalizedDate:{get:function o(){return n}},__esModule:{value:true}});function n(e){var t=new Date(e);if(!isNaN(new Date(e+"T00:00").getDate())){return new Date(t.getTime()+t.getTimezoneOffset()*6e4)}return t}},{}],47:[function(e,t,r){"use strict";Object.defineProperties(r,{getParent:{get:function fe(){return d}},closest:{get:function ce(){return f}},closestDown:{get:function he(){return c}},isChildOf:{get:function me(){return h}},isChildOfWebComponentTable:{get:function pe(){return m}},polymerWrap:{get:function ve(){return p}},polymerUnwrap:{get:function ge(){return v}},index:{get:function we(){return g}},overlayContainsElement:{get:function be(){return w}},hasClass:{get:function ye(){return S}},addClass:{get:function Ce(){return O}},removeClass:{get:function _e(){return T}},removeTextNodes:{get:function Ee(){return A}},empty:{get:function Re(){return N}},HTML_CHARACTERS:{get:function Me(){return D}},fastInnerHTML:{
get:function Se(){return k}},fastInnerText:{get:function Oe(){return I}},isVisible:{get:function Te(){return P}},offset:{get:function Ae(){return L}},getWindowScrollTop:{get:function Ne(){return H}},getWindowScrollLeft:{get:function De(){return V}},getScrollTop:{get:function ke(){return F}},getScrollLeft:{get:function xe(){return B}},getScrollableElement:{get:function Ie(){return j}},getTrimmingContainer:{get:function Pe(){return W}},getStyle:{get:function Le(){return $}},getComputedStyle:{get:function He(){return U}},outerWidth:{get:function Ve(){return G}},outerHeight:{get:function Fe(){return Y}},innerHeight:{get:function Be(){return z}},innerWidth:{get:function je(){return K}},addEvent:{get:function We(){return q}},removeEvent:{get:function $e(){return X}},getCaretPosition:{get:function Ue(){return J}},getSelectionEndPosition:{get:function Ge(){return Z}},getSelectionText:{get:function Ye(){return Q}},setCaretPosition:{get:function ze(){return ee}},getScrollbarWidth:{get:function Ke(){return ne}},hasVerticalScrollbar:{get:function qe(){return oe}},hasHorizontalScrollbar:{get:function Xe(){return ie}},setOverlayPosition:{get:function Je(){return ae}},getCssTransform:{get:function Ze(){return se}},resetCssTransform:{get:function Qe(){return le}},isInput:{get:function et(){return ue}},isOutsideInput:{get:function tt(){return de}},__esModule:{value:true}});var n,o;var i=(n=e("../browser"),n&&n.__esModule&&n||{"default":n}),a=i.isIE8,s=i.isIE9,l=i.isSafari;var u=(o=e("../feature"),o&&o.__esModule&&o||{"default":o}).hasCaptionProblem;function d(e){var t=arguments[1]!==void 0?arguments[1]:0;var r=-1;var n=null;while(e!=null){if(r===t){n=e;break}if(e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){e=e.host}else{r++;e=e.parentNode}}return n}function f(e,t,r){while(e!=null&&e!==r){if(e.nodeType===Node.ELEMENT_NODE&&(t.indexOf(e.nodeName)>-1||t.indexOf(e)>-1)){return e}if(e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){e=e.host}else{e=e.parentNode}}return null}function c(e,t,r){var n=[];while(e){e=f(e,t,r);if(!e||r&&!r.contains(e)){break}n.push(e);if(e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){e=e.host}else{e=e.parentNode}}var o=n.length;return o?n[o-1]:null}function h(e,t){var r=e.parentNode;var n=[];if(typeof t==="string"){n=Array.prototype.slice.call(document.querySelectorAll(t),0)}else{n.push(t)}while(r!=null){if(n.indexOf(r)>-1){return true}r=r.parentNode}return false}function m(e){var t="hot-table",r=false,n;n=p(e);function o(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===t.toUpperCase()}while(n!=null){if(o(n)){r=true;break}else if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){r=o(n.host);if(r){break}n=n.host}n=n.parentNode}return r}function p(e){return typeof Polymer!=="undefined"&&typeof wrap==="function"?wrap(e):e}function v(e){return typeof Polymer!=="undefined"&&typeof unwrap==="function"?unwrap(e):e}function g(e){var t=0;if(e.previousSibling){while(e=e.previousSibling){++t}}return t}function w(e,t){var r=document.querySelector(".ht_clone_"+e);return r?r.contains(t):null}var b=document.documentElement.classList?true:false;var y,C,_;function E(e){var t=0,r=[];if(!e||!e.length){return r}while(e[t]){r.push(e[t]);t++}return r}if(b){var R=function(){var e=document.createElement("div");e.classList.add("test","test2");return e.classList.contains("test2")}();y=function rt(e,t){if(t===""){return false}return e.classList.contains(t)};C=function nt(e,t){var r=0;if(typeof t==="string"){t=t.split(" ")}t=E(t);if(R){e.classList.add.apply(e.classList,t)}else{while(t&&t[r]){e.classList.add(t[r]);r++}}};_=function ot(e,t){var r=0;if(typeof t==="string"){t=t.split(" ")}t=E(t);if(R){e.classList.remove.apply(e.classList,t)}else{while(t&&t[r]){e.classList.remove(t[r]);r++}}}}else{var M=function it(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")};y=function at(e,t){return e.className.match(M(t))?true:false};C=function st(e,t){var r=0,n=e.className;if(typeof t==="string"){t=t.split(" ")}if(n===""){n=t.join(" ")}else{while(t&&t[r]){if(!M(t[r]).test(n)){n+=" "+t[r]}r++}}e.className=n};_=function lt(e,t){var r=0,n=e.className;if(typeof t==="string"){t=t.split(" ")}while(t&&t[r]){n=n.replace(M(t[r])," ").trim();r++}if(e.className!==n){e.className=n}}}function S(e,t){return y(e,t)}function O(e,t){return C(e,t)}function T(e,t){return _(e,t)}function A(e,t){if(e.nodeType===3){t.removeChild(e)}else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){var r=e.childNodes;for(var n=r.length-1;n>=0;n--){A(r[n],e)}}}function N(e){var t;while(t=e.lastChild){e.removeChild(t)}}var D=/(<(.*)>|&(.*);)/;function k(e,t){if(D.test(t)){e.innerHTML=t}else{I(e,t)}}var x=document.createTextNode("test").textContent?true:false;function I(e,t){var r=e.firstChild;if(r&&r.nodeType===3&&r.nextSibling===null){if(x){r.textContent=t}else{r.data=t}}else{N(e);e.appendChild(document.createTextNode(t))}}function P(e){var t=e;while(v(t)!==document.documentElement){if(t===null){return false}else if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl){return P(t.host.impl)}else if(t.host){return P(t.host)}else{throw new Error("Lost in Web Components world")}}else{return false}}else if(t.style.display==="none"){return false}t=t.parentNode}return true}function L(e){var t,r,n,o,i;o=document.documentElement;if(u()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){i=e.getBoundingClientRect();return{top:i.top+(window.pageYOffset||o.scrollTop)-(o.clientTop||0),left:i.left+(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0)}}t=e.offsetLeft;r=e.offsetTop;n=e;while(e=e.offsetParent){if(e===document.body){break}t+=e.offsetLeft;r+=e.offsetTop;n=e}if(n&&n.style.position==="fixed"){t+=window.pageXOffset||o.scrollLeft;r+=window.pageYOffset||o.scrollTop}return{left:t,top:r}}function H(){var e=window.scrollY;if(e===void 0){e=document.documentElement.scrollTop}return e}function V(){var e=window.scrollX;if(e===void 0){e=document.documentElement.scrollLeft}return e}function F(e){if(e===window){return H()}else{return e.scrollTop}}function B(e){if(e===window){return V()}else{return e.scrollLeft}}function j(e){var t=e.parentNode,r=["auto","scroll"],n,o,i,a="",s="",l="",u="";while(t&&t.style&&document.body!==t){n=t.style.overflow;o=t.style.overflowX;i=t.style.overflowY;if(n=="scroll"||o=="scroll"||i=="scroll"){return t}else if(window.getComputedStyle){a=window.getComputedStyle(t);s=a.getPropertyValue("overflow");l=a.getPropertyValue("overflow-y");u=a.getPropertyValue("overflow-x");if(s==="scroll"||u==="scroll"||l==="scroll"){return t}}if(t.clientHeight<=t.scrollHeight&&(r.indexOf(i)!==-1||r.indexOf(n)!==-1||r.indexOf(s)!==-1||r.indexOf(l)!==-1)){return t}if(t.clientWidth<=t.scrollWidth&&(r.indexOf(o)!==-1||r.indexOf(n)!==-1||r.indexOf(s)!==-1||r.indexOf(u)!==-1)){return t}t=t.parentNode}return window}function W(e){var t=e.parentNode;while(t&&t.style&&document.body!==t){if(t.style.overflow!=="visible"&&t.style.overflow!==""){return t}else if(window.getComputedStyle){var r=window.getComputedStyle(t);if(r.getPropertyValue("overflow")!=="visible"&&r.getPropertyValue("overflow")!==""){return t}}t=t.parentNode}return window}function $(e,t){if(!e){return}else if(e===window){if(t==="width"){return window.innerWidth+"px"}else if(t==="height"){return window.innerHeight+"px"}return}var r=e.style[t],n;if(r!==""&&r!==void 0){return r}else{n=U(e);if(n[t]!==""&&n[t]!==void 0){return n[t]}return void 0}}function U(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function G(e){return e.offsetWidth}function Y(e){if(u()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){return e.offsetHeight+e.firstChild.offsetHeight}else{return e.offsetHeight}}function z(e){return e.clientHeight||e.innerHeight}function K(e){return e.clientWidth||e.innerWidth}function q(e,t,r){if(window.addEventListener){e.addEventListener(t,r,false)}else{e.attachEvent("on"+t,r)}}function X(e,t,r){if(window.removeEventListener){e.removeEventListener(t,r,false)}else{e.detachEvent("on"+t,r)}}function J(e){if(e.selectionStart){return e.selectionStart}else if(document.selection){e.focus();var t=document.selection.createRange();if(t==null){return 0}var r=e.createTextRange();var n=r.duplicate();r.moveToBookmark(t.getBookmark());n.setEndPoint("EndToStart",r);return n.text.length}return 0}function Z(e){if(e.selectionEnd){return e.selectionEnd}else if(document.selection){var t=document.selection.createRange();if(t==null){return 0}var r=e.createTextRange();return r.text.indexOf(t.text)+t.text.length}}function Q(){var e="";if(window.getSelection){e=window.getSelection().toString()}else if(document.selection&&document.selection.type!=="Control"){e=document.selection.createRange().text}return e}function ee(e,t,r){if(r===void 0){r=t}if(e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch(n){var o=e.parentNode;var i=o.style.display;o.style.display="block";e.setSelectionRange(t,r);o.style.display=i}}else if(e.createTextRange){var a=e.createTextRange();a.collapse(true);a.moveEnd("character",r);a.moveStart("character",t);a.select()}}var te;function re(){var e=document.createElement("div");e.style.height="200px";e.style.width="100%";var t=document.createElement("div");t.style.boxSizing="content-box";t.style.height="150px";t.style.left="0px";t.style.overflow="hidden";t.style.position="absolute";t.style.top="0px";t.style.width="200px";t.style.visibility="hidden";t.appendChild(e);(document.body||document.documentElement).appendChild(t);var r=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;if(r==n){n=t.clientWidth}(document.body||document.documentElement).removeChild(t);return r-n}function ne(){if(te===void 0){te=re()}return te}function oe(e){return e.offsetWidth!==e.clientWidth}function ie(e){return e.offsetHeight!==e.clientHeight}function ae(e,t,r){if(a()||s()){e.style.top=r;e.style.left=t}else if(l()){e.style["-webkit-transform"]="translate3d("+t+","+r+",0)"}else{e.style.transform="translate3d("+t+","+r+",0)"}}function se(e){var t;if(e.style.transform&&(t=e.style.transform)!==""){return["transform",t]}else if(e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""){return["-webkit-transform",t]}return-1}function le(e){if(e.style.transform&&e.style.transform!==""){e.style.transform=""}else if(e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""){e.style["-webkit-transform"]=""}}function ue(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function de(e){return ue(e)&&e.className.indexOf("handsontableInput")==-1&&e.className.indexOf("copyPaste")==-1}},{"../browser":44,"../feature":49}],48:[function(e,t,r){"use strict";Object.defineProperties(r,{stopImmediatePropagation:{get:function m(){return s}},isImmediatePropagationStopped:{get:function p(){return l}},stopPropagation:{get:function v(){return u}},pageX:{get:function g(){return d}},pageY:{get:function w(){return f}},isRightClick:{get:function b(){return c}},isLeftClick:{get:function y(){return h}},__esModule:{value:true}});var n;var o=(n=e("element"),n&&n.__esModule&&n||{"default":n}),i=o.getWindowScrollTop,a=o.getWindowScrollLeft;function s(e){e.isImmediatePropagationEnabled=false;e.cancelBubble=true}function l(e){return e.isImmediatePropagationEnabled===false}function u(e){if(typeof e.stopPropagation==="function"){e.stopPropagation()}else{e.cancelBubble=true}}function d(e){if(e.pageX){return e.pageX}return e.clientX+a()}function f(e){if(e.pageY){return e.pageY}return e.clientY+i()}function c(e){return e.button===2}function h(e){return e.button===0}},{element:47}],49:[function(e,t,r){"use strict";Object.defineProperties(r,{requestAnimationFrame:{get:function g(){return l}},cancelAnimationFrame:{get:function w(){return u}},isTouchSupported:{get:function b(){return d}},isWebComponentSupportedNatively:{get:function y(){return f}},hasCaptionProblem:{get:function C(){return m}},getComparisonFunction:{get:function _(){return v}},__esModule:{value:true}});var n=0;var o=["ms","moz","webkit","o"];var i=window.requestAnimationFrame;var a=window.cancelAnimationFrame;for(var s=0;s<o.length&&!i;++s){i=window[o[s]+"RequestAnimationFrame"];a=window[o[s]+"CancelAnimationFrame"]||window[o[s]+"CancelRequestAnimationFrame"]}if(!i){i=function E(e){var t=(new Date).getTime();var r=Math.max(0,16-(t-n));var o=window.setTimeout(function(){e(t+r)},r);n=t+r;return o}}if(!a){a=function R(e){clearTimeout(e)}}function l(e){return i.call(window,e)}function u(e){a.call(window,e)}function d(){return"ontouchstart"in window}function f(){var e=document.createElement("div");return e.createShadowRoot&&e.createShadowRoot.toString().match(/\[native code\]/)?true:false}var c;function h(){var e=document.createElement("TABLE");e.style.borderSpacing=0;e.style.borderWidth=0;e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t);t.appendChild(document.createElement("TR"));t.firstChild.appendChild(document.createElement("TD"));t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c";r.style.padding=0;r.style.margin=0;e.insertBefore(r,t);document.body.appendChild(e);c=e.offsetHeight<2*e.lastChild.offsetHeight;document.body.removeChild(e)}function m(){if(c===void 0){h()}return c}var p;function v(e){var t=arguments[1]!==void 0?arguments[1]:{};if(p){return p}if((typeof Intl==="undefined"?"undefined":_typeof(Intl))==="object"){p=new Intl.Collator(e,t).compare}else if(typeof String.prototype.localeCompare==="function"){p=function r(e,t){return(e+"").localeCompare(t)}}else{p=function n(e,t){if(e===t){return 0}return e>t?-1:1}}return p}},{}],50:[function(e,t,r){"use strict";Object.defineProperties(r,{isFunction:{get:function m(){return i}},proxy:{get:function p(){return a}},throttle:{get:function v(){return s}},throttleAfterHits:{get:function g(){return l}},debounce:{get:function w(){return u}},pipe:{get:function b(){return d}},partial:{get:function y(){return f}},curry:{get:function C(){return c}},curryRight:{get:function _(){return h}},__esModule:{value:true}});var n;var o=(n=e("array"),n&&n.__esModule&&n||{"default":n}).arrayReduce;function i(e){return typeof e==="function"}function a(e,t){return function(){return e.apply(t,arguments)}}function s(e){var t=arguments[1]!==void 0?arguments[1]:200;var r=0;var n={lastCallThrottled:true};var o=null;function i(){var i=this;var a=arguments;var s=Date.now();var l=false;n.lastCallThrottled=true;if(!r){r=s;l=true}var u=t-(s-r);if(l){n.lastCallThrottled=false;e.apply(this,a)}else{if(o){clearTimeout(o)}o=setTimeout(function(){n.lastCallThrottled=false;e.apply(i,a);r=0;o=void 0},u)}return n}return i}function l(e){var t=arguments[1]!==void 0?arguments[1]:200;var r=arguments[2]!==void 0?arguments[2]:10;var n=s(e,t);var o=r;function i(){o=r}function a(){if(o){o--;return e.apply(this,arguments)}return n.apply(this,arguments)}a.clearHits=i;return a}function u(e){var t=arguments[1]!==void 0?arguments[1]:200;var r=null;var n;function o(){var o=this;var i=arguments;if(r){clearTimeout(r)}r=setTimeout(function(){n=e.apply(o,i)},t);return n}return o}function d(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=e,n=r[0],i=Array.prototype.slice.call(r,1);return function a(){return o(i,function(e,t){return t(e)},n.apply(this,arguments))}}function f(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r]}return function n(){for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return e.apply(this,t.concat(r))}}function c(e){var t=e.length;function r(n){return function o(){for(var o=[],i=0;i<arguments.length;i++){o[i]=arguments[i]}var a=n.concat(o);var s;if(a.length>=t){s=e.apply(this,a)}else{s=r(a)}return s}}return r([])}function h(e){var t=e.length;function r(n){return function o(){for(var o=[],i=0;i<arguments.length;i++){o[i]=arguments[i]}var a=n.concat(o.reverse());var s;if(a.length>=t){s=e.apply(this,a)}else{s=r(a)}return s}}return r([])}},{array:43}],51:[function(e,t,r){"use strict";Object.defineProperties(r,{stringify:{get:function s(){return n}},isDefined:{get:function l(){return o}},isUndefined:{get:function u(){return i}},isEmpty:{get:function d(){return a}},__esModule:{value:true}});function n(e){switch(typeof e==="undefined"?"undefined":_typeof(e)){case"string":case"number":return e+"";case"object":if(e===null){return""}else{return e.toString()}break;case"undefined":return"";default:return e.toString()}}function o(e){return typeof e!=="undefined"}function i(e){return typeof e==="undefined"}function a(e){return e===null||e===""||i(e)}},{}],52:[function(e,t,r){"use strict";Object.defineProperties(r,{isNumeric:{get:function s(){return n}},rangeEach:{get:function l(){return o}},rangeEachReverse:{get:function u(){return i}},valueAccordingPercent:{get:function d(){return a}},__esModule:{value:true}});function n(e){var t=typeof e==="undefined"?"undefined":_typeof(e);return t=="number"?!isNaN(e)&&isFinite(e):t=="string"?!e.length?false:e.length==1?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):t=="object"?!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date):false}function o(e,t,r){var n=-1;if(typeof t==="function"){r=t;t=e}else{n=e-1}while(++n<=t){if(r(n)===false){break}}}function i(e,t,r){var n=e+1;if(typeof t==="function"){r=t;t=0}while(--n>=t){if(r(n)===false){break}}}function a(e,t){t=parseInt(t.toString().replace("%",""),10);t=parseInt(e*t/100);return t}},{}],53:[function(e,t,r){"use strict";Object.defineProperties(r,{duckSchema:{get:function y(){return i}},inherit:{get:function C(){return a}},extend:{get:function _(){return s}},deepExtend:{get:function E(){return l}},deepClone:{get:function R(){return u}},clone:{get:function M(){return d}},mixin:{get:function S(){return f}},isObjectEquals:{get:function O(){return c}},isObject:{get:function T(){return h}},getPrototypeOf:{get:function A(){return m}},defineGetter:{get:function N(){return p}},objectEach:{get:function D(){return v}},getProperty:{get:function k(){return g}},deepObjectSize:{get:function x(){return w}},createObjectPropListener:{get:function I(){return b}},__esModule:{value:true}});var n;var o=(n=e("array"),n&&n.__esModule&&n||{"default":n}).arrayEach;function i(e){var t;if(Array.isArray(e)){t=[]}else{t={};v(e,function(e,r){if(r==="__children"){return}if(e&&(typeof e==="undefined"?"undefined":_typeof(e))==="object"&&!Array.isArray(e)){t[r]=i(e)}else if(Array.isArray(e)){if(e.length&&_typeof(e[0])==="object"&&!Array.isArray(e[0])){t[r]=[i(e[0])]}else{t[r]=[]}}else{t[r]=null}})}return t}function a(e,t){t.prototype.constructor=t;e.prototype=new t;e.prototype.constructor=e;return e}function s(e,t){v(t,function(t,r){e[r]=t});return e}function l(e,t){v(t,function(r,n){if(t[n]&&_typeof(t[n])==="object"){if(!e[n]){if(Array.isArray(t[n])){e[n]=[]}else if(Object.prototype.toString.call(t[n])==="[object Date]"){e[n]=t[n]}else{e[n]={}}}l(e[n],t[n])}else{e[n]=t[n]}})}function u(e){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){return JSON.parse(JSON.stringify(e))}return e}function d(e){var t={};v(e,function(e,r){t[r]=e});return t}function f(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r]}if(!e.MIXINS){e.MIXINS=[]}o(t,function(t){e.MIXINS.push(t.MIXIN_NAME);v(t,function(t,r){if(e.prototype[r]!==void 0){throw new Error("Mixin conflict. Property '"+r+"' already exist and cannot be overwritten.")}if(typeof t==="function"){e.prototype[r]=t}else{var n=function i(e,t){e="_"+e;var r=function n(e){if(Array.isArray(e)||h(e)){e=u(e)}return e};return function(){if(this[e]===void 0){this[e]=r(t)}return this[e]}};var o=function a(e){e="_"+e;return function(t){this[e]=t}};Object.defineProperty(e.prototype,r,{get:n(r,t),set:o(r),configurable:true})}})});return e}function c(e,t){return JSON.stringify(e)===JSON.stringify(t)}function h(e){return Object.prototype.toString.call(e)=="[object Object]"}function m(e){var t;if(_typeof(e.__proto__)=="object"){t=e.__proto__}else{var r,n=e.constructor;if(typeof e.constructor=="function"){r=n;if(delete e.constructor){n=e.constructor;e.constructor=r}}t=n?n.prototype:null}return t}function p(e,t,r,n){n.value=r;n.writable=n.writable!==false;n.enumerable=n.enumerable!==false;n.configurable=n.configurable!==false;Object.defineProperty(e,t,n)}function v(e,t){for(var r in e){if(!e.hasOwnProperty||e.hasOwnProperty&&e.hasOwnProperty(r)){if(t(e[r],r,e)===false){break}}}return e}function g(e,t){var r=t.split(".");var n=e;v(r,function(e){n=n[e];if(n===void 0){n=void 0;return false}});return n}function w(e){if(!h(e)){return 0}var t=function r(e){var t=0;if(h(e)){v(e,function(e){t+=r(e)})}else{t++}return t};return t(e)}function b(e){var t=arguments[1]!==void 0?arguments[1]:"value";var r;var n="_"+t;var o=(r={},Object.defineProperty(r,"_touched",{value:false,configurable:true,enumerable:true,writable:true}),Object.defineProperty(r,n,{value:e,configurable:true,enumerable:true,writable:true}),Object.defineProperty(r,"isTouched",{value:function i(){return this._touched},configurable:true,enumerable:true,writable:true}),r);Object.defineProperty(o,t,{get:function a(){return this[n]},set:function s(e){this._touched=true;this[n]=e},enumerable:true,configurable:true});return o}},{array:43}],54:[function(e,t,r){"use strict";Object.defineProperties(r,{columnFactory:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("object"),n&&n.__esModule&&n||{"default":n}).inherit;function i(e,t){function r(){}o(r,e);for(var n=0,i=t.length;n<i;n++){r.prototype[t[n]]=void 0}return r}},{object:53}],55:[function(e,t,r){"use strict";Object.defineProperties(r,{toUpperCaseFirst:{get:function g(){return s}},startsWith:{get:function w(){return l}},endsWith:{get:function b(){return u}},equalsIgnoreCase:{get:function y(){return d}},randomString:{get:function C(){return f}},isPercentValue:{get:function _(){return c}},substitute:{get:function E(){return h}},padStart:{get:function R(){return m}},stripTags:{get:function M(){return v}},__esModule:{value:true}});var n,o;var i=(n=e("mixed"),n&&n.__esModule&&n||{"default":n}).stringify;var a=(o=e("number"),o&&o.__esModule&&o||{"default":o}).rangeEach;function s(e){return e[0].toUpperCase()+e.substr(1)}function l(e,t){var r=true;a(t.length-1,function(n){if(e.charAt(n)!==t.charAt(n)){r=false;return false}});return r}function u(e,t){var r=true;var n=t.length-1;var o=e.length-1;a(n,function(i){var a=o-i;var s=n-i;if(e.charAt(a)!==t.charAt(s)){r=false;return false}});return r}function d(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=[];var n=e.length;while(n--){var o=i(e[n]).toLowerCase();if(r.indexOf(o)===-1){r.push(o)}}return r.length===1}function f(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function c(e){return/^([0-9][0-9]?\%$)|(^100\%$)/.test(e)}function h(e){var t=arguments[1]!==void 0?arguments[1]:{};return(e+"").replace(/(?:\\)?\[([^\[\]]+)]/g,function(e,r){if(e.charAt(0)==="\\"){return e.substr(1,e.length-1)}return t[r]===void 0?"":t[r]})}function m(e,t){var r=arguments[2]!==void 0?arguments[2]:" ";e=e+"";if(e.length>=t){return e}r=String(r);var n=r.length;if(!n){r=" "}var o=t-e.length;var i=Math.ceil(o/r.length);var s="";a(i,function(e){s+=r});s=s.slice(0,o);return s+e}var p=/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi;function v(e){e=e+"";return e.replace(p,"")}},{mixed:51,number:52}],56:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY_CODES:{get:function d(){return i}},isPrintableChar:{get:function f(){return a}},isMetaKey:{get:function c(){return s}},isCtrlKey:{get:function h(){return l}},isKey:{get:function m(){return u}},__esModule:{value:true}});var n;var o=(n=e("array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var i={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};function a(e){return e==32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function s(e){var t=[i.ARROW_DOWN,i.ARROW_UP,i.ARROW_LEFT,i.ARROW_RIGHT,i.HOME,i.END,i.DELETE,i.BACKSPACE,i.F1,i.F2,i.F3,i.F4,i.F5,i.F6,i.F7,i.F8,i.F9,i.F10,i.F11,i.F12,i.TAB,i.PAGE_DOWN,i.PAGE_UP,i.ENTER,i.ESCAPE,i.SHIFT,i.CAPS_LOCK,i.ALT];return t.indexOf(e)!==-1}function l(e){return[i.CONTROL_LEFT,224,i.COMMAND_LEFT,i.COMMAND_RIGHT].indexOf(e)!==-1}function u(e,t){var r=t.split("|");var n=false;o(r,function(t){if(e===i[t]){n=true;return false}});return n}},{array:43}],57:[function(e,t,r){"use strict";Object.defineProperties(r,{arrayMapper:{get:function g(){return v}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}),u=l.arrayEach,d=l.arrayReduce,f=l.arrayMap,c=l.arrayMax;var h=(i=e("helpers/object"),i&&i.__esModule&&i||{"default":i}).defineGetter;var m=(a=e("helpers/number"),a&&a.__esModule&&a||{"default":a}).rangeEach;var p="arrayMapper";var v={_arrayMap:[],getValueByIndex:function w(e){var t;return(t=this._arrayMap[e])===void 0?null:t},getIndexByValue:function b(e){var t;return(t=this._arrayMap.indexOf(e))===-1?null:t},insertItems:function y(e){var t=arguments[1]!==void 0?arguments[1]:1;var r=this;var n=c(this._arrayMap)+1;var o=[];m(t-1,function(t){o.push(r._arrayMap.splice(e+t,0,n+t))});return o},removeItems:function C(e){var t=arguments[1]!==void 0?arguments[1]:1;var r=this;var n=[];if(Array.isArray(e)){var o=[].concat(this._arrayMap);e.sort(function(e,t){return t-e});n=d(e,function(e,t){r._arrayMap.splice(t,1);return e.concat(o.slice(t,t+1))},[])}else{n=this._arrayMap.splice(e,t)}return n},unshiftItems:function _(e){var t=arguments[1]!==void 0?arguments[1]:1;var r=this.removeItems(e,t);function n(e){return d(r,function(t,r){if(e>r){t++}return t},0)}this._arrayMap=f(this._arrayMap,function(e,t){var r=n(e);if(r){e-=r}return e})},shiftItems:function E(e){var t=arguments[1]!==void 0?arguments[1]:1;var r=this;this._arrayMap=f(this._arrayMap,function(r){if(r>=e){r+=t}return r});m(t-1,function(t){r._arrayMap.splice(e+t,0,e+t)})},clearMap:function R(){this._arrayMap.length=0}};h(v,"MIXIN_NAME",p,{writable:false,enumerable:false});s.utils.arrayMapper=v},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53}],58:[function(e,t,r){"use strict";Object.defineProperties(r,{localHooks:{get:function f(){return d}},__esModule:{value:true}});var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var l=(i=e("helpers/object"),i&&i.__esModule&&i||{"default":i}).defineGetter;var u="localHooks";var d={_localHooks:Object.create(null),addLocalHook:function c(e,t){if(!this._localHooks[e]){this._localHooks[e]=[]}this._localHooks[e].push(t)},runLocalHooks:function h(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r]}var n=this;if(this._localHooks[e]){s(this._localHooks[e],function(e){return e.apply(n,t)})}},clearLocalHooks:function m(){this._localHooks={}}};l(d,"MIXIN_NAME",u,{writable:false,enumerable:false});a.utils.localHooks=d},{browser:24,"helpers/array":43,"helpers/object":53}],59:[function(e,t,r){"use strict";var n;Object.defineProperties(r,{stateSaver:{get:function v(){return p}},__esModule:{value:true}});var o,i,a;var s=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var l=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var u=(a=e("helpers/object"),a&&a.__esModule&&a||{"default":a}).defineGetter;var d="stateSaver";var f="state_";var c="_states";var h=function g(e,t){return e[c][f+t]};var m=function w(e,t,r){e[c][f+t]=r};var p=(n={},Object.defineProperty(n,c,{value:{},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"getCachedState",{value:function b(e){return h(this,e)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"setCachedState",{value:function y(e,t){m(this,e,t)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"saveState",{value:function C(e){m(this,e,this.getState())},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"restoreState",{value:function _(e){this.setState(h(this,e))},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"hasSavedState",{value:function E(e){return h(this,e)!==void 0},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"clearState",{value:function R(e){m(this,e)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"clearStates",{value:function M(){this[c]={}},configurable:true,enumerable:true,writable:true}),n);u(p,"MIXIN_NAME",d,{writable:false,enumerable:false});s.utils.stateSaver=p},{browser:24,"helpers/array":43,"helpers/object":53}],60:[function(e,t,r){"use strict";Object.defineProperties(r,{MultiMap:{get:function o(){return n}},__esModule:{value:true}});window.MultiMap=n;function n(){var e={arrayMap:[],weakMap:new WeakMap};return{get:function o(n){if(t(n)){return e.arrayMap[n]}else if(r(n)){return e.weakMap.get(n)}},set:function i(n,o){if(t(n)){e.arrayMap[n]=o}else if(r(n)){e.weakMap.set(n,o)}else{throw new Error("Invalid key type")}},"delete":function a(n){if(t(n)){delete e.arrayMap[n]}else if(r(n)){e.weakMap.delete(n)}}};function t(e){return e!==null&&!n(e)&&(typeof e=="string"||typeof e=="number")}function r(e){return e!==null&&((typeof e==="undefined"?"undefined":_typeof(e))=="object"||typeof e=="function")}function n(e){return e!==e}}},{}],61:[function(e,t,r){"use strict";Object.defineProperties(r,{Hooks:{get:function u(){return l}},__esModule:{value:true}});var n,o;var i=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","beforeValueRender","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing"];
var a=(n=e("helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var s=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}).objectEach;var l=function d(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(l,{createEmptyBucket:function f(){var e=Object.create(null);a(i,function(t){return e[t]=[]});return e},getBucket:function c(){var e=arguments[0]!==void 0?arguments[0]:null;if(e){if(!e.pluginHookBucket){e.pluginHookBucket=this.createEmptyBucket()}return e.pluginHookBucket}return this.globalBucket},add:function h(e,t){var r=arguments[2]!==void 0?arguments[2]:null;var n=this;if(Array.isArray(t)){a(t,function(t){return n.add(e,t,r)})}else{var o=this.getBucket(r);if(typeof o[e]==="undefined"){this.register(e);o[e]=[]}t.skip=false;if(o[e].indexOf(t)===-1){var i=false;if(t.initialHook){a(o[e],function(r,n){if(r.initialHook){o[e][n]=t;i=true;return false}})}if(!i){o[e].push(t)}}}return this},once:function m(e,t){var r=arguments[2]!==void 0?arguments[2]:null;var n=this;if(Array.isArray(t)){a(t,function(t){return n.once(e,t,r)})}else{t.runOnce=true;this.add(e,t,r)}},remove:function p(e,t){var r=arguments[2]!==void 0?arguments[2]:null;var n=this.getBucket(r);if(typeof n[e]!=="undefined"){if(n[e].indexOf(t)>=0){t.skip=true;return true}}return false},has:function v(e){var t=arguments[1]!==void 0?arguments[1]:null;var r=this.getBucket(t);return r[e]!==void 0&&r[e].length?true:false},run:function g(e,t,r,n,o,i,a,s){{var l=this.globalBucket[t];var u=-1;var d=l?l.length:0;if(d){while(++u<d){if(!l[u]||l[u].skip){continue}var f=l[u].call(e,r,n,o,i,a,s);if(f!==void 0){r=f}if(l[u]&&l[u].runOnce){this.remove(t,l[u])}}}}{var c=this.getBucket(e)[t];var h=-1;var m=c?c.length:0;if(m){while(++h<m){if(!c[h]||c[h].skip){continue}var p=c[h].call(e,r,n,o,i,a,s);if(p!==void 0){r=p}if(c[h]&&c[h].runOnce){this.remove(t,c[h],e)}}}}return r},destroy:function w(){var e=arguments[0]!==void 0?arguments[0]:null;s(this.getBucket(e),function(e,t,r){return r[t].length=0})},register:function b(e){if(!this.isRegistered(e)){i.push(e)}},deregister:function y(e){if(this.isRegistered(e)){i.splice(i.indexOf(e),1)}},isRegistered:function C(e){return i.indexOf(e)>=0},getRegistered:function _(){return i}},{})},{"helpers/array":43,"helpers/object":53}],62:[function(e,t,r){"use strict";Object.defineProperties(r,{registerPlugin:{get:function m(){return d}},getPlugin:{get:function p(){return f}},getRegistredPluginNames:{get:function v(){return c}},getPluginName:{get:function g(){return h}},__esModule:{value:true}});var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}).objectEach;var l=(i=e("helpers/string"),i&&i.__esModule&&i||{"default":i}).toUpperCaseFirst;var u=new WeakMap;function d(e,t){e=l(e);a.plugins[e]=t;a.hooks.add("construct",function(){var r;if(!u.has(this)){u.set(this,{})}r=u.get(this);if(!r[e]){r[e]=new t(this)}});a.hooks.add("afterDestroy",function(){if(u.has(this)){var e=u.get(this);s(e,function(e){return e.destroy()});u.delete(this)}})}function f(e,t){if(typeof t!="string"){throw Error('Only strings can be passed as "plugin" parameter')}var r=l(t);if(!u.has(e)||!u.get(e)[r]){return void 0}return u.get(e)[r]}function c(e){return u.has(e)?Object.keys(u.get(e)):[]}function h(e,t){var r=null;if(u.has(e)){s(u.get(e),function(e,n){if(e===t){r=n}})}return r}},{browser:24,"helpers/object":53,"helpers/string":55}],63:[function(e,t,r){"use strict";Object.defineProperties(r,{"default":{get:function E(){return _}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}),d=u.defineGetter,f=u.objectEach;var c=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var h=(a=e("utils/recordTranslator"),a&&a.__esModule&&a||{"default":a}),m=h.registerIdentity,p=h.getTranslator;var v=(s=e("plugins"),s&&s.__esModule&&s||{"default":s}),g=v.getRegistredPluginNames,w=v.getPluginName;var b=new WeakMap;var y=null;var C=function R(e){var t=this;d(this,"hot",e,{writable:false});d(this,"t",p(e),{writable:false});b.set(this,{hooks:{}});y=null;this.pluginName=null;this.pluginsInitializedCallbacks=[];this.isPluginsReady=false;this.enabled=false;this.initialized=false;this.hot.addHook("afterPluginsInitialized",function(){return t.onAfterPluginsInitialized()});this.hot.addHook("afterUpdateSettings",function(){return t.onUpdateSettings()});this.hot.addHook("beforeInit",function(){return t.init()})};$traceurRuntime.createClass(C,{init:function M(){this.pluginName=w(this.hot,this);if(this.isEnabled&&this.isEnabled()){this.enablePlugin()}if(!y){y=g(this.hot)}if(y.indexOf(this.pluginName)>=0){y.splice(y.indexOf(this.pluginName),1)}if(!y.length){this.hot.runHooks("afterPluginsInitialized")}this.initialized=true},enablePlugin:function S(){this.enabled=true},disablePlugin:function O(){if(this.eventManager){this.eventManager.clear()}this.clearHooks();this.enabled=false},addHook:function T(e,t){var r=b.get(this).hooks[e]=b.get(this).hooks[e]||[];this.hot.addHook(e,t);r.push(t);b.get(this).hooks[e]=r},removeHooks:function A(e){var t=this;c(b.get(this).hooks[e]||[],function(r){t.hot.removeHook(e,r)})},clearHooks:function N(){var e=this;var t=b.get(this).hooks;f(t,function(t,r){return e.removeHooks(r)});t.length=0},callOnPluginsReady:function D(e){if(this.isPluginsReady){e()}else{this.pluginsInitializedCallbacks.push(e)}},onAfterPluginsInitialized:function k(){c(this.pluginsInitializedCallbacks,function(e){return e()});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=true},onUpdateSettings:function x(){if(this.isEnabled){if(this.enabled&&!this.isEnabled()){this.disablePlugin()}if(!this.enabled&&this.isEnabled()){this.enablePlugin()}if(this.enabled&&this.isEnabled()){this.updatePlugin()}}},updatePlugin:function I(){},destroy:function P(){var e=this;if(this.eventManager){this.eventManager.destroy()}this.clearHooks();f(this,function(t,r){if(r!=="hot"&&r!=="t"){e[r]=null}});delete this.t;delete this.hot}},{});var _=C;l.plugins.BasePlugin=C},{browser:24,"helpers/array":43,"helpers/object":53,plugins:62,"utils/recordTranslator":132}],64:[function(e,t,r){"use strict";Object.defineProperties(r,{AutoColumnSize:{get:function V(){return L}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h;var m=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).default;var p=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}),v=p.arrayEach,g=p.arrayFilter,w=p.arrayReduce,b=p.arrayMap;var y=(i=e("helpers/feature"),i&&i.__esModule&&i||{"default":i}),C=y.cancelAnimationFrame,_=y.requestAnimationFrame;var E=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}).isVisible;var R=(s=e("utils/ghostTable"),s&&s.__esModule&&s||{"default":s}).GhostTable;var M=(l=e("helpers/object"),l&&l.__esModule&&l||{"default":l}),S=M.isObject,O=M.objectEach;var T=(u=e("helpers/number"),u&&u.__esModule&&u||{"default":u}),A=T.valueAccordingPercent,N=T.rangeEach;var D=(d=e("plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var k=(f=e("utils/samplesGenerator"),f&&f.__esModule&&f||{"default":f}).SamplesGenerator;var x=(c=e("helpers/string"),c&&c.__esModule&&c||{"default":c}).isPercentValue;var I=(h=e("3rdparty/walkontable/src/calculator/viewportColumns"),h&&h.__esModule&&h||{"default":h}).WalkontableViewportColumnsCalculator;var P=new WeakMap;var L=function F(e){var t=this;$traceurRuntime.superConstructor(H).call(this,e);P.set(this,{cachedColumnHeaders:[]});this.widths=[];this.ghostTable=new R(this.hot);this.samplesGenerator=new k(function(e,r){return t.hot.getDataAtCell(e,r)});this.firstCalculation=true;this.inProgress=false;this.addHook("beforeColumnResize",function(e,r,n){return t.onBeforeColumnResize(e,r,n)})};var H=L;$traceurRuntime.createClass(L,{isEnabled:function B(){return this.hot.getSettings().autoColumnSize!==false&&!this.hot.getSettings().colWidths},enablePlugin:function j(){var e=this;if(this.enabled){return}var t=this.hot.getSettings().autoColumnSize;if(t&&t.useHeaders!=null){this.ghostTable.setSetting("useHeaders",t.useHeaders)}this.addHook("afterLoadData",function(){return e.onAfterLoadData()});this.addHook("beforeChange",function(t){return e.onBeforeChange(t)});this.addHook("beforeRender",function(t){return e.onBeforeRender(t)});this.addHook("modifyColWidth",function(t,r){return e.getColumnWidth(r,t)});this.addHook("afterInit",function(){return e.onAfterInit()});$traceurRuntime.superGet(this,H.prototype,"enablePlugin").call(this)},updatePlugin:function W(){var e=this.findColumnsWhereHeaderWasChanged();if(e.length){this.clearCache(e)}$traceurRuntime.superGet(this,H.prototype,"updatePlugin").call(this)},disablePlugin:function $(){$traceurRuntime.superGet(this,H.prototype,"disablePlugin").call(this)},calculateColumnsWidth:function U(){var e=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1};var t=arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1};var r=arguments[2]!==void 0?arguments[2]:false;var n=this;if(typeof e==="number"){e={from:e,to:e}}if(typeof t==="number"){t={from:t,to:t}}N(e.from,e.to,function(e){if(r||n.widths[e]===void 0&&!n.hot._getColWidthFromSettings(e)){var o=n.samplesGenerator.generateColumnSamples(e,t);o.forEach(function(e,t){return n.ghostTable.addColumn(t,e)})}});if(this.ghostTable.columns.length){this.ghostTable.getWidths(function(e,t){return n.widths[e]=t});this.ghostTable.clean()}},calculateAllColumnsWidth:function G(){var e=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1};var t=this;var r=0;var n=this.hot.countCols()-1;var o=null;this.inProgress=true;var i=function a(){if(!t.hot){C(o);t.inProgress=false;return}t.calculateColumnsWidth({from:r,to:Math.min(r+H.CALCULATION_STEP,n)},e);r=r+H.CALCULATION_STEP+1;if(r<n){o=_(a)}else{C(o);t.inProgress=false;t.hot.view.wt.wtOverlays.adjustElementsSize(true);if(t.hot.view.wt.wtOverlays.leftOverlay.needFullRender){t.hot.view.wt.wtOverlays.leftOverlay.clone.draw()}}};if(this.firstCalculation&&this.getSyncCalculationLimit()){this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},e);this.firstCalculation=false;r=this.getSyncCalculationLimit()+1}if(r<n){i()}else{this.inProgress=false}},setSamplingOptions:function Y(){var e=this.hot.getSettings().autoColumnSize;var t=e&&e.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0;var r=e&&e.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;if(t&&!isNaN(t)){this.samplesGenerator.setSampleCount(parseInt(t,10))}if(r){this.samplesGenerator.setAllowDuplicates(r)}},recalculateAllColumnsWidth:function z(){if(this.hot.view&&E(this.hot.view.wt.wtTable.TABLE)){this.clearCache();this.calculateAllColumnsWidth()}},getSyncCalculationLimit:function K(){var e=H.SYNC_CALCULATION_LIMIT;var t=this.hot.countCols()-1;if(S(this.hot.getSettings().autoColumnSize)){e=this.hot.getSettings().autoColumnSize.syncLimit;if(x(e)){e=A(t,e)}else{e=e>>0}}return Math.min(e,t)},getColumnWidth:function q(e){var t=arguments[1];var r=arguments[2]!==void 0?arguments[2]:true;var n=t;if(n===void 0){n=this.widths[e];if(r&&typeof n==="number"){n=Math.max(n,I.DEFAULT_WIDTH)}}return n},getFirstVisibleColumn:function X(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){return e.wtTable.getFirstVisibleColumn()}if(e.wtViewport.columnsRenderCalculator){return e.wtTable.getFirstRenderedColumn()}return-1},getLastVisibleColumn:function J(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){return e.wtTable.getLastVisibleColumn()}if(e.wtViewport.columnsRenderCalculator){return e.wtTable.getLastRenderedColumn()}return-1},findColumnsWhereHeaderWasChanged:function Z(){var e=this.hot.getColHeader();var t=P.get(this).cachedColumnHeaders;var r=w(e,function(e,r,n){var o=t.length;if(o-1<n||t[n]!==r){e.push(n)}if(o-1<n){t.push(r)}else{t[n]=r}return e},[]);return r},clearCache:function Q(){var e=arguments[0]!==void 0?arguments[0]:[];var t=this;if(e.length){v(e,function(e){return t.widths[e]=void 0})}else{this.widths.length=0}},isNeedRecalculate:function ee(){return g(this.widths,function(e){return e===void 0}).length?true:false},onBeforeRender:function te(){var e=this.hot.renderCall;var t=this.hot.countRows();if(!t){return}this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,e);if(this.isNeedRecalculate()&&!this.inProgress){this.calculateAllColumnsWidth()}},onAfterLoadData:function re(){var e=this;if(this.hot.view){this.recalculateAllColumnsWidth()}else{setTimeout(function(){if(e.hot){e.recalculateAllColumnsWidth()}},0)}},onBeforeChange:function ne(e){var t=this;var r=b(e,function(e){var r=e,n=r[0],o=r[1];return t.hot.propToCol(o)});this.clearCache(r)},onBeforeColumnResize:function oe(e,t,r){if(r){this.calculateColumnsWidth(e,void 0,true);t=this.getColumnWidth(e,void 0,false)}return t},onAfterInit:function ie(){P.get(this).cachedColumnHeaders=this.hot.getColHeader()},destroy:function ae(){this.ghostTable.clean();$traceurRuntime.superGet(this,H.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 50}},m);D("autoColumnSize",L)},{"3rdparty/walkontable/src/calculator/viewportColumns":4,_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":130,"utils/samplesGenerator":133}],65:[function(e,t,r){"use strict";Object.defineProperties(r,{AutoRowSize:{get:function x(){return D}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c;var h=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).default;var m=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}),p=m.arrayEach,v=m.arrayFilter;var g=(i=e("helpers/feature"),i&&i.__esModule&&i||{"default":i}),w=g.cancelAnimationFrame,b=g.requestAnimationFrame;var y=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}).isVisible;var C=(s=e("utils/ghostTable"),s&&s.__esModule&&s||{"default":s}).GhostTable;var _=(l=e("helpers/object"),l&&l.__esModule&&l||{"default":l}),E=_.isObject,R=_.objectEach;var M=(u=e("helpers/number"),u&&u.__esModule&&u||{"default":u}),S=M.valueAccordingPercent,O=M.rangeEach;var T=(d=e("plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var A=(f=e("utils/samplesGenerator"),f&&f.__esModule&&f||{"default":f}).SamplesGenerator;var N=(c=e("helpers/string"),c&&c.__esModule&&c||{"default":c}).isPercentValue;var D=function I(e){var t=this;$traceurRuntime.superConstructor(k).call(this,e);this.heights=[];this.ghostTable=new C(this.hot);this.samplesGenerator=new A(function(e,r){if(e>=0){return t.hot.getDataAtCell(e,r)}else if(e===-1){return t.hot.getColHeader(r)}else{return null}});this.firstCalculation=true;this.inProgress=false;this.addHook("beforeRowResize",function(e,r,n){return t.onBeforeRowResize(e,r,n)})};var k=D;$traceurRuntime.createClass(D,{isEnabled:function P(){return this.hot.getSettings().autoRowSize===true||E(this.hot.getSettings().autoRowSize)},enablePlugin:function L(){var e=this;if(this.enabled){return}this.setSamplingOptions();this.addHook("afterLoadData",function(){return e.onAfterLoadData()});this.addHook("beforeChange",function(t){return e.onBeforeChange(t)});this.addHook("beforeColumnMove",function(){return e.recalculateAllRowsHeight()});this.addHook("beforeColumnResize",function(){return e.recalculateAllRowsHeight()});this.addHook("beforeColumnSort",function(){return e.clearCache()});this.addHook("beforeRender",function(t){return e.onBeforeRender(t)});this.addHook("beforeRowMove",function(t,r){return e.onBeforeRowMove(t,r)});this.addHook("modifyRowHeight",function(t,r){return e.getRowHeight(r,t)});this.addHook("modifyColumnHeaderHeight",function(){return e.getColumnHeaderHeight()});$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this)},disablePlugin:function H(){$traceurRuntime.superGet(this,k.prototype,"disablePlugin").call(this)},calculateRowsHeight:function V(){var e=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1};var t=arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1};var r=arguments[2]!==void 0?arguments[2]:false;var n=this;if(typeof e==="number"){e={from:e,to:e}}if(typeof t==="number"){t={from:t,to:t}}if(this.hot.getColHeader(0)!==null){var o=this.samplesGenerator.generateRowSamples(-1,t);this.ghostTable.addColumnHeadersRow(o.get(-1))}O(e.from,e.to,function(e){if(r||n.heights[e]===void 0){var o=n.samplesGenerator.generateRowSamples(e,t);o.forEach(function(e,t){return n.ghostTable.addRow(t,e)})}});if(this.ghostTable.rows.length){this.ghostTable.getHeights(function(e,t){return n.heights[e]=t});this.ghostTable.clean()}},calculateAllRowsHeight:function F(){var e=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1};var t=this;var r=0;var n=this.hot.countRows()-1;var o=null;this.inProgress=true;var i=function a(){if(!t.hot){w(o);t.inProgress=false;return}t.calculateRowsHeight({from:r,to:Math.min(r+k.CALCULATION_STEP,n)},e);r=r+k.CALCULATION_STEP+1;if(r<n){o=b(a)}else{w(o);t.inProgress=false;t.hot.view.wt.wtOverlays.adjustElementsSize(true);if(t.hot.view.wt.wtOverlays.leftOverlay.needFullRender){t.hot.view.wt.wtOverlays.leftOverlay.clone.draw()}}};if(this.firstCalculation&&this.getSyncCalculationLimit()){this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},e);this.firstCalculation=false;r=this.getSyncCalculationLimit()+1}if(r<n){i()}else{this.inProgress=false;this.hot.view.wt.wtOverlays.adjustElementsSize(false)}},setSamplingOptions:function B(){var e=this.hot.getSettings().autoRowSize;var t=e&&e.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0;var r=e&&e.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;if(t&&!isNaN(t)){this.samplesGenerator.setSampleCount(parseInt(t,10))}if(r){this.samplesGenerator.setAllowDuplicates(r)}},recalculateAllRowsHeight:function j(){if(y(this.hot.view.wt.wtTable.TABLE)){this.clearCache();this.calculateAllRowsHeight()}},getSyncCalculationLimit:function W(){var e=k.SYNC_CALCULATION_LIMIT;var t=this.hot.countRows()-1;if(E(this.hot.getSettings().autoRowSize)){e=this.hot.getSettings().autoRowSize.syncLimit;if(N(e)){e=S(t,e)}else{e=e>>0}}return Math.min(e,t)},getRowHeight:function $(e){var t=arguments[1];var r=t;if(this.heights[e]!==void 0&&this.heights[e]>(t||0)){r=this.heights[e]}return r},getColumnHeaderHeight:function U(){return this.heights[-1]},getFirstVisibleRow:function G(){var e=this.hot.view.wt;if(e.wtViewport.rowsVisibleCalculator){return e.wtTable.getFirstVisibleRow()}if(e.wtViewport.rowsRenderCalculator){return e.wtTable.getFirstRenderedRow()}return-1},getLastVisibleRow:function Y(){var e=this.hot.view.wt;if(e.wtViewport.rowsVisibleCalculator){return e.wtTable.getLastVisibleRow()}if(e.wtViewport.rowsRenderCalculator){return e.wtTable.getLastRenderedRow()}return-1},clearCache:function z(){this.heights.length=0;this.heights[-1]=void 0},clearCacheByRange:function K(e){var t=this;if(typeof e==="number"){e={from:e,to:e}}O(Math.min(e.from,e.to),Math.max(e.from,e.to),function(e){return t.heights[e]=void 0})},isNeedRecalculate:function q(){return v(this.heights,function(e){return e===void 0}).length?true:false},onBeforeRender:function X(){var e=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,e);var t=this.hot.getSettings().fixedRowsBottom;if(t){var r=this.hot.countRows()-1;this.calculateRowsHeight({from:r-t,to:r})}if(this.isNeedRecalculate()&&!this.inProgress){this.calculateAllRowsHeight()}},onBeforeRowMove:function J(e,t){this.clearCacheByRange({from:e,to:t});this.calculateAllRowsHeight()},onBeforeRowResize:function Z(e,t,r){if(r){this.calculateRowsHeight(e,void 0,true);t=this.getRowHeight(e)}return t},onAfterLoadData:function Q(){var e=this;if(this.hot.view){this.recalculateAllRowsHeight()}else{setTimeout(function(){if(e.hot){e.recalculateAllRowsHeight()}},0)}},onBeforeChange:function ee(e){var t=null;if(e.length===1){t=e[0][0]}else if(e.length>1){t={from:e[0][0],to:e[e.length-1][0]}}if(t!==null){this.clearCacheByRange(t)}},destroy:function te(){this.ghostTable.clean();$traceurRuntime.superGet(this,k.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 500}},h);T("autoRowSize",D)},{_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":130,"utils/samplesGenerator":133}],66:[function(e,t,r){"use strict";Object.defineProperties(r,{Autofill:{get:function N(){return T}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var h=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayIncludes;var m=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}),p=m.offset,v=m.outerHeight,g=m.outerWidth;var w=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).eventManager;var b=(l=e("plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var y=(u=e("3rdparty/walkontable/src/cell/coords"),u&&u.__esModule&&u||{"default":u}).WalkontableCellCoords;var C=(d=e("utils"),d&&d.__esModule&&d||{"default":d}),_=C.getDeltas,E=C.getDragDirectionAndRange,R=C.DIRECTIONS,M=C.getMappedFillHandleSetting;var S="insert_row";var O=200;var T=function D(e){$traceurRuntime.superConstructor(A).call(this,e);this.eventManager=w(this);this.addingStarted=false;this.mouseDownOnCellCorner=false;this.mouseDragOutside=false;this.handleDraggedCells=0;this.directions=[];this.autoInsertRow=false};var A=T;$traceurRuntime.createClass(T,{isEnabled:function k(){return this.hot.getSettings().fillHandle},enablePlugin:function x(){var e=this;if(this.enabled){return}this.mapSettings();this.registerEvents();this.addHook("afterOnCellCornerMouseDown",function(t){return e.onAfterCellCornerMouseDown(t)});this.addHook("afterOnCellCornerDblClick",function(t){return e.onCellCornerDblClick(t)});this.addHook("beforeOnCellMouseOver",function(t,r,n){return e.onBeforeCellMouseOver(r)});$traceurRuntime.superGet(this,A.prototype,"enablePlugin").call(this)},updatePlugin:function I(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,A.prototype,"updatePlugin").call(this)},disablePlugin:function P(){this.clearMappedSettings();$traceurRuntime.superGet(this,A.prototype,"disablePlugin").call(this)},getSelectionData:function L(){var e={from:this.hot.getSelectedRange().from,to:this.hot.getSelectedRange().to};return this.hot.getData(e.from.row,e.from.col,e.to.row,e.to.col)},fillIn:function H(){if(this.hot.view.wt.selections.fill.isEmpty()){return false}var e=this.hot.view.wt.selections.fill.getCorners();this.resetSelectionOfDraggedArea();var t=this.getCornersOfSelectedCells();var r=E(t,e),n=r.directionOfDrag,o=r.startOfDragCoords,i=r.endOfDragCoords;this.hot.runHooks("modifyAutofillRange",t,e);if(o&&o.row>-1&&o.col>-1){var a=this.getSelectionData();var s=_(o,i,a,n);this.hot.runHooks("beforeAutofill",o,i,a);this.hot.populateFromArray(o.row,o.col,a,i.row,i.col,this.pluginName+".fill",null,n,s);this.setSelection(e)}else{this.hot.selection.refreshBorders()}return true},reduceSelectionAreaIfNeeded:function V(e){if(e.row<0){e.row=0}if(e.col<0){e.col=0}return e},getCoordsOfDragAndDropBorders:function F(e){var t=this.hot.getSelectedRange().getTopLeftCorner();var r=this.hot.getSelectedRange().getBottomRightCorner();var n;if(h(this.directions,R.vertical)&&(r.row<e.row||t.row>e.row)){n=new y(e.row,r.col)}else if(h(this.directions,R.horizontal)){n=new y(r.row,e.col)}else{return}return this.reduceSelectionAreaIfNeeded(n)},showBorder:function B(e){var t=this.getCoordsOfDragAndDropBorders(e);if(t){this.redrawBorders(t)}},addRow:function j(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.alter(S,void 0,1,e.pluginName+".fill");e.addingStarted=false},O))},addNewRowIfNeeded:function W(){if(this.hot.view.wt.selections.fill.cellRange&&this.addingStarted===false&&this.autoInsertRow){var e=this.hot.getSelected();var t=this.hot.view.wt.selections.fill.getCorners();var r=this.hot.countRows();if(e[2]<r-1&&t[2]===r-1){this.addingStarted=true;this.addRow()}}},getCornersOfSelectedCells:function $(){if(this.hot.selection.isMultiple()){return this.hot.view.wt.selections.area.getCorners()}else{return this.hot.view.wt.selections.current.getCorners()}},getIndexOfLastAdjacentFilledInRow:function U(e){var t=this.hot.getData();var r=this.hot.countRows();var n;for(var o=e[2]+1;o<r;o++){for(var i=e[1];i<=e[3];i++){var a=t[o][i];if(a){return-1}}var s=t[o][e[1]-1];var l=t[o][e[3]+1];if(!!s||!!l){n=o}}return n},addSelectionFromStartAreaToSpecificRowIndex:function G(e,t){this.hot.view.wt.selections.fill.clear();this.hot.view.wt.selections.fill.add(new y(e[0],e[1]));this.hot.view.wt.selections.fill.add(new y(t,e[3]))},setSelection:function Y(e){this.hot.selection.setRangeStart(new y(e[0],e[1]));this.hot.selection.setRangeEnd(new y(e[2],e[3]))},selectAdjacent:function z(){var e=this.getCornersOfSelectedCells();var t=this.getIndexOfLastAdjacentFilledInRow(e);if(t===-1){return false}else{this.addSelectionFromStartAreaToSpecificRowIndex(e,t);return true}},resetSelectionOfDraggedArea:function K(){this.handleDraggedCells=0;this.hot.view.wt.selections.fill.clear()},redrawBorders:function q(e){this.hot.view.wt.selections.fill.clear();this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().from);this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().to);this.hot.view.wt.selections.fill.add(e);this.hot.view.render()},getIfMouseWasDraggedOutside:function X(e){var t=p(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+v(this.hot.table);var r=p(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+g(this.hot.table);return e.clientY>t&&e.clientX<=r},registerEvents:function J(){var e=this;this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()});this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)})},onCellCornerDblClick:function Z(){var e=this.selectAdjacent();if(e){this.fillIn()}},onAfterCellCornerMouseDown:function Q(){this.handleDraggedCells=1;this.mouseDownOnCellCorner=true},onBeforeCellMouseOver:function ee(e){if(this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells){this.handleDraggedCells++;this.showBorder(e);this.addNewRowIfNeeded()}},onMouseUp:function te(){if(this.handleDraggedCells){if(this.handleDraggedCells>1){this.fillIn()}this.handleDraggedCells=0;this.mouseDownOnCellCorner=false}},onMouseMove:function re(e){var t=this.getIfMouseWasDraggedOutside(e);if(this.addingStarted===false&&this.handleDraggedCells>0&&t){this.mouseDragOutside=true;this.addingStarted=true}else{this.mouseDragOutside=false}if(this.mouseDragOutside&&this.autoInsertRow){this.addRow()}},clearMappedSettings:function ne(){this.directions.length=0;this.autoInsertRow=false},mapSettings:function oe(){var e=M(this.hot.getSettings().fillHandle);this.directions=e.directions;this.autoInsertRow=e.autoInsertRow},destroy:function ie(){$traceurRuntime.superGet(this,A.prototype,"destroy").call(this)}},{},f);b("autofill",T);c.hooks.register("modifyAutofillRange");c.hooks.register("beforeAutofill")},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,utils:67}],67:[function(e,t,r){"use strict";Object.defineProperties(r,{DIRECTIONS:{get:function f(){return s}},getDeltas:{get:function c(){return l}},getDragDirectionAndRange:{get:function h(){return u}},getMappedFillHandleSetting:{get:function m(){return d}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/object"),n&&n.__esModule&&n||{"default":n}).isObject;var a=(o=e("helpers/mixed"),o&&o.__esModule&&o||{"default":o}).isDefined;var s={horizontal:"horizontal",vertical:"vertical"};function l(e,t,r,n){var o=r.length;var i=r?r[0].length:0;var a=[];var s=t.row-e.row;var l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){var u=[];for(var d=0;d<=l;d++){var f=parseInt(r[0][d],10);var c=parseInt(r[o-1][d],10);var h=(n==="down"?c-f:f-c)/(o-1)||0;u.push(h)}a.push(u)}if(["right","left"].indexOf(n)!==-1){for(var m=0;m<=s;m++){var p=parseInt(r[m][0],10);var v=parseInt(r[m][i-1],10);var g=(n==="right"?v-p:p-v)/(i-1)||0;a.push([g])}}return a}function u(e,t){var r,n,o;if(t[0]===e[0]&&t[1]<e[1]){o="left";r=new WalkontableCellCoords(t[0],t[1]);n=new WalkontableCellCoords(t[2],e[1]-1)}else if(t[0]===e[0]&&t[3]>e[3]){o="right";r=new WalkontableCellCoords(t[0],e[3]+1);n=new WalkontableCellCoords(t[2],t[3])}else if(t[0]<e[0]&&t[1]===e[1]){o="up";r=new WalkontableCellCoords(t[0],t[1]);n=new WalkontableCellCoords(e[0]-1,t[3])}else if(t[2]>e[2]&&t[1]===e[1]){o="down";r=new WalkontableCellCoords(e[2]+1,t[1]);n=new WalkontableCellCoords(t[2],t[3])}return{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:n}}function d(e){var t={};if(e===true){t.directions=Object.keys(s);t.autoInsertRow=true}else if(i(e)){if(a(e.autoInsertRow)){if(e.direction===s.horizontal){t.autoInsertRow=false}else{t.autoInsertRow=e.autoInsertRow}}else{t.autoInsertRow=false}if(a(e.direction)){t.directions=[e.direction]}else{t.directions=Object.keys(s)}}else if(typeof e==="string"){t.directions=[e];t.autoInsertRow=true}else{t.directions=[];t.autoInsertRow=false}return t}},{"helpers/mixed":51,"helpers/object":53}],68:[function(e,t,r){"use strict";Object.defineProperties(r,{ColumnSorting:{get:function S(){return R}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var h=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}),m=h.addClass,p=h.hasClass,v=h.removeClass;var g=(a=e("helpers/array"),a&&a.__esModule&&a||{"default":a}),w=g.arrayMap,b=g.arrayReduce;var y=(s=e("helpers/mixed"),s&&s.__esModule&&s||{"default":s}).isEmpty;var C=(l=e("_base"),l&&l.__esModule&&l||{"default":l}).default;var _=(u=e("plugins"),u&&u.__esModule&&u||{"default":u}).registerPlugin;var E=(d=e("utils/sortingAlgorithms/mergeSort"),d&&d.__esModule&&d||{"default":d}).mergeSort;f.hooks.register("beforeColumnSort");f.hooks.register("afterColumnSort");var R=function O(e){$traceurRuntime.superConstructor(M).call(this,e);this.sortIndicators=[];this.lastSortedColumn=null;this.sortEmptyCells=false};var M=R;$traceurRuntime.createClass(R,{isEnabled:function T(){return!!this.hot.getSettings().columnSorting},enablePlugin:function A(){var e=this;if(this.enabled){return}this.setPluginOptions();var t=this;this.hot.sortIndex=[];this.hot.sort=function(){var e=Array.prototype.slice.call(arguments);return t.sortByColumn.apply(t,e)};if(typeof this.hot.getSettings().observeChanges==="undefined"){this.enableObserveChangesPlugin()}this.addHook("afterTrimRow",function(t){return e.sort()});this.addHook("afterUntrimRow",function(t){return e.sort()});this.addHook("modifyRow",function(t){return e.translateRow(t)});this.addHook("unmodifyRow",function(t){return e.untranslateRow(t)});this.addHook("afterUpdateSettings",function(){return e.onAfterUpdateSettings()});this.addHook("afterGetColHeader",function(t,r){return e.getColHeader(t,r)});this.addHook("afterOnCellMouseDown",function(t,r){return e.onAfterOnCellMouseDown(t,r)});this.addHook("afterCreateRow",function(){t.afterCreateRow.apply(t,arguments)});this.addHook("afterRemoveRow",function(){t.afterRemoveRow.apply(t,arguments)});this.addHook("afterInit",function(){return e.sortBySettings()});this.addHook("afterLoadData",function(){e.hot.sortIndex=[];if(e.hot.view){e.sortBySettings()}});if(this.hot.view){this.sortBySettings()}$traceurRuntime.superGet(this,M.prototype,"enablePlugin").call(this);
},disablePlugin:function N(){this.hot.sort=void 0;$traceurRuntime.superGet(this,M.prototype,"disablePlugin").call(this)},onAfterUpdateSettings:function D(){this.sortBySettings()},sortBySettings:function k(){var e=this.hot.getSettings().columnSorting;var t=this.loadSortingState();var r;var n;if(typeof t==="undefined"){r=e.column;n=e.sortOrder}else{r=t.sortColumn;n=t.sortOrder}if(typeof r==="number"){this.lastSortedColumn=r;this.sortByColumn(r,n)}},setSortingColumn:function x(e,t){if(typeof e=="undefined"){this.hot.sortColumn=void 0;this.hot.sortOrder=void 0;return}else if(this.hot.sortColumn===e&&typeof t=="undefined"){if(this.hot.sortOrder===false){this.hot.sortOrder=void 0}else{this.hot.sortOrder=!this.hot.sortOrder}}else{this.hot.sortOrder=typeof t==="undefined"?true:t}this.hot.sortColumn=e},sortByColumn:function I(e,t){this.setSortingColumn(e,t);if(typeof this.hot.sortColumn=="undefined"){return}var r=f.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder);if(r!==false){this.sort()}this.updateOrderClass();this.updateSortIndicator();f.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder);this.hot.render();this.saveSortingState()},saveSortingState:function P(){var e={};if(typeof this.hot.sortColumn!="undefined"){e.sortColumn=this.hot.sortColumn}if(typeof this.hot.sortOrder!="undefined"){e.sortOrder=this.hot.sortOrder}if(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder")){f.hooks.run(this.hot,"persistentStateSave","columnSorting",e)}},loadSortingState:function L(){var e={};f.hooks.run(this.hot,"persistentStateLoad","columnSorting",e);return e.value},updateOrderClass:function H(){var e;if(this.hot.sortOrder===true){e="ascending"}else if(this.hot.sortOrder===false){e="descending"}this.sortOrderClass=e},enableObserveChangesPlugin:function V(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.updateSettings({observeChanges:true})},0))},defaultSort:function F(e,t){return function(r,n){if(typeof r[1]=="string"){r[1]=r[1].toLowerCase()}if(typeof n[1]=="string"){n[1]=n[1].toLowerCase()}if(r[1]===n[1]){return 0}if(y(r[1])){if(y(n[1])){return 0}if(t.columnSorting.sortEmptyCells){return e?-1:1}return 1}if(y(n[1])){if(y(r[1])){return 0}if(t.columnSorting.sortEmptyCells){return e?1:-1}return-1}if(isNaN(r[1])&&!isNaN(n[1])){return e?1:-1}else if(!isNaN(r[1])&&isNaN(n[1])){return e?-1:1}else if(!(isNaN(r[1])||isNaN(n[1]))){r[1]=parseFloat(r[1]);n[1]=parseFloat(n[1])}if(r[1]<n[1]){return e?-1:1}if(r[1]>n[1]){return e?1:-1}return 0}},dateSort:function B(e,t){return function(r,n){if(r[1]===n[1]){return 0}if(y(r[1])){if(y(n[1])){return 0}if(t.columnSorting.sortEmptyCells){return e?-1:1}return 1}if(y(n[1])){if(y(r[1])){return 0}if(t.columnSorting.sortEmptyCells){return e?1:-1}return-1}var o=c(r[1],t.dateFormat);var i=c(n[1],t.dateFormat);if(!o.isValid()){return 1}if(!i.isValid()){return-1}if(i.isAfter(o)){return e?-1:1}if(i.isBefore(o)){return e?1:-1}return 0}},numericSort:function j(e,t){return function(r,n){var o=parseFloat(r[1]);var i=parseFloat(n[1]);if(o===i||isNaN(o)&&isNaN(i)){return 0}if(t.columnSorting.sortEmptyCells){if(y(r[1])){return e?-1:1}if(y(n[1])){return e?1:-1}}if(isNaN(o)){return 1}if(isNaN(i)){return-1}if(o<i){return e?-1:1}else if(o>i){return e?1:-1}return 0}},sort:function W(){if(typeof this.hot.sortOrder=="undefined"){this.hot.sortIndex.length=0;return}var e=this.hot.getCellMeta(0,this.hot.sortColumn);var t=this.hot.countEmptyRows();var r;var n;this.hot.sortingEnabled=false;this.hot.sortIndex.length=0;if(typeof e.columnSorting.sortEmptyCells==="undefined"){e.columnSorting={sortEmptyCells:this.sortEmptyCells}}if(this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY){n=this.hot.countRows()-this.hot.getSettings().minSpareRows}else{n=this.hot.countRows()-t}for(var o=0,i=n;o<i;o++){this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn)])}if(e.sortFunction){r=e.sortFunction}else{switch(e.type){case"date":r=this.dateSort;break;case"numeric":r=this.numericSort;break;default:r=this.defaultSort}}E(this.hot.sortIndex,r(this.hot.sortOrder,e));for(var a=this.hot.sortIndex.length;a<this.hot.countRows();a++){this.hot.sortIndex.push([a,this.hot.getDataAtCell(a,this.hot.sortColumn)])}this.hot.sortingEnabled=true},updateSortIndicator:function $(){if(typeof this.hot.sortOrder=="undefined"){return}var e=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=e.sortIndicator},translateRow:function U(e){if(this.hot.sortingEnabled&&typeof this.hot.sortOrder!=="undefined"&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[e]){return this.hot.sortIndex[e][0]}return e},untranslateRow:function G(e){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length){for(var t=0;t<this.hot.sortIndex.length;t++){if(this.hot.sortIndex[t][0]==e){return t}}}},getColHeader:function Y(e,t){if(e<0||!t.parentNode){return false}var r=t.querySelector(".colHeader");var n=t.getAttribute("colspan");var o=t.parentNode.parentNode.childNodes;var i=Array.prototype.indexOf.call(o,t.parentNode);i=i-o.length;if(!r){return}if(this.hot.getSettings().columnSorting&&e>=0&&i===-1){m(r,"columnSorting")}v(r,"descending");v(r,"ascending");if(this.sortIndicators[e]){if(e===this.hot.sortColumn){if(this.sortOrderClass==="ascending"){m(r,"ascending")}else if(this.sortOrderClass==="descending"){m(r,"descending")}}}},isSorted:function z(){return typeof this.hot.sortColumn!="undefined"},afterCreateRow:function K(e,t){if(!this.isSorted()){return}for(var r=0;r<this.hot.sortIndex.length;r++){if(this.hot.sortIndex[r][0]>=e){this.hot.sortIndex[r][0]+=t}}for(var r=0;r<t;r++){this.hot.sortIndex.splice(e+r,0,[e+r,this.hot.getSourceData()[e+r][this.hot.sortColumn+this.hot.colOffset()]])}this.saveSortingState()},afterRemoveRow:function q(e,t){if(!this.isSorted()){return}var r=this.hot.sortIndex.splice(e,t);r=w(r,function(e){return e[0]});function n(e){return b(r,function(t,r){if(e>r){t++}return t},0)}this.hot.sortIndex=w(this.hot.sortIndex,function(e,t){var r=n(e[0]);if(r){e[0]-=r}return e});this.saveSortingState()},setPluginOptions:function X(){var e=this.hot.getSettings().columnSorting;if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){this.sortEmptyCells=e.sortEmptyCells||false}else{this.sortEmptyCells=false}},onAfterOnCellMouseDown:function J(e,t){if(t.row>-1){return}if(p(e.realTarget,"columnSorting")){if(t.col!==this.lastSortedColumn){this.hot.sortOrder=true}this.lastSortedColumn=t.col;this.sortByColumn(t.col)}}},{},C);_("columnSorting",R)},{_base:63,browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,moment:"moment",plugins:62,"utils/sortingAlgorithms/mergeSort":134}],69:[function(e,t,r){"use strict";Object.defineProperties(r,{CommentEditor:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).addClass;var i=function l(){this.editor=this.createEditor();this.editorStyle=this.editor.style;this.hidden=true;this.hide()};var a=i;$traceurRuntime.createClass(i,{setPosition:function u(e,t){this.editorStyle.left=e+"px";this.editorStyle.top=t+"px"},setSize:function d(e,t){if(e&&t){var r=this.getInputElement();r.style.width=e+"px";r.style.height=t+"px"}},resetSize:function f(){var e=this.getInputElement();e.style.width="";e.style.height=""},setReadOnlyState:function c(e){var t=this.getInputElement();t.readOnly=e},show:function h(){this.editorStyle.display="block";this.hidden=false},hide:function m(){this.editorStyle.display="none";this.hidden=true},isVisible:function p(){return this.editorStyle.display==="block"},setValue:function v(){var e=arguments[0]!==void 0?arguments[0]:"";e=e||"";this.getInputElement().value=e},getValue:function g(){return this.getInputElement().value},isFocused:function w(){return document.activeElement===this.getInputElement()},focus:function b(){this.getInputElement().focus()},createEditor:function y(){var e=document.querySelector("."+a.CLASS_EDITOR_CONTAINER);var t;var r;if(!e){e=document.createElement("div");o(e,a.CLASS_EDITOR_CONTAINER);document.body.appendChild(e)}t=document.createElement("div");o(t,a.CLASS_EDITOR);r=document.createElement("textarea");o(r,a.CLASS_INPUT);t.appendChild(r);e.appendChild(t);return t},getInputElement:function C(){return this.editor.querySelector("."+a.CLASS_INPUT)},destroy:function _(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"helpers/dom/element":47}],70:[function(e,t,r){"use strict";var n;Object.defineProperties(r,{Comments:{get:function $(){return j}},__esModule:{value:true}});var o,i,a,s,l,u,d,f,c,h;var m=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var p=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}),v=p.addClass,g=p.closest,w=p.isChildOf,b=p.hasClass,y=p.offset,C=p.outerWidth,_=p.outerHeight,E=p.getScrollableElement;var R=(a=e("helpers/object"),a&&a.__esModule&&a||{"default":a}),M=R.deepClone,S=R.deepExtend;var O=(s=e("helpers/function"),s&&s.__esModule&&s||{"default":s}).debounce;var T=(l=e("eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager;var A=(u=e("3rdparty/walkontable/src/cell/coords"),u&&u.__esModule&&u||{"default":u}).WalkontableCellCoords;var N=(d=e("plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var D=(f=e("_base"),f&&f.__esModule&&f||{"default":f}).default;var k=(c=e("commentEditor"),c&&c.__esModule&&c||{"default":c}).CommentEditor;var x=(h=e("contextMenu/utils"),h&&h.__esModule&&h||{"default":h}),I=x.checkSelectionConsistency,P=x.markLabelAsSelected;var L=new WeakMap;var H="comment";var V="value";var F="style";var B="readOnly";var j=function U(e){$traceurRuntime.superConstructor(W).call(this,e);this.editor=null;this.eventManager=null;this.range={};this.mouseDown=false;this.contextMenuEvent=false;this.timer=null;this.displayDelay=250;L.set(this,{tempEditorDimensions:{},cellBelowCursor:null})};var W=j;$traceurRuntime.createClass(j,(n={},Object.defineProperty(n,"isEnabled",{value:function G(){return!!this.hot.getSettings().comments},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"enablePlugin",{value:function Y(){var e=this;if(this.enabled){return}if(!this.editor){this.editor=new k}if(!this.eventManager){this.eventManager=new T(this)}this.addHook("afterContextMenuDefaultOptions",function(t){return e.addToContextMenu(t)});this.addHook("afterRenderer",function(t,r,n,o,i,a){return e.onAfterRenderer(t,a)});this.addHook("afterScrollHorizontally",function(){return e.hide()});this.addHook("afterScrollVertically",function(){return e.hide()});this.addHook("afterBeginEditing",function(t){return e.onAfterBeginEditing(t)});this.registerListeners();$traceurRuntime.superGet(this,W.prototype,"enablePlugin").call(this)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"disablePlugin",{value:function z(){$traceurRuntime.superGet(this,W.prototype,"disablePlugin").call(this)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"registerListeners",{value:function K(){var e=this;this.eventManager.addEventListener(document,"mouseover",function(t){return e.onMouseOver(t)});this.eventManager.addEventListener(document,"mousedown",function(t){return e.onMouseDown(t)});this.eventManager.addEventListener(document,"mouseup",function(t){return e.onMouseUp(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return e.onEditorBlur(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(t){return e.onEditorMouseDown(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(t){return e.onEditorMouseUp(t)})},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"setRange",{value:function q(e){this.range=e},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"clearRange",{value:function X(){this.range={}},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"targetIsCellWithComment",{value:function J(e){var t=g(e.target,"TD","TBODY");return t&&b(t,"htCommentCell")&&g(t,[this.hot.rootElement])?true:false},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"targetIsCommentTextArea",{value:function Z(e){return this.editor.getInputElement()===e.target},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"setComment",{value:function Q(e){var t;if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var r=this.editor.getValue();var n="";if(e!=null){n=e}else if(r!=null){n=r}var o=this.range.from.row;var i=this.range.from.col;this.updateCommentMeta(o,i,(t={},Object.defineProperty(t,V,{value:n,configurable:true,enumerable:true,writable:true}),t));this.hot.render()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"setCommentAtCell",{value:function ee(e,t,r){this.setRange({from:new A(e,t)});this.setComment(r)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"removeComment",{value:function te(){var e=arguments[0]!==void 0?arguments[0]:true;if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}this.hot.setCellMeta(this.range.from.row,this.range.from.col,H,void 0);if(e){this.hot.render()}this.hide()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"removeCommentAtCell",{value:function re(e,t){var r=arguments[2]!==void 0?arguments[2]:true;this.setRange({from:new A(e,t)});this.removeComment(r)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"getComment",{value:function ne(){var e=this.range.from.row;var t=this.range.from.col;return this.getCommentMeta(e,t,V)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"getCommentAtCell",{value:function oe(e,t){return this.getCommentMeta(e,t,V)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"show",{value:function ie(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var e=this.hot.getCellMeta(this.range.from.row,this.range.from.col);this.refreshEditor(true);this.editor.setValue(e[H]?e[H][V]:null||"");if(this.editor.hidden){this.editor.show()}return true},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"showAtCell",{value:function ae(e,t){this.setRange({from:new A(e,t)});return this.show()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"hide",{value:function se(){if(!this.editor.hidden){this.editor.hide()}},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"refreshEditor",{value:function le(){var e=arguments[0]!==void 0?arguments[0]:false;if(!e&&(!this.range.from||!this.editor.isVisible())){return}var t=E(this.hot.view.wt.wtTable.TABLE);var r=this.hot.view.wt.wtTable.getCell(this.range.from);var n=this.range.from.row;var o=this.range.from.col;var i=y(r);var a=this.hot.view.wt.wtTable.getStretchedColumnWidth(o);var s=i.top<0?0:i.top;var l=i.left;if(this.hot.view.wt.wtViewport.hasVerticalScroll()&&t!==window){s=s-this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()}if(this.hot.view.wt.wtViewport.hasHorizontalScroll()&&t!==window){l=l-this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition()}var u=t;while(u=u.parentElement){if(u===document.body){break}s-=u.scrollTop}var d=l+a;var f=s;var c=this.getCommentMeta(n,o,F);var h=this.getCommentMeta(n,o,B);if(c){this.editor.setSize(c.width,c.height)}else{this.editor.resetSize()}this.editor.setReadOnlyState(h);var m=c?c.width:215;if(d+m>=document.body.offsetWidth){d=l-m}this.editor.setPosition(d,f)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"checkSelectionCommentsConsistency",{value:function ue(){var e=this.hot.getSelectedRange();if(!e){return false}var t=false;var r=e.from;if(this.getCommentMeta(r.row,r.col,V)){t=true}return t},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"updateCommentMeta",{value:function de(e,t,r){var n=this.hot.getCellMeta(e,t)[H];var o;if(n){o=M(n);S(o,r)}else{o=r}this.hot.setCellMeta(e,t,H,o)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"getCommentMeta",{value:function fe(e,t,r){var n=this.hot.getCellMeta(e,t);if(!n[H]){return void 0}return n[H][r]},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onMouseDown",{value:function ce(e){this.mouseDown=true;if(!this.hot.view||!this.hot.view.wt){return}if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(e)){var t=g(e.target,"TD","TBODY");var r=null;if(t){r=this.hot.view.wt.wtTable.getCoords(t)}if(!t||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col)){this.hide()}}this.contextMenuEvent=false},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onMouseOver",{value:function he(e){var t=this;if(this.mouseDown||this.editor.isFocused()){return}var r=L.get(this);r.cellBelowCursor=document.elementFromPoint(e.clientX,e.clientY);O(function(){if(b(e.target,"wtBorder")||r.cellBelowCursor!==e.target||!t.editor){return}if(t.targetIsCellWithComment(e)){var n=t.hot.view.wt.wtTable.getCoords(e.target);var o={from:new A(n.row,n.col)};t.setRange(o);t.show()}else if(w(e.target,document)&&!t.targetIsCommentTextArea(e)&&!t.editor.isFocused()){t.hide()}},this.displayDelay)()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onMouseUp",{value:function me(e){this.mouseDown=false},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onAfterRenderer",{value:function pe(e,t){if(t[H]&&t[H][V]){v(e,t.commentedCellClassName)}},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onEditorBlur",{value:function ve(e){this.setComment()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onEditorMouseDown",{value:function ge(e){var t=L.get(this);t.tempEditorDimensions={width:C(e.target),height:_(e.target)}},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onEditorMouseUp",{value:function we(e){var t;var r=L.get(this);var n=C(e.target);var o=_(e.target);if(n!==r.tempEditorDimensions.width+1||o!==r.tempEditorDimensions.height+2){this.updateCommentMeta(this.range.from.row,this.range.from.col,(t={},Object.defineProperty(t,F,{value:{width:n,height:o},configurable:true,enumerable:true,writable:true}),t))}},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onContextMenuAddComment",{value:function be(){var e=this;var t=this.hot.getSelectedRange();this.contextMenuEvent=true;this.setRange({from:t.from});this.show();setTimeout(function(){if(e.hot){e.hot.deselectCell();e.editor.focus()}},10)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onContextMenuRemoveComment",{value:function ye(e){this.contextMenuEvent=true;for(var t=e.start.row;t<=e.end.row;t++){for(var r=e.start.col;r<=e.end.col;r++){this.removeCommentAtCell(t,r,false)}}this.hot.render()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onContextMenuMakeReadOnly",{value:function Ce(e){var t;this.contextMenuEvent=true;for(var r=e.start.row;r<=e.end.row;r++){for(var n=e.start.col;n<=e.end.col;n++){var o=!!this.getCommentMeta(r,n,B);this.updateCommentMeta(r,n,(t={},Object.defineProperty(t,B,{value:!o,configurable:true,enumerable:true,writable:true}),t))}}},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"addToContextMenu",{value:function _e(e){var t=this;e.items.push(m.plugins.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function r(){return t.checkSelectionCommentsConsistency()?"Edit comment":"Add comment"},callback:function n(){return t.onContextMenuAddComment()},disabled:function o(){return this.getSelected()&&!this.selection.selectedHeader.corner?false:true}},{key:"commentsRemove",name:function i(){return"Delete comment"},callback:function a(e,r){return t.onContextMenuRemoveComment(r)},disabled:function s(){return t.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function l(){var e=this;var t="Read only comment";var r=I(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r)[H];if(n){n=n[B]}if(n){return true}});if(r){t=P(t)}return t},callback:function u(e,r){return t.onContextMenuMakeReadOnly(r)},disabled:function d(){return t.hot.selection.selectedHeader.corner||!t.checkSelectionCommentsConsistency()}})},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"onAfterBeginEditing",{value:function Ee(e,t){this.hide()},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"destroy",{value:function Re(){if(this.editor){this.editor.destroy()}$traceurRuntime.superGet(this,W.prototype,"destroy").call(this)},configurable:true,enumerable:true,writable:true}),n),{},D);N("comments",j)},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,commentEditor:69,"contextMenu/utils":89,eventManager:42,"helpers/dom/element":47,"helpers/function":50,"helpers/object":53,plugins:62}],71:[function(e,t,r){"use strict";Object.defineProperties(r,{CommandExecutor:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var i=function l(e){this.hot=e;this.commands={};this.commonCallback=null};$traceurRuntime.createClass(i,{registerCommand:function u(e,t){this.commands[e]=t},setCommonCallback:function d(e){this.commonCallback=e},execute:function f(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r]}var n=this;var i=e.split(":");e=i[0];var s=i.length===2?i[1]:null;var l=this.commands[e];if(!l){throw new Error("Menu command '"+e+"' not exists.")}if(s&&l.submenu){l=a(s,l.submenu.items)}if(l.disabled===true){return}if(typeof l.disabled=="function"&&l.disabled.call(this.hot)===true){return}if(l.hasOwnProperty("submenu")){return}var u=[];if(typeof l.callback==="function"){u.push(l.callback)}if(typeof this.commonCallback==="function"){u.push(this.commonCallback)}t.unshift(i.join(":"));o(u,function(e){return e.apply(n.hot,t)})}},{});function a(e,t){var r;o(t,function(t){var n=t.key?t.key.split(":"):null;if(Array.isArray(n)&&n[1]===e){r=t;return false}});return r}},{"helpers/array":43}],72:[function(e,t,r){"use strict";Object.defineProperties(r,{ContextMenu:{get:function U(){return W}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,l,h;var m=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var p=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).default;var v=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var g=(a=e("commandExecutor"),a&&a.__esModule&&a||{"default":a}).CommandExecutor;var w=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager;var b=(l=e("helpers/dom/element"),l&&l.__esModule&&l||{"default":l}).hasClass;var y=(u=e("itemsFactory"),u&&u.__esModule&&u||{"default":u}).ItemsFactory;var C=(d=e("menu"),d&&d.__esModule&&d||{"default":d}).Menu;var _=(f=e("plugins"),f&&f.__esModule&&f||{"default":f}).registerPlugin;var E=(c=e("helpers/dom/event"),c&&c.__esModule&&c||{"default":c}),R=E.stopPropagation,M=E.pageX,S=E.pageY;var O=(l=e("helpers/dom/element"),l&&l.__esModule&&l||{"default":l}),T=O.getWindowScrollLeft,A=O.getWindowScrollTop;var N=(h=e("predefinedItems"),h&&h.__esModule&&h||{"default":h}),D=N.ROW_ABOVE,k=N.ROW_BELOW,x=N.COLUMN_LEFT,I=N.COLUMN_RIGHT,P=N.REMOVE_ROW,L=N.REMOVE_COLUMN,H=N.UNDO,V=N.REDO,F=N.READ_ONLY,B=N.ALIGNMENT,j=N.SEPARATOR;var W=function G(e){$traceurRuntime.superConstructor($).call(this,e);this.eventManager=new w(this);this.commandExecutor=new g(this.hot);this.itemsFactory=null;this.menu=null};var $=W;$traceurRuntime.createClass(W,{isEnabled:function Y(){return this.hot.getSettings().contextMenu},enablePlugin:function z(){var e=this;if(this.enabled){return}this.itemsFactory=new y(this.hot,$.DEFAULT_ITEMS);var t=this.hot.getSettings().contextMenu;var r={items:this.itemsFactory.getItems(t)};this.registerEvents();if(typeof t.callback==="function"){this.commandExecutor.setCommonCallback(t.callback)}$traceurRuntime.superGet(this,$.prototype,"enablePlugin").call(this);this.callOnPluginsReady(function(){e.hot.runHooks("afterContextMenuDefaultOptions",r);e.itemsFactory.setPredefinedItems(r.items);var n=e.itemsFactory.getItems(t);e.menu=new C(e.hot,{className:"htContextMenu",keepInViewport:true});e.hot.runHooks("beforeContextMenuSetItems",n);e.menu.setMenuItems(n);e.menu.addLocalHook("afterOpen",function(){return e.onMenuAfterOpen()});e.menu.addLocalHook("afterClose",function(){return e.onMenuAfterClose()});e.menu.addLocalHook("executeCommand",function(){for(var t=[],r=0;r<arguments.length;r++){t[r]=arguments[r]}return e.executeCommand.apply(e,t)});v(n,function(t){return e.commandExecutor.registerCommand(t.key,t)})})},updatePlugin:function K(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,$.prototype,"updatePlugin").call(this)},disablePlugin:function q(){this.close();if(this.menu){this.menu.destroy();this.menu=null}$traceurRuntime.superGet(this,$.prototype,"disablePlugin").call(this)},registerEvents:function X(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(t){return e.onContextMenu(t)})},open:function J(e){if(!this.menu){return}this.menu.open();this.menu.setPosition({top:parseInt(S(e),10)-A(),left:parseInt(M(e),10)-T()});this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv;m.eventManager.isHotTableEnv=this.hot.isHotTableEnv},close:function Z(){if(!this.menu){return}this.menu.close()},executeCommand:function Q(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.commandExecutor.execute.apply(this.commandExecutor,e)},onContextMenu:function ee(e){var t=this.hot.getSettings();var r=t.rowHeaders;var n=t.colHeaders;function o(e){return e.nodeName==="TD"||e.parentNode.nodeName==="TD"}var i=e.realTarget;this.close();if(b(i,"handsontableInput")){return}e.preventDefault();R(e);if(!(r||n)){if(!o(i)&&!(b(i,"current")&&b(i,"wtBorder"))){return}}this.open(e)},onMenuAfterOpen:function te(){this.hot.runHooks("afterContextMenuShow",this)},onMenuAfterClose:function re(){this.hot.listen();this.hot.runHooks("afterContextMenuHide",this)},destroy:function ne(){this.close();if(this.menu){this.menu.destroy()}$traceurRuntime.superGet(this,$.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[D,k,j,x,I,j,P,L,j,H,V,j,F,j,B]}},p);W.SEPARATOR={name:j};m.hooks.register("afterContextMenuDefaultOptions");m.hooks.register("afterContextMenuShow");m.hooks.register("afterContextMenuHide");m.hooks.register("afterContextMenuExecute");_("contextMenu",W)},{_base:63,browser:24,commandExecutor:71,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,itemsFactory:74,menu:75,plugins:62,predefinedItems:76}],73:[function(e,t,r){"use strict";Object.defineProperties(r,{Cursor:{get:function m(){return h}},__esModule:{value:true}});var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),l=s.getWindowScrollLeft,u=s.getWindowScrollTop;var d=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{"default":i}),f=d.pageX,c=d.pageY;var h=function p(e){var t=u();var r=l();var n,o;var i,a;var s,d;this.type=this.getSourceType(e);if(this.type==="literal"){n=parseInt(e.top,10);i=parseInt(e.left,10);s=e.height||0;d=e.width||0;o=n;a=i;n=n+t;i=i+r}else if(this.type==="event"){n=parseInt(c(e),10);i=parseInt(f(e),10);s=e.target.clientHeight;d=e.target.clientWidth;o=n-t;a=i-r}this.top=n;this.topRelative=o;this.left=i;this.leftRelative=a;this.scrollTop=t;this.scrollLeft=r;this.cellHeight=s;this.cellWidth=d};$traceurRuntime.createClass(h,{getSourceType:function v(e){var t="literal";if(e instanceof Event){t="event"}return t},fitsAbove:function g(e){return this.topRelative>=e.offsetHeight},fitsBelow:function w(e){var t=arguments[1]!==void 0?arguments[1]:window.innerHeight;return this.topRelative+e.offsetHeight<=t},fitsOnRight:function b(e){var t=arguments[1]!==void 0?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t},fitsOnLeft:function y(e){return this.leftRelative>=e.offsetWidth}},{});a.plugins.utils=a.plugins.utils||{};a.plugins.utils.Cursor=h},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48}],74:[function(e,t,r){"use strict";Object.defineProperties(r,{ItemsFactory:{get:function g(){return p}},__esModule:{value:true}});var n,o,i;var a=(n=e("helpers/object"),n&&n.__esModule&&n||{"default":n}),s=a.objectEach,l=a.isObject,u=a.extend;var d=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var f=(i=e("predefinedItems"),i&&i.__esModule&&i||{"default":i}),c=f.SEPARATOR,h=f.ITEMS,m=f.predefinedItems;var p=function w(e){var t=arguments[1]!==void 0?arguments[1]:null;this.hot=e;this.predefinedItems=m();this.defaultOrderPattern=t};$traceurRuntime.createClass(p,{setPredefinedItems:function b(e){var t=this;var r={};this.defaultOrderPattern.length=0;s(e,function(e,n){var o="";if(e.name===c){r[c]=e;o=c}else if(isNaN(parseInt(n,10))){e.key=e.key===void 0?n:e.key;r[n]=e;o=e.key}else{r[e.key]=e;o=e.key}t.defaultOrderPattern.push(o)});this.predefinedItems=r},getItems:function y(){var e=arguments[0]!==void 0?arguments[0]:null;return v(e,this.defaultOrderPattern,this.predefinedItems)}},{});function v(){var e=arguments[0]!==void 0?arguments[0]:null;var t=arguments[1]!==void 0?arguments[1]:[];var r=arguments[2]!==void 0?arguments[2]:{};var n=[];if(e&&e.items){e=e.items}else if(!Array.isArray(e)){e=t}if(l(e)){s(e,function(e,t){var o=r[typeof e==="string"?e:t];if(!o){o=e}if(l(e)){u(o,e)}else if(typeof o==="string"){o={name:o}}if(o.key===void 0){o.key=t}n.push(o)})}else{d(e,function(e,t){var o=r[e];if(!o&&h.indexOf(e)>=0){return}if(!o){o={name:e,key:t+""}}if(l(e)){u(o,e)}if(o.key===void 0){o.key=t}n.push(o)})}return n}},{"helpers/array":43,"helpers/object":53,predefinedItems:76}],75:[function(e,t,r){"use strict";Object.defineProperties(r,{Menu:{get:function G(){return $}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h,m;var p=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var v=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),g=v.addClass,w=v.empty,b=v.fastInnerHTML,y=v.getScrollbarWidth,C=v.isChildOf,_=v.removeClass;var E=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}),R=E.arrayEach,M=E.arrayFilter,S=E.arrayReduce;var O=(a=e("cursor"),a&&a.__esModule&&a||{"default":a}).Cursor;var T=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager;var A=(l=e("helpers/object"),l&&l.__esModule&&l||{"default":l}).mixin;var N=(u=e("helpers/function"),u&&u.__esModule&&u||{"default":u}).debounce;var D=(d=e("utils"),d&&d.__esModule&&d||{"default":d}),k=D.filterSeparators,x=D.hasSubMenu,I=D.isDisabled,P=D.isItemHidden,L=D.isSeparator,H=D.isSelectionDisabled,V=D.normalizeSelection;var F=(f=e("helpers/unicode"),f&&f.__esModule&&f||{"default":f}).KEY_CODES;var B=(c=e("mixins/localHooks"),c&&c.__esModule&&c||{"default":c}).localHooks;var j=(h=e("predefinedItems"),h&&h.__esModule&&h||{"default":h}).SEPARATOR;var W=(m=e("helpers/dom/event"),m&&m.__esModule&&m||{"default":m}).stopImmediatePropagation;var $=function Y(e,t){this.hot=e;this.options=t||{parent:null,name:null,className:"",keepInViewport:true,standalone:false};this.eventManager=new T(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.menuItems=null;this.origOutsideClickDeselects=null;this.keyEvent=false;this.offset={above:0,below:0,left:0,right:0};this._afterScrollCallback=null;
this.registerEvents()};var U=$;$traceurRuntime.createClass($,{registerEvents:function z(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return e.onDocumentMouseDown(t)})},setMenuItems:function K(e){this.menuItems=e},setOffset:function q(e){var t=arguments[1]!==void 0?arguments[1]:0;this.offset[e]=t},isSubMenu:function X(){return this.parentMenu!==null},open:function J(){var e=this;this.container.removeAttribute("style");this.container.style.display="block";var t=N(function(t){return e.openSubMenu(t)},300);var r=M(this.menuItems,function(t){return P(t,e.hot)});r=k(r,j);var n={data:r,colHeaders:false,colWidths:[200],autoRowSize:false,readOnly:true,copyPaste:false,columns:[{data:"name",renderer:function o(t,r,n,i,a,s){return e.menuItemRenderer(t,r,n,i,a,s)}}],renderAllRows:true,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function i(t){return e.onBeforeKeyDown(t)},afterOnCellMouseOver:function a(r,n,o){if(e.isAllSubMenusClosed()){t(n.row)}else{e.openSubMenu(n.row)}},rowHeights:function s(e){return r[e].name===j?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=false;this.hotMenu=new p.Core(this.container,n);this.hotMenu.addHook("afterInit",function(){return e.onAfterInit()});this.hotMenu.addHook("afterSelection",function(t,r,n,o,i){return e.onAfterSelection(t,r,n,o,i)});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks("afterOpen")},close:function Z(){var e=arguments[0]!==void 0?arguments[0]:false;if(!this.isOpened()){return}if(e&&this.parentMenu){this.parentMenu.close()}else{this.closeAllSubMenus();this.container.style.display="none";this.releaseMainTableCallbacks();this.hotMenu.destroy();this.hotMenu=null;this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects;this.runLocalHooks("afterClose");if(this.parentMenu){this.parentMenu.hotMenu.listen()}}},openSubMenu:function Q(e){if(!this.hotMenu){return false}var t=this.hotMenu.getCell(e,0);this.closeAllSubMenus();if(!t||!x(t)){return false}var r=this.hotMenu.getSourceDataAtRow(e);var n=new U(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:true});n.setMenuItems(r.submenu.items);n.open();n.setPosition(t.getBoundingClientRect());this.hotSubMenus[r.key]=n;return n},closeSubMenu:function ee(e){var t=this.hotMenu.getSourceDataAtRow(e);var r=this.hotSubMenus[t.key];if(r){r.destroy();delete this.hotSubMenus[t.key]}},closeAllSubMenus:function te(){var e=this;R(this.hotMenu.getData(),function(t,r){return e.closeSubMenu(r)})},isAllSubMenusClosed:function re(){return Object.keys(this.hotSubMenus).length===0},destroy:function ne(){this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy()},isOpened:function oe(){return this.hotMenu!==null},executeCommand:function ie(e){if(!this.isOpened()||!this.hotMenu.getSelected()){return}var t=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);this.runLocalHooks("select",t,e);if(t.isCommand===false||t.name===j){return}var r=this.hot.getSelectedRange();var n=r?V(r):{};var o=true;if(t.disabled===true||typeof t.disabled==="function"&&t.disabled.call(this.hot)===true||t.submenu){o=false}this.runLocalHooks("executeCommand",t.key,n,e);if(this.isSubMenu()){this.parentMenu.runLocalHooks("executeCommand",t.key,n,e)}if(o){this.close(true)}},setPosition:function ae(e){var t=new O(e);if(this.options.keepInViewport){if(t.fitsBelow(this.container)){this.setPositionBelowCursor(t)}else if(t.fitsAbove(this.container)){this.setPositionAboveCursor(t)}else{this.setPositionBelowCursor(t)}if(t.fitsOnRight(this.container)){this.setPositionOnRightOfCursor(t)}else{this.setPositionOnLeftOfCursor(t)}}else{this.setPositionBelowCursor(t);this.setPositionOnRightOfCursor(t)}},setPositionAboveCursor:function se(e){var t=this.offset.above+e.top-this.container.offsetHeight;if(this.isSubMenu()){t=e.top+e.cellHeight-this.container.offsetHeight+3}this.container.style.top=t+"px"},setPositionBelowCursor:function le(e){var t=this.offset.below+e.top;if(this.isSubMenu()){t=e.top-1}this.container.style.top=t+"px"},setPositionOnRightOfCursor:function ue(e){var t;if(this.isSubMenu()){t=1+e.left+e.cellWidth}else{t=this.offset.right+1+e.left}this.container.style.left=t+"px"},setPositionOnLeftOfCursor:function de(e){var t=this.offset.left+e.left-this.container.offsetWidth+y()+4;this.container.style.left=t+"px"},selectFirstCell:function fe(){var e=this.hotMenu.getCell(0,0);if(L(e)||I(e)||H(e)){this.selectNextCell(0,0)}else{this.hotMenu.selectCell(0,0)}},selectLastCell:function ce(){var e=this.hotMenu.countRows()-1;var t=this.hotMenu.getCell(e,0);if(L(t)||I(t)||H(t)){this.selectPrevCell(e,0)}else{this.hotMenu.selectCell(e,0)}},selectNextCell:function he(e,t){var r=e+1;var n=r<this.hotMenu.countRows()?this.hotMenu.getCell(r,t):null;if(!n){return}if(L(n)||I(n)||H(n)){this.selectNextCell(r,t)}else{this.hotMenu.selectCell(r,t)}},selectPrevCell:function me(e,t){var r=e-1;var n=r>=0?this.hotMenu.getCell(r,t):null;if(!n){return}if(L(n)||I(n)||H(n)){this.selectPrevCell(r,t)}else{this.hotMenu.selectCell(r,t)}},menuItemRenderer:function pe(e,t,r,n,o,i){var a=this;var s=e.getSourceDataAtRow(r);var l=document.createElement("div");var u=function h(e){return e.hasOwnProperty("submenu")};var d=function m(e){return new RegExp(j,"i").test(e.name)};var f=function p(e){return e.disabled===true||typeof e.disabled=="function"&&e.disabled.call(a.hot)===true};var c=function v(e){return e.disableSelection};if(typeof i==="function"){i=i.call(this.hot)}w(t);g(l,"htItemWrapper");t.appendChild(l);if(d(s)){g(t,"htSeparator")}else if(typeof s.renderer==="function"){g(t,"htCustomMenuRenderer");t.appendChild(s.renderer(e,l,r,n,o,i))}else{b(l,i)}if(f(s)){g(t,"htDisabled");this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})}else if(c(s)){g(t,"htSelectionDisabled");this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})}else if(u(s)){g(t,"htSubmenu");if(c(s)){this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})}else{this.eventManager.addEventListener(t,"mouseenter",function(){return e.selectCell(r,n,void 0,void 0,false,false)})}}else{_(t,"htSubmenu");_(t,"htDisabled");if(c(s)){this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})}else{this.eventManager.addEventListener(t,"mouseenter",function(){return e.selectCell(r,n,void 0,void 0,false,false)})}}},createContainer:function ve(){var e=arguments[0]!==void 0?arguments[0]:null;if(e){e=e.replace(/[^A-z0-9]/g,"_");e=this.options.className+"Sub_"+e}var t;if(e){t=document.querySelector("."+this.options.className+"."+e)}else{t=document.querySelector("."+this.options.className)}if(!t){t=document.createElement("div");g(t,"htMenu "+this.options.className);if(e){g(t,e)}document.getElementsByTagName("body")[0].appendChild(t)}return t},blockMainTableCallbacks:function ge(){this._afterScrollCallback=function(){};this.hot.addHook("afterScrollVertically",this._afterScrollCallback);this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)},releaseMainTableCallbacks:function we(){if(this._afterScrollCallback){this.hot.removeHook("afterScrollVertically",this._afterScrollCallback);this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback);this._afterScrollCallback=null}},onBeforeKeyDown:function be(e){var t=this.hotMenu.getSelected();var r=false;this.keyEvent=true;switch(e.keyCode){case F.ESCAPE:this.close();r=true;break;case F.ENTER:if(t){if(this.hotMenu.getSourceDataAtRow(t[0]).submenu){r=true}else{this.executeCommand(e);this.close(true)}}break;case F.ARROW_DOWN:if(t){this.selectNextCell(t[0],t[1])}else{this.selectFirstCell()}r=true;break;case F.ARROW_UP:if(t){this.selectPrevCell(t[0],t[1])}else{this.selectLastCell()}r=true;break;case F.ARROW_RIGHT:if(t){var n=this.openSubMenu(t[0]);if(n){n.selectFirstCell()}}r=true;break;case F.ARROW_LEFT:if(t&&this.isSubMenu()){this.close();if(this.parentMenu){this.parentMenu.hotMenu.listen()}r=true}break}if(r){e.preventDefault();W(e)}this.keyEvent=false},onAfterInit:function ye(){var e=this.hotMenu.getSettings().data;var t=this.hotMenu.view.wt.wtTable.hider.style;var r=this.hotMenu.view.wt.wtTable.holder.style;var n=parseInt(t.width,10);var o=S(e,function(e,t){return e+(t.name===j?1:26)},0);r.width=n+22+"px";r.height=o+4+"px";t.height=r.height},onAfterSelection:function Ce(e,t,r,n,o){if(this.keyEvent===false){o.value=true}},onDocumentMouseDown:function _e(e){if(!this.isOpened()){return}if(this.container&&C(e.target,this.container)){this.executeCommand(e)}if(this.options.standalone&&this.hotMenu&&!C(e.target,this.hotMenu.rootElement)){this.close(true)}else if((this.isAllSubMenusClosed()||this.isSubMenu())&&!C(e.target,".htMenu")&&C(e.target,document)){this.close(true)}}},{});A($,B)},{browser:24,cursor:73,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/object":53,"helpers/unicode":56,"mixins/localHooks":58,predefinedItems:76,utils:89}],76:[function(e,t,r){"use strict";var n;Object.defineProperties(r,{ALIGNMENT:{get:function oe(){return i.KEY}},CLEAR_COLUMN:{get:function ie(){return a.KEY}},COLUMN_LEFT:{get:function ae(){return s.KEY}},COLUMN_RIGHT:{get:function se(){return l.KEY}},READ_ONLY:{get:function le(){return u.KEY}},REDO:{get:function ue(){return d.KEY}},REMOVE_COLUMN:{get:function de(){return f.KEY}},REMOVE_ROW:{get:function fe(){return c.KEY}},ROW_ABOVE:{get:function ce(){return h.KEY}},ROW_BELOW:{get:function he(){return m.KEY}},SEPARATOR:{get:function me(){return p.KEY}},UNDO:{get:function pe(){return v.KEY}},ITEMS:{get:function ve(){return ee}},predefinedItems:{get:function ge(){return re}},addItem:{get:function we(){return ne}},__esModule:{value:true}});var o,i,a,s,l,u,d,f,c,h,m,p,v,i,a,s,l,u,d,f,c,h,m,p,v;var g=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}).objectEach;var w=(i=e("predefinedItems/alignment"),i&&i.__esModule&&i||{"default":i}),b=w.alignmentItem,y=w.KEY;var C=(a=e("predefinedItems/clearColumn"),a&&a.__esModule&&a||{"default":a}),_=C.clearColumnItem,E=C.KEY;var R=(s=e("predefinedItems/columnLeft"),s&&s.__esModule&&s||{"default":s}),M=R.columnLeftItem,S=R.KEY;var O=(l=e("predefinedItems/columnRight"),l&&l.__esModule&&l||{"default":l}),T=O.columnRightItem,A=O.KEY;var N=(u=e("predefinedItems/readOnly"),u&&u.__esModule&&u||{"default":u}),D=N.readOnlyItem,k=N.KEY;var x=(d=e("predefinedItems/redo"),d&&d.__esModule&&d||{"default":d}),I=x.redoItem,P=x.KEY;var L=(f=e("predefinedItems/removeColumn"),f&&f.__esModule&&f||{"default":f}),H=L.removeColumnItem,V=L.KEY;var F=(c=e("predefinedItems/removeRow"),c&&c.__esModule&&c||{"default":c}),B=F.removeRowItem,j=F.KEY;var W=(h=e("predefinedItems/rowAbove"),h&&h.__esModule&&h||{"default":h}),$=W.rowAboveItem,U=W.KEY;var G=(m=e("predefinedItems/rowBelow"),m&&m.__esModule&&m||{"default":m}),Y=G.rowBelowItem,z=G.KEY;var K=(p=e("predefinedItems/separator"),p&&p.__esModule&&p||{"default":p}),q=K.separatorItem,X=K.KEY;var J=(v=e("predefinedItems/undo"),v&&v.__esModule&&v||{"default":v}),Z=J.undoItem,Q=J.KEY;var i=(i=e("predefinedItems/alignment"),i&&i.__esModule&&i||{"default":i});var a=(a=e("predefinedItems/clearColumn"),a&&a.__esModule&&a||{"default":a});var s=(s=e("predefinedItems/columnLeft"),s&&s.__esModule&&s||{"default":s});var l=(l=e("predefinedItems/columnRight"),l&&l.__esModule&&l||{"default":l});var u=(u=e("predefinedItems/readOnly"),u&&u.__esModule&&u||{"default":u});var d=(d=e("predefinedItems/redo"),d&&d.__esModule&&d||{"default":d});var f=(f=e("predefinedItems/removeColumn"),f&&f.__esModule&&f||{"default":f});var c=(c=e("predefinedItems/removeRow"),c&&c.__esModule&&c||{"default":c});var h=(h=e("predefinedItems/rowAbove"),h&&h.__esModule&&h||{"default":h});var m=(m=e("predefinedItems/rowBelow"),m&&m.__esModule&&m||{"default":m});var p=(p=e("predefinedItems/separator"),p&&p.__esModule&&p||{"default":p});var v=(v=e("predefinedItems/undo"),v&&v.__esModule&&v||{"default":v});var ee=[U,z,S,A,E,j,V,Q,P,k,y,X];var te=(n={},Object.defineProperty(n,X,{value:q,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,U,{value:$,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,z,{value:Y,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,S,{value:M,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,A,{value:T,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,E,{value:_,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,j,{value:B,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,V,{value:H,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,Q,{value:Z,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,P,{value:I,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,k,{value:D,configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,y,{value:b,configurable:true,enumerable:true,writable:true}),n);function re(){var e={};g(te,function(t,r){return e[r]=t()});return e}function ne(e,t){if(ee.indexOf(e)===-1){te[e]=t}}},{"helpers/object":53,"predefinedItems/alignment":77,"predefinedItems/clearColumn":78,"predefinedItems/columnLeft":79,"predefinedItems/columnRight":80,"predefinedItems/readOnly":81,"predefinedItems/redo":82,"predefinedItems/removeColumn":83,"predefinedItems/removeRow":84,"predefinedItems/rowAbove":85,"predefinedItems/rowBelow":86,"predefinedItems/separator":87,"predefinedItems/undo":88}],77:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function h(){return f}},alignmentItem:{get:function m(){return c}},__esModule:{value:true}});var n,o;var i=(n=e("utils"),n&&n.__esModule&&n||{"default":n}),a=i.align,s=i.getAlignmentClasses,l=i.checkSelectionConsistency,u=i.markLabelAsSelected;var d=(o=e("separator"),o&&o.__esModule&&o||{"default":o}).KEY;var f="alignment";function c(){return{key:f,name:"Alignment",disabled:function e(){return this.getSelectedRange()&&!this.selection.selectedHeader.corner?false:true},submenu:{items:[{key:f+":left",name:function t(){var e=this;var t="Left";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htLeft")!==-1){return true}});if(r){t=u(t)}return t},callback:function r(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="horizontal";var o="htLeft";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false},{key:f+":center",name:function n(){var e=this;var t="Center";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htCenter")!==-1){return true}});if(r){t=u(t)}return t},callback:function o(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="horizontal";var o="htCenter";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false},{key:f+":right",name:function i(){var e=this;var t="Right";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htRight")!==-1){return true}});if(r){t=u(t)}return t},callback:function c(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="horizontal";var o="htRight";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false},{key:f+":justify",name:function h(){var e=this;var t="Justify";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htJustify")!==-1){return true}});if(r){t=u(t)}return t},callback:function m(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="horizontal";var o="htJustify";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false},{name:d},{key:f+":top",name:function p(){var e=this;var t="Top";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htTop")!==-1){return true}});if(r){t=u(t)}return t},callback:function v(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="vertical";var o="htTop";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false},{key:f+":middle",name:function g(){var e=this;var t="Middle";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htMiddle")!==-1){return true}});if(r){t=u(t)}return t},callback:function w(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="vertical";var o="htMiddle";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false},{key:f+":bottom",name:function b(){var e=this;var t="Bottom";var r=l(this.getSelectedRange(),function(t,r){var n=e.getCellMeta(t,r).className;if(n&&n.indexOf("htBottom")!==-1){return true}});if(r){t=u(t)}return t},callback:function y(){var e=this;var t=this.getSelectedRange();var r=s(t,function(t,r){return e.getCellMeta(t,r).className});var n="vertical";var o="htBottom";this.runHooks("beforeCellAlignment",r,t,n,o);a(t,n,o,function(t,r){return e.getCellMeta(t,r)},function(t,r,n,o){return e.setCellMeta(t,r,n,o)});this.render()},disabled:false}]}}}},{separator:87,utils:89}],78:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},clearColumnItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="clear_column";function a(){return{key:i,name:"Clear column",callback:function e(t,r){var n=r.start.col;if(this.countRows()){this.populateFromArray(0,n,[[null]],Math.max(r.start.row,r.end.row),n,"ContextMenu.clearColumn")}},disabled:function t(){var e=o(this);if(!e){return true}var t=[e[0],0,e[0],this.countCols()-1];var r=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||r}}}},{utils:89}],79:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},columnLeftItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="col_left";function a(){return{key:i,name:"Insert column on the left",callback:function e(t,r){this.alter("insert_col",r.start.col,1,"ContextMenu.columnLeft")},disabled:function t(){var e=o(this);if(!e){return true}if(!this.isColumnModificationAllowed()){return true}var t=[e[0],0,e[0],this.countCols()-1];var r=t.join(",")==e.join(",");var n=this.countCols()===1;return e[1]<0||this.countCols()>=this.getSettings().maxCols||!n&&r},hidden:function r(){return!this.getSettings().allowInsertColumn}}}},{utils:89}],80:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},columnRightItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="col_right";function a(){return{key:i,name:"Insert column on the right",callback:function e(t,r){this.alter("insert_col",r.end.col+1,1,"ContextMenu.columnRight")},disabled:function t(){var e=o(this);if(!e){return true}if(!this.isColumnModificationAllowed()){return true}var t=[e[0],0,e[0],this.countCols()-1];var r=t.join(",")==e.join(",");var n=this.countCols()===1;return e[1]<0||this.countCols()>=this.getSettings().maxCols||!n&&r},hidden:function r(){return!this.getSettings().allowInsertColumn}}}},{utils:89}],81:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function u(){return s}},readOnlyItem:{get:function d(){return l}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}),i=o.checkSelectionConsistency,a=o.markLabelAsSelected;var s="make_read_only";function l(){return{key:s,name:function e(){var e=this;var t="Read only";var r=i(this.getSelectedRange(),function(t,r){return e.getCellMeta(t,r).readOnly});if(r){t=a(t)}return t},callback:function t(){var e=this;var t=this.getSelectedRange();var r=i(t,function(t,r){return e.getCellMeta(t,r).readOnly});t.forAll(function(t,n){e.setCellMeta(t,n,"readOnly",r?false:true)});this.render()},disabled:function r(){return this.getSelectedRange()&&!this.selection.selectedHeader.corner?false:true}}}},{utils:89}],82:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function i(){return n}},redoItem:{get:function a(){return o}},__esModule:{value:true}});var n="redo";function o(){return{key:n,name:"Redo",callback:function e(){this.redo()},disabled:function t(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},{}],83:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},removeColumnItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="remove_col";function a(){return{key:i,name:"Remove column",callback:function e(t,r){var n=r.end.col-r.start.col+1;this.alter("remove_col",r.start.col,n,"ContextMenu.removeColumn")},disabled:function t(){var e=o(this);var t=this.countCols();return!e||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!t},hidden:function r(){return!this.getSettings().allowRemoveColumn}}}},{utils:89}],84:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},removeRowItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="remove_row";function a(){return{key:i,name:"Remove row",callback:function e(t,r){var n=r.end.row-r.start.row+1;this.alter("remove_row",r.start.row,n,"ContextMenu.removeRow")},disabled:function t(){var e=o(this);var t=this.countRows();return!e||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!t},hidden:function r(){return!this.getSettings().allowRemoveRow}}}},{utils:89}],85:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},rowAboveItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="row_above";function a(){return{key:i,name:"Insert row above",callback:function e(t,r){this.alter("insert_row",r.start.row,1,"ContextMenu.rowAbove")},disabled:function t(){var e=o(this);return!e||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function r(){return!this.getSettings().allowInsertRow}}}},{utils:89}],86:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function s(){return i}},rowBelowItem:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("utils"),n&&n.__esModule&&n||{"default":n}).getValidSelection;var i="row_below";function a(){return{key:i,name:"Insert row below",callback:function e(t,r){this.alter("insert_row",r.end.row+1,1,"ContextMenu.rowBelow")},disabled:function t(){var e=o(this);return!e||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function r(){return!this.getSettings().allowInsertRow}}}},{utils:89}],87:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function i(){return n}},separatorItem:{get:function a(){return o}},__esModule:{value:true}});var n="---------";function o(){return{name:n}}},{}],88:[function(e,t,r){"use strict";Object.defineProperties(r,{KEY:{get:function i(){return n}},undoItem:{get:function a(){return o}},__esModule:{value:true}});var n="undo";function o(){return{key:n,name:"Undo",callback:function e(){this.undo()},disabled:function t(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}},{}],89:[function(e,t,r){"use strict";Object.defineProperties(r,{normalizeSelection:{get:function O(){return u}},isSeparator:{get:function T(){return d}},hasSubMenu:{get:function A(){return f}},isDisabled:{get:function N(){return c}},isSelectionDisabled:{get:function D(){return h}},getValidSelection:{get:function k(){return m}},prepareVerticalAlignClass:{get:function x(){return p}},prepareHorizontalAlignClass:{get:function I(){return v}},getAlignmentClasses:{get:function P(){return g}},align:{get:function L(){return w}},checkSelectionConsistency:{get:function H(){return y}},markLabelAsSelected:{get:function V(){return C}},isItemHidden:{get:function F(){return _}},filterSeparators:{get:function B(){return S}},__esModule:{value:true}});var n,o,i;var a=(n=e("helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).hasClass;var l=(i=e("predefinedItems/separator"),i&&i.__esModule&&i||{"default":i}).KEY;function u(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}}function d(e){return s(e,"htSeparator")}function f(e){return s(e,"htSubmenu")}function c(e){return s(e,"htDisabled")}function h(e){return s(e,"htSelectionDisabled")}function m(e){var t=e.getSelected();if(!t){return null}if(t[0]<0){return null}return t}function p(e,t){if(e.indexOf(t)!=-1){return e}e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");e+=" "+t;return e}function v(e,t){if(e.indexOf(t)!=-1){return e}e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");e+=" "+t;return e}function g(e,t){var r={};for(var n=e.from.row;n<=e.to.row;n++){for(var o=e.from.col;o<=e.to.col;o++){if(!r[n]){r[n]=[]}r[n][o]=t(n,o)}}return r}function w(e,t,r,n,o){if(e.from.row==e.to.row&&e.from.col==e.to.col){b(e.from.row,e.from.col,t,r,n,o)}else{for(var i=e.from.row;i<=e.to.row;i++){for(var a=e.from.col;a<=e.to.col;a++){b(i,a,t,r,n,o)}}}}function b(e,t,r,n,o,i){var a=o(e,t);var s=n;if(a.className){if(r==="vertical"){s=p(a.className,n)}else{s=v(a.className,n)}}i(e,t,"className",s)}function y(e,t){var r=false;if(e){e.forAll(function(e,n){if(t(e,n)){r=true;return false}})}return r}function C(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e}function _(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function E(e,t){var r=e.slice(0);for(var n=0;n<r.length;){if(r[n].name===t){r.shift()}else{break}}return r}function R(e,t){var r=e.slice(0);r.reverse();r=E(r,t);r.reverse();return r}function M(e){var t=[];a(e,function(e,r){if(r>0){if(t[t.length-1].name!==e.name){t.push(e)}}else{t.push(e)}});return t}function S(e){var t=arguments[1]!==void 0?arguments[1]:l;var r=e.slice(0);r=E(r,t);r=R(r,t);r=M(r);return r}},{"helpers/array":43,"helpers/dom/element":47,"predefinedItems/separator":87}],90:[function(e,t,r){"use strict";Object.defineProperties(r,{ContextMenuCopyPaste:{get:function b(){return g}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).default;var f=(o=e("zeroclipboard"),o&&o.__esModule&&o||{"default":o}).default;var c=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}).removeClass;var h=(a=e("helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var m=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager;var p=(l=e("plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var v=(u=e("contextMenu/predefinedItems"),u&&u.__esModule&&u||{"default":u}).SEPARATOR;var g=function y(e){$traceurRuntime.superConstructor(w).call(this,e);this.eventManager=new m(this);this.swfPath=null;this.outsideClickDeselectsCache=null};var w=g;$traceurRuntime.createClass(g,{isEnabled:function C(){return this.hot.getSettings().contextMenuCopyPaste},enablePlugin:function _(){var e=this;if(this.enabled){return}if(_typeof(this.hot.getSettings().contextMenuCopyPaste)==="object"){this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath}if(typeof f==="undefined"){console.error("To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.")}try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(t){if(typeof navigator.mimeTypes["application/x-shockwave-flash"]=="undefined"){console.error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}}if(this.swfPath){f.config({swfPath:this.swfPath})}this.hot.addHook("afterContextMenuShow",function(){return e.onAfterContextMenuShow()});this.hot.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)});this.registerEvents();$traceurRuntime.superGet(this,w.prototype,"enablePlugin").call(this)},disablePlugin:function E(){$traceurRuntime.superGet(this,w.prototype,"disablePlugin").call(this)},registerEvents:function R(){var e=this;this.eventManager.addEventListener(document,"mouseenter",function(){return e.removeCurrentClass()});this.eventManager.addEventListener(document,"mouseleave",function(){return e.removeZeroClipboardClass()})},getCopyValue:function M(){this.hot.copyPaste.setCopyableText();this.hot.copyPaste.copyPasteInstance.triggerCopy();return this.hot.copyPaste.copyPasteInstance.elTextarea.value},onAfterContextMenuDefaultOptions:function S(e){e.items.unshift({key:"copy",name:"Copy",disabled:function t(){return this.selection.selectedHeader.corner}},{key:"paste",name:"Paste",callback:function r(){this.copyPaste.triggerPaste()},disabled:function n(){return this.selection.selectedHeader.corner}},{name:v})},onAfterContextMenuShow:function O(){var e=this;var t=this.hot.getPlugin("contextMenu");var r=t.menu.hotMenu.getSourceData();h(r,function(r,n){if(r.key==="copy"){var o=new f(t.menu.hotMenu.getCell(n,0));o.off();o.on("copy",function(t){var r=t.clipboardData;r.setData("text/plain",e.getCopyValue());e.hot.getSettings().outsideClickDeselects=e.outsideClickDeselectsCache});return false}})},removeCurrentClass:function T(){var e=this.hot.getPlugin("contextMenu");if(!e.enabled){return}if(e.menu.isOpened()){var t=e.menu.hotMenu.rootElement.querySelector("td.current");if(t){c(t,"current")}}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=false},removeZeroClipboardClass:function A(){var e=this.hot.getPlugin("contextMenu");if(!e.enabled){return}if(e.menu.isOpened()){var t=e.menu.hotMenu.rootElement.querySelector("td.zeroclipboard-is-hover");if(t){c(t,"zeroclipboard-is-hover")}}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache}},{},d);p("contextMenuCopyPaste",g)},{_base:63,"contextMenu/predefinedItems":76,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,zeroclipboard:"zeroclipboard"}],91:[function(e,t,r){"use strict";Object.defineProperties(r,{CopyPastePlugin:{get:function D(){return A}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h;var m=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var p=(o=e("copyPaste"),o&&o.__esModule&&o||{"default":o}).default;var v=(i=e("SheetClip"),i&&i.__esModule&&i||{"default":i}).default;var g=(a=e("helpers/unicode"),a&&a.__esModule&&a||{"default":a}),w=g.KEY_CODES,b=g.isCtrlKey;var y=(s=e("helpers/array"),s&&s.__esModule&&s||{"default":s}).arrayEach;var C=(l=e("helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach;var _=(u=e("helpers/dom/event"),
u&&u.__esModule&&u||{"default":u}),E=_.stopImmediatePropagation,R=_.isImmediatePropagationStopped;var M=(d=e("helpers/dom/element"),d&&d.__esModule&&d||{"default":d}).getSelectionText;var S=(f=e("helpers/function"),f&&f.__esModule&&f||{"default":f}).proxy;var O=(c=e("3rdparty/walkontable/src/cell/coords"),c&&c.__esModule&&c||{"default":c}).WalkontableCellCoords;var T=(h=e("3rdparty/walkontable/src/cell/range"),h&&h.__esModule&&h||{"default":h}).WalkontableCellRange;function A(e){var t=this;this.copyPasteInstance=p();this.copyPasteInstance.onCut(r);this.copyPasteInstance.triggerCopy=o;this.copyPasteInstance.onPaste(i);this.onPaste=i;this.copyableRanges=[];e.addHook("beforeKeyDown",a);function r(){if(!e.isListening()){return}}function n(){var r=t.getRangedData(t.copyableRanges);if(e.getSettings().fragmentSelection&&v.stringify(r)!=M()){return}var n=!!e.runHooks("beforeCut",r,t.copyableRanges);if(n){e.copyPaste.copyPasteInstance.copyable(v.stringify(r));e.selection.empty();e.runHooks("afterCut",r,t.copyableRanges)}else{e.copyPaste.copyPasteInstance.copyable("")}}function o(){if(!e.isListening()){return}var r=t.getRangedData(t.copyableRanges);if(e.getSettings().fragmentSelection&&v.stringify(r)!=M()){return}var n=!!e.runHooks("beforeCopy",r,t.copyableRanges);if(n){e.copyPaste.copyPasteInstance.copyable(v.stringify(r));e.runHooks("afterCopy",r,t.copyableRanges)}else{e.copyPaste.copyPasteInstance.copyable("")}}function i(r){var n,o,i,a,s,l,u,d,f,c;if(!e.isListening()||!e.selection.isSelected()){return}n=r;o=v.parse(n);i=e.getSelected();a=new O(i[0],i[1]);s=new O(i[2],i[3]);l=new T(a,a,s);u=l.getTopLeftCorner();d=l.getBottomRightCorner();f=u;c=new O(Math.max(d.row,o.length-1+u.row),Math.max(d.col,o[0].length-1+u.col));var h=s.row-a.row>=o.length-1;var m=s.col-a.col>=o[0].length-1;e.addHookOnce("afterChange",function(t,r){var n=t?t.length:0;if(n){var o={row:0,col:0};var i=-1;y(t,function(e,r){var a=n>r+1?t[r+1]:null;if(a){if(!h){o.row=o.row+Math.max(a[0]-e[0]-1,0)}if(!m&&e[1]>i){i=e[1];o.col=o.col+Math.max(a[1]-e[1]-1,0)}}});e.selectCell(f.row,f.col,c.row+o.row,c.col+o.col)}});var p=!!e.runHooks("beforePaste",o,t.copyableRanges);if(p){e.populateFromArray(f.row,f.col,o,c.row,c.col,"CopyPaste.paste",e.getSettings().pasteMode);e.runHooks("afterPaste",o,t.copyableRanges)}}function a(r){if(!e.getSelected()){return}if(e.getActiveEditor()&&e.getActiveEditor().isOpened()){return}if(R(r)){return}if(b(r.keyCode)){if(e.getSettings().fragmentSelection&&M()){return}t.setCopyableText();E(r);return}var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if(i){if(r.keyCode==w.A){e._registerTimeout(setTimeout(S(t.setCopyableText,t),0))}if(r.keyCode==w.X){n()}if(r.keyCode==w.C){o()}}}this.destroy=function(){if(this.copyPasteInstance){this.copyPasteInstance.removeCallback(r);this.copyPasteInstance.removeCallback(i);this.copyPasteInstance.destroy();this.copyPasteInstance=null}e.removeHook("beforeKeyDown",a)};e.addHook("afterDestroy",S(this.destroy,this));this.triggerPaste=S(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=S(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var t=e.getSettings();var r=t.copyRowsLimit;var n=t.copyColsLimit;var o=e.getSelectedRange();var i=o.getTopLeftCorner();var a=o.getBottomRightCorner();var s=i.row;var l=i.col;var u=a.row;var d=a.col;var f=Math.min(u,s+r-1);var c=Math.min(d,l+n-1);this.copyableRanges.length=0;this.copyableRanges.push({startRow:s,startCol:l,endRow:f,endCol:c});this.copyableRanges=e.runHooks("modifyCopyableRange",this.copyableRanges);var h=this.getRangedCopyableData(this.copyableRanges);e.copyPaste.copyPasteInstance.copyable(h);if(u!==f||d!==c){m.hooks.run(e,"afterCopyLimit",u-s+1,d-l+1,r,n)}};this.getRangedCopyableData=function(t){var r=[];var n=[];var o=[];y(t,function(e){C(e.startRow,e.endRow,function(e){if(n.indexOf(e)===-1){n.push(e)}});C(e.startCol,e.endCol,function(e){if(o.indexOf(e)===-1){o.push(e)}})});y(n,function(t){var n=[];y(o,function(r){n.push(e.getCopyableData(t,r))});r.push(n)});return v.stringify(r)};this.getRangedData=function(t){var r=[];var n=[];var o=[];y(t,function(e){C(e.startRow,e.endRow,function(e){if(n.indexOf(e)===-1){n.push(e)}});C(e.startCol,e.endCol,function(e){if(o.indexOf(e)===-1){o.push(e)}})});y(n,function(t){var n=[];y(o,function(r){n.push(e.getCopyableData(t,r))});r.push(n)});return r}}function N(){var e=this,t=e.getSettings().copyPaste!==false;if(t&&!e.copyPaste){e.copyPaste=new A(e)}else if(!t&&e.copyPaste){e.copyPaste.destroy();e.copyPaste=null}}m.hooks.add("afterInit",N);m.hooks.add("afterUpdateSettings",N);m.hooks.register("afterCopyLimit");m.hooks.register("modifyCopyableRange");m.hooks.register("beforeCut");m.hooks.register("afterCut");m.hooks.register("beforePaste");m.hooks.register("afterPaste");m.hooks.register("beforeCopy");m.hooks.register("afterCopy")},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,SheetClip:"SheetClip",browser:24,copyPaste:"copyPaste","helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/number":52,"helpers/unicode":56}],92:[function(e,t,r){"use strict";var n,o,i,a;var s=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin;var u=(i=e("3rdparty/walkontable/src/cell/range"),i&&i.__esModule&&i||{"default":i}).WalkontableCellRange;var d=(a=e("3rdparty/walkontable/src/selection"),a&&a.__esModule&&a||{"default":a}).WalkontableSelection;function f(){}var c;var h=function k(e){if(typeof e==="boolean"){if(e===true){return true}}if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){if(e.length>0){return true}}return false};var m=function x(){if(h(this.getSettings().customBorders)){if(!this.customBorders){c=this;this.customBorders=new f}}};var p=function I(e){for(var t=0;t<c.view.wt.selections.length;t++){if(c.view.wt.selections[t].settings.className==e){return t}}return-1};var v=function P(e){var t={row:e.row,col:e.col};var r=new d(e,new u(t,t,t));var n=p(e.className);if(n>=0){c.view.wt.selections[n]=r}else{c.view.wt.selections.push(r)}};var g=function L(e,t,r){var n=E(e,t);n=R(n,r);this.setCellMeta(e,t,"borders",n);v(n)};var w=function H(e){var t=e.range;for(var r=t.from.row;r<=t.to.row;r++){for(var n=t.from.col;n<=t.to.col;n++){var o=E(r,n);var i=0;if(r==t.from.row){i++;if(e.hasOwnProperty("top")){o.top=e.top}}if(r==t.to.row){i++;if(e.hasOwnProperty("bottom")){o.bottom=e.bottom}}if(n==t.from.col){i++;if(e.hasOwnProperty("left")){o.left=e.left}}if(n==t.to.col){i++;if(e.hasOwnProperty("right")){o.right=e.right}}if(i>0){this.setCellMeta(r,n,"borders",o);v(o)}}}};var b=function V(e,t){return"border_row"+e+"col"+t};var y=function F(){return{width:1,color:"#000"}};var C=function B(){return{hide:true}};var _=function j(){return{width:1,color:"#000",cornerVisible:false}};var E=function W(e,t){return{className:b(e,t),border:_(),row:e,col:t,top:C(),right:C(),bottom:C(),left:C()}};var R=function $(e,t){if(t.hasOwnProperty("border")){e.border=t.border}if(t.hasOwnProperty("top")){e.top=t.top}if(t.hasOwnProperty("right")){e.right=t.right}if(t.hasOwnProperty("bottom")){e.bottom=t.bottom}if(t.hasOwnProperty("left")){e.left=t.left}return e};var M=function U(e){var t=document.querySelectorAll("."+e);for(var r=0;r<t.length;r++){if(t[r]){if(t[r].nodeName!="TD"){var n=t[r].parentNode;if(n.parentNode){n.parentNode.removeChild(n)}}}}};var S=function G(e,t){var r=b(e,t);M(r);this.removeCellMeta(e,t,"borders")};var O=function Y(e,t,r,n){var o=this.getCellMeta(e,t).borders;if(!o||o.border==undefined){o=E(e,t)}if(n){o[r]=C()}else{o[r]=y()}this.setCellMeta(e,t,"borders",o);var i=b(e,t);M(i);v(o);this.render()};var T=function z(e,t,r){if(e.from.row==e.to.row&&e.from.col==e.to.col){if(t=="noBorders"){S.call(this,e.from.row,e.from.col)}else{O.call(this,e.from.row,e.from.col,t,r)}}else{switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++){for(var o=e.from.row;o<=e.to.row;o++){S.call(this,o,n)}}break;case"top":for(var i=e.from.col;i<=e.to.col;i++){O.call(this,e.from.row,i,t,r)}break;case"right":for(var a=e.from.row;a<=e.to.row;a++){O.call(this,a,e.to.col,t)}break;case"bottom":for(var s=e.from.col;s<=e.to.col;s++){O.call(this,e.to.row,s,t)}break;case"left":for(var l=e.from.row;l<=e.to.row;l++){O.call(this,l,e.from.col,t)}break}}};var A=function K(e,t){var r=false;e.getSelectedRange().forAll(function(n,o){var i=e.getCellMeta(n,o).borders;if(i){if(t){if(!i[t].hasOwnProperty("hide")){r=true;return false}}else{r=true;return false}}});return r};var N=function q(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e};var D=function X(e){if(!this.getSettings().customBorders){return}e.items.push(s.plugins.ContextMenu.SEPARATOR);e.items.push({key:"borders",name:"Borders",disabled:function t(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function r(){var e="Top";var t=A(this,"top");if(t){e=N(e)}return e},callback:function n(){var e=A(this,"top");T.call(this,this.getSelectedRange(),"top",e)}},{key:"borders:right",name:function o(){var e="Right";var t=A(this,"right");if(t){e=N(e)}return e},callback:function i(){var e=A(this,"right");T.call(this,this.getSelectedRange(),"right",e)}},{key:"borders:bottom",name:function a(){var e="Bottom";var t=A(this,"bottom");if(t){e=N(e)}return e},callback:function l(){var e=A(this,"bottom");T.call(this,this.getSelectedRange(),"bottom",e)}},{key:"borders:left",name:function u(){var e="Left";var t=A(this,"left");if(t){e=N(e)}return e},callback:function d(){var e=A(this,"left");T.call(this,this.getSelectedRange(),"left",e)}},{key:"borders:no_borders",name:"Remove border(s)",callback:function f(){T.call(this,this.getSelectedRange(),"noBorders")},disabled:function c(){return!A(this)}}]}})};s.hooks.add("beforeInit",m);s.hooks.add("afterContextMenuDefaultOptions",D);s.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++){if(e[t].range){w.call(this,e[t])}else{g.call(this,e[t].row,e[t].col,e[t])}}this.render();this.view.wt.draw(true)}});s.CustomBorders=f},{"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/selection":19,browser:24,plugins:62}],93:[function(e,t,r){"use strict";Object.defineProperties(r,{DragToScroll:{get:function h(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("eventManager"),o&&o.__esModule&&o||{"default":o}).eventManager;var l=(i=e("plugins"),i&&i.__esModule&&i||{"default":i}).registerPlugin;a.plugins.DragToScroll=u;function u(){this.boundaries=null;this.callback=null}u.prototype.setBoundaries=function(e){this.boundaries=e};u.prototype.setCallback=function(e){this.callback=e};u.prototype.check=function(e,t){var r=0;var n=0;if(t<this.boundaries.top){n=t-this.boundaries.top}else if(t>this.boundaries.bottom){n=t-this.boundaries.bottom}if(e<this.boundaries.left){r=e-this.boundaries.left}else if(e>this.boundaries.right){r=e-this.boundaries.right}this.callback(r,n)};var d;var f;var c=function m(e){e.dragToScrollListening=false;var t=e.view.wt.wtTable.holder;d=new u;if(t===window){return}else{d.setBoundaries(t.getBoundingClientRect())}d.setCallback(function(e,r){if(e<0){t.scrollLeft-=50}else if(e>0){t.scrollLeft+=50}if(r<0){t.scrollTop-=20}else if(r>0){t.scrollTop+=20}});e.dragToScrollListening=true};a.hooks.add("afterInit",function(){var e=this;var t=s(this);t.addEventListener(document,"mouseup",function(){e.dragToScrollListening=false});t.addEventListener(document,"mousemove",function(t){if(e.dragToScrollListening){d.check(t.clientX,t.clientY)}})});a.hooks.add("afterDestroy",function(){s(this).clear()});a.hooks.add("afterOnCellMouseDown",function(){c(this)});a.hooks.add("afterOnCellCornerMouseDown",function(){c(this)});a.plugins.DragToScroll=u},{browser:24,eventManager:42,plugins:62}],94:[function(e,t,r){"use strict";Object.defineProperties(r,{freezeColumnItem:{get:function o(){return n}},__esModule:{value:true}});function n(e){return{key:"freeze_column",name:"Freeze this column",callback:function t(){var t=this.getSelectedRange().from.col;e.freezeColumn(t);this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},hidden:function r(){var e=this.getSelectedRange();var t=false;if(e===void 0){t=true}else if(e.from.col!==e.to.col||e.from.col<=this.getSettings().fixedColumnsLeft-1){t=true}return t}}}},{}],95:[function(e,t,r){"use strict";Object.defineProperties(r,{unfreezeColumnItem:{get:function o(){return n}},__esModule:{value:true}});function n(e){return{key:"unfreeze_column",name:"Unfreeze this column",callback:function t(){var t=this.getSelectedRange().from.col;e.unfreezeColumn(t);this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},hidden:function r(){var e=this.getSelectedRange();var t=false;if(e===void 0){t=true}else if(e.from.col!==e.to.col||e.from.col>=this.getSettings().fixedColumnsLeft){t=true}return t}}}},{}],96:[function(e,t,r){"use strict";Object.defineProperties(r,{ManualColumnFreeze:{get:function w(){return v}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).default;var f=(i=e("plugins"),i&&i.__esModule&&i||{"default":i}).registerPlugin;var c=(a=e("helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var h=(s=e("contextMenuItem/freezeColumn"),s&&s.__esModule&&s||{"default":s}).freezeColumnItem;var m=(l=e("contextMenuItem/unfreezeColumn"),l&&l.__esModule&&l||{"default":l}).unfreezeColumnItem;var p=new WeakMap;var v=function b(e){$traceurRuntime.superConstructor(g).call(this,e);p.set(this,{moveByFreeze:false,afterFirstUse:false});this.frozenColumnsBasePositions=[];this.manualColumnMovePlugin=void 0};var g=v;$traceurRuntime.createClass(v,{isEnabled:function y(){return!!this.hot.getSettings().manualColumnFreeze},enablePlugin:function C(){var e=this;if(this.enabled){return}this.addHook("afterContextMenuDefaultOptions",function(t){return e.addContextMenuEntry(t)});this.addHook("afterInit",function(){return e.onAfterInit()});this.addHook("beforeColumnMove",function(t,r){return e.onBeforeColumnMove(t,r)});$traceurRuntime.superGet(this,g.prototype,"enablePlugin").call(this)},disablePlugin:function _(){var e=p.get(this);e.afterFirstUse=false;e.moveByFreeze=false;$traceurRuntime.superGet(this,g.prototype,"disablePlugin").call(this)},updatePlugin:function E(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,g.prototype,"updatePlugin").call(this)},freezeColumn:function R(e){var t=p.get(this);var r=this.hot.getSettings();if(!t.afterFirstUse){t.afterFirstUse=true}if(r.fixedColumnsLeft===this.hot.countCols()||e<=r.fixedColumnsLeft-1){return}t.moveByFreeze=true;if(e!==this.getMovePlugin().columnsMapper.getValueByIndex(e)){this.frozenColumnsBasePositions[r.fixedColumnsLeft]=e}this.getMovePlugin().moveColumn(e,r.fixedColumnsLeft++)},unfreezeColumn:function M(e){var t=p.get(this);var r=this.hot.getSettings();if(!t.afterFirstUse){t.afterFirstUse=true}if(r.fixedColumnsLeft<=0||e>r.fixedColumnsLeft-1){return}var n=this.getBestColumnReturnPosition(e);t.moveByFreeze=true;r.fixedColumnsLeft--;this.getMovePlugin().moveColumn(e,n+1)},getMovePlugin:function S(){if(!this.manualColumnMovePlugin){this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")}return this.manualColumnMovePlugin},getBestColumnReturnPosition:function O(e){var t=this.getMovePlugin();var r=this.hot.getSettings();var n=r.fixedColumnsLeft;var o=t.columnsMapper.getValueByIndex(n);var i;if(this.frozenColumnsBasePositions[e]==null){i=t.columnsMapper.getValueByIndex(e);while(o<i){n++;o=t.columnsMapper.getValueByIndex(n)}}else{i=this.frozenColumnsBasePositions[e];this.frozenColumnsBasePositions[e]=void 0;while(o<=i){n++;o=t.columnsMapper.getValueByIndex(n)}n=o}return n-1},addContextMenuEntry:function T(e){e.items.push(u.plugins.ContextMenu.SEPARATOR,h(this),m(this))},onAfterInit:function A(){if(!this.getMovePlugin().isEnabled()){this.getMovePlugin().enablePlugin()}},onBeforeColumnMove:function N(e,t){var r=p.get(this);if(r.afterFirstUse&&!r.moveByFreeze){var n=this.hot.getSettings().fixedColumnsLeft;var o=t<n;if(!o){c(e,function(e,t,r){if(e<n){o=true;return false}})}if(o){return false}}if(r.moveByFreeze){r.moveByFreeze=false}},destroy:function D(){$traceurRuntime.superGet(this,g.prototype,"destroy").call(this)}},{},d);f("manualColumnFreeze",v)},{_base:63,browser:24,"contextMenuItem/freezeColumn":94,"contextMenuItem/unfreezeColumn":95,"helpers/array":43,plugins:62}],97:[function(e,t,r){"use strict";Object.defineProperties(r,{ColumnsMapper:{get:function m(){return h}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("mixins/arrayMapper"),o&&o.__esModule&&o||{"default":o}).arrayMapper;var d=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayFilter;var f=(a=e("helpers/object"),a&&a.__esModule&&a||{"default":a}).mixin;var c=(s=e("helpers/number"),s&&s.__esModule&&s||{"default":s}).rangeEach;var h=function p(e){this.manualColumnMove=e};$traceurRuntime.createClass(h,{createMap:function v(e){var t=this;var r=e===void 0?this._arrayMap.length:e;this._arrayMap.length=0;c(r-1,function(e){t._arrayMap[e]=e})},destroy:function g(){this._arrayMap=null},moveColumn:function w(e,t){var r=this._arrayMap[e];this._arrayMap[e]=null;this._arrayMap.splice(t,0,r)},clearNull:function b(){this._arrayMap=d(this._arrayMap,function(e){return e!==null})}},{});f(h,u);l.utils.ManualColumnMoveColumnsMapper=h},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],98:[function(e,t,r){"use strict";Object.defineProperties(r,{ManualColumnMove:{get:function x(){return D}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c;var h=(n=e("_base.js"),n&&n.__esModule&&n||{"default":n}).default;var m=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var p=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var v=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}),g=v.addClass,w=v.removeClass,b=v.offset;var y=(s=e("helpers/number"),s&&s.__esModule&&s||{"default":s}).rangeEach;var C=(l=e("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager;var _=(u=e("plugins"),u&&u.__esModule&&u||{"default":u}).registerPlugin;var E=(d=e("columnsMapper"),d&&d.__esModule&&d||{"default":d}).ColumnsMapper;var R=(f=e("ui/backlight"),f&&f.__esModule&&f||{"default":f}).BacklightUI;var M=(c=e("ui/guideline"),c&&c.__esModule&&c||{"default":c}).GuidelineUI;var S=new WeakMap;var O="ht__manualColumnMove";var T="show-ui";var A="on-moving--columns";var N="after-selection--columns";var D=function I(e){$traceurRuntime.superConstructor(k).call(this,e);S.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}});this.removedColumns=[];this.columnsMapper=new E(this);this.eventManager=C(this);this.backlight=new R(e);this.guideline=new M(e)};var k=D;$traceurRuntime.createClass(D,{isEnabled:function P(){return!!this.hot.getSettings().manualColumnMove},enablePlugin:function L(){var e=this;if(this.enabled){return}this.addHook("beforeOnCellMouseDown",function(t,r,n,o){return e.onBeforeOnCellMouseDown(t,r,n,o)});this.addHook("beforeOnCellMouseOver",function(t,r,n,o){return e.onBeforeOnCellMouseOver(t,r,n,o)});this.addHook("afterScrollVertically",function(){return e.onAfterScrollVertically()});this.addHook("modifyCol",function(t,r){return e.onModifyCol(t,r)});this.addHook("beforeRemoveCol",function(t,r){return e.onBeforeRemoveCol(t,r)});this.addHook("afterRemoveCol",function(t,r){return e.onAfterRemoveCol(t,r)});this.addHook("afterCreateCol",function(t,r){return e.onAfterCreateCol(t,r)});this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)});this.addHook("unmodifyCol",function(t){return e.onUnmodifyCol(t)});this.registerEvents();g(this.hot.rootElement,O);$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this)},updatePlugin:function H(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,k.prototype,"updatePlugin").call(this)},disablePlugin:function V(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e)){this.columnsMapper.clearMap()}w(this.hot.rootElement,O);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,k.prototype,"disablePlugin").call(this)},moveColumn:function F(e,t){this.moveColumns([e],t)},moveColumns:function B(e,t){var r=this;var n=S.get(this);var o=this.hot.runHooks("beforeColumnMove",e,t);n.disallowMoving=!o;if(o!==false){p(e,function(e,t,n){n[t]=r.columnsMapper.getValueByIndex(e)});p(e,function(e,n){var o=r.columnsMapper.getIndexByValue(e);if(o!==t){r.columnsMapper.moveColumn(o,t+n)}});this.columnsMapper.clearNull()}this.hot.runHooks("afterColumnMove",e,t)},changeSelection:function j(e,t){var r=this.hot.selection;var n=this.hot.countRows()-1;r.setRangeStartOnly(new WalkontableCellCoords(0,e));r.setRangeEnd(new WalkontableCellCoords(n,t),false)},getColumnsWidth:function W(e,t){var r=0;for(var n=e;n<t;n++){var o=0;if(n<0){o=this.hot.view.wt.wtTable.getColumnWidth(n)||0}else{o=this.hot.view.wt.wtTable.getStretchedColumnWidth(n)||0}r+=o}return r},initialSettings:function $(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e)){this.moveColumns(e,0)}else if(e!==void 0){this.persistentStateLoad()}},isFixedColumnsLeft:function U(e){return e<this.hot.getSettings().fixedColumnsLeft},persistentStateSave:function G(){m.hooks.run(this.hot,"persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)},persistentStateLoad:function Y(){var e={};m.hooks.run(this.hot,"persistentStateLoad","manualColumnMove",e);if(e.value){this.columnsMapper._arrayMap=e.value}},prepareColumnsToMoving:function z(e,t){var r=[];y(e,t,function(e){r.push(e)});return r},refreshPositions:function K(){var e=S.get(this);var t=this.hot.view.wt.wtTable.getFirstVisibleColumn();var r=this.hot.view.wt.wtTable.getLastVisibleColumn();var n=this.hot.view.wt.wtTable;var o=this.hot.view.wt.wtOverlays.scrollableElement;var i=typeof o.scrollX==="number"?o.scrollX:o.scrollLeft;var a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.coordsColumn);var s=e.target.eventPageX-(e.rootElementOffset-(o.scrollX===void 0?i:0));var l=n.hider.offsetWidth;var u=n.TBODY.offsetLeft;var d=this.backlight.getOffset().left;var f=this.backlight.getSize().width;var c=0;if(e.rootElementOffset+n.holder.offsetWidth+i<e.target.eventPageX){if(e.coordsColumn<e.countCols){e.coordsColumn++}}if(e.hasRowHeaders){c=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth}if(this.isFixedColumnsLeft(e.coordsColumn)){a+=i}a+=c;if(e.coordsColumn<0){if(e.fixedColumns>0){e.target.col=0}else{e.target.col=t>0?t-1:t}}else if(e.target.TD.offsetWidth/2+a<=s){var h=e.coordsColumn>=e.countCols?e.countCols-1:e.coordsColumn;e.target.col=h+1;a+=e.target.TD.offsetWidth;if(e.target.col>r){this.hot.scrollViewportTo(void 0,r+1,void 0,true)}}else{e.target.col=e.coordsColumn;if(e.target.col<=t&&e.target.col>=e.fixedColumns){this.hot.scrollViewportTo(void 0,t-1)}}if(e.target.col<=t&&e.target.col>=e.fixedColumns){this.hot.scrollViewportTo(void 0,t-1)}var m=s;var p=a;if(s+f+d>=l){m=l-f-d}else if(s+d<u+c){m=u+c+Math.abs(d)}if(a>=l-1){p=l-1}else if(p===0){p=1}else if(o.scrollX!==void 0&&e.coordsColumn<e.fixedColumns){p=p-(e.rootElementOffset<=o.scrollX?e.rootElementOffset:0)}this.backlight.setPosition(null,m);this.guideline.setPosition(null,p)},updateColumnsMapper:function q(){var e=this.hot.countSourceCols();var t=this.columnsMapper._arrayMap.length;if(t===0){this.columnsMapper.createMap(e||this.hot.getSettings().startCols)}else if(t<e){var r=e-t;this.columnsMapper.insertItems(t,r)}else if(t>e){var n=e-1;var o=[];p(this.columnsMapper._arrayMap,function(e,t,r){if(e>n){o.push(t)}});this.columnsMapper.removeItems(o)}},registerEvents:function X(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})},unregisterEvents:function J(){this.eventManager.clear()},onBeforeOnCellMouseDown:function Z(e,t,r,n){var o=this.hot.view.wt.wtTable;var i=this.hot.selection.selectedHeader.cols;var a=this.hot.getSelectedRange();var s=S.get(this);var l=e.realTarget.className.indexOf("columnSorting")>-1;if(!a||!i||s.pressed||e.button!==0||l){s.pressed=false;s.columnsToMove.length=0;w(this.hot.rootElement,[A,T]);return}var u=this.guideline.isBuilt()&&!this.guideline.isAppended();var d=this.backlight.isBuilt()&&!this.backlight.isAppended();if(u&&d){this.guideline.appendTo(o.hider);this.backlight.appendTo(o.hider)}var f=a,c=f.from,h=f.to;var m=Math.min(c.col,h.col);var p=Math.max(c.col,h.col);if(t.row<0&&t.col>=m&&t.col<=p){n.column=true;s.pressed=true;s.target.eventPageX=e.pageX;s.coordsColumn=t.col;s.target.TD=r;s.target.col=t.col;s.columnsToMove=this.prepareColumnsToMoving(m,p);s.hasRowHeaders=!!this.hot.getSettings().rowHeaders;s.countCols=this.hot.countCols();s.fixedColumns=this.hot.getSettings().fixedColumnsLeft;s.rootElementOffset=b(this.hot.rootElement).left;var v=s.hasRowHeaders?-1:0;var y=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1;var C=t.col<s.fixedColumns;var _=this.hot.view.wt.wtOverlays.scrollableElement;var E=_.scrollX?_.scrollX-s.rootElementOffset:0;var R=e.layerX-(C?E:0);var M=Math.abs(this.getColumnsWidth(m,t.col)+R);this.backlight.setPosition(y,this.getColumnsWidth(v,m)+M);this.backlight.setSize(this.getColumnsWidth(m,p+1),o.hider.offsetHeight-y);this.backlight.setOffset(null,M*-1);g(this.hot.rootElement,A)}else{w(this.hot.rootElement,N);s.pressed=false;s.columnsToMove.length=0}},onMouseMove:function Q(e){var t=S.get(this);if(!t.pressed){return}if(e.realTarget===this.backlight.element){var r=this.backlight.getSize().width;this.backlight.setSize(0);setTimeout(function(){this.backlight.setPosition(r)})}t.target.eventPageX=e.pageX;this.refreshPositions()},onBeforeOnCellMouseOver:function ee(e,t,r,n){var o=this.hot.getSelectedRange();var i=S.get(this);if(!o||!i.pressed){return}if(i.columnsToMove.indexOf(t.col)>-1){w(this.hot.rootElement,T)}else{g(this.hot.rootElement,T)}n.row=true;n.column=true;n.cell=true;i.coordsColumn=t.col;i.target.TD=r},onMouseUp:function te(){var e=S.get(this);e.coordsColumn=void 0;e.pressed=false;e.backlightWidth=0;w(this.hot.rootElement,[A,T,N]);if(this.hot.selection.selectedHeader.cols){g(this.hot.rootElement,N)}if(e.columnsToMove.length<1||e.target.col===void 0||e.columnsToMove.indexOf(e.target.col)>-1){return}this.moveColumns(e.columnsToMove,e.target.col);this.persistentStateSave();this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize(true);if(!e.disallowMoving){var t=this.columnsMapper.getIndexByValue(e.columnsToMove[0]);var r=this.columnsMapper.getIndexByValue(e.columnsToMove[e.columnsToMove.length-1]);this.changeSelection(t,r)}e.columnsToMove.length=0},onAfterScrollVertically:function re(){var e=this.hot.view.wt.wtTable;var t=e.getColumnHeaderHeight(0)+1;var r=e.holder.scrollTop;var n=t+r;this.backlight.setPosition(n);this.backlight.setSize(null,e.hider.offsetHeight-n)},onAfterCreateCol:function ne(e,t){this.columnsMapper.shiftItems(e,t)},onBeforeRemoveCol:function oe(e,t){var r=this;this.removedColumns.length=0;if(e!==false){y(e,e+t-1,function(e){r.removedColumns.push(r.hot.runHooks("modifyCol",e,r.pluginName))})}},onAfterRemoveCol:function ie(e,t){this.columnsMapper.unshiftItems(this.removedColumns)},onAfterLoadData:function ae(e){this.updateColumnsMapper()},onModifyCol:function se(e,t){if(t!==this.pluginName){var r=this.columnsMapper.getValueByIndex(e);e=r===null?e:r}return e},onUnmodifyCol:function le(e){var t=this.columnsMapper.getIndexByValue(e);return t===null?e:t},onAfterPluginsInitialized:function ue(){this.updateColumnsMapper();this.initialSettings();this.backlight.build();this.guideline.build()},destroy:function de(){this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,k.prototype,"destroy").call(this)}},{},h);_("ManualColumnMove",D);m.hooks.register("beforeColumnMove");m.hooks.register("afterColumnMove");m.hooks.register("unmodifyCol")},{"_base.js":63,browser:24,columnsMapper:97,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,"ui/backlight":100,"ui/guideline":101}],99:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseUI:{get:function d(){return u}},__esModule:{value:true}});var n;var o=(n=e("helpers/number"),n&&n.__esModule&&n||{"default":n}).isNumeric;var i=0;var a=1;var s=2;var l="px";var u=function f(e){this.hot=e;this._element=null;this.state=i};$traceurRuntime.createClass(u,{appendTo:function c(e){e.appendChild(this._element);this.state=s},build:function h(){this._element=document.createElement("div");this.state=a},destroy:function m(){if(this.isAppended()){this._element.parentElement.removeChild(this._element)}this._element=null;this.state=i},isAppended:function p(){return this.state===s},isBuilt:function v(){return this.state>=a},setPosition:function g(e,t){if(o(e)){this._element.style.top=e+l}if(o(t)){this._element.style.left=t+l}},getPosition:function w(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function b(e,t){if(o(e)){this._element.style.width=e+l}if(o(t)){this._element.style.height=t+l}},getSize:function y(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function C(e,t){if(o(e)){this._element.style.marginTop=e+l}if(o(t)){this._element.style.marginLeft=t+l}},getOffset:function _(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{"helpers/number":52}],100:[function(e,t,r){"use strict";Object.defineProperties(r,{BacklightUI:{get:function d(){return l}},__esModule:{value:true}});var n,o;var i=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var a=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).addClass;var s="ht__manualColumnMove--backlight";var l=function f(e){$traceurRuntime.superConstructor(u).call(this,e)};var u=l;$traceurRuntime.createClass(l,{build:function c(){$traceurRuntime.superGet(this,u.prototype,"build").call(this);a(this._element,s)}},{},i)},{_base:99,"helpers/dom/element":47}],101:[function(e,t,r){"use strict";Object.defineProperties(r,{GuidelineUI:{get:function d(){return l}},__esModule:{value:true}});var n,o;var i=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var a=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).addClass;var s="ht__manualColumnMove--guideline";var l=function f(e){$traceurRuntime.superConstructor(u).call(this,e)};var u=l;$traceurRuntime.createClass(l,{build:function c(){$traceurRuntime.superGet(this,u.prototype,"build").call(this);a(this._element,s)}},{},i)},{_base:99,"helpers/dom/element":47}],102:[function(e,t,r){"use strict";Object.defineProperties(r,{ManualColumnResize:{get:function O(){return M}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("_base.js"),o&&o.__esModule&&o||{"default":o}).default;var h=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}),m=h.addClass,p=h.hasClass,v=h.removeClass,g=h.outerHeight;var w=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).eventManager;var b=(s=e("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}),y=b.pageX,C=b.pageY;var _=(l=e("helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach;var E=(u=e("helpers/number"),u&&u.__esModule&&u||{
"default":u}).rangeEach;var R=(d=e("plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var M=function T(e){$traceurRuntime.superConstructor(S).call(this,e);this.currentTH=null;this.currentCol=null;this.selectedCols=[];this.currentWidth=null;this.newSize=null;this.startY=null;this.startWidth=null;this.startOffset=null;this.handle=document.createElement("DIV");this.guide=document.createElement("DIV");this.eventManager=w(this);this.pressed=null;this.dblclick=0;this.autoresizeTimeout=null;this.manualColumnWidths=[];m(this.handle,"manualColumnResizer");m(this.guide,"manualColumnResizerGuide")};var S=M;$traceurRuntime.createClass(M,{isEnabled:function A(){return this.hot.getSettings().manualColumnResize},enablePlugin:function N(){var e=this;if(this.enabled){return}this.manualColumnWidths=[];var t=this.hot.getSettings().manualColumnResize;var r=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(t,r){return e.onModifyColWidth(t,r)});this.addHook("beforeStretchingColumnWidth",function(t,r){return e.onBeforeStretchingColumnWidth(t,r)});this.addHook("beforeColumnResize",function(t,r,n){return e.onBeforeColumnResize(t,r,n)});if(typeof r!="undefined"){this.manualColumnWidths=r}else if(Array.isArray(t)){this.manualColumnWidths=t}else{this.manualColumnWidths=[]}f.hooks.register("beforeColumnResize");f.hooks.register("afterColumnResize");this.bindEvents();$traceurRuntime.superGet(this,S.prototype,"enablePlugin").call(this)},updatePlugin:function D(){var e=this.hot.getSettings().manualColumnResize;if(Array.isArray(e)){this.manualColumnWidths=e}else if(!e){this.manualColumnWidths=[]}},disablePlugin:function k(){$traceurRuntime.superGet(this,S.prototype,"disablePlugin").call(this)},saveManualColumnWidths:function x(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)},loadManualColumnWidths:function I(){var e={};this.hot.runHooks("persistentStateLoad","manualColumnWidths",e);return e.value},setupHandlePosition:function P(e){var t=this;if(!e.parentNode){return false}this.currentTH=e;var r=this.hot.view.wt.wtTable.getCoords(e).col;var n=g(this.currentTH);if(r>=0){var o=this.currentTH.getBoundingClientRect();this.currentCol=r;this.selectedCols=[];if(this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var i=this.hot.getSelectedRange(),a=i.from,s=i.to;var l=a.col;var u=s.col;if(l>=u){l=s.col;u=a.col}if(this.currentCol>=l&&this.currentCol<=u){E(l,u,function(e){return t.selectedCols.push(e)})}else{this.selectedCols.push(this.currentCol)}}else{this.selectedCols.push(this.currentCol)}this.startOffset=o.left-6;this.startWidth=parseInt(o.width,10);this.handle.style.top=o.top+"px";this.handle.style.left=this.startOffset+this.startWidth+"px";this.handle.style.height=n+"px";this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function L(){this.handle.style.left=this.startOffset+this.currentWidth+"px"},setupGuidePosition:function H(){var e=parseInt(g(this.handle),10);var t=parseInt(this.handle.style.top,10)+e;var r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);m(this.handle,"active");m(this.guide,"active");this.guide.style.top=t+"px";this.guide.style.left=this.handle.style.left;this.guide.style.height=r-e+"px";this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function V(){this.guide.style.left=this.handle.style.left},hideHandleAndGuide:function F(){v(this.handle,"active");v(this.guide,"active")},checkIfColumnHeader:function B(e){if(e!=this.hot.rootElement){var t=e.parentNode;if(t.tagName==="THEAD"){return true}return this.checkIfColumnHeader(t)}return false},getTHFromTargetElement:function j(e){if(e.tagName!="TABLE"){if(e.tagName=="TH"){return e}else{return this.getTHFromTargetElement(e.parentNode)}}return null},onMouseOver:function W(e){if(this.checkIfColumnHeader(e.target)){var t=this.getTHFromTargetElement(e.target);if(!t){return}var r=t.getAttribute("colspan");if(t&&(r===null||r===1)){if(!this.pressed){this.setupHandlePosition(t)}}}},afterMouseDownTimeout:function $(){var e=this;var t=function o(){e.hot.forceFullRender=true;e.hot.view.render();e.hot.view.wt.wtOverlays.adjustElementsSize(true)};var r=function i(r,n){var o=e.hot.runHooks("beforeColumnResize",r,e.newSize,true);if(o!==void 0){e.newSize=o}if(e.hot.getSettings().stretchH==="all"){e.clearManualSize(r)}else{e.setManualSize(r,e.newSize)}if(n){t()}e.saveManualColumnWidths();e.hot.runHooks("afterColumnResize",r,e.newSize,true)};if(this.dblclick>=2){var n=this.selectedCols.length;if(n>1){_(this.selectedCols,function(e){r(e)});t()}else{_(this.selectedCols,function(e){r(e,true)})}}this.dblclick=0;this.autoresizeTimeout=null},onMouseDown:function U(e){var t=this;if(p(e.target,"manualColumnResizer")){this.setupGuidePosition();this.pressed=this.hot;if(this.autoresizeTimeout===null){this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500);this.hot._registerTimeout(this.autoresizeTimeout)}this.dblclick++;this.startX=y(e);this.newSize=this.startWidth}},onMouseMove:function G(e){var t=this;if(this.pressed){this.currentWidth=this.startWidth+(y(e)-this.startX);_(this.selectedCols,function(e){t.newSize=t.setManualSize(e,t.currentWidth)});this.refreshHandlePosition();this.refreshGuidePosition()}},onMouseUp:function Y(e){var t=this;var r=function i(){t.hot.forceFullRender=true;t.hot.view.render();t.hot.view.wt.wtOverlays.adjustElementsSize(true)};var n=function a(e,n){t.hot.runHooks("beforeColumnResize",e,t.newSize);if(n){r()}t.saveManualColumnWidths();t.hot.runHooks("afterColumnResize",e,t.newSize)};if(this.pressed){this.hideHandleAndGuide();this.pressed=false;if(this.newSize!=this.startWidth){var o=this.selectedCols.length;if(o>1){_(this.selectedCols,function(e){n(e)});r()}else{_(this.selectedCols,function(e){n(e,true)})}}this.setupHandlePosition(this.currentTH)}},bindEvents:function z(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return e.onMouseUp(t)})},setManualSize:function K(e,t){t=Math.max(t,20);e=this.hot.runHooks("modifyCol",e);this.manualColumnWidths[e]=t;return t},clearManualSize:function q(e){e=this.hot.runHooks("modifyCol",e);this.manualColumnWidths[e]=void 0},onModifyColWidth:function X(e,t){if(this.enabled){t=this.hot.runHooks("modifyCol",t);if(this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[t]){return this.manualColumnWidths[t]}}return e},onBeforeStretchingColumnWidth:function J(e,t){var r=this.manualColumnWidths[t];if(r===void 0){r=e}return r},onBeforeColumnResize:function Z(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}},{},c);R("manualColumnResize",M)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],103:[function(e,t,r){"use strict";Object.defineProperties(r,{ManualRowMove:{get:function x(){return D}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c;var h=(n=e("_base.js"),n&&n.__esModule&&n||{"default":n}).default;var m=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var p=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var v=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{"default":a}),g=v.addClass,w=v.removeClass,b=v.offset;var y=(s=e("helpers/number"),s&&s.__esModule&&s||{"default":s}).rangeEach;var C=(l=e("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager;var _=(u=e("plugins"),u&&u.__esModule&&u||{"default":u}).registerPlugin;var E=(d=e("rowsMapper"),d&&d.__esModule&&d||{"default":d}).RowsMapper;var R=(f=e("ui/backlight"),f&&f.__esModule&&f||{"default":f}).BacklightUI;var M=(c=e("ui/guideline"),c&&c.__esModule&&c||{"default":c}).GuidelineUI;var S=new WeakMap;var O="ht__manualRowMove";var T="show-ui";var A="on-moving--rows";var N="after-selection--rows";var D=function I(e){$traceurRuntime.superConstructor(k).call(this,e);S.set(this,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}});this.removedRows=[];this.rowsMapper=new E(this);this.eventManager=C(this);this.backlight=new R(e);this.guideline=new M(e)};var k=D;$traceurRuntime.createClass(D,{isEnabled:function P(){return!!this.hot.getSettings().manualRowMove},enablePlugin:function L(){var e=this;if(this.enabled){return}this.addHook("beforeOnCellMouseDown",function(t,r,n,o){return e.onBeforeOnCellMouseDown(t,r,n,o)});this.addHook("beforeOnCellMouseOver",function(t,r,n,o){return e.onBeforeOnCellMouseOver(t,r,n,o)});this.addHook("afterScrollHorizontally",function(){return e.onAfterScrollHorizontally()});this.addHook("modifyRow",function(t,r){return e.onModifyRow(t,r)});this.addHook("beforeRemoveRow",function(t,r){return e.onBeforeRemoveRow(t,r)});this.addHook("afterRemoveRow",function(t,r){return e.onAfterRemoveRow(t,r)});this.addHook("afterCreateRow",function(t,r){return e.onAfterCreateRow(t,r)});this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)});this.addHook("beforeColumnSort",function(t,r){return e.onBeforeColumnSort(t,r)});this.addHook("unmodifyRow",function(t){return e.onUnmodifyRow(t)});this.registerEvents();g(this.hot.rootElement,O);$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this)},updatePlugin:function H(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,k.prototype,"updatePlugin").call(this)},disablePlugin:function V(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e)){this.rowsMapper.clearMap()}w(this.hot.rootElement,O);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,k.prototype,"disablePlugin").call(this)},moveRow:function F(e,t){this.moveRows([e],t)},moveRows:function B(e,t){var r=this;var n=S.get(this);var o=this.hot.runHooks("beforeRowMove",e,t);n.disallowMoving=o===false;if(!n.disallowMoving){p(e,function(e,t,n){n[t]=r.rowsMapper.getValueByIndex(e)});p(e,function(e,n){var o=r.rowsMapper.getIndexByValue(e);if(o!==t){r.rowsMapper.moveRow(o,t+n)}});this.rowsMapper.clearNull()}this.hot.runHooks("afterRowMove",e,t)},changeSelection:function j(e,t){var r=this.hot.selection;var n=this.hot.countCols()-1;r.setRangeStartOnly(new WalkontableCellCoords(e,0));r.setRangeEnd(new WalkontableCellCoords(t,n),false)},getRowsHeight:function W(e,t){var r=0;for(var n=e;n<t;n++){var o=this.hot.view.wt.wtTable.getRowHeight(n)||23;r+=o}return r},initialSettings:function $(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e)){this.moveRows(e,0)}else if(e!==void 0){var t=this.persistentStateLoad();if(t.length){this.moveRows(t,0)}}},isFixedRowTop:function U(e){return e<this.hot.getSettings().fixedRowsTop},isFixedRowBottom:function G(e){return e>this.hot.getSettings().fixedRowsBottom},persistentStateSave:function Y(){m.hooks.run(this.hot,"persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)},persistentStateLoad:function z(){var e={};m.hooks.run(this.hot,"persistentStateLoad","manualRowMove",e);return e.value?e.value:[]},prepareRowsToMoving:function K(){var e=this.hot.getSelectedRange();var t=[];if(!e){return t}var r=e,n=r.from,o=r.to;var i=Math.min(n.row,o.row);var a=Math.max(n.row,o.row);y(i,a,function(e){t.push(e)});return t},refreshPositions:function q(){var e=S.get(this);var t=e.target.coords;var r=this.hot.view.wt.wtTable.getFirstVisibleRow();var n=this.hot.view.wt.wtTable.getLastVisibleRow();var o=this.hot.getSettings().fixedRowsTop;var i=this.hot.countRows();if(t.row<o&&r>0){this.hot.scrollViewportTo(r-1)}if(t.row>=n&&n<i){this.hot.scrollViewportTo(n+1,undefined,true)}var a=this.hot.view.wt.wtTable;var s=e.target.TD;var l=b(this.hot.rootElement);var u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row);var d=e.target.eventPageY-l.top+a.holder.scrollTop;var f=a.hider.offsetHeight;var c=a.TBODY.offsetTop;var h=this.backlight.getOffset().top;var m=this.backlight.getSize().height;if(l.top+a.holder.offsetHeight<e.target.eventPageY){e.target.coords.row++}if(this.isFixedRowTop(t.row)){u+=a.holder.scrollTop}if(t.row<0){e.target.row=r>0?r-1:r}else if(s.offsetHeight/2+u<=d){e.target.row=t.row+1;u+=t.row===0?s.offsetHeight-1:s.offsetHeight}else{e.target.row=t.row}var p=d;var v=u;if(d+m+h>=f){p=f-m-h}else if(d+h<c){p=c+Math.abs(h)}if(u>=f-1){v=f-1}var g=0;if(this.hot.view.wt.wtOverlays.topOverlay){g=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight}if(t.row>=o&&v-a.holder.scrollTop<g){this.hot.scrollViewportTo(t.row)}this.backlight.setPosition(p);this.guideline.setPosition(v)},updateRowsMapper:function X(){var e=this.hot.countSourceRows();var t=this.rowsMapper._arrayMap.length;if(t===0){this.rowsMapper.createMap(e||this.hot.getSettings().startRows)}else if(t<e){var r=e-t;this.rowsMapper.insertItems(t,r)}else if(t>e){var n=e-1;var o=[];p(this.rowsMapper._arrayMap,function(e,t,r){if(e>n){o.push(t)}});this.rowsMapper.removeItems(o)}},registerEvents:function J(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)});this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})},unregisterEvents:function Z(){this.eventManager.clear()},onBeforeColumnSort:function Q(e,t){var r=S.get(this);r.disallowMoving=t!==void 0},onBeforeOnCellMouseDown:function ee(e,t,r,n){var o=this.hot.view.wt.wtTable;var i=this.hot.selection.selectedHeader.rows;var a=this.hot.getSelectedRange();var s=S.get(this);if(!a||!i||s.pressed||e.button!==0){s.pressed=false;s.rowsToMove.length=0;w(this.hot.rootElement,[A,T]);return}var l=this.guideline.isBuilt()&&!this.guideline.isAppended();var u=this.backlight.isBuilt()&&!this.backlight.isAppended();if(l&&u){this.guideline.appendTo(o.hider);this.backlight.appendTo(o.hider)}var d=a,f=d.from,c=d.to;var h=Math.min(f.row,c.row);var m=Math.max(f.row,c.row);if(t.col<0&&t.row>=h&&t.row<=m){n.row=true;s.pressed=true;s.target.eventPageY=e.pageY;s.target.coords=t;s.target.TD=r;s.rowsToMove=this.prepareRowsToMoving();var p=o.holder.scrollLeft+o.getColumnWidth(-1);this.backlight.setPosition(null,p);this.backlight.setSize(o.hider.offsetWidth-p,this.getRowsHeight(h,m+1));this.backlight.setOffset((this.getRowsHeight(h,t.row)+e.layerY)*-1,null);g(this.hot.rootElement,A);this.refreshPositions()}else{w(this.hot.rootElement,N);s.pressed=false;s.rowsToMove.length=0}},onMouseMove:function te(e){var t=S.get(this);if(!t.pressed){return}if(e.realTarget===this.backlight.element){var r=this.backlight.getSize().height;this.backlight.setSize(null,0);setTimeout(function(){this.backlight.setPosition(null,r)})}t.target.eventPageY=e.pageY;this.refreshPositions()},onBeforeOnCellMouseOver:function re(e,t,r,n){var o=this.hot.getSelectedRange();var i=S.get(this);if(!o||!i.pressed){return}if(i.rowsToMove.indexOf(t.row)>-1){w(this.hot.rootElement,T)}else{g(this.hot.rootElement,T)}n.row=true;n.column=true;n.cell=true;i.target.coords=t;i.target.TD=r},onMouseUp:function ne(){var e=S.get(this);var t=e.target.row;var r=e.rowsToMove.length;e.pressed=false;e.backlightHeight=0;w(this.hot.rootElement,[A,T,N]);if(this.hot.selection.selectedHeader.rows){g(this.hot.rootElement,N)}if(r<1||t===void 0||e.rowsToMove.indexOf(t)>-1||e.rowsToMove[r-1]===t-1){return}this.moveRows(e.rowsToMove,t);this.persistentStateSave();this.hot.render();if(!e.disallowMoving){var n=this.rowsMapper.getIndexByValue(e.rowsToMove[0]);var o=this.rowsMapper.getIndexByValue(e.rowsToMove[r-1]);this.changeSelection(n,o)}e.rowsToMove.length=0},onAfterScrollHorizontally:function oe(){var e=this.hot.view.wt.wtTable;var t=e.getColumnWidth(-1);var r=e.holder.scrollLeft;var n=t+r;this.backlight.setPosition(null,n);this.backlight.setSize(e.hider.offsetWidth-n)},onAfterCreateRow:function ie(e,t){this.rowsMapper.shiftItems(e,t)},onBeforeRemoveRow:function ae(e,t){var r=this;this.removedRows.length=0;if(e!==false){y(e,e+t-1,function(e){r.removedRows.push(r.hot.runHooks("modifyRow",e,r.pluginName))})}},onAfterRemoveRow:function se(e,t){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function le(e){this.updateRowsMapper()},onModifyRow:function ue(e,t){if(t!==this.pluginName){var r=this.rowsMapper.getValueByIndex(e);e=r===null?e:r}return e},onUnmodifyRow:function de(e){var t=this.rowsMapper.getIndexByValue(e);return t===null?e:t},onAfterPluginsInitialized:function fe(){this.updateRowsMapper();this.initialSettings();this.backlight.build();this.guideline.build()},destroy:function ce(){this.backlight.destroy();this.guideline.destroy();$traceurRuntime.superGet(this,k.prototype,"destroy").call(this)}},{},h);_("ManualRowMove",D);m.hooks.register("beforeRowMove");m.hooks.register("afterRowMove");m.hooks.register("unmodifyRow")},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,rowsMapper:104,"ui/backlight":106,"ui/guideline":107}],104:[function(e,t,r){"use strict";Object.defineProperties(r,{RowsMapper:{get:function m(){return h}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("mixins/arrayMapper"),o&&o.__esModule&&o||{"default":o}).arrayMapper;var d=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayFilter;var f=(a=e("helpers/object"),a&&a.__esModule&&a||{"default":a}).mixin;var c=(s=e("helpers/number"),s&&s.__esModule&&s||{"default":s}).rangeEach;var h=function p(e){this.manualRowMove=e};$traceurRuntime.createClass(h,{createMap:function v(e){var t=this;var r=e===void 0?this._arrayMap.length:e;this._arrayMap.length=0;c(r-1,function(e){t._arrayMap[e]=e})},destroy:function g(){this._arrayMap=null},moveRow:function w(e,t){var r=this._arrayMap[e];this._arrayMap[e]=null;this._arrayMap.splice(t,0,r)},clearNull:function b(){this._arrayMap=d(this._arrayMap,function(e){return e!==null})}},{});f(h,u);l.utils.ManualRowMoveRowsMapper=h},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],105:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseUI:{get:function l(){return s}},__esModule:{value:true}});var n=0;var o=1;var i=2;var a="px";var s=function u(e){this.hot=e;this._element=null;this.state=n};$traceurRuntime.createClass(s,{appendTo:function d(e){e.appendChild(this._element);this.state=i},build:function f(){this._element=document.createElement("div");this.state=o},destroy:function c(){if(this.isAppended()){this._element.parentElement.removeChild(this._element)}this._element=null;this.state=n},isAppended:function h(){return this.state===i},isBuilt:function m(){return this.state>=o},setPosition:function p(e,t){if(e){this._element.style.top=e+a}if(t){this._element.style.left=t+a}},getPosition:function v(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function g(e,t){if(e){this._element.style.width=e+a}if(t){this._element.style.height=t+a}},getSize:function w(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function b(e,t){if(e){this._element.style.marginTop=e+a}if(t){this._element.style.marginLeft=t+a}},getOffset:function y(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{}],106:[function(e,t,r){"use strict";Object.defineProperties(r,{BacklightUI:{get:function d(){return l}},__esModule:{value:true}});var n,o;var i=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var a=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).addClass;var s="ht__manualRowMove--backlight";var l=function f(e){$traceurRuntime.superConstructor(u).call(this,e)};var u=l;$traceurRuntime.createClass(l,{build:function c(){$traceurRuntime.superGet(this,u.prototype,"build").call(this);a(this._element,s)}},{},i)},{_base:105,"helpers/dom/element":47}],107:[function(e,t,r){"use strict";Object.defineProperties(r,{GuidelineUI:{get:function d(){return l}},__esModule:{value:true}});var n,o;var i=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var a=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).addClass;var s="ht__manualRowMove--guideline";var l=function f(e){$traceurRuntime.superConstructor(u).call(this,e)};var u=l;$traceurRuntime.createClass(l,{build:function c(){$traceurRuntime.superGet(this,u.prototype,"build").call(this);a(this._element,s)}},{},i)},{_base:105,"helpers/dom/element":47}],108:[function(e,t,r){"use strict";Object.defineProperties(r,{ManualRowResize:{get:function O(){return M}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("_base.js"),o&&o.__esModule&&o||{"default":o}).default;var h=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}),m=h.addClass,p=h.hasClass,v=h.removeClass,g=h.outerWidth;var w=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).eventManager;var b=(s=e("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}),y=b.pageX,C=b.pageY;var _=(l=e("helpers/array"),l&&l.__esModule&&l||{"default":l}).arrayEach;var E=(u=e("helpers/number"),u&&u.__esModule&&u||{"default":u}).rangeEach;var R=(d=e("plugins"),d&&d.__esModule&&d||{"default":d}).registerPlugin;var M=function T(e){$traceurRuntime.superConstructor(S).call(this,e);this.currentTH=null;this.currentRow=null;this.selectedRows=[];this.currentHeight=null;this.newSize=null;this.startY=null;this.startHeight=null;this.startOffset=null;this.handle=document.createElement("DIV");this.guide=document.createElement("DIV");this.eventManager=w(this);this.pressed=null;this.dblclick=0;this.autoresizeTimeout=null;this.manualRowHeights=[];m(this.handle,"manualRowResizer");m(this.guide,"manualRowResizerGuide")};var S=M;$traceurRuntime.createClass(M,{isEnabled:function A(){return this.hot.getSettings().manualRowResize},enablePlugin:function N(){var e=this;if(this.enabled){return}this.manualRowHeights=[];var t=this.hot.getSettings().manualRowResize;var r=this.loadManualRowHeights();if(typeof r!="undefined"){this.manualRowHeights=r}else if(Array.isArray(t)){this.manualRowHeights=t}else{this.manualRowHeights=[]}this.addHook("modifyRowHeight",function(t,r){return e.onModifyRowHeight(t,r)});f.hooks.register("beforeRowResize");f.hooks.register("afterRowResize");this.bindEvents();$traceurRuntime.superGet(this,S.prototype,"enablePlugin").call(this)},updatePlugin:function D(){var e=this.hot.getSettings().manualRowResize;if(Array.isArray(e)){this.manualRowHeights=e}else if(!e){this.manualRowHeights=[]}},disablePlugin:function k(){$traceurRuntime.superGet(this,S.prototype,"disablePlugin").call(this)},saveManualRowHeights:function x(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)},loadManualRowHeights:function I(){var e={};this.hot.runHooks("persistentStateLoad","manualRowHeights",e);return e.value},setupHandlePosition:function P(e){var t=this;this.currentTH=e;var r=this.hot.view.wt.wtTable.getCoords(e).row;var n=g(this.currentTH);if(r>=0){var o=this.currentTH.getBoundingClientRect();this.currentRow=r;this.selectedRows=[];if(this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var i=this.hot.getSelectedRange(),a=i.from,s=i.to;var l=a.row;var u=s.row;if(l>=u){l=s.row;u=a.row}if(this.currentRow>=l&&this.currentRow<=u){E(l,u,function(e){return t.selectedRows.push(e)})}else{this.selectedRows.push(this.currentRow)}}else{this.selectedRows.push(this.currentRow)}this.startOffset=o.top-6;this.startHeight=parseInt(o.height,10);this.handle.style.left=o.left+"px";this.handle.style.top=this.startOffset+this.startHeight+"px";this.handle.style.width=n+"px";this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function L(){this.handle.style.top=this.startOffset+this.currentHeight+"px"},setupGuidePosition:function H(){var e=parseInt(g(this.handle),10);var t=parseInt(this.handle.style.left,10)+e;var r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);m(this.handle,"active");m(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left=t+"px";this.guide.style.width=r-e+"px";this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function V(){this.guide.style.top=this.handle.style.top},hideHandleAndGuide:function F(){v(this.handle,"active");v(this.guide,"active")},checkIfRowHeader:function B(e){if(e!=this.hot.rootElement){var t=e.parentNode;if(t.tagName==="TBODY"){return true}return this.checkIfRowHeader(t)}return false},getTHFromTargetElement:function j(e){if(e.tagName!="TABLE"){if(e.tagName=="TH"){return e}else{return this.getTHFromTargetElement(e.parentNode)}}return null},onMouseOver:function W(e){if(this.checkIfRowHeader(e.target)){var t=this.getTHFromTargetElement(e.target);if(t){if(!this.pressed){this.setupHandlePosition(t)}}}},afterMouseDownTimeout:function $(){var e=this;var t=function o(){e.hot.forceFullRender=true;e.hot.view.render();e.hot.view.wt.wtOverlays.adjustElementsSize(true)};var r=function i(r,n){var o=e.hot.runHooks("beforeRowResize",r,e.newSize,true);if(o!==void 0){e.newSize=o}e.setManualSize(r,e.newSize);if(n){t()}e.hot.runHooks("afterRowResize",r,e.newSize,true)};if(this.dblclick>=2){var n=this.selectedRows.length;if(n>1){_(this.selectedRows,function(e){r(e)});t()}else{_(this.selectedRows,function(e){r(e,true)})}}this.dblclick=0;this.autoresizeTimeout=null},onMouseDown:function U(e){var t=this;if(p(e.target,"manualRowResizer")){this.setupGuidePosition();this.pressed=this.hot;if(this.autoresizeTimeout==null){this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500);this.hot._registerTimeout(this.autoresizeTimeout)}this.dblclick++;this.startY=C(e);this.newSize=this.startHeight}},onMouseMove:function G(e){var t=this;if(this.pressed){this.currentHeight=this.startHeight+(C(e)-this.startY);_(this.selectedRows,function(e){t.newSize=t.setManualSize(e,t.currentHeight)});this.refreshHandlePosition();this.refreshGuidePosition()}},onMouseUp:function Y(e){var t=this;var r=function i(){t.hot.forceFullRender=true;t.hot.view.render();t.hot.view.wt.wtOverlays.adjustElementsSize(true)};var n=function a(e,n){t.hot.runHooks("beforeRowResize",e,t.newSize);if(n){r()}t.saveManualRowHeights();t.hot.runHooks("afterRowResize",e,t.newSize)};if(this.pressed){this.hideHandleAndGuide();this.pressed=false;if(this.newSize!=this.startHeight){var o=this.selectedRows.length;if(o>1){_(this.selectedRows,function(e){n(e)});r()}else{_(this.selectedRows,function(e){n(e,true)})}}this.setupHandlePosition(this.currentTH)}},bindEvents:function z(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return e.onMouseUp(t)})},setManualSize:function K(e,t){e=this.hot.runHooks("modifyRow",e);this.manualRowHeights[e]=t;return t},onModifyRowHeight:function q(e,t){if(this.enabled){var r=this.hot.getPlugin("autoRowSize");var n=r?r.heights[t]:null;t=this.hot.runHooks("modifyRow",t);var o=this.manualRowHeights[t];if(o!==void 0&&(o===n||o>(e||0))){return o}}return e}},{},c);R("manualRowResize",M)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],109:[function(e,t,r){"use strict";Object.defineProperties(r,{MergeCells:{get:function P(){return v}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin;var f=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{"default":i}).stopImmediatePropagation;var c=(a=e("3rdparty/walkontable/src/cell/coords"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords;var h=(s=e("3rdparty/walkontable/src/cell/range"),s&&s.__esModule&&s||{"default":s}).WalkontableCellRange;var m=(l=e("3rdparty/walkontable/src/table"),l&&l.__esModule&&l||{"default":l}).WalkontableTable;function p(){var e=[];e.getInfo=function(e,t){for(var r=0,n=this.length;r<n;r++){if(this[r].row<=e&&this[r].row+this[r].rowspan-1>=e&&this[r].col<=t&&this[r].col+this[r].colspan-1>=t){return this[r]}}};e.setInfo=function(e){for(var t=0,r=this.length;t<r;t++){if(this[t].row===e.row&&this[t].col===e.col){this[t]=e;return}}this.push(e)};e.removeInfo=function(e,t){for(var r=0,n=this.length;r<n;r++){if(this[r].row===e&&this[r].col===t){this.splice(r,1);break}}};return e}function v(e){this.mergedCellInfoCollection=new p;if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++){this.mergedCellInfoCollection.setInfo(e[t])}}}v.prototype.canMergeRange=function(e){return!e.isSingle()};v.prototype.mergeRange=function(e){if(!this.canMergeRange(e)){return}var t=e.getTopLeftCorner();var r=e.getBottomRightCorner();var n={};n.row=t.row;n.col=t.col;n.rowspan=r.row-t.row+1;n.colspan=r.col-t.col+1;this.mergedCellInfoCollection.setInfo(n)};v.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);if(t){this.unmergeSelection(e.from)}else{this.mergeSelection(e)}};v.prototype.mergeSelection=function(e){this.mergeRange(e)};v.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)};v.prototype.applySpanProperties=function(e,t,r){var n=this.mergedCellInfoCollection.getInfo(t,r);if(n){if(n.row===t&&n.col===r){e.setAttribute("rowspan",n.rowspan);e.setAttribute("colspan",n.colspan)}else{e.removeAttribute("rowspan");e.removeAttribute("colspan");e.style.display="none"}}else{e.removeAttribute("rowspan");e.removeAttribute("colspan")}};v.prototype.modifyTransform=function(e,t,r){var n=function S(e,t){if(t.row>=e.row&&t.row<=e.row+e.rowspan-1){return true}return false},o=function O(e,t){if(t.col>=e.col&&t.col<=e.col+e.colspan-1){return true}return false},i=function T(e){return new c(t.to.row+e.row,t.to.col+e.col)};var a={row:r.row,col:r.col};if(e=="modifyTransformStart"){if(!this.lastDesiredCoords){this.lastDesiredCoords=new c(null,null)}var s=new c(t.highlight.row,t.highlight.col),l=this.mergedCellInfoCollection.getInfo(s.row,s.col),u;for(var d=0,f=this.mergedCellInfoCollection.length;d<f;d++){var m=this.mergedCellInfoCollection[d];m=new c(m.row+m.rowspan-1,m.col+m.colspan-1);if(t.includes(m)){u=true;break}}if(l){var p=new c(l.row,l.col),v=new c(l.row+l.rowspan-1,l.col+l.colspan-1),g=new h(p,p,v);if(!g.includes(this.lastDesiredCoords)){this.lastDesiredCoords=new c(null,null)}a.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-s.row:a.row;a.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-s.col:a.col;if(r.row>0){a.row=l.row+l.rowspan-1-s.row+r.row}else if(r.row<0){a.row=s.row-l.row+r.row}if(r.col>0){a.col=l.col+l.colspan-1-s.col+r.col}else if(r.col<0){a.col=s.col-l.col+r.col}}var w=new c(t.highlight.row+a.row,t.highlight.col+a.col),b=this.mergedCellInfoCollection.getInfo(w.row,w.col);if(b){this.lastDesiredCoords=w;a={row:b.row-s.row,col:b.col-s.col}}}else if(e=="modifyTransformEnd"){for(var d=0,f=this.mergedCellInfoCollection.length;d<f;d++){var y=this.mergedCellInfoCollection[d],p=new c(y.row,y.col),v=new c(y.row+y.rowspan-1,y.col+y.colspan-1),C=new h(p,p,v),_=t.getBordersSharedWith(C);if(C.isEqual(t)){t.setDirection("NW-SE")}else if(_.length>0){var E=t.highlight.isEqual(C.from);if(_.indexOf("top")>-1){if(t.to.isSouthEastOf(C.from)&&E){t.setDirection("NW-SE");
}else if(t.to.isSouthWestOf(C.from)&&E){t.setDirection("NE-SW")}}else if(_.indexOf("bottom")>-1){if(t.to.isNorthEastOf(C.from)&&E){t.setDirection("SW-NE")}else if(t.to.isNorthWestOf(C.from)&&E){t.setDirection("SE-NW")}}}var w=i(a),R=n(y,w),M=o(y,w);if(t.includesRange(C)&&(C.includes(w)||R||M)){if(R){if(a.row<0){a.row-=y.rowspan-1}else if(a.row>0){a.row+=y.rowspan-1}}if(M){if(a.col<0){a.col-=y.colspan-1}else if(a.col>0){a.col+=y.colspan-1}}}}}if(a.row!==0){r.row=a.row}if(a.col!==0){r.col=a.col}};v.prototype.shiftCollection=function(e,t,r){var n=[0,0];switch(e){case"right":n[0]+=1;break;case"left":n[0]-=1;break;case"down":n[1]+=1;break;case"up":n[1]-=1;break}for(var o=0;o<this.mergedCellInfoCollection.length;o++){var i=this.mergedCellInfoCollection[o];if(e==="right"||e==="left"){if(t<=i.col){i.col+=n[0]}}else{if(t<=i.row){i.row+=n[1]}}}};var g=function L(){var e=this;var t=e.getSettings().mergeCells;if(t){if(!e.mergeCells){e.mergeCells=new v(t)}}};var w=function H(){var e=this;if(e.mergeCells){e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var r=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);if(r){t=r}}return m.prototype.getCell.call(this,t)}}};var b=function V(){var e=this;var t=e.getSettings().mergeCells;if(t){if(e.mergeCells){e.mergeCells.mergedCellInfoCollection=new p;if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++){e.mergeCells.mergedCellInfoCollection.setInfo(t[r])}}}else{e.mergeCells=new v(t)}}else{if(e.mergeCells){e.mergeCells.mergedCellInfoCollection=new p}}};var y=function F(e){if(!this.mergeCells){return}var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(t){if(e.keyCode===77){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render();f(e)}}};var C=function B(e){if(!this.getSettings().mergeCells){return}e.items.push(u.plugins.ContextMenu.SEPARATOR);e.items.push({key:"mergeCells",name:function t(){var e=this.getSelected();var t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);if(t){return"Unmerge cells"}else{return"Merge cells"}},callback:function r(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function n(){return this.selection.selectedHeader.corner}})};var _=function j(e,t,r,n,o,i){if(this.mergeCells){this.mergeCells.applySpanProperties(e,t,r)}};var E=function W(e){return function(t){var r=this.getSettings().mergeCells;if(r){var n=this.getSelectedRange();this.mergeCells.modifyTransform(e,n,t);if(e==="modifyTransformEnd"){var o=this.countRows();var i=this.countCols();if(n.from.row<0){n.from.row=0}else if(n.from.row>0&&n.from.row>=o){n.from.row=n.from-1}if(n.from.col<0){n.from.col=0}else if(n.from.col>0&&n.from.col>=i){n.from.col=i-1}}}}};var R=function $(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var r=this.getSelectedRange();r.highlight=new c(r.highlight.row,r.highlight.col);r.to=e;var n=false;do{n=false;for(var o=0,i=this.mergeCells.mergedCellInfoCollection.length;o<i;o++){var a=this.mergeCells.mergedCellInfoCollection[o];var s=new c(a.row,a.col);var l=new c(a.row+a.rowspan-1,a.col+a.colspan-1);var u=new h(s,s,l);if(r.expandByRange(u)){e.row=r.to.row;e.col=r.to.col;n=true}}}while(n)}};var M=function U(e,t){if(t&&t=="area"){var r=this.getSettings().mergeCells;if(r){var n=this.getSelectedRange();var o=new h(n.from,n.from,n.from);var i=new h(n.to,n.to,n.to);for(var a=0,s=this.mergeCells.mergedCellInfoCollection.length;a<s;a++){var l=this.mergeCells.mergedCellInfoCollection[a];var u=new c(l.row,l.col);var d=new c(l.row+l.rowspan-1,l.col+l.colspan-1);var f=new h(u,u,d);if(o.expandByRange(f)){e[0]=o.from.row;e[1]=o.from.col}if(i.expandByRange(f)){e[2]=i.from.row;e[3]=i.from.col}}}}};var S=function G(e,t,r){var n=this.getSettings().mergeCells;if(n){var o=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);if(o&&(o.row!=e||o.col!=t)){r.copyable=false}}};var O=function Y(e){var t=this.getSettings().mergeCells;if(t){var r=this.countCols();var n;for(var o=0;o<r;o++){n=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,o);if(n){if(n.row<e.startRow){e.startRow=n.row;return Y.call(this,e)}}n=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,o);if(n){var i=n.row+n.rowspan-1;if(i>e.endRow){e.endRow=i;return Y.call(this,e)}}}}};var T=function z(e){var t=this.getSettings().mergeCells;if(t){var r=this.countRows();var n;for(var o=0;o<r;o++){n=this.mergeCells.mergedCellInfoCollection.getInfo(o,e.startColumn);if(n){if(n.col<e.startColumn){e.startColumn=n.col;return z.call(this,e)}}n=this.mergeCells.mergedCellInfoCollection.getInfo(o,e.endColumn);if(n){var i=n.col+n.colspan-1;if(i>e.endColumn){e.endColumn=i;return z.call(this,e)}}}}};var A=function K(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,r=this.getSelectedRange();for(var n in t){if(r.highlight.row==t[n].row&&r.highlight.col==t[n].col&&r.to.row==t[n].row+t[n].rowspan-1&&r.to.col==t[n].col+t[n].colspan-1){return false}}}return e};function N(e,t){var r=this.getSettings().mergeCells;if(!r||this.selection.isMultiple()){return}var n=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);if(n){e[0]=n.row;e[1]=n.col;e[2]=n.row+n.rowspan-1;e[3]=n.col+n.colspan-1}}function D(e,t){if(this.mergeCells){this.mergeCells.shiftCollection("right",e,t)}}function k(e,t){if(this.mergeCells){this.mergeCells.shiftCollection("left",e,t)}}function x(e,t){if(this.mergeCells){this.mergeCells.shiftCollection("down",e,t)}}function I(e,t){if(this.mergeCells){this.mergeCells.shiftCollection("up",e,t)}}u.hooks.add("beforeInit",g);u.hooks.add("afterInit",w);u.hooks.add("afterUpdateSettings",b);u.hooks.add("beforeKeyDown",y);u.hooks.add("modifyTransformStart",E("modifyTransformStart"));u.hooks.add("modifyTransformEnd",E("modifyTransformEnd"));u.hooks.add("beforeSetRangeEnd",R);u.hooks.add("beforeDrawBorders",M);u.hooks.add("afterIsMultipleSelection",A);u.hooks.add("afterRenderer",_);u.hooks.add("afterContextMenuDefaultOptions",C);u.hooks.add("afterGetCellMeta",S);u.hooks.add("afterViewportRowCalculatorOverride",O);u.hooks.add("afterViewportColumnCalculatorOverride",T);u.hooks.add("modifyAutofillRange",N);u.hooks.add("afterCreateCol",D);u.hooks.add("afterRemoveCol",k);u.hooks.add("afterCreateRow",x);u.hooks.add("afterRemoveRow",I);u.MergeCells=v},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/table":21,browser:24,"helpers/dom/event":48,plugins:62}],110:[function(e,t,r){"use strict";Object.defineProperties(r,{MultipleSelectionHandles:{get:function y(){return w}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),f=d.getWindowScrollTop,c=d.hasClass,h=d.getWindowScrollLeft;var m=(i=e("helpers/browser"),i&&i.__esModule&&i||{"default":i}).isMobileBrowser;var p=(a=e("_base"),a&&a.__esModule&&a||{"default":a}).default;var v=(s=e("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager;var g=(l=e("plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var w=function C(e){$traceurRuntime.superConstructor(b).call(this,e);this.dragged=[];this.eventManager=null;this.lastSetCell=null};var b=w;$traceurRuntime.createClass(w,{isEnabled:function _(){return m()},enablePlugin:function E(){if(this.enabled){return}if(!this.eventManager){this.eventManager=new v(this)}this.registerListeners();$traceurRuntime.superGet(this,b.prototype,"enablePlugin").call(this)},registerListeners:function R(){var e=this;function t(t){if(e.dragged.length===1){e.dragged.splice(0,e.dragged.length);return true}var r=e.dragged.indexOf(t);if(r==-1){return false}else if(r===0){e.dragged=e.dragged.slice(0,1)}else if(r==1){e.dragged=e.dragged.slice(-1)}}this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var r;if(c(t.target,"topLeftSelectionHandle-HitArea")){r=e.hot.getSelectedRange();e.dragged.push("topLeft");e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()};t.preventDefault();return false}else if(c(t.target,"bottomRightSelectionHandle-HitArea")){r=e.hot.getSelectedRange();e.dragged.push("bottomRight");e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()};t.preventDefault();return false}});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(r){if(c(r.target,"topLeftSelectionHandle-HitArea")){t.call(e,"topLeft");e.touchStartRange=void 0;r.preventDefault();return false}else if(c(r.target,"bottomRightSelectionHandle-HitArea")){t.call(e,"bottomRight");e.touchStartRange=void 0;r.preventDefault();return false}});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var r=f(),n=h(),o,i,a,s,l,u,d;if(e.dragged.length===0){return}o=document.elementFromPoint(t.touches[0].screenX-n,t.touches[0].screenY-r);if(!o||o===e.lastSetCell){return}if(o.nodeName=="TD"||o.nodeName=="TH"){i=e.hot.getCoords(o);if(i.col==-1){i.col=0}a=e.hot.getSelectedRange();s=a.getWidth();l=a.getHeight();u=a.getDirection();if(s==1&&l==1){e.hot.selection.setRangeEnd(i)}d=e.getCurrentRangeCoords(a,i,e.touchStartRange.direction,u,e.dragged[0]);if(d.start!==null){e.hot.selection.setRangeStart(d.start)}e.hot.selection.setRangeEnd(d.end);e.lastSetCell=o}t.preventDefault()})},getCurrentRangeCoords:function M(e,t,r,n,o){var i=e.getTopLeftCorner(),a=e.getBottomRightCorner(),s=e.getBottomLeftCorner(),l=e.getTopRightCorner();var u={start:null,end:null};switch(r){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":if(o=="topLeft"){u={start:new WalkontableCellCoords(t.row,e.highlight.col),end:new WalkontableCellCoords(s.row,t.col)}}else{u={start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,i.col)}}break;case"SE-NW":if(o=="bottomRight"){u={start:new WalkontableCellCoords(a.row,t.col),end:new WalkontableCellCoords(t.row,i.col)}}break}break;case"NW-SE":switch(n){case"NE-SW":if(o=="topLeft"){u={start:t,end:s}}else{u.end=t}break;case"NW-SE":if(o=="topLeft"){u={start:t,end:a}}else{u.end=t}break;case"SE-NW":if(o=="topLeft"){u={start:t,end:i}}else{u.end=t}break;case"SW-NE":if(o=="topLeft"){u={start:t,end:l}}else{u.end=t}break}break;case"SW-NE":switch(n){case"NW-SE":if(o=="bottomRight"){u={start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(s.row,t.col)}}else{u={start:new WalkontableCellCoords(i.row,t.col),end:new WalkontableCellCoords(t.row,a.col)}}break;case"SW-NE":if(o=="topLeft"){u={start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,a.col)}}else{u={start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(i.row,t.col)}}break;case"SE-NW":if(o=="bottomRight"){u={start:new WalkontableCellCoords(t.row,l.col),end:new WalkontableCellCoords(i.row,t.col)}}else if(o=="topLeft"){u={start:s,end:t}}break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":if(o=="topLeft"){u.end=t}break;case"SE-NW":if(o=="topLeft"){u.end=t}else{u={start:t,end:i}}break}break}return u},isDragged:function S(){return this.dragged.length>0}},{},p);g("multipleSelectionHandles",w)},{_base:63,browser:24,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,plugins:62}],111:[function(e,t,r){"use strict";Object.defineProperties(r,{DataObserver:{get:function c(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("jsonpatch"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("../../mixins/localHooks"),o&&o.__esModule&&o||{"default":o}).localHooks;var u=(i=e("../../helpers/object"),i&&i.__esModule&&i||{"default":i}).mixin;var d=(a=e("utils"),a&&a.__esModule&&a||{"default":a}).cleanPatches;var f=function h(e){this.observedData=null;this.observer=null;this.paused=false;this.setObservedData(e)};$traceurRuntime.createClass(f,{setObservedData:function m(e){var t=this;if(this.observer){s.unobserve(this.observedData,this.observer)}this.observedData=e;this.observer=s.observe(this.observedData,function(e){return t.onChange(e)})},isPaused:function p(){return this.paused},pause:function v(){this.paused=true},resume:function g(){this.paused=false},onChange:function w(e){this.runLocalHooks("change",d(e))},destroy:function b(){s.unobserve(this.observedData,this.observer);this.observedData=null;this.observer=null}},{});u(f,l)},{"../../helpers/object":53,"../../mixins/localHooks":58,jsonpatch:"jsonpatch",utils:113}],112:[function(e,t,r){"use strict";Object.defineProperties(r,{ObserveChanges:{get:function g(){return p}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).default;var f=(i=e("jsonpatch"),i&&i.__esModule&&i||{"default":i}).default;var c=(a=e("dataObserver"),a&&a.__esModule&&a||{"default":a}).DataObserver;var h=(s=e("helpers/array"),s&&s.__esModule&&s||{"default":s}).arrayEach;var m=(l=e("plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin;u.hooks.register("afterChangesObserved");var p=function w(e){$traceurRuntime.superConstructor(v).call(this,e);this.observer=null};var v=p;$traceurRuntime.createClass(p,{isEnabled:function b(){return this.hot.getSettings().observeChanges},enablePlugin:function y(){var e=this;if(this.enabled){return}if(!this.observer){this.observer=new c(this.hot.getSourceData());this._exposePublicApi()}this.observer.addLocalHook("change",function(t){return e.onDataChange(t)});this.addHook("afterCreateRow",function(){return e.onAfterTableAlter()});this.addHook("afterRemoveRow",function(){return e.onAfterTableAlter()});this.addHook("afterCreateCol",function(){return e.onAfterTableAlter()});this.addHook("afterRemoveCol",function(){return e.onAfterTableAlter()});this.addHook("afterChange",function(t,r){return e.onAfterTableAlter(r)});this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)});$traceurRuntime.superGet(this,v.prototype,"enablePlugin").call(this)},disablePlugin:function C(){if(this.observer){this.observer.destroy();this.observer=null;this._deletePublicApi()}$traceurRuntime.superGet(this,v.prototype,"disablePlugin").call(this)},onDataChange:function _(e){var t=this;if(!this.observer.isPaused()){var r=this.pluginName+".change";var n={add:function o(e){if(isNaN(e.col)){t.hot.runHooks("afterCreateRow",e.row,1,r)}else{t.hot.runHooks("afterCreateCol",e.col,1,r)}},remove:function i(e){if(isNaN(e.col)){t.hot.runHooks("afterRemoveRow",e.row,1,r)}else{t.hot.runHooks("afterRemoveCol",e.col,1,r)}},replace:function a(e){t.hot.runHooks("afterChange",[e.row,e.col,null,e.value],r)}};h(e,function(e){if(n[e.op]){n[e.op](e)}});this.hot.render()}this.hot.runHooks("afterChangesObserved")},onAfterTableAlter:function E(e){var t=this;if(e!=="loadData"){this.observer.pause();this.hot.addHookOnce("afterChangesObserved",function(){return t.observer.resume()})}},onAfterLoadData:function R(e){if(!e){this.observer.setObservedData(this.hot.getSourceData())}},destroy:function M(){if(this.observer){this.observer.destroy();this._deletePublicApi()}$traceurRuntime.superGet(this,v.prototype,"destroy").call(this)},_exposePublicApi:function S(){var e=this;var t=this.hot;t.pauseObservingChanges=function(){return e.observer.pause()};t.resumeObservingChanges=function(){return e.observer.resume()};t.isPausedObservingChanges=function(){return e.observer.isPaused()}},_deletePublicApi:function O(){var e=this.hot;delete e.pauseObservingChanges;delete e.resumeObservingChanges;delete e.isPausedObservingChanges}},{},d);m("observeChanges",p)},{_base:63,browser:24,dataObserver:111,"helpers/array":43,jsonpatch:"jsonpatch",plugins:62}],113:[function(e,t,r){"use strict";Object.defineProperties(r,{cleanPatches:{get:function u(){return s}},parsePath:{get:function d(){return l}},__esModule:{value:true}});var n;var o=(n=e("../../helpers/array"),n&&n.__esModule&&n||{"default":n}),i=o.arrayFilter,a=o.arrayMap;function s(e){var t=[];e=i(e,function(e){if(/[\/]length/gi.test(e.path)){return false}if(!l(e.path)){return false}return true});e=a(e,function(e){var t=l(e.path);e.row=t.row;e.col=t.col;return e});e=i(e,function(e){if(["add","remove"].indexOf(e.op)!==-1&&!isNaN(e.col)){if(t.indexOf(e.col)!==-1){return false}t.push(e.col)}return true});t.length=0;return e}function l(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);if(!t){return null}var r=t,n=r[1],o=r[2];return{row:parseInt(n,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}},{"../../helpers/array":43}],114:[function(e,t,r){"use strict";Object.defineProperties(r,{HandsontablePersistentState:{get:function d(){return l}},__esModule:{value:true}});var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin;function s(e){var t;var r=function i(){window.localStorage[e+"__"+"persistentStateKeys"]=JSON.stringify(t)};var n=function a(){var r=window.localStorage[e+"__"+"persistentStateKeys"];var n=typeof r=="string"?JSON.parse(r):void 0;t=n?n:[]};var o=function s(){t=[];r()};n();this.saveValue=function(n,o){window.localStorage[e+"_"+n]=JSON.stringify(o);if(t.indexOf(n)==-1){t.push(n);r()}};this.loadValue=function(t,r){t=typeof t==="undefined"?r:t;var n=window.localStorage[e+"_"+t];return typeof n=="undefined"?void 0:JSON.parse(n)};this.reset=function(t){window.localStorage.removeItem(e+"_"+t)};this.resetAll=function(){for(var r=0;r<t.length;r++){window.localStorage.removeItem(e+"_"+t[r])}o()}}function l(){var e=this;this.init=function(){var t=this,r=t.getSettings().persistentState;e.enabled=!!r;if(!e.enabled){o.call(t);return}if(!t.storage){t.storage=new s(t.rootElement.id)}t.resetState=e.resetValue;n.call(t)};this.saveValue=function(e,t){var r=this;r.storage.saveValue(e,t)};this.loadValue=function(e,t){var r=this;t.value=r.storage.loadValue(e)};this.resetValue=function(e){var t=this;if(typeof e==="undefined"){t.storage.resetAll()}else{t.storage.reset(e)}};var t={persistentStateSave:e.saveValue,persistentStateLoad:e.loadValue,persistentStateReset:e.resetValue};for(var r in t){if(t.hasOwnProperty(r)){i.hooks.register(r)}}function n(){var e=this;for(var r in t){if(t.hasOwnProperty(r)){e.addHook(r,t[r])}}}function o(){var e=this;for(var r in t){if(t.hasOwnProperty(r)){e.removeHook(r,t[r])}}}}var u=new l;i.hooks.add("beforeInit",u.init);i.hooks.add("afterUpdateSettings",u.init)},{browser:24,plugins:62}],115:[function(e,t,r){"use strict";var n,o,i;var a=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),l=s.addClass,u=s.removeClass;var d=(i=e("renderers"),i&&i.__esModule&&i||{"default":i}),f=d.registerRenderer,c=d.getRenderer;a.Search=function p(e){this.query=function(t,r,n){var o=e.countRows();var i=e.countCols();var s=[];if(!r){r=a.Search.global.getDefaultCallback()}if(!n){n=a.Search.global.getDefaultQueryMethod()}for(var l=0;l<o;l++){for(var u=0;u<i;u++){var d=e.getDataAtCell(l,u);var f=e.getCellMeta(l,u);var c=f.search.callback||r;var h=f.search.queryMethod||n;var m=h(t,d);if(m){var p={row:l,col:u,data:d};s.push(p)}if(c){c(e,l,u,d,m)}}}return s}};a.Search.DEFAULT_CALLBACK=function(e,t,r,n,o){e.getCellMeta(t,r).isSearchResult=o};a.Search.DEFAULT_QUERY_METHOD=function(e,t){if(typeof e=="undefined"||e==null||!e.toLowerCase||e.length===0){return false}if(typeof t=="undefined"||t==null){return false}return t.toString().toLowerCase().indexOf(e.toLowerCase())!=-1};a.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";a.Search.global=function(){var e=a.Search.DEFAULT_CALLBACK;var t=a.Search.DEFAULT_QUERY_METHOD;var r=a.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function n(){return e},setDefaultCallback:function o(t){e=t},getDefaultQueryMethod:function i(){return t},setDefaultQueryMethod:function s(e){t=e},getDefaultSearchResultClass:function l(){return r},setDefaultSearchResultClass:function u(e){r=e}}}();a.SearchCellDecorator=function(e,t,r,n,o,i,s){var d=s.search!==null&&_typeof(s.search)=="object"&&s.search.searchResultClass||a.Search.global.getDefaultSearchResultClass();if(s.isSearchResult){l(t,d)}else{u(t,d)}};var h=c("base");f("base",function(e,t,r,n,o,i,s){h.apply(this,arguments);a.SearchCellDecorator.apply(this,arguments)});function m(){var e=this;var t=!!e.getSettings().search;if(t){e.search=new a.Search(e)}else{delete e.search}}a.hooks.add("afterInit",m);a.hooks.add("afterUpdateSettings",m)},{browser:24,"helpers/dom/element":47,renderers:118}],116:[function(e,t,r){"use strict";Object.defineProperties(r,{TouchScroll:{get:function b(){return g}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),f=d.addClass,c=d.removeClass;var h=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var m=(a=e("_base"),a&&a.__esModule&&a||{"default":a}).default;var p=(s=e("plugins"),s&&s.__esModule&&s||{"default":s}).registerPlugin;var v=(l=e("helpers/feature"),l&&l.__esModule&&l||{"default":l}).isTouchSupported;var g=function y(e){$traceurRuntime.superConstructor(w).call(this,e);this.scrollbars=[];this.clones=[];this.lockedCollection=false};var w=g;$traceurRuntime.createClass(g,{isEnabled:function C(){return v()},enablePlugin:function _(){var e=this;if(this.enabled){return}this.addHook("afterRender",function(){return e.onAfterRender()});this.registerEvents();$traceurRuntime.superGet(this,w.prototype,"enablePlugin").call(this)},updatePlugin:function E(){this.lockedCollection=false;$traceurRuntime.superGet(this,w.prototype,"updatePlugin").call(this)},disablePlugin:function R(){$traceurRuntime.superGet(this,w.prototype,"disablePlugin").call(this)},registerEvents:function M(){var e=this;this.addHook("beforeTouchScroll",function(){return e.onBeforeTouchScroll()});this.addHook("afterMomentumScroll",function(){return e.onAfterMomentumScroll()})},onAfterRender:function S(){if(this.lockedCollection){return}var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,r=e.bottomOverlay,n=e.leftOverlay,o=e.topLeftCornerOverlay,i=e.bottomLeftCornerOverlay;this.lockedCollection=true;this.scrollbars.length=0;this.scrollbars.push(t);if(r.clone){this.scrollbars.push(r)}this.scrollbars.push(n);if(o){this.scrollbars.push(o)}if(i&&i.clone){this.scrollbars.push(i)}this.clones.length=0;if(t.needFullRender){this.clones.push(t.clone.wtTable.holder.parentNode)}if(r.needFullRender){this.clones.push(r.clone.wtTable.holder.parentNode)}if(n.needFullRender){this.clones.push(n.clone.wtTable.holder.parentNode)}if(o){this.clones.push(o.clone.wtTable.holder.parentNode)}if(i&&i.clone){this.clones.push(i.clone.wtTable.holder.parentNode)}},onBeforeTouchScroll:function O(){u.freezeOverlays=true;h(this.clones,function(e){f(e,"hide-tween")})},onAfterMomentumScroll:function T(){var e=this;u.freezeOverlays=false;h(this.clones,function(e){c(e,"hide-tween");f(e,"show-tween")});setTimeout(function(){h(e.clones,function(e){c(e,"show-tween")})},400);h(this.scrollbars,function(e){e.refresh();e.resetFixedPosition()});this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},m);p("touchScroll",g)},{_base:63,browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,plugins:62}],117:[function(e,t,r){"use strict";var n,o,i,a,s;var l=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayMap;var d=(i=e("helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var f=(a=e("helpers/object"),a&&a.__esModule&&a||{"default":a}),c=f.inherit,h=f.deepClone;var m=(s=e("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}).stopImmediatePropagation;l.UndoRedo=function(e){var t=this;this.instance=e;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;e.addHook("afterChange",function(e,r){if(e&&r!=="UndoRedo.undo"&&r!=="UndoRedo.redo"){t.done(new l.UndoRedo.ChangeAction(e))}});e.addHook("afterCreateRow",function(e,r,n){if(n==="UndoRedo.undo"||n==="UndoRedo.undo"||n==="auto"){return}var o=new l.UndoRedo.CreateRowAction(e,r);t.done(o)});e.addHook("beforeRemoveRow",function(e,r,n,o){if(o==="UndoRedo.undo"||o==="UndoRedo.redo"||o==="auto"){return}var i=t.instance.getSourceDataArray();e=(i.length+e)%i.length;var a=h(i.slice(e,e+r));t.done(new l.UndoRedo.RemoveRowAction(e,a))});e.addHook("afterCreateCol",function(e,r,n){if(n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto"){return}t.done(new l.UndoRedo.CreateColumnAction(e,r))});e.addHook("beforeRemoveCol",function(r,n,o,i){if(i==="UndoRedo.undo"||i==="UndoRedo.redo"||i==="auto"){return}var a=t.instance.getSourceDataArray();r=(t.instance.countCols()+r)%t.instance.countCols();var s=[];var u=[];var f=[];d(a.length-1,function(t){var o=[];var i=a[t];d(r,r+(n-1),function(t){o.push(i[e.runHooks("modifyCol",t)])});s.push(o)});d(n-1,function(t){f.push(e.runHooks("modifyCol",r+t))});if(Array.isArray(e.getSettings().colHeaders)){d(n-1,function(t){u.push(e.getSettings().colHeaders[e.runHooks("modifyCol",r+t)]||null)})}var c=t.instance.getPlugin("manualColumnMove");var h=c.isEnabled()?c.columnsMapper.__arrayMap:[];var m=new l.UndoRedo.RemoveColumnAction(r,f,s,u,h);t.done(m)});e.addHook("beforeCellAlignment",function(e,r,n,o){var i=new l.UndoRedo.CellAlignmentAction(e,r,n,o);t.done(i)});e.addHook("beforeFilter",function(e){t.done(new l.UndoRedo.FiltersAction(e))});e.addHook("beforeRowMove",function(e,r){if(e===false){return}t.done(new l.UndoRedo.RowMoveAction(e,r))})};l.UndoRedo.prototype.done=function(e){if(!this.ignoreNewActions){this.doneActions.push(e);this.undoneActions.length=0}};l.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();var t=h(e);var r=this.instance;var n=r.runHooks("beforeUndo",t);if(n===false){this.doneActions.push(e);return}this.ignoreNewActions=true;var o=this;e.undo(this.instance,function(){o.ignoreNewActions=false;o.undoneActions.push(e)});r.runHooks("afterUndo",t)}};l.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();var t=h(e);var r=this.instance;var n=r.runHooks("beforeRedo",t);if(n===false){return}this.ignoreNewActions=true;var o=this;e.redo(this.instance,function(){o.ignoreNewActions=false;o.doneActions.push(e)});r.runHooks("afterRedo",t)}};l.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};l.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};l.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};l.UndoRedo.Action=function(){};l.UndoRedo.Action.prototype.undo=function(){};l.UndoRedo.Action.prototype.redo=function(){};l.UndoRedo.ChangeAction=function(e){this.changes=e;this.actionType="change"};c(l.UndoRedo.ChangeAction,l.UndoRedo.Action);l.UndoRedo.ChangeAction.prototype.undo=function(e,t){var r=h(this.changes),n=e.countEmptyRows(true),o=e.countEmptyCols(true);for(var i=0,a=r.length;i<a;i++){r[i].splice(3,1)}e.addHookOnce("afterChange",t);e.setDataAtRowProp(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){if(e.getSettings().minSpareRows&&r[s][0]+1+e.getSettings().minSpareRows===e.countRows()&&n==e.getSettings().minSpareRows){e.alter("remove_row",parseInt(r[s][0]+1,10),e.getSettings().minSpareRows);e.undoRedo.doneActions.pop()}if(e.getSettings().minSpareCols&&r[s][1]+1+e.getSettings().minSpareCols===e.countCols()&&o==e.getSettings().minSpareCols){e.alter("remove_col",parseInt(r[s][1]+1,10),e.getSettings().minSpareCols);e.undoRedo.doneActions.pop()}}};l.UndoRedo.ChangeAction.prototype.redo=function(e,t){var r=h(this.changes);for(var n=0,o=r.length;n<o;n++){r[n].splice(2,1)}e.addHookOnce("afterChange",t);e.setDataAtRowProp(r,null,null,"UndoRedo.redo")};l.UndoRedo.CreateRowAction=function(e,t){this.index=e;this.amount=t;this.actionType="insert_row"};c(l.UndoRedo.CreateRowAction,l.UndoRedo.Action);l.UndoRedo.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;if(this.index>=r&&this.index-n<r){this.index-=n}e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};l.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t);e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};l.UndoRedo.RemoveRowAction=function(e,t){this.index=e;this.data=t;this.actionType="remove_row"};c(l.UndoRedo.RemoveRowAction,l.UndoRedo.Action);l.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo");e.addHookOnce("afterRender",t);e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};l.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t);e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};l.UndoRedo.CreateColumnAction=function(e,t){this.index=e;this.amount=t;this.actionType="insert_col"};c(l.UndoRedo.CreateColumnAction,l.UndoRedo.Action);l.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};l.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t);e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};l.UndoRedo.RemoveColumnAction=function(e,t,r,n,o){this.index=e;this.indexes=t;this.data=r;this.amount=this.data[0].length;this.headers=n;this.columnPositions=o.slice(0);this.actionType="remove_col"};c(l.UndoRedo.RemoveColumnAction,l.UndoRedo.Action);l.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){var r=this;var n;var o=this.indexes.slice(0).sort();var i=function c(e,t,n){return n[r.indexes.indexOf(o[t])]};var a=[];d(this.data.length-1,function(e){a[e]=u(r.data[e],i)});var s=[];s=u(this.headers,i);var f=[];l.hooks.run(e,"beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo");d(this.data.length-1,function(t){n=e.getSourceDataAtRow(t);d(o.length-1,function(e){n.splice(o[e],0,a[t][e]);f.push([t,o[e],null,a[t][e]])})});if(e.getPlugin("formulas")){e.getPlugin("formulas").onAfterSetDataAtCell(f)}if(typeof this.headers!=="undefined"){d(s.length-1,function(t){e.getSettings().colHeaders.splice(o[t],0,s[t])})}if(e.getPlugin("manualColumnMove")){e.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions}e.addHookOnce("afterRender",t);l.hooks.run(e,"afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo");if(e.getPlugin("formulas")){e.getPlugin("formulas").recalculateFull()}e.render()};l.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t);e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};l.UndoRedo.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e;this.range=t;this.type=r;this.alignment=n};l.UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){if(!e.getPlugin("contextMenu").isEnabled()){return}for(var r=this.range.from.row;r<=this.range.to.row;r++){for(var n=this.range.from.col;n<=this.range.to.col;n++){e.setCellMeta(r,n,"className",this.stateBefore[r][n]||" htLeft")}}e.addHookOnce("afterRender",t);e.render()};l.UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){if(!e.getPlugin("contextMenu").isEnabled()){return}e.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col);e.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase());e.addHookOnce("afterRender",t);e.render()};l.UndoRedo.FiltersAction=function(e){this.formulaStacks=e;this.actionType="filter"};c(l.UndoRedo.FiltersAction,l.UndoRedo.Action);l.UndoRedo.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterRender",t);r.formulaCollection.importAllFormulas(this.formulaStacks.slice(0,this.formulaStacks.length-1));r.filter()};l.UndoRedo.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterRender",t);r.formulaCollection.importAllFormulas(this.formulaStacks);r.filter()};l.UndoRedo.RowMoveAction=function(e,t){this.rows=e.slice();this.target=t};c(l.UndoRedo.RowMoveAction,l.UndoRedo.Action);
l.UndoRedo.RowMoveAction.prototype.undo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);var n=this.rows[0]<this.target?-1*this.rows.length:0;var o=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0];var i=[];var a=this.rows.length+n;for(var s=n;s<a;s++){i.push(this.target+s)}r.moveRows(i.slice(),o);e.render();e.selection.setRangeStartOnly(new WalkontableCellCoords(this.rows[0],0));e.selection.setRangeEnd(new WalkontableCellCoords(this.rows[this.rows.length-1],e.countCols()-1))};l.UndoRedo.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);r.moveRows(this.rows.slice(),this.target);e.render();var n=this.rows[0]<this.target?this.target-this.rows.length:this.target;e.selection.setRangeStartOnly(new WalkontableCellCoords(n,0));e.selection.setRangeEnd(new WalkontableCellCoords(n+this.rows.length-1,e.countCols()-1))};function p(){var e=this;var t=typeof e.getSettings().undo=="undefined"||e.getSettings().undo;if(t){if(!e.undoRedo){e.undoRedo=new l.UndoRedo(e);w(e);e.addHook("beforeKeyDown",v);e.addHook("afterChange",g)}}else{if(e.undoRedo){delete e.undoRedo;b(e);e.removeHook("beforeKeyDown",v);e.removeHook("afterChange",g)}}}function v(e){var t=this;var r=(e.ctrlKey||e.metaKey)&&!e.altKey;if(r){if(e.keyCode===89||e.shiftKey&&e.keyCode===90){t.undoRedo.redo();m(e)}else if(e.keyCode===90){t.undoRedo.undo();m(e)}}}function g(e,t){var r=this;if(t==="loadData"){return r.undoRedo.clear()}}function w(e){e.undo=function(){return e.undoRedo.undo()};e.redo=function(){return e.undoRedo.redo()};e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()};e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()};e.clearUndo=function(){return e.undoRedo.clear()}}function b(e){delete e.undo;delete e.redo;delete e.isUndoAvailable;delete e.isRedoAvailable;delete e.clearUndo}l.hooks.add("afterInit",p);l.hooks.add("afterUpdateSettings",p);l.hooks.register("beforeUndo");l.hooks.register("afterUndo");l.hooks.register("beforeRedo");l.hooks.register("afterRedo")},{browser:24,"helpers/array":43,"helpers/dom/event":48,"helpers/number":52,"helpers/object":53}],118:[function(e,t,r){"use strict";Object.defineProperties(r,{registerRenderer:{get:function f(){return l}},getRenderer:{get:function c(){return u}},hasRenderer:{get:function h(){return d}},__esModule:{value:true}});var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("helpers/string"),o&&o.__esModule&&o||{"default":o}).toUpperCaseFirst;var s={};i.renderers=i.renderers||{};i.renderers.registerRenderer=l;i.renderers.getRenderer=u;function l(e,t){var r;s[e]=t;r=a(e)+"Renderer";i.renderers[r]=t;i[r]=t;if(e==="base"){i.renderers.cellDecorator=t}}function u(e){if(typeof e=="function"){return e}if(typeof e!="string"){throw Error('Only strings and functions can be passed as "renderer" parameter')}if(!(e in s)){throw Error('No editor registered under name "'+e+'"')}return s[e]}function d(e){return e in s}},{browser:24,"helpers/string":55}],119:[function(e,t,r){"use strict";Object.defineProperties(r,{cellDecorator:{get:function d(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.addClass,s=i.removeClass;var l=(o=e("renderers"),o&&o.__esModule&&o||{"default":o}).registerRenderer;function u(e,t,r,n,o,i,l){if(l.className){if(t.className){t.className=t.className+" "+l.className}else{t.className=l.className}}if(l.readOnly){a(t,l.readOnlyCellClassName)}if(l.valid===false&&l.invalidCellClassName){a(t,l.invalidCellClassName)}else{s(t,l.invalidCellClassName)}if(l.wordWrap===false&&l.noWordWrapClassName){a(t,l.noWordWrapClassName)}if(!i&&l.placeholder){a(t,l.placeholderCellClassName)}}l("base",u)},{"helpers/dom/element":47,renderers:118}],120:[function(e,t,r){"use strict";Object.defineProperties(r,{autocompleteRenderer:{get:function y(){return b}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),l=s.addClass,u=s.hasClass,d=s.empty;var f=(o=e("eventManager"),o&&o.__esModule&&o||{"default":o}).eventManager;var c=(i=e("renderers"),i&&i.__esModule&&i||{"default":i}),h=c.getRenderer,m=c.registerRenderer;var p=(a=e("3rdparty/walkontable/src/cell/coords"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords;var v=document.createElement("DIV");v.className="htAutocompleteWrapper";var g=document.createElement("DIV");g.className="htAutocompleteArrow";g.appendChild(document.createTextNode(String.fromCharCode(9660)));var w=function C(e,t){t.innerHTML=e.innerHTML;d(e);e.appendChild(t)};function b(e,t,r,n,o,i,a){var s=v.cloneNode(true);var d=g.cloneNode(true);if(a.allowHtml){h("html").apply(this,arguments)}else{h("text").apply(this,arguments)}t.appendChild(d);l(t,"htAutocomplete");if(!t.firstChild){t.appendChild(document.createTextNode(String.fromCharCode(160)))}if(!e.acArrowListener){var c=f(e);e.acArrowListener=function(o){if(u(o.target,"htAutocompleteArrow")){e.view.wt.getSetting("onCellDblClick",null,new p(r,n),t)}};c.addEventListener(e.rootElement,"mousedown",e.acArrowListener);e.addHookOnce("afterDestroy",function(){c.destroy()})}}m("autocomplete",b)},{"3rdparty/walkontable/src/cell/coords":6,eventManager:42,"helpers/dom/element":47,renderers:118}],121:[function(e,t,r){"use strict";Object.defineProperties(r,{checkboxRenderer:{get:function P(){return O}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),f=d.empty,c=d.addClass,h=d.hasClass;var m=(o=e("helpers/string"),o&&o.__esModule&&o||{"default":o}).equalsIgnoreCase;var p=(i=e("eventManager"),i&&i.__esModule&&i||{"default":i}).EventManager;var v=(a=e("renderers"),a&&a.__esModule&&a||{"default":a}),g=v.getRenderer,w=v.registerRenderer;var b=(s=e("helpers/unicode"),s&&s.__esModule&&s||{"default":s}).isKey;var y=(l=e("helpers/function"),l&&l.__esModule&&l||{"default":l}).partial;var C=(u=e("helpers/dom/event"),u&&u.__esModule&&u||{"default":u}),_=C.stopImmediatePropagation,E=C.isImmediatePropagationStopped;var R=new WeakMap;var M=new WeakMap;var S="htBadValue";function O(e,t,r,n,o,i,a){g("base").apply(this,arguments);var s=T(e);var l=A();var u=a.label;var d=false;if(typeof a.checkedTemplate==="undefined"){a.checkedTemplate=true}if(typeof a.uncheckedTemplate==="undefined"){a.uncheckedTemplate=false}f(t);if(i===a.checkedTemplate||m(i,a.checkedTemplate)){l.checked=true}else if(i===a.uncheckedTemplate||m(i,a.uncheckedTemplate)){l.checked=false}else if(i===null){c(l,"noValue")}else{l.style.display="none";c(l,S);d=true}l.setAttribute("data-row",r);l.setAttribute("data-col",n);if(!d&&u){var h="";if(u.value){h=typeof u.value==="function"?u.value.call(this,r,n,o,i):u.value}else if(u.property){h=e.getDataAtRowProp(r,u.property)}var p=N(h);if(u.position==="before"){p.appendChild(l)}else{p.insertBefore(l,p.firstChild)}l=p}t.appendChild(l);if(d){t.appendChild(document.createTextNode("#bad-value#"))}if(!R.has(e)){R.set(e,true);e.addHook("beforeKeyDown",v)}function v(e){var t="SPACE|ENTER";var r="DELETE|BACKSPACE";var n=y(b,e.keyCode);if(n(t+"|"+r)&&!E(e)){C(function(){_(e);e.preventDefault()})}if(n(t)){w()}if(n(r)){w(true)}}function w(){var t=arguments[0]!==void 0?arguments[0]:false;var r=e.getSelectedRange();if(!r){return}var n=r.getTopLeftCorner();var o=r.getBottomRightCorner();var i=[];for(var a=n.row;a<=o.row;a+=1){for(var s=n.col;s<=o.col;s+=1){var l=e.getCellMeta(a,s);if(l.type!=="checkbox"){return}if(l.readOnly===true){continue}if(typeof l.checkedTemplate==="undefined"){l.checkedTemplate=true}if(typeof l.uncheckedTemplate==="undefined"){l.uncheckedTemplate=false}var u=e.getDataAtCell(a,s);if(t===false){if(u===l.checkedTemplate){i.push([a,s,l.uncheckedTemplate])}else if([l.uncheckedTemplate,null,void 0].indexOf(u)!==-1){i.push([a,s,l.checkedTemplate])}}else{i.push([a,s,l.uncheckedTemplate])}}}if(i.length>0){e.setDataAtCell(i)}}function C(t){var r=e.getSelectedRange();if(!r){return}var n=r.getTopLeftCorner();var o=r.getBottomRightCorner();for(var i=n.row;i<=o.row;i++){for(var a=n.col;a<=o.col;a++){var s=e.getCellMeta(i,a);if(s.type!=="checkbox"){return}var l=e.getCell(i,a);if(l==null){t(i,a,s)}else{var u=l.querySelectorAll("input[type=checkbox]");if(u.length>0&&!s.readOnly){t(u)}}}}}}function T(e){var t=M.get(e);if(!t){t=new p(e);t.addEventListener(e.rootElement,"click",function(t){return k(t,e)});t.addEventListener(e.rootElement,"mouseup",function(t){return D(t,e)});t.addEventListener(e.rootElement,"change",function(t){return x(t,e)});M.set(e,t)}return t}function A(){var e=document.createElement("input");e.className="htCheckboxRendererInput";e.type="checkbox";e.setAttribute("autocomplete","off");e.setAttribute("tabindex","-1");return e.cloneNode(false)}function N(e){var t=document.createElement("label");t.className="htCheckboxRendererLabel";t.appendChild(document.createTextNode(e));return t.cloneNode(true)}function D(e,t){if(!I(e.target)){return}setTimeout(t.listen,10)}function k(e,t){if(!I(e.target)){return false}var r=parseInt(e.target.getAttribute("data-row"),10);var n=parseInt(e.target.getAttribute("data-col"),10);var o=t.getCellMeta(r,n);if(o.readOnly){e.preventDefault()}}function x(e,t){if(!I(e.target)){return false}var r=parseInt(e.target.getAttribute("data-row"),10);var n=parseInt(e.target.getAttribute("data-col"),10);var o=t.getCellMeta(r,n);if(!o.readOnly){var i=null;if(e.target.checked){if(o.checkedTemplate===void 0){i=true}else{i=o.checkedTemplate}}else{if(o.uncheckedTemplate===void 0){i=false}else{i=o.uncheckedTemplate}}t.setDataAtCell(r,n,i)}}function I(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}w("checkbox",O)},{eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/string":55,"helpers/unicode":56,renderers:118}],122:[function(e,t,r){"use strict";Object.defineProperties(r,{htmlRenderer:{get:function d(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).fastInnerHTML;var a=(o=e("renderers"),o&&o.__esModule&&o||{"default":o}),s=a.getRenderer,l=a.registerRenderer;function u(e,t,r,n,o,a,l){s("base").apply(this,arguments);if(a===null||a===void 0){a=""}i(t,a)}l("html",u)},{"helpers/dom/element":47,renderers:118}],123:[function(e,t,r){"use strict";Object.defineProperties(r,{numericRenderer:{get:function c(){return f}},__esModule:{value:true}});var n,o,i;var a=(n=e("numbro"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("renderers"),o&&o.__esModule&&o||{"default":o}),l=s.getRenderer,u=s.registerRenderer;var d=(i=e("helpers/number"),i&&i.__esModule&&i||{"default":i}).isNumeric;function f(e,t,r,n,o,i,s){if(d(i)){if(typeof s.language!=="undefined"){a.culture(s.language)}i=a(i).format(s.format||"0");var u=s.className||"";var f=u.length?u.split(" "):[];if(f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0){f.push("htRight")}if(f.indexOf("htNumeric")<0){f.push("htNumeric")}s.className=f.join(" ")}l("text")(e,t,r,n,o,i,s)}u("numeric",f)},{"helpers/number":52,numbro:"numbro",renderers:118}],124:[function(e,t,r){"use strict";Object.defineProperties(r,{passwordRenderer:{get:function d(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).fastInnerHTML;var a=(o=e("renderers"),o&&o.__esModule&&o||{"default":o}),s=a.getRenderer,l=a.registerRenderer;function u(e,t,r,n,o,a,l){s("text").apply(this,arguments);a=t.innerHTML;var u;var d=l.hashLength||a.length;var f=l.hashSymbol||"*";for(u="";u.split(f).length-1<d;u+=f){}i(t,u)}l("password",u)},{"helpers/dom/element":47,renderers:118}],125:[function(e,t,r){"use strict";Object.defineProperties(r,{textRenderer:{get:function m(){return h}},__esModule:{value:true}});var n,o,i;var a=(n=e("helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),s=a.empty,l=a.fastInnerText;var u=(o=e("helpers/mixed"),o&&o.__esModule&&o||{"default":o}).stringify;var d=(i=e("renderers"),i&&i.__esModule&&i||{"default":i}),f=d.getRenderer,c=d.registerRenderer;function h(e,t,r,n,o,i,a){f("base").apply(this,arguments);if(!i&&a.placeholder){i=a.placeholder}var d=u(i);if(!e.getSettings().trimWhitespace){d=d.replace(/ /g,String.fromCharCode(160))}if(a.rendererTemplate){s(t);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}");c.innerHTML=a.rendererTemplate;HTMLTemplateElement.decorate(c);c.model=e.getSourceDataAtRow(r);t.appendChild(c)}else{l(t,d)}}c("text",h)},{"helpers/dom/element":47,"helpers/mixed":51,renderers:118}],126:[function(e,t,r){(function(e){"use strict";if(e.$traceurRuntime){return}var t=Object;var r=TypeError;var n=t.create;var o=t.defineProperties;var i=t.defineProperty;var a=t.freeze;var s=t.getOwnPropertyDescriptor;var l=t.getOwnPropertyNames;var u=t.keys;var d=Object.isExtensible;function f(e){return{configurable:true,enumerable:false,value:e,writable:true}}var c=f;var h=0;function m(){return"__$"+Math.floor(Math.random()*1e9)+"$"+ ++h+"$__"}var p=m();var v=m();var g=m();var w=n(null);var b=n(null);function y(e){return b[e]}function C(){var e=m();b[e]=true;return e}function _(e){return(typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e instanceof M}function E(e){if(_(e))return"symbol";return typeof e==="undefined"?"undefined":_typeof(e)}function R(e){var t=new M(e);if(!(this instanceof R))return t;throw new TypeError("Symbol cannot be new'ed")}i(R.prototype,"constructor",f(R));i(R.prototype,"toString",c(function(){var e=this[g];if(!P("symbols"))return e[p];if(!e)throw TypeError("Conversion from symbol to string");var t=e[v];if(t===undefined)t="";return"Symbol("+t+")"}));i(R.prototype,"valueOf",c(function(){var e=this[g];if(!e)throw TypeError("Conversion from symbol to string");if(!P("symbols"))return e[p];return e}));function M(e){var t=m();i(this,g,{value:this});i(this,p,{value:t});i(this,v,{value:e});D(this);w[t]=this}i(M.prototype,"constructor",f(R));i(M.prototype,"toString",{value:R.prototype.toString,enumerable:false});i(M.prototype,"valueOf",{value:R.prototype.valueOf,enumerable:false});var S=C();var O={value:undefined};var T={hash:{value:undefined},self:{value:undefined}};var A=0;function N(e){var t=e[S];if(t&&t.self===e)return t;if(d(e)){T.hash.value=A++;T.self.value=e;O.value=n(null,T);i(e,S,O);return O.value}return undefined}function D(e){N(e);return a.apply(this,arguments)}D(M.prototype);function k(e){return w[e]||b[e]}function x(e){if(_(e))return e[p];return e}function I(e){var t=[];var r=l(e);for(var n=0;n<r.length;n++){var o=w[r[n]];if(o){t.push(o)}}return t}function P(t){return e.traceur&&e.traceur.options[t]}function L(e){for(var t=1;t<arguments.length;t++){var r=l(arguments[t]);for(var n=0;n<r.length;n++){var o=r[n];if(k(o))continue;(function(t,r){i(e,r,{get:function n(){return t[r]},enumerable:true})})(arguments[t],r[n])}}return e}function H(e){return e!=null&&((typeof e==="undefined"?"undefined":_typeof(e))==="object"||typeof e==="function")}function V(e){if(e==null)throw r();return t(e)}function F(e){if(e==null){throw new TypeError("Value cannot be converted to an Object")}return e}function B(e,t){if(!e.Symbol){e.Symbol=t;Object.getOwnPropertySymbols=I}if(!e.Symbol.iterator){e.Symbol.iterator=t("Symbol.iterator")}}function j(e){B(e,R);e.Reflect=e.Reflect||{};e.Reflect.global=e.Reflect.global||e}j(e);e.$traceurRuntime={checkObjectCoercible:F,createPrivateName:C,defineProperties:o,defineProperty:i,exportStar:L,getOwnHashObject:N,getOwnPropertyDescriptor:s,getOwnPropertyNames:l,isObject:H,isPrivateName:y,isSymbolString:k,keys:u,setupGlobals:j,toObject:V,toProperty:x,"typeof":E}})(window);(function(){"use strict";var e=$traceurRuntime.toProperty;function t(){var t=[],r=0,n;for(var o=0;o<arguments.length;o++){var i=$traceurRuntime.checkObjectCoercible(arguments[o]);if(typeof i[e(Symbol.iterator)]!=="function"){i[e(Symbol.iterator)]=function(){var e=this;var t=e.length;var r=0;return{next:function n(){var n={done:true};if(r<t){n.done=false;n.value=e[r];++r}return n}}}}var a=i[e(Symbol.iterator)]();while(!(n=a.next()).done){t[r++]=n.value}}return t}$traceurRuntime.spread=t})();(function(){"use strict";var e=Object;var t=TypeError;var r=e.create;var n=$traceurRuntime.defineProperties;var o=$traceurRuntime.defineProperty;var i=$traceurRuntime.getOwnPropertyDescriptor;var a=Object.getPrototypeOf;var s=$traceurRuntime.toProperty;var l=Object,u=l.getOwnPropertyNames,d=l.getOwnPropertySymbols;function f(e,t){var r=a(e);do{var n=i(r,t);if(n)return n;r=a(r)}while(r);return undefined}function c(e){return e.__proto__}function h(e,t,r,n){return m(e,t,r).apply(e,n)}function m(e,t,r){var n=f(t,r);if(n){if(!n.get)return n.value;return n.get.call(e)}return undefined}function p(e,r,n,o){var i=f(r,n);if(i&&i.set){i.set.call(e,o);return o}throw t("super has no setter '"+n+"'.")}function v(e){var t={};var r=u(e);for(var n=0;n<r.length;n++){var o=r[n];t[o]=i(e,o)}var a=d(e);for(var n=0;n<a.length;n++){var l=a[n];t[s(l)]=i(e,s(l))}return t}function g(e,t,i,a){o(t,"constructor",{value:e,configurable:true,enumerable:false,writable:true});if(arguments.length>3){if(typeof a==="function")e.__proto__=a;e.prototype=r(w(a),v(t))}else{e.prototype=t}o(e,"prototype",{configurable:false,writable:false});return n(e,v(i))}function w(r){if(typeof r==="function"){var n=r.prototype;if(e(n)===n||n===null)return r.prototype;throw new t("super prototype must be an Object or null")}if(r===null)return null;throw new t("Super expression must either be null or a function, not "+(typeof r==="undefined"?"undefined":_typeof(r))+".")}function b(e,t,r){if(a(t)!==null)h(e,t,"constructor",r)}$traceurRuntime.createClass=g;$traceurRuntime.defaultSuperCall=b;$traceurRuntime.superCall=h;$traceurRuntime.superConstructor=c;$traceurRuntime.superGet=m;$traceurRuntime.superSet=p})()},{}],127:[function(e,t,r){"use strict";Object.defineProperties(r,{TableView:{get:function I(){return x}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),h=c.addClass,m=c.empty,p=c.fastInnerHTML,v=c.fastInnerText,g=c.getScrollbarWidth,w=c.hasClass,b=c.isChildOf,y=c.isInput,C=c.isOutsideInput,_=c.removeClass;var E=(i=e("helpers/object"),i&&i.__esModule&&i||{"default":i}).createObjectPropListener;var R=(a=e("eventManager"),a&&a.__esModule&&a||{"default":a}).eventManager;var M=(s=e("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}),S=M.stopPropagation,O=M.isImmediatePropagationStopped,T=M.isRightClick,A=M.isLeftClick;var N=(l=e("3rdparty/walkontable/src/cell/coords"),l&&l.__esModule&&l||{"default":l}).WalkontableCellCoords;var D=(u=e("3rdparty/walkontable/src/selection"),u&&u.__esModule&&u||{"default":u}).WalkontableSelection;var k=(d=e("3rdparty/walkontable/src/core"),d&&d.__esModule&&d||{"default":d}).Walkontable;f.TableView=x;function x(e){var t=this;var r=this;this.eventManager=R(e);this.instance=e;this.settings=e.getSettings();this.selectionMouseDown=false;var n=e.rootElement.getAttribute("style");if(n){e.rootElement.setAttribute("data-originalstyle",n)}h(e.rootElement,"handsontable");var o=document.createElement("TABLE");h(o,"htCore");if(e.getSettings().tableClassName){h(o,e.getSettings().tableClassName)}this.THEAD=document.createElement("THEAD");o.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");o.appendChild(this.TBODY);e.table=o;e.container.insertBefore(o,e.container.firstChild);this.eventManager.addEventListener(e.rootElement,"mousedown",function(e){this.selectionMouseDown=true;if(!r.isTextSelectionAllowed(e.target)){a();e.preventDefault();window.focus()}});this.eventManager.addEventListener(e.rootElement,"mouseup",function(e){this.selectionMouseDown=false});this.eventManager.addEventListener(e.rootElement,"mousemove",function(e){if(this.selectionMouseDown&&!r.isTextSelectionAllowed(e.target)){a();e.preventDefault()}});this.eventManager.addEventListener(document.documentElement,"keyup",function(t){if(e.selection.isInProgress()&&!t.shiftKey){e.selection.finish()}});var i;this.isMouseDown=function(){return i};this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){if(e.selection.isInProgress()&&t.which===1){e.selection.finish()}i=false;if(C(document.activeElement)){e.unlisten()}});this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){var n=t.target;var o=t.target;var a=t.x||t.clientX;var s=t.y||t.clientY;if(i||!e.rootElement){return}if(o===e.view.wt.wtTable.holder){var l=g();if(document.elementFromPoint(a+l,s)!==e.view.wt.wtTable.holder||document.elementFromPoint(a,s+l)!==e.view.wt.wtTable.holder){return}}else{while(o!==document.documentElement){if(o===null){if(t.isTargetWebComponent){break}return}if(o===e.rootElement){return}o=o.parentNode}}var u=typeof r.settings.outsideClickDeselects==="function"?r.settings.outsideClickDeselects(n):r.settings.outsideClickDeselects;if(u){e.deselectCell()}else{e.destroyEditor()}});this.eventManager.addEventListener(o,"selectstart",function(e){if(r.settings.fragmentSelection||y(e.target)){return}e.preventDefault()});var a=function u(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}else if(document.selection){document.selection.empty()}};var s=[new D({className:"current",border:{width:2,color:r.settings.selectedCellBorderColor,cornerVisible:function d(){return r.settings.fillHandle&&!r.isCellEdited()&&!e.selection.isMultiple()},multipleSelectionHandlesVisible:function c(){return!r.isCellEdited()&&!e.selection.isMultiple()}}}),new D({className:"area",border:{width:1,color:r.settings.selectedAreaBorderColor,cornerVisible:function m(){return r.settings.fillHandle&&!r.isCellEdited()&&e.selection.isMultiple()},multipleSelectionHandlesVisible:function p(){return!r.isCellEdited()&&e.selection.isMultiple()}}}),new D({className:"highlight",highlightHeaderClassName:r.settings.currentHeaderClassName,highlightRowClassName:r.settings.currentRowClassName,highlightColumnClassName:r.settings.currentColClassName}),new D({className:"fill",border:{width:1,color:r.settings.selectedFillBorderColor}})];s.current=s[0];s.area=s[1];s.highlight=s[2];s.fill=s[3];var l={debug:function v(){return r.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:o,preventOverflow:function w(){return t.settings.preventOverflow},stretchH:function b(){return r.settings.stretchH},data:e.getDataAtCell,totalRows:function _(){return e.countRows()},totalColumns:function E(){return e.countCols()},fixedColumnsLeft:function M(){return r.settings.fixedColumnsLeft},fixedRowsTop:function x(){return r.settings.fixedRowsTop},fixedRowsBottom:function I(){return r.settings.fixedRowsBottom},minSpareRows:function P(){return r.settings.minSpareRows},renderAllRows:r.settings.renderAllRows,rowHeaders:function L(){var t=[];if(e.hasRowHeaders()){t.push(function(e,t){r.appendRowHeader(e,t)})}f.hooks.run(e,"afterGetRowHeaderRenderers",t);return t},columnHeaders:function H(){var t=[];if(e.hasColHeaders()){t.push(function(e,t){r.appendColHeader(e,t)})}f.hooks.run(e,"afterGetColumnHeaderRenderers",t);return t},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function V(e,t,n){var o=r.instance.getCellMeta(e,t);var i=r.instance.colToProp(t);var a=r.instance.getDataAtRowProp(e,i);if(r.instance.hasHook("beforeValueRender")){a=r.instance.runHooks("beforeValueRender",a,e,t)}r.instance.runHooks("beforeRenderer",n,e,t,i,a,o);r.instance.getCellRenderer(o)(r.instance,n,e,t,i,a,o);r.instance.runHooks("afterRenderer",n,e,t,i,a,o)},selections:s,hideBorderOnMouseDownOver:function F(){return r.settings.fragmentSelection},onCellMouseDown:function B(t,n,o,a){var s={row:false,column:false,cells:false};e.listen();r.activeWt=a;f.hooks.run(e,"beforeOnCellMouseDown",t,n,o,s);if(O(t)){return}i=true;var l=e.getSelectedRange();var u=e.selection;var d=u.selectedHeader;if(t.shiftKey&&l){if(n.row>=0&&n.col>=0&&!s.cells){u.setSelectedHeaders(false,false);u.setRangeEnd(n)}else if((d.cols||d.rows)&&n.row>=0&&n.col>=0&&!s.cells){u.setSelectedHeaders(false,false);u.setRangeEnd(new N(n.row,n.col))}else if(d.cols&&n.row<0&&!s.column){u.setRangeEnd(new N(l.to.row,n.col))}else if(d.rows&&n.col<0&&!s.row){u.setRangeEnd(new N(n.row,l.to.col))}else if((!d.cols&&!d.rows&&n.col<0||d.cols&&n.col<0)&&!s.row){u.setSelectedHeaders(true,false);u.setRangeStartOnly(new N(l.from.row,0));u.setRangeEnd(new N(n.row,e.countCols()-1))}else if((!d.cols&&!d.rows&&n.row<0||d.rows&&n.row<0)&&!s.column){u.setSelectedHeaders(false,true);u.setRangeStartOnly(new N(0,l.from.col));u.setRangeEnd(new N(e.countRows()-1,n.col))}}else{var c=true;if(l){var h=l,m=h.from,p=h.to;var v=!u.inInSelection(n);if(n.row<0&&d.cols){var g=Math.min(m.col,p.col);var w=Math.max(m.col,p.col);c=n.col<g||n.col>w}else if(n.col<0&&d.rows){var b=Math.min(m.row,p.row);var y=Math.max(m.row,p.row);c=n.row<b||n.row>y}else{c=v}}var C=T(t);var _=A(t)||t.type==="touchstart";if(n.row<0&&n.col>=0&&!s.column){u.setSelectedHeaders(false,true);if(_||C&&c){u.setRangeStartOnly(new N(0,n.col));u.setRangeEnd(new N(Math.max(e.countRows()-1,0),n.col),false)}}else if(n.col<0&&n.row>=0&&!s.row){u.setSelectedHeaders(true,false);if(_||C&&c){u.setRangeStartOnly(new N(n.row,0));u.setRangeEnd(new N(n.row,Math.max(e.countCols()-1,0)),false)}}else if(n.col>=0&&n.row>=0&&!s.cells){if(_||C&&c){u.setSelectedHeaders(false,false);u.setRangeStart(n)}}else if(n.col<0&&n.row<0){n.row=0;n.col=0;u.setSelectedHeaders(false,false,true);u.setRangeStart(n)}}f.hooks.run(e,"afterOnCellMouseDown",t,n,o);r.activeWt=r.wt},onCellMouseOut:function j(t,n,o,i){r.activeWt=i;f.hooks.run(e,"beforeOnCellMouseOut",t,n,o);if(O(t)){return}f.hooks.run(e,"afterOnCellMouseOut",t,n,o);r.activeWt=r.wt},onCellMouseOver:function W(t,n,o,a){var s={row:false,column:false,cell:false};r.activeWt=a;f.hooks.run(e,"beforeOnCellMouseOver",t,n,o,s);if(O(t)){return}if(t.button===0&&i){if(n.row>=0&&n.col>=0){if(e.selection.selectedHeader.cols&&!s.column){e.selection.setRangeEnd(new N(e.countRows()-1,n.col),false)}else if(e.selection.selectedHeader.rows&&!s.row){e.selection.setRangeEnd(new N(n.row,e.countCols()-1),false)}else if(!s.cell){e.selection.setRangeEnd(n)}}else{if(e.selection.selectedHeader.cols&&!s.column){e.selection.setRangeEnd(new N(e.countRows()-1,n.col),false)}else if(e.selection.selectedHeader.rows&&!s.row){e.selection.setRangeEnd(new N(n.row,e.countCols()-1),false)}else if(!s.cell){e.selection.setRangeEnd(n)}}}f.hooks.run(e,"afterOnCellMouseOver",t,n,o);r.activeWt=r.wt},onCellMouseUp:function $(t,n,o,i){r.activeWt=i;f.hooks.run(e,"beforeOnCellMouseUp",t,n,o);f.hooks.run(e,"afterOnCellMouseUp",t,n,o);r.activeWt=r.wt},onCellCornerMouseDown:function U(t){t.preventDefault();f.hooks.run(e,"afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function G(t){t.preventDefault();f.hooks.run(e,"afterOnCellCornerDblClick",t)},beforeDraw:function Y(e,t){r.beforeRender(e,t)},onDraw:function z(e){r.onDraw(e)},onScrollVertically:function K(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function q(){e.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function X(t,r){e.runHooks("beforeDrawBorders",t,r)},onBeforeTouchScroll:function J(){e.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function Z(){e.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function Q(t,r){return e.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function ee(t){return e.runHooks("modifyRowHeaderWidth",t)},viewportRowCalculatorOverride:function te(t){var n=e.countRows();var o=r.settings.viewportRowRenderingOffset;if(o==="auto"&&r.settings.fixedRowsTop){o=10}if(typeof o==="number"){t.startRow=Math.max(t.startRow-o,0);t.endRow=Math.min(t.endRow+o,n-1)}if(o==="auto"){var i=t.startRow+t.endRow-t.startRow;var a=Math.ceil(i/n*12);t.startRow=Math.max(t.startRow-a,0);t.endRow=Math.min(t.endRow+a,n-1)}e.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function re(t){var n=e.countCols();var o=r.settings.viewportColumnRenderingOffset;if(o==="auto"&&r.settings.fixedColumnsLeft){o=10}if(typeof o==="number"){t.startColumn=Math.max(t.startColumn-o,0);t.endColumn=Math.min(t.endColumn+o,n-1)}if(o==="auto"){var i=t.startColumn+t.endColumn-t.startColumn;var a=Math.ceil(i/n*12);t.startRow=Math.max(t.startColumn-a,0);t.endColumn=Math.min(t.endColumn+a,n-1)}e.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function ne(){return r.settings.rowHeaderWidth},columnHeaderHeight:function oe(){var oe=e.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||oe}};f.hooks.run(e,"beforeInitWalkontable",l);this.wt=new k(l);this.activeWt=this.wt;this.eventManager.addEventListener(r.wt.wtTable.spreader,"mousedown",function(e){if(e.target===r.wt.wtTable.spreader&&e.which===3){S(e)}});this.eventManager.addEventListener(r.wt.wtTable.spreader,"contextmenu",function(e){if(e.target===r.wt.wtTable.spreader&&e.which===3){S(e)}});this.eventManager.addEventListener(document.documentElement,"click",function(){if(r.settings.observeDOMVisibility){if(r.wt.drawInterrupted){r.instance.forceFullRender=true;r.render()}}})}x.prototype.isTextSelectionAllowed=function(e){if(y(e)){return true}var t=b(e,this.instance.view.wt.wtTable.spreader);if(this.settings.fragmentSelection===true&&t){return true}if(this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t){return true}if(!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell()){return true}return false};x.prototype.isSelectedOnlyCell=function(){var e=this.instance.getSelected()||[],t=e[0],r=e[1],n=e[2],o=e[3];return t!==void 0&&t===n&&r===o};x.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()};x.prototype.beforeRender=function(e,t){if(e){f.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender,t)}};x.prototype.onDraw=function(e){if(e){f.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)}};x.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.renderCall=false};x.prototype.getCellAtCoords=function(e,t){var r=this.wt.getCell(e,t);if(r<0){return null}else{return r}};x.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)};x.prototype.appendRowHeader=function(e,t){if(t.firstChild){var r=t.firstChild;if(!w(r,"relative")){m(t);this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var n=document.createElement("div");var o=document.createElement("span");n.className="relative";o.className="rowHeader";this.updateCellHeader(o,e,this.instance.getRowHeader);n.appendChild(o);t.appendChild(n)}f.hooks.run(this.instance,"afterGetRowHeader",e,t)};x.prototype.appendColHeader=function(e,t){if(t.firstChild){var r=t.firstChild;if(w(r,"relative")){this.updateCellHeader(r.querySelector(".colHeader"),e,this.instance.getColHeader)}else{m(t);this.appendColHeader(e,t)}}else{var n=document.createElement("div");var o=document.createElement("span");n.className="relative";o.className="colHeader";this.updateCellHeader(o,e,this.instance.getColHeader);n.appendChild(o);t.appendChild(n)}f.hooks.run(this.instance,"afterGetColHeader",e,t)};x.prototype.updateCellHeader=function(e,t,r){var n=t;var o=this.wt.wtOverlays.getParentOverlay(e)||this.wt;if(e.parentNode){if(w(e,"colHeader")){n=o.wtTable.columnFilter.sourceToRendered(t)}else if(w(e,"rowHeader")){n=o.wtTable.rowFilter.sourceToRendered(t)}}if(n>-1){p(e,r(t))}else{v(e,String.fromCharCode(160));h(e,"cornerHeader")}};x.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth();var r=t-e;return r>0?r:0};x.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight();
var r=t-e;return r>0?r:0};x.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};x.prototype.destroy=function(){this.wt.destroy();this.eventManager.destroy()}},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/core":8,"3rdparty/walkontable/src/selection":19,browser:24,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53}],128:[function(e,t,r){"use strict";Object.defineProperties(r,{NodeStructure:{get:function s(){return i}},LinkedList:{get:function l(){return a}},__esModule:{value:true}});var n;var o=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var i=function u(e){this.data=e;this.next=null;this.prev=null};$traceurRuntime.createClass(i,{},{});var a=function d(){this.first=null;this.last=null};$traceurRuntime.createClass(a,{push:function f(e){var t=new i(e);if(this.first===null){this.first=this.last=t}else{var r=this.last;this.last=t;t.prev=r;r.next=t}},unshift:function c(e){var t=new i(e);if(this.first===null){this.first=this.last=t}else{var r=this.first;this.first=t;t.next=r;r.prev=t}},inorder:function h(e){var t=this.first;while(t){e(t);t=t.next}},remove:function m(e){if(this.first===null){return false}var t=this.first;var r;var n;while(t){if(t.data===e){r=t.next;n=t.prev;if(r){r.prev=n}if(n){n.next=r}if(t===this.first){this.first=r}if(t===this.last){this.last=n}return true}t=t.next}return false},hasCycle:function p(){var e=this.first;var t=this.first;while(true){if(e===null){return false}e=e.next;if(e===null){return false}e=e.next;t=t.next;if(e===t){return true}}},pop:function v(){if(this.last===null){return null}var e=this.last;this.last=this.last.prev;return e},shift:function g(){if(this.first===null){return null}var e=this.first;this.first=this.first.next;return e},recursiveReverse:function w(){function e(t,r){if(!r){return}e(r,r.next);r.next=t}if(!this.first){return}e(this.first,this.first.next);this.first.next=null;var t=this.first;this.first=this.last;this.last=t},reverse:function b(){if(!this.first||!this.first.next){return}var e=this.first.next;var t=this.first;var r;while(e){r=e.next;e.next=t;t.prev=e;t=e;e=r}this.first.next=null;this.last.prev=null;r=this.first;this.first=t;this.last=r}},{});o.utils.NodeStructure=i;o.utils.LinkedList=a},{browser:24}],129:[function(e,t,r){"use strict";Object.defineProperties(r,{Stack:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var i=function s(){var e=arguments[0]!==void 0?arguments[0]:[];this.items=e};$traceurRuntime.createClass(i,{push:function l(){var e;for(var t=[],r=0;r<arguments.length;r++){t[r]=arguments[r]}(e=this.items).push.apply(e,$traceurRuntime.spread(t))},pop:function u(){return this.items.pop()},peek:function d(){return this.isEmpty()?void 0:this.items[this.items.length-1]},isEmpty:function f(){return!this.size()},size:function c(){return this.items.length}},{});o.utils.Stack=i},{browser:24}],130:[function(e,t,r){"use strict";Object.defineProperties(r,{GhostTable:{get:function b(){return w}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),f=d.addClass,c=d.outerHeight,h=d.outerWidth;var m=(i=e("helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var p=(a=e("helpers/object"),a&&a.__esModule&&a||{"default":a}).objectEach;var v=(s=e("helpers/number"),s&&s.__esModule&&s||{"default":s}).rangeEach;var g=(l=e("helpers/mixed"),l&&l.__esModule&&l||{"default":l}).stringify;var w=function y(e){this.hot=e;this.container=null;this.injected=false;this.rows=[];this.columns=[];this.samples=null;this.settings={useHeaders:true}};$traceurRuntime.createClass(w,{addRow:function C(e,t){if(this.columns.length){throw new Error("Doesn't support multi-dimensional table")}if(!this.rows.length){this.container=this.createContainer(this.hot.rootElement.className)}var r={row:e};this.rows.push(r);this.samples=t;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tr.appendChild(this.createRow(e));this.container.container.appendChild(this.table.fragment);r.table=this.table.table},addColumnHeadersRow:function _(e){if(this.hot.getColHeader(0)!=null){var t={row:-1};this.rows.push(t);this.container=this.createContainer(this.hot.rootElement.className);this.samples=e;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tHead.appendChild(this.createColumnHeadersRow());this.container.container.appendChild(this.table.fragment);t.table=this.table.table}},addColumn:function E(e,t){if(this.rows.length){throw new Error("Doesn't support multi-dimensional table")}if(!this.columns.length){this.container=this.createContainer(this.hot.rootElement.className)}var r={col:e};this.columns.push(r);this.samples=t;this.table=this.createTable(this.hot.table.className);if(this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null){this.hot.view.appendColHeader(e,this.table.th)}this.table.tBody.appendChild(this.createCol(e));this.container.container.appendChild(this.table.fragment);r.table=this.table.table},getHeights:function R(e){if(!this.injected){this.injectTable()}m(this.rows,function(t){e(t.row,c(t.table)-1)})},getWidths:function M(e){if(!this.injected){this.injectTable()}m(this.columns,function(t){e(t.col,h(t.table))})},setSettings:function S(e){this.settings=e},setSetting:function O(e,t){if(!this.settings){this.settings={}}this.settings[e]=t},getSettings:function T(){return this.settings},getSetting:function A(e){if(this.settings){return this.settings[e]}else{return null}},createColGroupsCol:function N(){var e=this;var t=document;var r=t.createDocumentFragment();if(this.hot.hasRowHeaders()){r.appendChild(this.createColElement(-1))}this.samples.forEach(function(t){m(t.strings,function(t){r.appendChild(e.createColElement(t.col))})});return r},createRow:function D(e){var t=this;var r=document;var n=r.createDocumentFragment();var o=r.createElement("th");if(this.hot.hasRowHeaders()){this.hot.view.appendRowHeader(e,o);n.appendChild(o)}this.samples.forEach(function(o){m(o.strings,function(o){var i=o.col;var a=t.hot.getCellMeta(e,i);a.col=i;a.row=e;var s=t.hot.getCellRenderer(a);var l=r.createElement("td");s(t.hot,l,e,i,t.hot.colToProp(i),o.value,a);n.appendChild(l)})});return n},createColumnHeadersRow:function k(){var e=this;var t=document;var r=t.createDocumentFragment();if(this.hot.hasRowHeaders()){var n=t.createElement("th");this.hot.view.appendColHeader(-1,n);r.appendChild(n)}this.samples.forEach(function(n){m(n.strings,function(n){var o=n.col;var i=t.createElement("th");e.hot.view.appendColHeader(o,i);r.appendChild(i)})});return r},createCol:function x(e){var t=this;var r=document;var n=r.createDocumentFragment();this.samples.forEach(function(o){m(o.strings,function(o){var i=o.row;var a=t.hot.getCellMeta(i,e);a.col=e;a.row=i;var s=t.hot.getCellRenderer(a);var l=r.createElement("td");var u=r.createElement("tr");s(t.hot,l,i,e,t.hot.colToProp(e),o.value,a);u.appendChild(l);n.appendChild(u)})});return n},clean:function I(){this.rows.length=0;this.rows[-1]=void 0;this.columns.length=0;if(this.samples){this.samples.clear()}this.samples=null;this.removeTable()},injectTable:function P(){var e=arguments[0]!==void 0?arguments[0]:null;if(!this.injected){(e||this.hot.rootElement).appendChild(this.container.fragment);this.injected=true}},removeTable:function L(){if(this.injected&&this.container.container.parentNode){this.container.container.parentNode.removeChild(this.container.container);this.container=null;this.injected=false}},createColElement:function H(e){var t=document;var r=t.createElement("col");r.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(e)+"px";return r},createTable:function V(){var e=arguments[0]!==void 0?arguments[0]:"";var t=document;var r=t.createDocumentFragment();var n=t.createElement("table");var o=t.createElement("thead");var i=t.createElement("tbody");var a=t.createElement("colgroup");var s=t.createElement("tr");var l=t.createElement("th");if(this.isVertical()){n.appendChild(a)}if(this.isHorizontal()){s.appendChild(l);o.appendChild(s);n.style.tableLayout="auto";n.style.width="auto"}n.appendChild(o);if(this.isVertical()){i.appendChild(s)}n.appendChild(i);f(n,e);r.appendChild(n);return{fragment:r,table:n,tHead:o,tBody:i,colGroup:a,tr:s,th:l}},createContainer:function F(){var e=arguments[0]!==void 0?arguments[0]:"";var t=document;var r=t.createDocumentFragment();var n=t.createElement("div");e="htGhostTable htAutoSize "+e.trim();f(n,e);r.appendChild(n);return{fragment:r,container:n}},isVertical:function B(){return this.rows.length&&!this.columns.length?true:false},isHorizontal:function j(){return this.columns.length&&!this.rows.length?true:false}},{});u.utils.GhostTable=w},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],131:[function(e,t,r){"use strict";Object.defineProperties(r,{Interval:{get:function c(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("helpers/feature"),o&&o.__esModule&&o||{"default":o}),s=a.requestAnimationFrame,l=a.cancelAnimationFrame;var u=function h(e,t){var r=this;this.timer=null;this.func=e;this.delay=f(t);this.stopped=true;this._then=null;this._callback=function(){return r.__callback()}};var d=u;$traceurRuntime.createClass(u,{start:function m(){if(this.stopped){this._then=Date.now();this.stopped=false;this.timer=s(this._callback)}return this},stop:function p(){if(!this.stopped){this.stopped=true;l(this.timer);this.timer=null}return this},__callback:function v(){this.timer=s(this._callback);if(this.delay){var e=Date.now();var t=e-this._then;if(t>this.delay){this._then=e-t%this.delay;this.func()}}else{this.func()}}},{create:function g(e,t){return new d(e,t)}});function f(e){if(typeof e==="string"&&/fps$/.test(e)){e=1e3/parseInt(e.replace("fps","")||0,10)}return e}i.utils.Interval=u},{browser:24,"helpers/feature":49}],132:[function(e,t,r){"use strict";Object.defineProperties(r,{registerIdentity:{get:function c(){return d}},getTranslator:{get:function h(){return f}},__esModule:{value:true}});var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("helpers/object"),o&&o.__esModule&&o||{"default":o}).isObject;var s=function m(e){this.hot=e};$traceurRuntime.createClass(s,{toVisualRow:function p(e){return this.hot.runHooks("unmodifyRow",e)},toVisualColumn:function v(e){return this.hot.runHooks("unmodifyCol",e)},toVisual:function g(e,t){var r;if(a(e)){r={row:this.toVisualRow(e.row),column:this.toVisualColumn(e.column)}}else{r=[this.toVisualRow(e),this.toVisualColumn(t)]}return r},toPhysicalRow:function w(e){return this.hot.runHooks("modifyRow",e)},toPhysicalColumn:function b(e){return this.hot.runHooks("modifyCol",e)},toPhysical:function y(e,t){var r;if(a(e)){r={row:this.toPhysicalRow(e.row),column:this.toPhysicalColumn(e.column)}}else{r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)]}return r}},{});var l=new WeakMap;var u=new WeakMap;function d(e,t){l.set(e,t)}function f(e){var t;if(!(e instanceof i.Core)){if(!l.has(e)){throw Error("Record translator was not registered for this object identity")}e=l.get(e)}if(u.has(e)){t=u.get(e)}else{t=new s(e);u.set(e,t)}return t}i.utils.RecordTranslator=s;i.utils.RecordTranslatorUtils={registerIdentity:d,getTranslator:f}},{browser:24,"helpers/object":53}],133:[function(e,t,r){"use strict";var n;Object.defineProperties(r,{SamplesGenerator:{get:function E(){return C}},__esModule:{value:true}});var o,i,a,s,l,u;var d=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var f=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{"default":i}),c=f.addClass,h=f.outerHeight,m=f.outerWidth;var p=(a=e("helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var v=(s=e("helpers/object"),s&&s.__esModule&&s||{"default":s}),g=v.objectEach,w=v.isObject;var b=(l=e("helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach;var y=(u=e("helpers/mixed"),u&&u.__esModule&&u||{"default":u}).stringify;var C=function R(e){this.samples=null;this.dataFactory=e;this.customSampleCount=null;this.allowDuplicates=false};var _=C;$traceurRuntime.createClass(C,(n={},Object.defineProperty(n,"getSampleCount",{value:function M(){if(this.customSampleCount){return this.customSampleCount}return _.SAMPLE_COUNT},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"setSampleCount",{value:function S(e){this.customSampleCount=e},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"setAllowDuplicates",{value:function O(e){this.allowDuplicates=e},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"generateRowSamples",{value:function T(e,t){return this.generateSamples("row",t,e)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"generateColumnSamples",{value:function A(e,t){return this.generateSamples("col",t,e)},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"generateSamples",{value:function N(e,t,r){var n=this;var o=new Map;if(typeof r==="number"){r={from:r,to:r}}b(r.from,r.to,function(r){var i=n.generateSample(e,t,r);o.set(r,i)});return o},configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,"generateSample",{value:function D(e,t,r){var n=this;var o=new Map;var i=[];var a;b(t.from,t.to,function(t){var s;var l;if(e==="row"){l=n.dataFactory(r,t)}else if(e==="col"){l=n.dataFactory(t,r)}else{throw new Error("Unsupported sample type")}if(w(l)){a=Object.keys(l).length}else if(Array.isArray(l)){a=l.length}else{a=y(l).length}if(!o.has(a)){o.set(a,{needed:n.getSampleCount(),strings:[]})}var u=o.get(a);if(u.needed){var d=i.indexOf(l)>-1;if(!d||n.allowDuplicates){var f=e==="row"?"col":"row";u.strings.push((s={},Object.defineProperty(s,"value",{value:l,configurable:true,enumerable:true,writable:true}),Object.defineProperty(s,f,{value:t,configurable:true,enumerable:true,writable:true}),s));i.push(l);u.needed--}}});return o},configurable:true,enumerable:true,writable:true}),n),{get SAMPLE_COUNT(){return 3}});d.utils.SamplesGenerator=C},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],134:[function(e,t,r){"use strict";Object.defineProperties(r,{mergeSort:{get:function d(){return l}},__esModule:{value:true}});var n,o;var i=(n=e("../dataStructures/linkedList"),n&&n.__esModule&&n||{"default":n}).LinkedList;var a=(o=e("browser"),o&&o.__esModule&&o||{"default":o}).default;var s=function f(e,t){var r=e.toString();var n=t.toString();if(r===n){return 0}else if(r<n){return-1}else{return 1}};function l(e){var t=arguments[1]!==void 0?arguments[1]:s;var r=arguments[2]!==void 0?arguments[2]:0;var n=arguments[3]!==void 0?arguments[3]:e.length;if(Math.abs(n-r)<=1){return[]}var o=Math.ceil((r+n)/2);l(e,t,r,o);l(e,t,o,n);return u(e,t,r,o,n)}function u(e,t,r,n,o){var a=new i;var s=new i;var l=n-r;var u=o-n;var d=Math.max(l,u);var f=o-r;for(var c=0;c<d;c+=1){if(c<l){a.push(e[r+c])}if(c<u){s.push(e[n+c])}}var h=0;while(h<f){if(a.first&&s.first){if(t(a.first.data,s.first.data)>0){e[r+h]=s.shift().data}else{e[r+h]=a.shift().data}}else if(a.first){e[r+h]=a.shift().data}else{e[r+h]=s.shift().data}h+=1}return e}a.utils.mergeSort=l},{"../dataStructures/linkedList":128,browser:24}],135:[function(e,t,r){"use strict";var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("helpers/mixed"),o&&o.__esModule&&o||{"default":o}).stringify;i.AutocompleteValidator=function(e,t){if(e==null){e=""}if(this.allowEmpty&&e===""){t(true);return}if(this.strict&&this.source){if(typeof this.source==="function"){this.source(e,s(e,t))}else{s(e,t)(this.source)}}else{t(true)}};function s(e,t){var r=e;return function(e){var n=false;for(var o=0,i=e.length;o<i;o++){if(r===e[o]){n=true;break}}t(n)}}},{browser:24,"helpers/mixed":51}],136:[function(e,t,r){"use strict";var n,o,i,a;var s=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var u=(i=e("../helpers/date"),i&&i.__esModule&&i||{"default":i}).getNormalizedDate;var d=(a=e("editors"),a&&a.__esModule&&a||{"default":a}).getEditor;s.DateValidator=function(e,t){var r=true;var n=d("date",this.instance);if(e==null){e=""}var o=l(new Date(e)).isValid()||l(e,n.defaultDateFormat).isValid();var i=l(e,this.dateFormat||n.defaultDateFormat,true).isValid();if(this.allowEmpty&&e===""){o=true;i=true}if(!o){r=false}if(!o&&i){r=true}if(o&&!i){if(this.correctFormat===true){var a=f(e,this.dateFormat);var s=this.instance.runHooks("unmodifyRow",this.row);var u=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(s,u,a,"dateValidator");r=true}else{r=false}}t(r)};var f=function c(e,t){var r=l(u(e));var n=l(e,t);var o=e.search(/[A-z]/g)>-1;var i;if(r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o){i=r}else{i=n}return i.format(t)}},{"../helpers/date":46,browser:24,editors:30,moment:"moment"}],137:[function(e,t,r){"use strict";var n;var o=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;o.NumericValidator=function(e,t){if(e==null){e=""}if(this.allowEmpty&&e===""){t(true)}else if(e===""){t(false)}else{t(/^-?\d*(\.|\,)?\d*$/.test(e))}}},{browser:24}],138:[function(e,t,r){"use strict";var n,o;var i=(n=e("browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var s=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];i.TimeValidator=function(e,t){var r=true;var n=this.timeFormat||"h:mm:ss a";if(e===null){e=""}e=/^\d{3,}$/.test(e)?parseInt(e,10):e;var o=/^\d{1,2}$/.test(e);if(o){e=e+":00"}var i=a(e,s,true).isValid()?a(e):a(e,n);var l=i.isValid();var u=a(e,n,true).isValid()&&!o;if(this.allowEmpty&&e===""){l=true;u=true}if(!l){r=false}if(!l&&u){r=true}if(l&&!u){if(this.correctFormat===true){var d=i.format(n);var f=this.instance.runHooks("unmodifyRow",this.row);var c=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(f,c,d,"timeValidator");r=true}else{r=false}}t(r)}},{browser:24,moment:"moment"}],139:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableBottomOverlay:{get:function b(){return g}},__esModule:{value:true}});var n,o;var i=(n=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.addClass,s=i.getScrollbarWidth,l=i.getScrollTop,u=i.getWindowScrollLeft,d=i.hasClass,f=i.outerHeight,c=i.innerHeight,h=i.removeClass,m=i.setOverlayPosition,p=i.resetCssTransform;var v=(o=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlay;var g=function y(e){$traceurRuntime.superConstructor(w).call(this,e);this.clone=this.makeClone(v.CLONE_BOTTOM)};var w=g;$traceurRuntime.createClass(g,{repositionOverlay:function C(){var e=s();var t=this.clone.wtTable.holder.parentNode;if(this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight){e=0}t.style.top="";t.style.bottom=e+"px"},shouldBeRendered:function _(){return this.wot.getSetting("fixedRowsBottom")?true:false},resetFixedPosition:function E(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=0;e.style.top="";if(this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var r=this.wot.wtTable.hider.getBoundingClientRect();var n=Math.ceil(r.bottom);var o;var i;var a=document.body.offsetHeight;o=this.wot.wtTable.hider.style.left;o=o===""?0:o;if(n>a){i=n-a}else{i=0}t=i;i=i+"px";e.style.top="";e.style.left=o;e.style.bottom=i}else{t=this.getScrollPosition();p(e);this.repositionOverlay()}this.adjustHeaderBordersPosition(t)},setScrollPosition:function R(e){if(this.mainTableScrollableElement===window){window.scrollTo(u(),e)}else{this.mainTableScrollableElement.scrollTop=e}},onScroll:function M(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function S(e,t){var r=0;var n=this.wot.wtSettings.settings.defaultRowHeight;while(e<t){var o=this.wot.wtTable.getRowHeight(e);r+=o===void 0?n:o;e++}return r},adjustElementsSize:function O(){var e=arguments[0]!==void 0?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||e){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!e){this.areElementSizesAdjusted=true}}},adjustRootElementSize:function T(){var e=this.wot.wtTable.holder;var t=e.clientWidth===e.offsetWidth?0:s();var r=this.clone.wtTable.holder.parentNode;var n=r.style;var o;if(this.trimmingContainer===window){n.width=""}else{n.width=this.wot.wtViewport.getWorkspaceWidth()-t+"px"}this.clone.wtTable.holder.style.width=n.width;o=f(this.clone.wtTable.TABLE);n.height=(o===0?o:o)+"px"},adjustRootChildrenSize:function A(){var e=s();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(e===0){e=30}this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"},applyToDOM:function N(){var e=this.wot.getSetting("totalRows");if(!this.areElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px"}else if(e===0){this.spreader.style.top="0"}else{throw new Error("Incorrect value of the rowsRenderCalculator")}this.spreader.style.bottom="";if(this.needFullRender){this.syncOverlayOffset()}},syncOverlayOffset:function D(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px"}else{this.clone.wtTable.spreader.style.left=""}},scrollTo:function k(e,t){var r=this.getTableParentOffset();var n=this.wot.cloneSource?this.wot.cloneSource:this.wot;var o=n.wtTable.holder;var i=0;if(t&&o.offsetHeight!==o.clientHeight){i=s()}if(t){r+=this.sumCellSizes(0,e+1);r-=this.wot.wtViewport.getViewportHeight();r+=1}else{r+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),e)}r+=i;this.setScrollPosition(r)},getTableParentOffset:function x(){if(this.mainTableScrollableElement===window){return this.wot.wtTable.holderOffset.top}return 0},getScrollPosition:function I(){return l(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function P(e){if(this.wot.getSetting("fixedRowsBottom")===0&&this.wot.getSetting("columnHeaders").length>0){var t=this.wot.wtTable.holder.parentNode;var r=d(t,"innerBorderTop");if(e){a(t,"innerBorderTop")}else{h(t,"innerBorderTop")}if(!r&&e||r&&!e){this.wot.wtOverlays.adjustElementsSize()}}if(this.wot.getSetting("rowHeaders").length===0){var n=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");if(n){n.style["border-left-width"]=0}}}},{},v);window.WalkontableBottomOverlay=g;v.registerOverlay(v.CLONE_BOTTOM,g)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],140:[function(e,t,r){"use strict";Object.defineProperties(r,{WalkontableBottomLeftCornerOverlay:{get:function m(){return c}},__esModule:{value:true}});var n,o;var i=(n=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),a=i.getScrollbarWidth,s=i.outerHeight,l=i.outerWidth,u=i.setOverlayPosition,d=i.resetCssTransform;var f=(o=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlay;var c=function p(e){$traceurRuntime.superConstructor(h).call(this,e);this.clone=this.makeClone(f.CLONE_BOTTOM_LEFT_CORNER)};var h=c;$traceurRuntime.createClass(c,{shouldBeRendered:function v(){return this.wot.getSetting("fixedRowsBottom")&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?true:false},repositionOverlay:function g(){var e=a();var t=this.clone.wtTable.holder.parentNode;if(this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight){e=0}t.style.top="";t.style.bottom=e+"px"},resetFixedPosition:function w(){this.updateTrimmingContainer();if(!this.wot.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=s(this.clone.wtTable.TABLE);var r=l(this.clone.wtTable.TABLE);e.style.top="";if(this.trimmingContainer===window){var n=this.wot.wtTable.hider.getBoundingClientRect();var o=Math.ceil(n.bottom);var i=Math.ceil(n.left);var a;var u;var f=document.body.offsetHeight;if(i<0){a=-i}else{a=0}if(o>f){u=o-f}else{u=0}u=u+"px";a=a+"px";e.style.top="";e.style.left=a;e.style.bottom=u}else{d(e);this.repositionOverlay()}e.style.height=(t===0?t:t)+"px";e.style.width=(r===0?r:r)+"px"}},{},f);window.WalkontableBottomLeftCornerOverlay=c;f.registerOverlay(f.CLONE_BOTTOM_LEFT_CORNER,c)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],141:[function(e,t,r){"use strict";var n,o,i;var a=(n=e("../node_modules/hot-builder/node_modules/handsontable/src/browser"),n&&n.__esModule&&n||{"default":n}).default;var s=(o=e("3rdparty/walkontable/src/overlay/bottom"),o&&o.__esModule&&o||{"default":o}).WalkontableBottomOverlay;var l=(i=e("3rdparty/walkontable/src/overlay/bottomLeftCorner"),i&&i.__esModule&&i||{"default":i}).WalkontableBottomLeftCornerOverlay;t.exports=a},{"../node_modules/hot-builder/node_modules/handsontable/src/browser":24,"3rdparty/walkontable/src/overlay/bottom":139,"3rdparty/walkontable/src/overlay/bottomLeftCorner":140}],142:[function(e,t,r){"use strict";Object.defineProperties(r,{BindRowsWithHeaders:{get:function p(){return h}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var d=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var f=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),a&&a.__esModule&&a||{"default":a}).registerPlugin;var c=(s=e("bindStrategy"),s&&s.__esModule&&s||{"default":s}).BindStrategy;var h=function v(e){$traceurRuntime.superConstructor(m).call(this,e);this.bindStrategy=new c;this.removedRows=[]};var m=h;$traceurRuntime.createClass(h,{isEnabled:function g(){return!!this.hot.getSettings().bindRowsWithHeaders},enablePlugin:function w(){var e=this;if(this.enabled){return}var t=this.hot.getSettings().bindRowsWithHeaders;if(typeof t!=="string"){t=c.DEFAULT_STRATEGY}this.bindStrategy.setStrategy(t);this.bindStrategy.createMap(this.hot.countSourceRows());this.addHook("modifyRowHeader",function(t){return e.onModifyRowHeader(t)});this.addHook("afterCreateRow",function(t,r){return e.onAfterCreateRow(t,r)});this.addHook("beforeRemoveRow",function(t,r){return e.onBeforeRemoveRow(t,r)});this.addHook("afterRemoveRow",function(t,r){return e.onAfterRemoveRow(t,r)});this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)});$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this)},updatePlugin:function b(){$traceurRuntime.superGet(this,m.prototype,"updatePlugin").call(this)},disablePlugin:function y(){this.removedRows.length=0;this.bindStrategy.clearMap();$traceurRuntime.superGet(this,m.prototype,"disablePlugin").call(this)},onModifyRowHeader:function C(e){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",e))},onAfterCreateRow:function _(e,t){this.bindStrategy.createRow(e,t)},onBeforeRemoveRow:function E(e,t){var r=this;this.removedRows.length=0;if(e!==false){d(e,e+t-1,function(e){r.removedRows.push(r.hot.runHooks("modifyRow",e))})}},onAfterRemoveRow:function R(e,t){this.bindStrategy.removeRow(this.removedRows)},onAfterLoadData:function M(e){if(!e){this.bindStrategy.createMap(this.hot.countSourceRows())}},destroy:function S(){this.bindStrategy.destroy();$traceurRuntime.superGet(this,m.prototype,"destroy").call(this)}},{},l);f("bindRowsWithHeaders",h)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,bindStrategy:143}],143:[function(e,t,r){"use strict";Object.defineProperties(r,{BindStrategy:{get:function h(){return c}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),o&&o.__esModule&&o||{"default":o}).arrayMapper;var u=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{"default":i}).mixin;var d=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),a&&a.__esModule&&a||{"default":a}).rangeEach;var f={};var c=function m(){this.strategy=null};$traceurRuntime.createClass(c,{setStrategy:function p(e){var t=f[e];if(!t){throw new Error('Bind strategy "'+e+'" does not exist.')}this.strategy=new t},createMap:function v(e){var t=this.strategy;var r=e===void 0?t._arrayMap.length:e;t._arrayMap.length=0;d(r-1,function(e){t._arrayMap.push(e)})},createRow:function g(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.strategy.createRow.apply(this.strategy,e)},removeRow:function w(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.strategy.removeRow.apply(this.strategy,e)},translate:function b(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}return this.strategy.getValueByIndex.apply(this.strategy,e)},clearMap:function y(){this.strategy.clearMap()},destroy:function C(){if(this.strategy){this.strategy.destroy()}this.strategy=null}},{get DEFAULT_STRATEGY(){return"loose"},registerStrategy:function _(e,t){f[e]=t}});s.utils.BindStrategy=c},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":141}],144:[function(e,t,r){"use strict";Object.defineProperties(r,{LooseBindStrategy:{get:function d(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),n&&n.__esModule&&n||{"default":n}).arrayMapper;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).mixin;var l=(i=e("bindStrategy"),i&&i.__esModule&&i||{"default":i}).BindStrategy;var u=function f(){};$traceurRuntime.createClass(u,{createRow:function c(e,t){this.shiftItems(e,t)},removeRow:function h(e,t){this.unshiftItems(e,t)},destroy:function m(){this._arrayMap=null}},{get STRATEGY_NAME(){return"loose"}});s(u,a);l.registerStrategy(u.STRATEGY_NAME,u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:143}],145:[function(e,t,r){"use strict";Object.defineProperties(r,{StrictBindStrategy:{get:function d(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),
n&&n.__esModule&&n||{"default":n}).arrayMapper;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).mixin;var l=(i=e("bindStrategy"),i&&i.__esModule&&i||{"default":i}).BindStrategy;var u=function f(){};$traceurRuntime.createClass(u,{createRow:function c(e,t){this.insertItems(e,t)},removeRow:function h(e,t){this.removeItems(e,t)},destroy:function m(){this._arrayMap=null}},{get STRATEGY_NAME(){return"strict"}});s(u,a);l.registerStrategy(u.STRATEGY_NAME,u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:143}],146:[function(e,t,r){"use strict";Object.defineProperties(r,{CollapsibleColumns:{get:function O(){return M}},__esModule:{value:true}});var n,o,i,a,s,l,u,s,d;var f=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),n&&n.__esModule&&n||{"default":n}).objectEach;var c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var h=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var m=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),a&&a.__esModule&&a||{"default":a}),p=m.addClass,v=m.hasClass,g=m.fastInnerText;var w=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager;var b=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),l&&l.__esModule&&l||{"default":l}),y=b.registerPlugin,C=b.getPlugin;var _=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),u&&u.__esModule&&u||{"default":u}).stopImmediatePropagation;var E=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),s&&s.__esModule&&s||{"default":s}).eventManager;var R=(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),d&&d.__esModule&&d||{"default":d}).default;var M=function T(e){$traceurRuntime.superConstructor(S).call(this,e);this.settings=null;this.buttonEnabledList={};this.hiddenColumnsPlugin=null;this.nestedHeadersPlugin=null;this.collapsedSections={};this.columnHeaderLevelCount=null;this.eventManager=null};var S=M;$traceurRuntime.createClass(M,{isEnabled:function A(){return!!this.hot.getSettings().collapsibleColumns},enablePlugin:function N(){var e=this;if(this.enabled){return}this.settings=this.hot.getSettings().collapsibleColumns;if(typeof this.settings!=="boolean"){this.parseSettings()}this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns");this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.checkDependencies();this.addHook("afterRender",function(){return e.onAfterRender()});this.addHook("afterInit",function(){return e.onAfterInit()});this.addHook("afterGetColHeader",function(t,r){return e.onAfterGetColHeader(t,r)});this.addHook("beforeOnCellMouseDown",function(t,r,n){return e.onBeforeOnCellMouseDown(t,r,n)});this.eventManager=E(this.hot);$traceurRuntime.superGet(this,S.prototype,"enablePlugin").call(this)},disablePlugin:function D(){this.settings=null;this.buttonEnabledList={};this.hiddenColumnsPlugin=null;this.collapsedSections={};this.clearButtons();$traceurRuntime.superGet(this,S.prototype,"disablePlugin").call(this)},clearButtons:function k(){if(!this.hot.view){return}var e=this.hot.view.wt.getSetting("columnHeaders").length;var t=this.hot.view.wt.wtTable.THEAD;var r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;var n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;var o=function i(e){if(e){e.parentNode.removeChild(e)}};h(0,e-1,function(e){var i=t.childNodes[e];var a=r.childNodes[e];var s=n?n.childNodes[e]:null;h(0,i.childNodes.length-1,function(e){var t=i.childNodes[e].querySelector(".collapsibleIndicator");o(t);if(a&&a.childNodes[e]){t=a.childNodes[e].querySelector(".collapsibleIndicator");o(t)}if(n&&s&&s.childNodes[e]){t=s.childNodes[e].querySelector(".collapsibleIndicator");o(t)}})},true)},parseSettings:function x(){var e=this;f(this.settings,function(t){if(!e.buttonEnabledList[t.row]){e.buttonEnabledList[t.row]={}}e.buttonEnabledList[t.row][t.col]=t.collapsible})},meetsDependencies:function I(){var e=this.hot.getSettings();return e.nestedHeaders&&e.hiddenColumns},checkDependencies:function P(){var e=this.hot.getSettings();if(this.meetsDependencies()){return}if(!e.nestedHeaders){console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers.")}if(!e.hiddenColumns){console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers.")}},generateIndicator:function L(e,t){var r=t.parentNode;var n=r.parentNode;var o=-1*n.childNodes.length+Array.prototype.indexOf.call(n.childNodes,r);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[o]||!this.buttonEnabledList[o][e])){return null}var i=document.createElement("DIV");p(i,"collapsibleIndicator");if(this.collapsedSections[o]&&this.collapsedSections[o][e]===true){p(i,"collapsed");g(i,"+")}else{p(i,"expanded");g(i,"-")}return i},markSectionAs:function H(e,t,r,n){if(!this.collapsedSections[t]){this.collapsedSections[t]={}}switch(e){case"collapsed":this.collapsedSections[t][r]=true;break;case"expanded":this.collapsedSections[t][r]=void 0;break}if(n){var o=this.nestedHeadersPlugin.colspanArray;var i=this.nestedHeadersPlugin.rowCoordsToLevel(t);var a=this.nestedHeadersPlugin.getChildHeaders(t,r);var s=o[i+1];for(var l=1;l<a.length;l++){if(s&&s[a[l]].colspan>1){this.markSectionAs(e,t+1,a[l],true)}}}},expandSection:function V(e){this.markSectionAs("expanded",e.row,e.col,true);this.toggleCollapsibleSection(e,"expand")},collapseSection:function F(e){this.markSectionAs("collapsed",e.row,e.col,true);this.toggleCollapsibleSection(e,"collapse")},toggleAllCollapsibleSections:function B(e){var t=this;var r=this.nestedHeadersPlugin.colspanArray;if(this.settings===true){c(r,function(r,n){c(r,function(r,o){if(r.colspan>1){n=parseInt(n,10);o=parseInt(o,10);var i=t.nestedHeadersPlugin.levelToRowCoords(n);var a=o;t.markSectionAs(e==="collapse"?"collapsed":"expanded",i,a,true);t.toggleCollapsibleSection({row:i,col:a},e)}})})}else{f(this.buttonEnabledList,function(r,n){f(r,function(r,o){n=parseInt(n,10);o=parseInt(o,10);t.markSectionAs(e==="collapse"?"collapsed":"expanded",n,o,true);t.toggleCollapsibleSection({row:n,col:o},e)})})}},collapseAll:function j(){this.toggleAllCollapsibleSections("collapse")},expandAll:function W(){this.toggleAllCollapsibleSections("expand")},toggleCollapsibleSection:function $(e,t){var r=this;if(e.row){e.row=parseInt(e.row,10)}if(e.col){e.col=parseInt(e.col,10)}var n=this.hiddenColumnsPlugin.hiddenColumns;var o=this.nestedHeadersPlugin.colspanArray;var i=this.nestedHeadersPlugin.rowCoordsToLevel(e.row);var a=o[i][e.col].colspan;var s=this.nestedHeadersPlugin.getChildHeaders(e.row,e.col);var l=i+1;var u=o[l];var d=u?u[s[0]].colspan||1:1;while(d===a&&l<this.columnHeaderLevelCount){l+=1;u=o[l];d=u?u[s[0]].colspan||1:1}h(d,a-1,function(o){var i=e.col+o;switch(t){case"collapse":if(!r.hiddenColumnsPlugin.isHidden(i)){n.push(i)}break;case"expand":if(r.hiddenColumnsPlugin.isHidden(i)){n.splice(n.indexOf(i),1)}break}});this.hot.render()},onAfterGetColHeader:function U(e,t){if(t.hasAttribute("colspan")&&t.getAttribute("colspan")>1&&e>=this.hot.getSettings().fixedColumnsLeft){var r=this.generateIndicator(e,t);if(r!==null){t.querySelector("div:first-child").appendChild(r)}}},onBeforeOnCellMouseDown:function G(e,t){if(v(e.target,"collapsibleIndicator")){if(v(e.target,"expanded")){if(!this.collapsedSections[t.row]){this.collapsedSections[t.row]=[]}this.markSectionAs("collapsed",t.row,t.col,true);this.eventManager.fireEvent(e.target,"mouseup");this.toggleCollapsibleSection(t,"collapse")}else if(v(e.target,"collapsed")){this.markSectionAs("expanded",t.row,t.col,true);this.eventManager.fireEvent(e.target,"mouseup");this.toggleCollapsibleSection(t,"expand")}_(e);return false}},onAfterInit:function Y(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length},onAfterRender:function z(){if(!this.nestedHeadersPlugin.enabled||!this.hiddenColumnsPlugin.enabled){this.disablePlugin()}},destroy:function K(){this.settings=null;this.buttonEnabledList=null;this.hiddenColumnsPlugin=null;this.nestedHeadersPlugin=null;this.collapsedSections=null;this.columnHeaderLevelCount=null;$traceurRuntime.superGet(this,S.prototype,"destroy").call(this)}},{},R);y("collapsibleColumns",M)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63}],147:[function(e,t,r){"use strict";Object.defineProperties(r,{ColumnSummary:{get:function b(){return g}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("endpoints"),o&&o.__esModule&&o||{"default":o}).Endpoints;var d=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{"default":i}),f=d.deepClone,c=d.objectEach;var h=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var m=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),s&&s.__esModule&&s||{"default":s}),p=m.registerPlugin,v=m.getPlugin;var g=function y(e){$traceurRuntime.superConstructor(w).call(this,e);this.endpoints=null};var w=g;$traceurRuntime.createClass(g,{isEnabled:function C(){return!!this.hot.getSettings().columnSummary},enablePlugin:function _(){var e=this;if(this.enabled){return}this.settings=this.hot.getSettings().columnSummary;this.endpoints=new u(this,this.settings);this.addHook("afterInit",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterInit.apply(t,$traceurRuntime.spread(r))});this.addHook("afterChange",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterChange.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeCreateRow",function(t,r,n){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,n)});this.addHook("beforeCreateCol",function(t,r,n){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,n)});this.addHook("beforeRemoveRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,$traceurRuntime.spread(["remove_row"],r))});this.addHook("beforeRemoveCol",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,$traceurRuntime.spread(["remove_col"],r))});this.addHook("beforeRowMove",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeRowMove.apply(t,$traceurRuntime.spread(r))});this.addHook("afterCreateRow",function(t,r,n){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,n)});this.addHook("afterCreateCol",function(t,r,n){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,n)});this.addHook("afterRemoveRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,$traceurRuntime.spread(["remove_row"],r))});this.addHook("afterRemoveCol",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,$traceurRuntime.spread(["remove_col"],r))});this.addHook("afterRowMove",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterRowMove.apply(t,$traceurRuntime.spread(r))});$traceurRuntime.superGet(this,w.prototype,"enablePlugin").call(this)},disablePlugin:function E(){this.endpoints=null;this.settings=null;this.currentEndpoint=null},calculate:function R(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}},calculateSum:function M(e){var t=0;for(var r in e.ranges){if(e.ranges.hasOwnProperty(r)){t+=this.getPartialSum(e.ranges[r],e.sourceColumn)}}return t},getPartialSum:function S(e,t){var r=0;var n=e[1]||e[0];var o=null;var i=0;do{o=this.getCellValue(n,t)||0;var a=((o+"").split(".")[1]||[]).length||1;if(a>i){i=a}r+=o||0;n--}while(n>=e[0]);return Math.round(r*Math.pow(10,i))/Math.pow(10,i)},calculateMinMax:function O(e,t){var r=null;for(var n in e.ranges){if(e.ranges.hasOwnProperty(n)){var o=this.getPartialMinMax(e.ranges[n],e.sourceColumn,t);if(r===null&&o!==null){r=o}if(o!==null){switch(t){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}}}return r===null?"Not enough data":r},getPartialMinMax:function T(e,t,r){var n=null;var o=e[1]||e[0];var i;do{i=this.getCellValue(o,t)||null;if(n===null){n=i}else if(i!==null){switch(r){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i);break}}o--}while(o>=e[0]);return n},countEmpty:function A(e,t){var r;var n=0;var o=e[1]||e[0];do{r=this.getCellValue(o,t);if(!r){n++}o--}while(o>=e[0]);return n},countEntries:function N(e){var t=0;var r=e.ranges;for(var n in r){if(r.hasOwnProperty(n)){var o=r[n][1]===void 0?1:r[n][1]-r[n][0]+1;var i=this.countEmpty(r[n],e.sourceColumn);t+=o;t-=i}}return t},calculateAverage:function D(e){var t=this.calculateSum(e);var r=this.countEntries(e);return t/r},getCellValue:function k(e,t){var r=this.endpoints.getVisualRowIndex(e);var n=this.endpoints.getVisualColumnIndex(t);var o=this.hot.getSourceDataAtCell(e,t);var i=this.hot.getCellMeta(r,n).className||"";if(i.indexOf("columnSummaryResult")>-1){return null}if(this.endpoints.currentEndpoint.forceNumeric){if(typeof o==="string"){o=o.replace(/,/,".")}o=parseFloat(o)}if(isNaN(o)){if(!this.endpoints.currentEndpoint.suppressDataTypeErrors){throw new Error("ColumnSummary plugin: cell at ("+e+", "+t+") is not in a numeric format. Cannot do the calculation.")}}return o},onAfterInit:function x(){this.endpoints.endpoints=this.endpoints.parseSettings();this.endpoints.refreshAllEndpoints(true)},onAfterChange:function I(e,t){if(e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"){this.endpoints.refreshChangedEndpoints(e)}},onBeforeRowMove:function P(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName)},onAfterRowMove:function L(e,t){this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}},{},l);p("columnSummary",g)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,endpoints:148}],148:[function(e,t,r){"use strict";Object.defineProperties(r,{Endpoints:{get:function d(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var s=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).deepClone;var l=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),i&&i.__esModule&&i||{"default":i}).getTranslator;var u=function f(e,t){this.plugin=e;this.hot=this.plugin.hot;this.endpoints=[];this.settings=t;this.settingsType="array";this.currentEndpoint=null;this.cellsToSetCache=[];this.recordTranslator=l(this.hot)};$traceurRuntime.createClass(u,{getEndpoint:function c(e){if(this.settingsType==="function"){return this.fillMissingEndpointData(this.settings)[e]}else{return this.endpoints[e]}},getAllEndpoints:function h(){if(this.settingsType==="function"){return this.fillMissingEndpointData(this.settings)}else{return this.endpoints}},fillMissingEndpointData:function m(e){return this.parseSettings(e.call(this))},parseSettings:function p(e){var t=this;var r=[];if(!e&&typeof this.settings==="function"){this.settingsType="function";return}if(!e){e=this.settings}a(e,function(e){var n={};t.assignSetting(e,n,"ranges",[[0,t.hot.countRows()-1]]);t.assignSetting(e,n,"reversedRowCoords",false);t.assignSetting(e,n,"destinationRow",new Error("You must provide a destination row for the Column Summary plugin in order to work properly!"));t.assignSetting(e,n,"destinationColumn",new Error("You must provide a destination column for the Column Summary plugin in order to work properly!"));t.assignSetting(e,n,"sourceColumn",e.destinationColumn);t.assignSetting(e,n,"type","sum");t.assignSetting(e,n,"forceNumeric",false);t.assignSetting(e,n,"suppressDataTypeErrors",true);t.assignSetting(e,n,"suppressDataTypeErrors",true);t.assignSetting(e,n,"customFunction",null);t.assignSetting(e,n,"readOnly",true);t.assignSetting(e,n,"roundFloat",false);r.push(n)});return r},assignSetting:function v(e,t,r,n){if(r==="ranges"&&e[r]===void 0){t[r]=n;return}else if(r==="ranges"&&e[r].length===0){return}if(e[r]===void 0){if(n instanceof Error){throw n}t[r]=n}else{if(r==="destinationRow"&&t.reversedRowCoords){t[r]=this.hot.countRows()-e[r]-1}else{t[r]=e[r]}}},resetSetupBeforeStructureAlteration:function g(e,t,r,n,o){if(this.settingsType!=="function"){return}var i=e.indexOf("row")>-1?"row":"col";var s=this.getAllEndpoints();a(s,function(n,o,a){if(i==="row"&&n.destinationRow>=t){if(e==="insert_row"){n.alterRowOffset=r}else if(e==="remove_row"){n.alterRowOffset=-1*r}}if(i==="col"&&n.destinationColumn>=t){if(e==="insert_col"){n.alterColumnOffset=r}else if(e==="remove_col"){n.alterColumnOffset=-1*r}}});this.resetAllEndpoints(s,false)},resetSetupAfterStructureAlteration:function w(e,t,r,n,o){var i=arguments[5]!==void 0?arguments[5]:true;var s=this;if(this.settingsType==="function"){var l=function m(){s.hot.removeHook("beforeRender",m);return s.refreshAllEndpoints(true)};this.hot.addHookOnce("beforeRender",l);return}var u=e.indexOf("row")>-1?"row":"col";var d=e.indexOf("remove")>-1?-1:1;var f=this.getAllEndpoints();var c=e.indexOf("move_row")===0;var h=t;a(f,function(e,t,n){if(u==="row"&&e.destinationRow>=h){e.alterRowOffset=d*r}if(u==="col"&&e.destinationColumn>=h){e.alterColumnOffset=d*r}});this.resetAllEndpoints(f,!c);if(c){a(f,function(e,t,r){s.extendEndpointRanges(e,h,n[0],n.length);s.recreatePhysicalRanges(e);s.clearOffsetInformation(e)})}else{a(f,function(e,t,r){s.shiftEndpointCoordinates(e,h)})}if(i){this.refreshAllEndpoints(true)}},clearOffsetInformation:function b(e){e.alterRowOffset=void 0;e.alterColumnOffset=void 0},extendEndpointRanges:function y(e,t,r,n){a(e.ranges,function(e,o){if(e[1]){if(t>=e[0]&&t<=e[1]){if(r>e[1]){e[1]+=n}else if(r<e[0]){e[0]-=n}}else if(r>=e[0]&&r<=e[1]){e[1]-=n;if(t<=e[0]){e[0]++;e[1]++}}}})},recreatePhysicalRanges:function C(e){var t=this;var r=e.ranges;var n=[];var o=[];a(r,function(e){var r=[];if(e[1]){for(var n=e[0];n<=e[1];n++){r.push(t.recordTranslator.toPhysicalRow(n))}}else{r.push(t.recordTranslator.toPhysicalRow(e[0]))}o.push(r)});a(o,function(e){var t=[];a(e,function(r,o){if(o===0){t.push(r)}else{if(e[o]!==e[o-1]+1){t.push(e[o-1]);n.push(t);t=[];t.push(r)}}if(o===e.length-1){t.push(r);n.push(t)}})});e.ranges=n},shiftEndpointCoordinates:function _(e,t){if(e.alterRowOffset&&e.alterRowOffset!==0){e.destinationRow+=e.alterRowOffset||0;a(e.ranges,function(r,n){a(r,function(n,o){if(n>=t){r[o]+=e.alterRowOffset||0}})})}else if(e.alterColumnOffset&&e.alterColumnOffset!==0){e.destinationColumn+=e.alterColumnOffset||0;e.sourceColumn+=e.alterColumnOffset||0}},resetAllEndpoints:function E(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=this;this.cellsToSetCache=[];if(!e){e=this.getAllEndpoints()}a(e,function(e){r.resetEndpointValue(e,t)});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]},refreshAllEndpoints:function R(e){var t=this;this.cellsToSetCache=[];a(this.getAllEndpoints(),function(e){t.currentEndpoint=e;t.plugin.calculate(e);t.setEndpointValue(e,"init")});this.currentEndpoint=null;this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]},refreshChangedEndpoints:function M(e){var t=this;var r=[];this.cellsToSetCache=[];a(e,function(e,n,o){if((e[2]||"")+""===e[3]+""){return}a(t.getAllEndpoints(),function(e,i){if(t.hot.propToCol(o[n][1])===e.sourceColumn&&r.indexOf(i)===-1){r.push(i)}})});a(r,function(e){t.refreshEndpoint(t.getEndpoint(e))});this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset");this.cellsToSetCache=[]},refreshEndpoint:function S(e){this.currentEndpoint=e;this.plugin.calculate(e);this.setEndpointValue(e);this.currentEndpoint=null},resetEndpointValue:function O(e){var t;var r=arguments[1]!==void 0?arguments[1]:true;var n=e.alterRowOffset||0;var o=e.alterColumnOffset||0;var i,a;t=this.recordTranslator.toVisual(e.destinationRow,e.destinationColumn),i=t[0],a=t[1],t;var s=this.hot.getCellMeta(i,a);s.readOnly=false;s.className="";this.cellsToSetCache.push([this.recordTranslator.toVisualRow(e.destinationRow+(r?n:0)),this.recordTranslator.toVisualColumn(e.destinationColumn+(r?o:0)),""])},setEndpointValue:function T(e,t){var r=arguments[2]!==void 0?arguments[2]:false;var n=-1*e.alterRowOffset||0;var o=-1*e.alterColumnOffset||0;var i=this.getVisualRowIndex(e.destinationRow);var a=this.hot.getCellMeta(this.getVisualRowIndex(e.destinationRow+n),e.destinationColumn+o);if(i>this.hot.countRows()||e.destinationColumn>this.hot.countCols()){this.throwOutOfBoundsWarning();return}if(t==="init"||a.readOnly!==e.readOnly){a.readOnly=e.readOnly;a.className="columnSummaryResult"}if(e.roundFloat&&!isNaN(e.result)){e.result=e.result.toFixed(e.roundFloat)}if(r){this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set")}else{this.cellsToSetCache.push([i,e.destinationColumn,e.result])}e.alterRowOffset=void 0;e.alterColumnOffset=void 0},getVisualRowIndex:function A(e){return this.hot.runHooks("unmodifyRow",e,"columnSummary")},getVisualColumnIndex:function N(e){return this.hot.runHooks("unmodifyCol",e,"columnSummary")},throwOutOfBoundsWarning:function D(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132}],149:[function(e,t,r){"use strict";Object.defineProperties(r,{DropdownMenu:{get:function j(){return F}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h,m;var p=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;var v=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),o&&o.__esModule&&o||{"default":o}).default;var g=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var w=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),a&&a.__esModule&&a||{"default":a}).objectEach;var b=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor"),s&&s.__esModule&&s||{"default":s}).CommandExecutor;var y=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),l&&l.__esModule&&l||{"default":l}).EventManager;var C=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),_=C.getWindowScrollTop,E=C.getWindowScrollLeft,R=C.hasClass,M=C.closest;var S=(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory"),d&&d.__esModule&&d||{"default":d}).ItemsFactory;var O=(f=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),f&&f.__esModule&&f||{"default":f}).Menu;var T=(c=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),c&&c.__esModule&&c||{"default":c}).registerPlugin;var A=(h=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),h&&h.__esModule&&h||{"default":h}).stopPropagation;var N=(m=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),m&&m.__esModule&&m||{"default":m}),D=N.COLUMN_LEFT,k=N.COLUMN_RIGHT,x=N.REMOVE_COLUMN,I=N.CLEAR_COLUMN,P=N.READ_ONLY,L=N.ALIGNMENT,H=N.SEPARATOR;var V="changeType";var F=function W(e){var t=this;$traceurRuntime.superConstructor(B).call(this,e);this.eventManager=new y(this);this.commandExecutor=new b(this.hot);this.itemsFactory=null;this.menu=null;this.hot.addHook("afterGetColHeader",function(e,r){return t.onAfterGetColHeader(e,r)})};var B=F;$traceurRuntime.createClass(F,{isEnabled:function $(){return this.hot.getSettings().dropdownMenu},enablePlugin:function U(){var e=this;if(this.enabled){return}this.itemsFactory=new S(this.hot,B.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu;var r={items:this.itemsFactory.getItems(t)};this.registerEvents();if(typeof t.callback==="function"){this.commandExecutor.setCommonCallback(t.callback)}$traceurRuntime.superGet(this,B.prototype,"enablePlugin").call(this);this.callOnPluginsReady(function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",r);e.itemsFactory.setPredefinedItems(r.items);var n=e.itemsFactory.getItems(t);e.menu=new O(e.hot,{className:"htDropdownMenu",keepInViewport:true});e.hot.runHooks("beforeDropdownMenuSetItems",n);e.menu.setMenuItems(n);e.menu.addLocalHook("afterOpen",function(){return e.onMenuAfterOpen()});e.menu.addLocalHook("afterClose",function(){return e.onMenuAfterClose()});e.menu.addLocalHook("executeCommand",function(){for(var t=[],r=0;r<arguments.length;r++){t[r]=arguments[r]}return e.executeCommand.apply(e,t)});g(n,function(t){return e.commandExecutor.registerCommand(t.key,t)})})},updatePlugin:function G(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,B.prototype,"updatePlugin").call(this)},disablePlugin:function Y(){this.close();if(this.menu){this.menu.destroy()}$traceurRuntime.superGet(this,B.prototype,"disablePlugin").call(this)},registerEvents:function z(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})},open:function K(e){if(!this.menu){return}this.menu.open();if(e.width){this.menu.setOffset("left",e.width)}this.menu.setPosition(e);this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv;p.eventManager.isHotTableEnv=this.hot.isHotTableEnv},close:function q(){if(!this.menu){return}this.menu.close()},executeCommand:function X(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.commandExecutor.execute.apply(this.commandExecutor,e)},setListening:function J(){var e=arguments[0]!==void 0?arguments[0]:true;if(e){this.menu.hotMenu.listen()}else{this.menu.hotMenu.unlisten()}},onTableClick:function Z(e){A(e);if(R(e.target,V)&&!this.menu.isOpened()){var t=e.target.getBoundingClientRect();this.open({left:t.left,top:t.top+e.target.offsetHeight+3,width:t.width,height:t.height})}},onAfterGetColHeader:function Q(e,t){var r=t.parentNode;if(!r){return}var n=r.parentNode.childNodes;var o=Array.prototype.indexOf.call(n,r);if(e<0||o!==n.length-1){return}var i=t.querySelector("."+V);if(this.enabled&&i){return}if(!this.enabled){if(i){i.parentNode.removeChild(i)}return}var a=document.createElement("button");a.className=V;a.onclick=function(){return false};t.firstChild.insertBefore(a,t.firstChild.firstChild)},onMenuAfterOpen:function ee(){this.hot.runHooks("afterDropdownMenuShow",this)},onMenuAfterClose:function te(){this.hot.listen();this.hot.runHooks("afterDropdownMenuHide",this)},destroy:function re(){this.close();if(this.menu){this.menu.destroy()}$traceurRuntime.superGet(this,B.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[D,k,H,x,H,I,H,P,H,L]}},v);F.SEPARATOR={name:H};p.hooks.register("afterDropdownMenuDefaultOptions");p.hooks.register("afterDropdownMenuShow");p.hooks.register("afterDropdownMenuHide");p.hooks.register("afterDropdownMenuExecute");T("dropdownMenu",F)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor":71,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory":74,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"../../browser":141}],150:[function(e,t,r){"use strict";Object.defineProperties(r,{DataProvider:{get:function c(){return f}},__esModule:{value:true}});var n,o,i;var a=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var s=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}),l=s.extend,u=s.clone;var d=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var f=function h(e){this.hot=e;this.options={}};$traceurRuntime.createClass(f,{setOptions:function m(e){this.options=e},getData:function p(){var e=this;var t=this._getDataRange(),r=t.startRow,n=t.startCol,o=t.endRow,i=t.endCol;var a=this.options;var s=[];d(r,o,function(t){var r=[];if(!a.exportHiddenRows&&e._isHiddenRow(t)){return}d(n,i,function(n){if(!a.exportHiddenColumns&&e._isHiddenColumn(n)){return}r.push(e.hot.getDataAtCell(t,n))});s.push(r)});return s},getRowHeaders:function v(){var e=this;var t=[];if(this.options.rowHeaders){var r=this._getDataRange(),n=r.startRow,o=r.endRow;var i=this.hot.getRowHeader();d(n,o,function(r){if(!e.options.exportHiddenRows&&e._isHiddenRow(r)){return}t.push(i[r])})}return t},getColumnHeaders:function g(){var e=this;var t=[];if(this.options.columnHeaders){var r=this._getDataRange(),n=r.startCol,o=r.endCol;var i=this.hot.getColHeader();d(n,o,function(r){if(!e.options.exportHiddenColumns&&e._isHiddenColumn(r)){return}t.push(i[r])})}return t},_getDataRange:function w(){var e,t,r,n;var o=this.hot.countCols()-1;
var i=this.hot.countRows()-1;var a=this.options.range,s=(e=a[0])===void 0?0:e,l=(t=a[1])===void 0?0:t,u=(r=a[2])===void 0?i:r,d=(n=a[3])===void 0?o:n;s=Math.max(s,0);l=Math.max(l,0);u=Math.min(u,i);d=Math.min(d,o);return{startRow:s,startCol:l,endRow:u,endCol:d}},_isHiddenRow:function b(e){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",e)},_isHiddenColumn:function y(e){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",e)}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],151:[function(e,t,r){"use strict";Object.defineProperties(r,{ExportFile:{get:function y(){return w}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}),d=u.objectEach,f=u.extend,c=u.clone;var h=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),i&&i.__esModule&&i||{"default":i}).registerPlugin;var m=(a=e("dataProvider"),a&&a.__esModule&&a||{"default":a}).DataProvider;var p=(s=e("typeFactory"),s&&s.__esModule&&s||{"default":s}),v=p.typeFactory,g=p.EXPORT_TYPES;var w=function C(e){$traceurRuntime.superConstructor(b).call(this,e)};var b=w;$traceurRuntime.createClass(w,{isEnabled:function _(){return true},exportAsString:function E(e){var t=arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()},exportAsBlob:function R(e){var t=arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))},downloadFile:function M(e){var t=arguments[1]!==void 0?arguments[1]:{};var r=this._createTypeFormatter(e,t);var n=this._createBlob(r);var o=window.URL||window.webkitURL;var i=document.createElement("a");var a=r.options.filename+"."+r.options.fileExtension;if(i.download!==void 0){var s=o.createObjectURL(n);i.style.display="none";i.setAttribute("href",s);i.setAttribute("download",a);document.body.appendChild(i);i.dispatchEvent(new MouseEvent("click"));document.body.removeChild(i);setTimeout(function(){o.revokeObjectURL(s)},100)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(n,a)}},_createTypeFormatter:function S(e){var t=arguments[1]!==void 0?arguments[1]:{};if(!g[e]){throw new Error('Export format type "'+e+'" is not supported.')}return v(e,new m(this.hot),t)},_createBlob:function O(e){var t=null;if(typeof Blob!=="undefined"){t=new Blob([e.export()],{type:e.options.mimeType+";charset="+e.options.encoding})}return t}},{},l);h("exportFile",w)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:150,typeFactory:152}],152:[function(e,t,r){"use strict";var n;Object.defineProperties(r,{TYPE_CSV:{get:function f(){return a}},TYPE_EXCEL:{get:function c(){return s}},TYPE_PDF:{get:function h(){return l}},EXPORT_TYPES:{get:function m(){return u}},typeFactory:{get:function p(){return d}},__esModule:{value:true}});var o;var i=(o=e("types/csv.js"),o&&o.__esModule&&o||{"default":o}).Csv;var a="csv";var s="excel";var l="pdf";var u=(n={},Object.defineProperty(n,a,{value:i,configurable:true,enumerable:true,writable:true}),n);function d(e,t,r){if(typeof u[e]==="function"){return new u[e](t,r)}return null}},{"types/csv.js":154}],153:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseType:{get:function g(){return p}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}),u=l.extend,d=l.clone;var f=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var c=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),a&&a.__esModule&&a||{"default":a}),h=c.substitute,m=c.padStart;var p=function w(e,t){this.dataProvider=e;this.options=this._mergeOptions(t);this.dataProvider.setOptions(this.options)};var v=p;$traceurRuntime.createClass(p,{_mergeOptions:function b(e){var t=d(this.constructor.DEFAULT_OPTIONS);var r=new Date;t=u(d(v.DEFAULT_OPTIONS),t);t=u(t,e);t.filename=h(t.filename,{YYYY:r.getFullYear(),MM:m(r.getMonth()+1,2,"0"),DD:m(r.getDate(),2,"0")});return t}},{get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:false,rowHeaders:false,exportHiddenColumns:false,exportHiddenRows:false,range:[]}}})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55}],154:[function(e,t,r){"use strict";Object.defineProperties(r,{Csv:{get:function v(){return m}},__esModule:{value:true}});var n,o,i;var a=(n=e("_base.js"),n&&n.__esModule&&n||{"default":n}).BaseType;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}),l=s.arrayEach,u=s.arrayMap;var d=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),i&&i.__esModule&&i||{"default":i}).stringify;var f=String.fromCharCode(13);var c=String.fromCharCode(34);var h=String.fromCharCode(10);var m=function g(e,t){$traceurRuntime.superConstructor(p).call(this,e,t)};var p=m;$traceurRuntime.createClass(m,{"export":function w(){var e=this;var t=this.options;var r=this.dataProvider.getData();var n=this.dataProvider.getColumnHeaders();var o=n.length>0;var i=this.dataProvider.getRowHeaders();var a=i.length>0;var s="\ufeff";if(o){n=u(n,function(t){return e._escapeCell(t,true)});if(a){s+=t.columnDelimiter}s+=n.join(t.columnDelimiter);s+=t.rowDelimiter}l(r,function(r,n){if(n>0){s+=t.rowDelimiter}if(a){s+=e._escapeCell(i[n])+t.columnDelimiter}s+=r.map(function(t){return e._escapeCell(t)}).join(t.columnDelimiter)});return s},_escapeCell:function b(e){var t=arguments[1]!==void 0?arguments[1]:false;e=d(e);if(e!==""&&(t||e.indexOf(f)>=0||e.indexOf(c)>=0||e.indexOf(h)>=0||e.indexOf(this.options.columnDelimiter)>=0)){e=e.replace(new RegExp('"',"g"),'""');e='"'+e+'"'}return e}},{get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}},a)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"_base.js":153}],155:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseComponent:{get:function c(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).mixin;var u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),i&&i.__esModule&&i||{"default":i}).localHooks;var d=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver"),a&&a.__esModule&&a||{"default":a}).stateSaver;var f=function h(e){this.hot=e;this.elements=[];this.hidden=false};$traceurRuntime.createClass(f,{reset:function m(){s(this.elements,function(e){return e.reset()})},hide:function p(){this.hidden=true},show:function v(){this.hidden=false},isHidden:function g(){return this.hidden},destroy:function w(){this.clearLocalHooks();s(this.elements,function(e){return e.destroy()});this.elements=null;this.hot=null}},{});l(f,u);l(f,d)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver":59}],156:[function(e,t,r){"use strict";Object.defineProperties(r,{ActionBarComponent:{get:function p(){return h}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).addClass;var u=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var d=(i=e("_base"),i&&i.__esModule&&i||{"default":i}).BaseComponent;var f=(a=e("ui/input"),a&&a.__esModule&&a||{"default":a}).InputUI;var c=(s=e("ui/select"),s&&s.__esModule&&s||{"default":s}).SelectUI;var h=function v(e){$traceurRuntime.superConstructor(m).call(this,e);this.elements.push(new f(this.hot,{type:"button",value:"OK",className:"htUIButton htUIButtonOK",identifier:m.BUTTON_OK}));this.elements.push(new f(this.hot,{type:"button",value:"Cancel",className:"htUIButton htUIButtonCancel",identifier:m.BUTTON_CANCEL}));this.registerHooks()};var m=h;$traceurRuntime.createClass(h,{registerHooks:function g(){var e=this;u(this.elements,function(t){t.addLocalHook("click",function(t,r){return e.onButtonClick(t,r)})})},getMenuItemDescriptor:function w(){var e=this;return{key:"filter_action_bar",name:"Action bar",isCommand:false,disableSelection:true,hidden:function t(){return e.isHidden()},renderer:function r(t,n,o,i,a,s){l(n.parentNode,"htFiltersMenuActionBar");u(e.elements,function(e){return n.appendChild(e.element)});return n}}},accept:function b(){this.runLocalHooks("accept")},cancel:function y(){this.runLocalHooks("cancel")},onButtonClick:function C(e,t){if(t.options.identifier===m.BUTTON_OK){this.accept()}else{this.cancel()}}},{get BUTTON_OK(){return"ok"},get BUTTON_CANCEL(){return"cancel"}},d)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,_base:155,"ui/input":187,"ui/select":189}],157:[function(e,t,r){"use strict";Object.defineProperties(r,{ConditionComponent:{get:function N(){return T}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c;var h=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).addClass;var m=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),o&&o.__esModule&&o||{"default":o}).stopImmediatePropagation;var p=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}),v=p.arrayEach,g=p.arrayFilter;var w=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),a&&a.__esModule&&a||{"default":a}).extend;var b=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),s&&s.__esModule&&s||{"default":s}).isKey;var y=(l=e("_base"),l&&l.__esModule&&l||{"default":l}).BaseComponent;var C=(u=e("constants"),u&&u.__esModule&&u||{"default":u}),_=C.getOptionsList,E=C.FORMULA_NONE,R=C.FORMULA_BY_VALUE;var M=(d=e("ui/input"),d&&d.__esModule&&d||{"default":d}).InputUI;var S=(f=e("ui/select"),f&&f.__esModule&&f||{"default":f}).SelectUI;var O=(c=e("formulaRegisterer"),c&&c.__esModule&&c||{"default":c}).getFormulaDescriptor;var T=function D(e){$traceurRuntime.superConstructor(A).call(this,e);this.elements.push(new S(this.hot));this.elements.push(new M(this.hot,{placeholder:"Value"}));this.elements.push(new M(this.hot,{placeholder:"Second value"}));this.registerHooks()};var A=T;$traceurRuntime.createClass(T,{registerHooks:function k(){var e=this;this.getSelectElement().addLocalHook("select",function(t){return e.onConditionSelect(t)});v(this.getInputElements(),function(t){t.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})})},setState:function x(e){var t=this;this.reset();if(e){this.getSelectElement().setValue(e.command);v(e.args,function(r,n){var o=t.getInputElement(n);o.setValue(r);o[e.command.inputsCount>n?"show":"hide"]();if(!n){setTimeout(function(){return o.focus()},10)}})}},getState:function I(){var e=this.getSelectElement().getValue()||O(E);var t=[];v(this.getInputElements(),function(r,n){if(e.inputsCount>n){t.push(r.getValue())}});return{command:e,args:t}},updateState:function P(e){var t=e.editedFormulaStack.column;var r=e.editedFormulaStack.formulas;var n=g(r,function(e){return e.name!==R})[0];if(n&&n.name===R){return}this.setCachedState(t,{command:n?O(n.name):O(E),args:n?n.args:[]})},getSelectElement:function L(){return this.elements.filter(function(e){return e instanceof S})[0]},getInputElement:function H(){var e=arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]},getInputElements:function V(){return this.elements.filter(function(e){return e instanceof M})},getMenuItemDescriptor:function F(){var e=this;return{key:"filter_by_condition",name:"",isCommand:false,disableSelection:true,hidden:function t(){return e.isHidden()},renderer:function r(t,n,o,i,a,s){h(n.parentNode,"htFiltersMenuCondition");var l=document.createElement("div");h(l,"htFiltersMenuLabel");l.textContent="Filter by condition:";n.appendChild(l);v(e.elements,function(e){return n.appendChild(e.element)});return n}}},reset:function B(){var e=this.hot.getPlugin("filters").getSelectedColumn();var t=e&&e.visualIndex;var r=this.hot.getDataType.apply(this.hot,this.hot.getSelected()||[0,t]);var n=_(r);v(this.getInputElements(),function(e){return e.hide()});this.getSelectElement().setItems(n);$traceurRuntime.superGet(this,A.prototype,"reset").call(this);this.getSelectElement().setValue(n[0])},onConditionSelect:function j(e){v(this.getInputElements(),function(t,r){t[e.inputsCount>r?"show":"hide"]();if(!r){setTimeout(function(){return t.focus()},10)}});this.runLocalHooks("change",e)},onInputKeyDown:function W(e){if(b(e.keyCode,"ENTER")){this.runLocalHooks("accept");m(e)}else if(b(e.keyCode,"ESCAPE")){this.runLocalHooks("cancel");m(e)}}},{},y)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,_base:155,constants:159,formulaRegisterer:184,"ui/input":187,"ui/select":189}],158:[function(e,t,r){"use strict";Object.defineProperties(r,{ValueComponent:{get:function F(){return H}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h,m;var p=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}).addClass;var v=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),o&&o.__esModule&&o||{"default":o}).stopImmediatePropagation;var g=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}),w=g.arrayEach,b=g.arrayUnique,y=g.arrayFilter,C=g.arrayMap,_=g.arrayIncludes;var E=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/sortingAlgorithms/mergeSort"),a&&a.__esModule&&a||{"default":a}).mergeSort;var R=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{"default":s}).deepClone;var M=(l=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),l&&l.__esModule&&l||{"default":l}).stringify;var S=(u=e("utils"),u&&u.__esModule&&u||{"default":u}),O=S.unifyColumnValues,T=S.intersectValues,A=S.toEmptyString;var N=(d=e("_base"),d&&d.__esModule&&d||{"default":d}).BaseComponent;var D=(f=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),f&&f.__esModule&&f||{"default":f}).isKey;var k=(c=e("ui/multipleSelect"),c&&c.__esModule&&c||{"default":c}).MultipleSelectUI;var x=(h=e("constants"),h&&h.__esModule&&h||{"default":h}),I=x.FORMULA_BY_VALUE,P=x.FORMULA_NONE;var L=(m=e("formulaRegisterer"),m&&m.__esModule&&m||{"default":m}).getFormulaDescriptor;var H=function B(e){$traceurRuntime.superConstructor(V).call(this,e);this.elements.push(new k(this.hot));this.registerHooks()};var V=H;$traceurRuntime.createClass(H,{registerHooks:function j(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})},setState:function W(e){this.reset();if(e&&e.command.key===I){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot);t.setValue(e.args[0])}},getState:function $(){var e=this.getMultipleSelectElement();var t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?P:I},args:[e.getValue()],itemsSnapshot:t}},updateState:function U(e){var t=this;var r=function n(e,r,o,i,a){var s=y(r,function(e){return e.name===I})[0];var l={};if(s){var u=C(i(e,a),function(e){return e.value});u=O(u);if(o){s.args[0]=o}var d=[];var f=T(u,s.args[0],function(e){if(e.checked){d.push(e.value)}});l.args=[d];l.command=L(I);l.itemsSnapshot=f}else{l.args=[];l.command=L(P)}t.setCachedState(e,l)};r(e.editedFormulaStack.column,e.editedFormulaStack.formulas,e.formulaArgsChange,e.filteredRowsFactory);if(e.dependentFormulaStacks.length){r(e.dependentFormulaStacks[0].column,e.dependentFormulaStacks[0].formulas,e.formulaArgsChange,e.filteredRowsFactory,e.editedFormulaStack)}},getMultipleSelectElement:function G(){return this.elements.filter(function(e){return e instanceof k})[0]},getMenuItemDescriptor:function Y(){var e=this;return{key:"filter_by_value",name:"Filter by value",isCommand:false,disableSelection:true,hidden:function t(){return e.isHidden()},renderer:function r(t,n,o,i,a,s){p(n.parentNode,"htFiltersMenuValue");var l=document.createElement("div");p(l,"htFiltersMenuLabel");l.textContent="Filter by value:";n.appendChild(l);w(e.elements,function(e){return n.appendChild(e.element)});return n}}},reset:function z(){var e=O(this._getColumnVisibleValues());var t=T(e,e);this.getMultipleSelectElement().setItems(t);$traceurRuntime.superGet(this,V.prototype,"reset").call(this);this.getMultipleSelectElement().setValue(e)},onInputKeyDown:function K(e){if(D(e.keyCode,"ESCAPE")){this.runLocalHooks("cancel");v(e)}},_getColumnVisibleValues:function q(){var e=this.hot.getPlugin("filters").getSelectedColumn();var t=e&&e.visualIndex;return C(this.hot.getDataAtCol(t),function(e){return A(e)})}},{},N)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/sortingAlgorithms/mergeSort":134,_base:155,constants:159,formulaRegisterer:184,"ui/multipleSelect":188,utils:190}],159:[function(e,t,r){"use strict";var n;Object.defineProperties(r,{FORMULA_NONE:{get:function ie(){return x}},FORMULA_EMPTY:{get:function ae(){return I}},FORMULA_NOT_EMPTY:{get:function se(){return P}},FORMULA_EQUAL:{get:function le(){return L}},FORMULA_NOT_EQUAL:{get:function ue(){return H}},FORMULA_GREATER_THAN:{get:function de(){return V}},FORMULA_GREATER_THAN_OR_EQUAL:{get:function fe(){return F}},FORMULA_LESS_THAN:{get:function ce(){return B}},FORMULA_LESS_THAN_OR_EQUAL:{get:function he(){return j}},FORMULA_BETWEEN:{get:function me(){return W}},FORMULA_NOT_BETWEEN:{get:function pe(){return $}},FORMULA_BEGINS_WITH:{get:function ve(){return U}},FORMULA_ENDS_WITH:{get:function ge(){return G}},FORMULA_CONTAINS:{get:function we(){return Y}},FORMULA_NOT_CONTAINS:{get:function be(){return z}},FORMULA_DATE_BEFORE:{get:function ye(){return K}},FORMULA_DATE_AFTER:{get:function Ce(){return q}},FORMULA_TOMORROW:{get:function _e(){return X}},FORMULA_TODAY:{get:function Ee(){return J}},FORMULA_YESTERDAY:{get:function Re(){return Z}},FORMULA_BY_VALUE:{get:function Me(){return Q}},TYPE_NUMERIC:{get:function Se(){return ee}},TYPE_TEXT:{get:function Oe(){return te}},TYPE_DATE:{get:function Te(){return re}},TYPES:{get:function Ae(){return ne}},getOptionsList:{get:function Ne(){return oe}},__esModule:{value:true}});var o,i,a,s,l,u,d,f,c,h,m,p,v,g,w,b,y,C,_,E,R,M,S,O,T;var A=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).clone;var N=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var D=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),a&&a.__esModule&&a||{"default":a}).SEPARATOR;var k=(s=e("formulaRegisterer"),s&&s.__esModule&&s||{"default":s}).getFormulaDescriptor;var x=(l=e("formula/none"),l&&l.__esModule&&l||{"default":l}).FORMULA_NAME;var I=(u=e("formula/empty"),u&&u.__esModule&&u||{"default":u}).FORMULA_NAME;var P=(d=e("formula/notEmpty"),d&&d.__esModule&&d||{"default":d}).FORMULA_NAME;var L=(f=e("formula/equal"),f&&f.__esModule&&f||{"default":f}).FORMULA_NAME;var H=(c=e("formula/notEqual"),c&&c.__esModule&&c||{"default":c}).FORMULA_NAME;var V=(h=e("formula/greaterThan"),h&&h.__esModule&&h||{"default":h}).FORMULA_NAME;var F=(m=e("formula/greaterThanOrEqual"),m&&m.__esModule&&m||{"default":m}).FORMULA_NAME;var B=(p=e("formula/lessThan"),p&&p.__esModule&&p||{"default":p}).FORMULA_NAME;var j=(v=e("formula/lessThanOrEqual"),v&&v.__esModule&&v||{"default":v}).FORMULA_NAME;var W=(g=e("formula/between"),g&&g.__esModule&&g||{"default":g}).FORMULA_NAME;var $=(w=e("formula/notBetween"),w&&w.__esModule&&w||{"default":w}).FORMULA_NAME;var U=(b=e("formula/beginsWith"),b&&b.__esModule&&b||{"default":b}).FORMULA_NAME;var G=(y=e("formula/endsWith"),y&&y.__esModule&&y||{"default":y}).FORMULA_NAME;var Y=(C=e("formula/contains"),C&&C.__esModule&&C||{"default":C}).FORMULA_NAME;var z=(_=e("formula/notContains"),_&&_.__esModule&&_||{"default":_}).FORMULA_NAME;var K=(E=e("formula/date/before"),E&&E.__esModule&&E||{"default":E}).FORMULA_NAME;var q=(R=e("formula/date/after"),R&&R.__esModule&&R||{"default":R}).FORMULA_NAME;var X=(M=e("formula/date/tomorrow"),M&&M.__esModule&&M||{"default":M}).FORMULA_NAME;var J=(S=e("formula/date/today"),S&&S.__esModule&&S||{"default":S}).FORMULA_NAME;var Z=(O=e("formula/date/yesterday"),O&&O.__esModule&&O||{"default":O}).FORMULA_NAME;var Q=(T=e("formula/byValue"),T&&T.__esModule&&T||{"default":T}).FORMULA_NAME;var ee="numeric";var te="text";var re="date";var ne=(n={},Object.defineProperty(n,ee,{value:[x,D,I,P,D,L,H,D,V,F,B,j,W,$],configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,te,{value:[x,D,I,P,D,L,H,D,U,G,D,Y,z],configurable:true,enumerable:true,writable:true}),Object.defineProperty(n,re,{value:[x,D,I,P,D,L,H,D,K,q,W,D,X,J,Z],configurable:true,enumerable:true,writable:true}),n);function oe(e){var t=[];if(!ne[e]){e=te}N(ne[e],function(e){var r;if(e===D){r={name:D}}else{r=A(k(e))}t.push(r)});return t}},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"formula/beginsWith":162,"formula/between":163,"formula/byValue":164,"formula/contains":165,"formula/date/after":166,"formula/date/before":167,"formula/date/today":168,"formula/date/tomorrow":169,"formula/date/yesterday":170,"formula/empty":171,"formula/endsWith":172,"formula/equal":173,"formula/greaterThan":174,"formula/greaterThanOrEqual":175,"formula/lessThan":176,"formula/lessThanOrEqual":177,"formula/none":178,"formula/notBetween":179,"formula/notContains":180,"formula/notEmpty":181,"formula/notEqual":182,formulaRegisterer:184}],160:[function(e,t,r){"use strict";Object.defineProperties(r,{DataFilter:{get:function l(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;var a=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var s=function u(e){var t=arguments[1]!==void 0?arguments[1]:function(e){return[]};this.formulaCollection=e;this.columnDataFactory=t};$traceurRuntime.createClass(s,{filter:function d(){var e=this;var t=[];if(!this.formulaCollection.isEmpty()){a(this.formulaCollection.orderStack,function(r,n){var o=e.columnDataFactory(r);if(n){o=e._getIntersectData(o,t)}t=e.filterByColumn(r,o)})}return t},filterByColumn:function f(e){var t=arguments[1]!==void 0?arguments[1]:[];var r=this;var n=[];a(t,function(t){if(t!==void 0&&r.formulaCollection.isMatch(t,e)){n.push(t)}});return n},_getIntersectData:function c(e,t){var r=[];a(t,function(t){var n=t.meta.visualRow;if(e[n]!==void 0){r[n]=e[n]}});return r}},{});i.utils.FiltersDataFilter=s},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../browser":141}],161:[function(e,t,r){"use strict";Object.defineProperties(r,{Filters:{get:function U(){return W}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h,m,p,v,g;var w=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var b=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}),y=b.arrayEach,C=b.arrayMap,_=b.arrayIncludes;var E=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var R=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),a&&a.__esModule&&a||{"default":a}).EventManager;var M=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),s&&s.__esModule&&s||{"default":s}),S=M.addClass,O=M.removeClass,T=M.closest;var A=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var N=(u=e("component/condition"),u&&u.__esModule&&u||{"default":u}).ConditionComponent;var D=(d=e("component/value"),d&&d.__esModule&&d||{"default":d}).ValueComponent;var k=(f=e("component/actionBar"),f&&f.__esModule&&f||{"default":f}).ActionBarComponent;var x=(c=e("formulaCollection"),c&&c.__esModule&&c||{"default":c}).FormulaCollection;var I=(h=e("dataFilter"),h&&h.__esModule&&h||{"default":h}).DataFilter;var P=(m=e("formulaUpdateObserver"),m&&m.__esModule&&m||{"default":m}).FormulaUpdateObserver;var L=(p=e("utils"),p&&p.__esModule&&p||{"default":p}),H=L.createArrayAssertion,V=L.toEmptyString,F=L.unifyColumnValues;var B=(v=e("constants"),v&&v.__esModule&&v||{"default":v}).FORMULA_NONE;var j=(g=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),g&&g.__esModule&&g||{"default":g}).SEPARATOR;var W=function G(e){var t=this;$traceurRuntime.superConstructor($).call(this,e);this.eventManager=new R(this);this.trimRowsPlugin=null;this.dropdownMenuPlugin=null;this.formulaCollection=null;this.formulaUpdateObserver=null;this.conditionComponent=null;this.valueComponent=null;this.actionBarComponent=null;this.lastSelectedColumn=null;this.hot.addHook("afterGetColHeader",function(e,r){return t.onAfterGetColHeader(e,r)})};var $=W;$traceurRuntime.createClass(W,{isEnabled:function Y(){return this.hot.getSettings().filters?true:false},enablePlugin:function z(){var e=this;if(this.enabled){return}this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=function r(t){t.addLocalHook("accept",function(){return e.onActionBarSubmit("accept")});t.addLocalHook("cancel",function(){return e.onActionBarSubmit("cancel")});t.addLocalHook("change",function(r){return e.onComponentChange(t,r)});return t};if(!this.conditionComponent){this.conditionComponent=t(new N(this.hot))}if(!this.valueComponent){this.valueComponent=t(new D(this.hot))}if(!this.actionBarComponent){this.actionBarComponent=t(new k(this.hot))}if(!this.formulaCollection){this.formulaCollection=new x}if(!this.formulaUpdateObserver){this.formulaUpdateObserver=new P(this.formulaCollection,function(t){return e.getDataMapAtColumn(t)});this.formulaUpdateObserver.addLocalHook("update",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e.conditionComponent).updateState.apply(t,$traceurRuntime.spread(r))});this.formulaUpdateObserver.addLocalHook("update",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e.valueComponent).updateState.apply(t,$traceurRuntime.spread(r))})}this.conditionComponent.show();this.valueComponent.show();this.actionBarComponent.show();this.registerEvents();this.addHook("beforeDropdownMenuSetItems",function(t){return e.onBeforeDropdownMenuSetItems(t)});this.addHook("afterDropdownMenuDefaultOptions",function(t){return e.onAfterDropdownMenuDefaultOptions(t)});this.addHook("afterDropdownMenuShow",function(){return e.onAfterDropdownMenuShow()});this.addHook("afterDropdownMenuHide",function(){return e.onAfterDropdownMenuHide()});this.addHook("afterChange",function(t,r){return e.onAfterChange(t)});this.hot.getSettings().trimRows=true;this.trimRowsPlugin.enablePlugin();if(this.hot.getSettings().dropdownMenu){this.dropdownMenuPlugin.disablePlugin();this.dropdownMenuPlugin.enablePlugin()}$traceurRuntime.superGet(this,$.prototype,"enablePlugin").call(this)},registerEvents:function K(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})},disablePlugin:function q(){if(this.enabled){this.conditionComponent.hide();this.valueComponent.hide();this.actionBarComponent.hide();this.formulaCollection.clean();this.trimRowsPlugin.untrimAll()}$traceurRuntime.superGet(this,$.prototype,"disablePlugin").call(this)},addFormula:function X(e,t,r){var n=this.t.toPhysicalColumn(e);this.formulaCollection.addFormula(n,{command:{key:t},args:r})},removeFormulas:function J(e){var t=this.t.toPhysicalColumn(e);this.formulaCollection.removeFormulas(t)},clearFormulas:function Z(e){var t=this.t.toPhysicalColumn(e);if(e===void 0){this.formulaCollection.clean()}else{this.formulaCollection.clearFormulas(t)}},filter:function Q(){var e=this._createDataFilter();var t=!this.formulaCollection.isEmpty();var r=[];var n=this.formulaCollection.exportAllFormulas();var o=this.hot.runHooks("beforeFilter",n);if(o!==false){if(t){var i=[];this.trimRowsPlugin.trimmedRows.length=0;r=C(e.filter(),function(e){return e.meta.visualRow});var a=H(r);E(this.hot.countSourceRows()-1,function(e){if(!a(e)){i.push(e)}});this.trimRowsPlugin.trimRows(i);if(!r.length){this.hot.deselectCell()}}else{this.trimRowsPlugin.untrimAll()}}this.hot.view.wt.wtOverlays.adjustElementsSize(true);this.hot.render();this.clearColumnSelection();this.hot.runHooks("afterFilter",n)},getSelectedColumn:function ee(){return this.lastSelectedColumn},clearColumnSelection:function te(){
var e=this.hot.getSelected()||[],t=e[0],r=e[1];if(t!==void 0&&r!==void 0){this.hot.selectCell(t,r)}},getDataMapAtColumn:function re(e){var t=this;var r=this.t.toVisualColumn(e);var n=[];y(this.hot.getSourceDataAtCol(r),function(e,o){var i=t.hot.getCellMeta(o,r),a=i.row,s=i.col,l=i.visualCol,u=i.visualRow,d=i.type,f=i.instance,c=i.dateFormat;n.push({meta:{row:a,col:s,visualCol:l,visualRow:u,type:d,instance:f,dateFormat:c},value:V(e)})});return n},onAfterChange:function ne(e){var t=this;if(e){y(e,function(e){var r=e[1];var n=t.hot.propToCol(r);t.updateValueComponentFormula(n)})}},updateValueComponentFormula:function oe(e){var t=this.hot.getDataAtCol(e);var r=F(t);this.formulaUpdateObserver.updateStatesAtColumn(e,r)},onAfterDropdownMenuShow:function ie(){var e=this.getSelectedColumn();var t=e&&e.physicalIndex;var r=this.conditionComponent;var n=this.valueComponent;if(!r.isHidden()){r.restoreState(t)}if(!n.isHidden()){n.restoreState(t)}},onAfterDropdownMenuHide:function ae(){this.conditionComponent.getSelectElement().closeOptions()},onBeforeDropdownMenuSetItems:function se(e){var t=C(e,function(e){return e.key});var r=this.conditionComponent;var n=this.valueComponent;r[t.indexOf(r.getMenuItemDescriptor().key)===-1?"hide":"show"]();n[t.indexOf(n.getMenuItemDescriptor().key)===-1?"hide":"show"]()},onAfterDropdownMenuDefaultOptions:function le(e){e.items.push({name:j});e.items.push(this.conditionComponent.getMenuItemDescriptor());e.items.push(this.valueComponent.getMenuItemDescriptor());e.items.push(this.actionBarComponent.getMenuItemDescriptor())},onActionBarSubmit:function ue(e){if(e==="accept"){var t=this.getSelectedColumn();var r=t&&t.physicalIndex;var n=this.conditionComponent.getState();var o=this.valueComponent.getState();this.formulaUpdateObserver.groupChanges();this.formulaCollection.clearFormulas(r);if(n.command.key===B&&o.command.key===B){this.formulaCollection.removeFormulas(r)}if(n.command.key!==B){this.formulaCollection.addFormula(r,n)}if(o.command.key!==B){this.formulaCollection.addFormula(r,o)}this.formulaUpdateObserver.flush();this.conditionComponent.saveState(r);this.valueComponent.saveState(r);this.filter()}this.dropdownMenuPlugin.close()},onComponentChange:function de(e,t){if(e===this.conditionComponent&&!t.inputsCount){this.dropdownMenuPlugin.setListening()}},onAfterGetColHeader:function fe(e,t){var r=this.t.toPhysicalColumn(e);if(this.enabled&&this.formulaCollection.hasFormulas(r)){S(t,"htFiltersActive")}else{O(t,"htFiltersActive")}},onTableClick:function ce(e){var t=T(e.target,"TH");if(t){var r=this.hot.getCoords(t).col;var n=this.t.toPhysicalColumn(r);this.lastSelectedColumn={visualIndex:r,physicalIndex:n}}},destroy:function he(){if(this.enabled){this.conditionComponent.destroy();this.valueComponent.destroy();this.actionBarComponent.destroy();this.formulaCollection.destroy();this.formulaUpdateObserver.destroy()}$traceurRuntime.superGet(this,$.prototype,"destroy").call(this)},_createDataFilter:function me(){var e=arguments[0]!==void 0?arguments[0]:this.formulaCollection;var t=this;return new I(e,function(e){return t.getDataMapAtColumn(e)})}},{},w);A("filters",W)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"component/actionBar":156,"component/condition":157,"component/value":158,constants:159,dataFilter:160,formulaCollection:183,formulaUpdateObserver:185,utils:190}],162:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function f(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),o&&o.__esModule&&o||{"default":o}).startsWith;var l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),i&&i.__esModule&&i||{"default":i}).stringify;var u="begins_with";function d(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];return s(l(e.value).toLowerCase(),l(t))}a(u,d,{name:"Begins with",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:184}],163:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function h(){return f}},__esModule:{value:true}});var n,o,i;var a=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}),s=a.registerFormula,l=a.getFormula;var u=(o=e("date/after"),o&&o.__esModule&&o||{"default":o}).FORMULA_NAME;var d=(i=e("date/before"),i&&i.__esModule&&i||{"default":i}).FORMULA_NAME;var f="between";function c(e){var t=arguments[1]!==void 0?arguments[1]:inputValues,r=t[0],n=t[1];if(e.meta.type==="numeric"){var o=parseFloat(r,10);var i=parseFloat(n,10);r=Math.min(o,i);n=Math.max(o,i)}else if(e.meta.type==="date"){var a=l(d,[n]);var s=l(u,[r]);return a(e)&&s(e)}return e.value>=r&&e.value<=n}s(f,c,{name:"Is between",inputsCount:2})},{"date/after":166,"date/before":167,formulaRegisterer:184}],164:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("utils"),o&&o.__esModule&&o||{"default":o}).createArrayAssertion;var s="by_value";function l(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];return t(e.value)}i(s,l,{name:"By value",inputsCount:0,inputValuesDecorator:function d(){var e=(arguments[0]!==void 0?arguments[0]:inputValues)[0];return[a(e)]}})},{formulaRegisterer:184,utils:190}],165:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),o&&o.__esModule&&o||{"default":o}).stringify;var s="contains";function l(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];return a(e.value).toLowerCase().indexOf(a(t))>=0}i(s,l,{name:"Contains",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:184}],166:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var s="date_after";function l(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];var r=a(e.value,e.meta.dateFormat);var n=a(t,e.meta.dateFormat);if(!r.isValid()||!n.isValid()){return false}return r.diff(n)>=0}i(s,l,{name:"After",inputsCount:1})},{formulaRegisterer:184,moment:"moment"}],167:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var s="date_before";function l(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];var r=a(e.value,e.meta.dateFormat);var n=a(t,e.meta.dateFormat);if(!r.isValid()||!n.isValid()){return false}return r.diff(n)<=0}i(s,l,{name:"Before",inputsCount:1})},{formulaRegisterer:184,moment:"moment"}],168:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var s="date_today";function l(e){var t=a(e.value,e.meta.dateFormat);if(!t.isValid()){return false}return t.isSame(a().startOf("day"),"d")}i(s,l,{name:"Today",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],169:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var s="date_tomorrow";function l(e){var t=a(e.value,e.meta.dateFormat);if(!t.isValid()){return false}return t.isSame(a().subtract(-1,"days").startOf("day"),"d")}i(s,l,{name:"Tomorrow",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],170:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var a=(o=e("moment"),o&&o.__esModule&&o||{"default":o}).default;var s="date_yesterday";function l(e){var t=a(e.value,e.meta.dateFormat);if(!t.isValid()){return false}return t.isSame(a().subtract(1,"days").startOf("day"),"d")}i(s,l,{name:"Yesterday",inputsCount:0})},{formulaRegisterer:184,moment:"moment"}],171:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var i="empty";function a(e){return e.value===""||e.value===null||e.value===void 0}o(i,a,{name:"Is empty",inputsCount:0})},{formulaRegisterer:184}],172:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function f(){return u}},__esModule:{value:true}});var n,o,i;var a=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),o&&o.__esModule&&o||{"default":o}).endsWith;var l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),i&&i.__esModule&&i||{"default":i}).stringify;var u="ends_with";function d(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];return s(l(e.value).toLowerCase(),l(t))}a(u,d,{name:"Ends with",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:184}],173:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),n&&n.__esModule&&n||{"default":n}).stringify;var a=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{"default":o}).registerFormula;var s="eq";function l(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];return i(e.value).toLowerCase()===i(t)}a(s,l,{name:"Is equal to",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:184}],174:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var i="gt";function a(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];if(e.meta.type==="numeric"){t=parseFloat(t,10)}return e.value>t}o(i,a,{name:"Greater than",inputsCount:1})},{formulaRegisterer:184}],175:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var i="gte";function a(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];if(e.meta.type==="numeric"){t=parseFloat(t,10)}return e.value>=t}o(i,a,{name:"Greater than or equal to",inputsCount:1})},{formulaRegisterer:184}],176:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var i="lt";function a(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];if(e.meta.type==="numeric"){t=parseFloat(t,10)}return e.value<t}o(i,a,{name:"Less than",inputsCount:1})},{formulaRegisterer:184}],177:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var i="lte";function a(e){var t=(arguments[1]!==void 0?arguments[1]:inputValues)[0];if(e.meta.type==="numeric"){t=parseFloat(t,10)}return e.value<=t}o(i,a,{name:"Less than or equal to",inputsCount:1})},{formulaRegisterer:184}],178:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function s(){return i}},__esModule:{value:true}});var n;var o=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}).registerFormula;var i="none";function a(){return true}o(i,a,{name:"None",inputsCount:0})},{formulaRegisterer:184}],179:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function f(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}),a=i.registerFormula,s=i.getFormula;var l=(o=e("between"),o&&o.__esModule&&o||{"default":o}).FORMULA_NAME;var u="not_between";function d(e,t){return!s(l,t)(e)}a(u,d,{name:"Is not between",inputsCount:2})},{between:163,formulaRegisterer:184}],180:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function f(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}),a=i.registerFormula,s=i.getFormula;var l=(o=e("contains"),o&&o.__esModule&&o||{"default":o}).FORMULA_NAME;var u="not_contains";function d(e,t){return!s(l,t)(e)}a(u,d,{name:"Does not contain",inputsCount:1})},{contains:165,formulaRegisterer:184}],181:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function f(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}),a=i.registerFormula,s=i.getFormula;var l=(o=e("empty"),o&&o.__esModule&&o||{"default":o}).FORMULA_NAME;var u="not_empty";function d(e,t){return!s(l,t)(e)}a(u,d,{name:"Is not empty",inputsCount:0})},{empty:171,formulaRegisterer:184}],182:[function(e,t,r){"use strict";Object.defineProperties(r,{FORMULA_NAME:{get:function f(){return u}},__esModule:{value:true}});var n,o;var i=(n=e("formulaRegisterer"),n&&n.__esModule&&n||{"default":n}),a=i.registerFormula,s=i.getFormula;var l=(o=e("equal"),o&&o.__esModule&&o||{"default":o}).FORMULA_NAME;var u="neq";function d(e,t){return!s(l,t)(e)}a(u,d,{name:"Is not equal to",inputsCount:1})},{equal:173,formulaRegisterer:184}],183:[function(e,t,r){"use strict";Object.defineProperties(r,{FormulaCollection:{get:function g(){return v}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}),l=s.arrayEach,u=s.arrayMap,d=s.arrayFilter;var f=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}),c=f.objectEach,h=f.mixin;var m=(i=e("formulaRegisterer"),i&&i.__esModule&&i||{"default":i}).getFormula;var p=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),a&&a.__esModule&&a||{"default":a}).localHooks;var v=function w(){this.formulas=Object.create(null);this.orderStack=[]};$traceurRuntime.createClass(v,{isEmpty:function b(){return!this.orderStack.length},isMatch:function y(e,t){var r=this;var n=true;if(t===void 0){c(this.formulas,function(t){n=r.isMatchInFormulas(t,e);return n})}else{n=this.isMatchInFormulas(this.getFormulas(t),e)}return n},isMatchInFormulas:function C(e,t){var r=false;if(e.length){l(e,function(e){return r=e.func(t)})}else{r=true}return r},addFormula:function _(e,t){var r=u(t.args,function(e){return typeof e==="string"?e.toLowerCase():e});var n=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);if(this.orderStack.indexOf(e)===-1){this.orderStack.push(e)}if(this.hasFormulas(e,n)){l(this.getFormulas(e),function(e){if(e.name===n){e.func=m(e.name,r);e.args=r;return false}})}else{this.getFormulas(e).push({name:n,args:r,func:m(n,r)})}this.runLocalHooks("afterAdd",e)},getFormulas:function E(e){if(!this.formulas[e]){this.formulas[e]=[]}return this.formulas[e]},exportAllFormulas:function R(){var e=this;var t=[];l(this.orderStack,function(r){var n=u(e.getFormulas(r),function(){var e=arguments[0]!==void 0?arguments[0]:formula,t=e.name,r=e.args;return{name:t,args:r}});t.push({column:r,formulas:n})});return t},importAllFormulas:function M(e){var t=this;this.clean();l(e,function(e){t.orderStack.push(e.column);l(e.formulas,function(r){return t.addFormula(e.column,r)})})},removeFormulas:function S(e){this.runLocalHooks("beforeRemove",e);if(this.orderStack.indexOf(e)>=0){this.orderStack.splice(this.orderStack.indexOf(e),1)}this.clearFormulas(e);this.runLocalHooks("afterRemove",e)},clearFormulas:function O(e){this.runLocalHooks("beforeClear",e);this.getFormulas(e).length=0;this.runLocalHooks("afterClear",e)},hasFormulas:function T(e,t){var r=false;var n=this.getFormulas(e);if(t){r=d(n,function(e){return e.name===t}).length>0}else{r=n.length>0}return r},clean:function A(){this.runLocalHooks("beforeClean");this.formulas=Object.create(null);this.orderStack.length=0;this.runLocalHooks("afterClean")},destroy:function N(){this.clearLocalHooks();this.formulas=null;this.orderStack=null}},{});h(v,p)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,formulaRegisterer:184}],184:[function(e,t,r){"use strict";Object.defineProperties(r,{getFormula:{get:function u(){return a}},getFormulaDescriptor:{get:function d(){return s}},registerFormula:{get:function f(){return l}},__esModule:{value:true}});var n;var o=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;var i={};function a(e,t){if(!i[e]){throw Error('Filter formula "'+e+'" does not exist.')}var r=i[e],n=r.formula,o=r.descriptor;if(o.inputValuesDecorator){t=o.inputValuesDecorator(t)}return function(e){return n.apply(e.meta.instance,[].concat([e],[t]))}}function s(e){if(!i[e]){throw Error('Filter formula "'+e+'" does not exist.')}return i[e].descriptor}function l(e,t,r){r.key=e;i[e]={formula:t,descriptor:r}}o.utils.FiltersFormulaRegisterer={getFormula:a,registerFormula:l,getFormulaDescriptor:s,formulas:i}},{"../../browser":141}],185:[function(e,t,r){"use strict";Object.defineProperties(r,{FormulaUpdateObserver:{get:function M(){return R}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}),f=d.arrayEach,c=d.arrayMap,h=d.arrayFilter;var m=(o=e("formulaCollection"),o&&o.__esModule&&o||{"default":o}).FormulaCollection;var p=(i=e("dataFilter"),i&&i.__esModule&&i||{"default":i}).DataFilter;var v=(a=e("utils"),a&&a.__esModule&&a||{"default":a}).createArrayAssertion;var g=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{"default":s}),w=g.mixin,b=g.objectEach;var y=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"),l&&l.__esModule&&l||{"default":l}),C=y.curry,_=y.debounce;var E=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),u&&u.__esModule&&u||{"default":u}).localHooks;var R=function S(e){var t=arguments[1]!==void 0?arguments[1]:function(e){return[]};var r=this;this.formulaCollection=e;this.columnDataFactory=t;this.changes=[];this.grouping=false;this.latestEditedColumnPosition=-1;this.latestOrderStack=[];this.formulaCollection.addLocalHook("beforeRemove",function(e){return r._onFormulaBeforeModify(e)});this.formulaCollection.addLocalHook("afterAdd",function(e){return r.updateStatesAtColumn(e)});this.formulaCollection.addLocalHook("afterClear",function(e){return r.updateStatesAtColumn(e)});this.formulaCollection.addLocalHook("beforeClean",function(){return r._onFormulaBeforeClean()});this.formulaCollection.addLocalHook("afterClean",function(){return r._onFormulaAfterClean()})};$traceurRuntime.createClass(R,{groupChanges:function O(){this.grouping=true},flush:function T(){var e=this;this.grouping=false;f(this.changes,function(t){return e.updateStatesAtColumn(t)});this.changes.length=0},_onFormulaBeforeModify:function A(e){this.latestEditedColumnPosition=this.formulaCollection.orderStack.indexOf(e)},updateStatesAtColumn:function N(e,t){var r=this;if(this.grouping){if(this.changes.indexOf(e)===-1){this.changes.push(e)}return}var n=this.formulaCollection.exportAllFormulas();var o=this.formulaCollection.orderStack.indexOf(e);if(o===-1){o=this.latestEditedColumnPosition}var i=n.slice(0,o);var a=n.slice(o);if(a.length&&a[0].column===e){a.shift()}var s=C(function(e,t){var n=arguments[2]!==void 0?arguments[2]:[];var o=new m;e=[].concat(e,n);o.importAllFormulas(e);var i=r.columnDataFactory(t);var a;if(o.isEmpty()){a=i}else{a=new p(o,function(e){return r.columnDataFactory(e)}).filter()}a=c(a,function(e){return e.meta.visualRow});var s=v(a);return h(i,function(e){return s(e.meta.visualRow)})})(i);var l=[].concat(this.formulaCollection.getFormulas(e));this.runLocalHooks("update",{editedFormulaStack:{column:e,formulas:l},dependentFormulaStacks:a,filteredRowsFactory:s,formulaArgsChange:t})},_onFormulaBeforeClean:function D(){this.latestOrderStack=[].concat(this.formulaCollection.orderStack)},_onFormulaAfterClean:function k(){var e=this;f(this.latestOrderStack,function(t){return e.updateStatesAtColumn(t)})},destroy:function x(){var e=this;this.clearLocalHooks();b(this,function(t,r){return e[r]=null})}},{});w(R,E)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,dataFilter:160,formulaCollection:183,utils:190}],186:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseUI:{get:function _(){return y}},__esModule:{value:true}});var n,o,i,a,s,n;var l=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),n&&n.__esModule&&n||{"default":n}),u=l.clone,d=l.extend,f=l.mixin;var c=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),o&&o.__esModule&&o||{"default":o}).localHooks;var h=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),i&&i.__esModule&&i||{"default":i}).EventManager;var m=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),a&&a.__esModule&&a||{"default":a}).addClass;var p=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{"default":s}).arrayEach;var v=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),n&&n.__esModule&&n||{"default":n}).objectEach;var g="built";var w="building";var b=["click","input","keydown","keypress","keyup","focus","blur"];var y=function E(e,t){this.hot=e;this.eventManager=new h(this);this.options=d(C.DEFAULTS,t);this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName);this.buildState=false};var C=y;$traceurRuntime.createClass(y,{setValue:function R(e){this.options.value=e;this.update()},getValue:function M(){return this.options.value},get element(){if(this.buildState===w){return this._element}if(this.buildState===g){this.update();return this._element}this.buildState=w;this.build();this.buildState=g;return this._element},isBuilt:function S(){return this.buildState===g},build:function O(){var e=this;var t=function n(t,r){e.eventManager.addEventListener(t,r,function(t){return e.runLocalHooks(r,t,e)})};if(!this.buildState){this.buildState=w}if(this.options.className){m(this._element,this.options.className)}if(this.options.children.length){p(this.options.children,function(t){return e._element.appendChild(t.element)})}else if(this.options.wrapIt){var r=document.createElement(this.options.tagName);v(this.options,function(e,t){if(r[t]!==void 0&&t!=="className"&&t!=="tagName"&&t!=="children"){r[t]=e}});this._element.appendChild(r);p(b,function(e){return t(r,e)})}else{p(b,function(r){return t(e._element,r)})}},update:function T(){},reset:function A(){this.options.value="";this.update()},show:function N(){this.element.style.display=""},hide:function D(){this.element.style.display="none"},focus:function k(){},destroy:function x(){this.eventManager.destroy();this.eventManager=null;this.hot=null;if(this._element.parentNode){this._element.parentNode.removeChild(this._element)}this._element=null}},{get DEFAULTS(){return u({className:"",value:"",tagName:"div",children:[],wrapIt:true})}});f(y,c)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58}],187:[function(e,t,r){"use strict";Object.defineProperties(r,{InputUI:{get:function v(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).addClass;var u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{"default":i}),d=u.clone,f=u.extend;var c=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var h=new WeakMap;var m=function g(e,t){h.set(this,{});$traceurRuntime.superConstructor(p).call(this,e,f(p.DEFAULTS,t));this.registerHooks()};var p=m;$traceurRuntime.createClass(m,{registerHooks:function w(){var e=this;this.addLocalHook("click",function(t){return e.onClick(t)});this.addLocalHook("keyup",function(t){return e.onKeyup(t)})},build:function b(){$traceurRuntime.superGet(this,p.prototype,"build").call(this);var e=h.get(this);var t=document.createElement("div");e.input=this._element.firstChild;l(this._element,"htUIInput");l(t,"htUIInputIcon");this._element.appendChild(t);this.update()},update:function y(){if(!this.isBuilt()){return}var e=h.get(this).input;e.type=this.options.type;e.value=this.options.value},focus:function C(){if(this.isBuilt()){h.get(this).input.focus()}},onClick:function _(e){},onKeyup:function E(e){this.options.value=e.target.value}},{get DEFAULTS(){return d({placeholder:"",type:"text",tagName:"input"})}},s)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,_base:186}],188:[function(e,t,r){"use strict";Object.defineProperties(r,{MultipleSelectUI:{get:function H(){return x}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h,m;var p=(n=e("../../../browser"),n&&n.__esModule&&n||{"default":n}).default;var v=(o=e("_base"),o&&o.__esModule&&o||{"default":o}).BaseUI;var g=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),i&&i.__esModule&&i||{"default":i}).addClass;var w=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),a&&a.__esModule&&a||{"default":a}).Menu;var b=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{"default":s}),y=b.clone,C=b.extend;var _=(l=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),l&&l.__esModule&&l||{"default":l}),E=_.arrayFilter,R=_.arrayMap,M=_.arrayEach;var S=(u=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),u&&u.__esModule&&u||{"default":u}).startsWith;var O=(d=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),d&&d.__esModule&&d||{"default":d}).isKey;var T=(f=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"),f&&f.__esModule&&f||{"default":f}).partial;var A=(c=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),c&&c.__esModule&&c||{"default":c}).stopImmediatePropagation;var N=(h=e("input"),h&&h.__esModule&&h||{"default":h}).InputUI;var D=(m=e("utils"),m&&m.__esModule&&m||{"default":m}).createArrayAssertion;var k=new WeakMap;var x=function V(e,t){k.set(this,{});$traceurRuntime.superConstructor(I).call(this,e,C(I.DEFAULTS,t));this.searchInput=new N(this.hot,{placeholder:"Search...",className:"htUIMultipleSelectSearch"});this.selectAllUI=new v(this.hot,{tagName:"a",textContent:"Select all",href:"#",className:"htUISelectAll"});this.clearAllUI=new v(this.hot,{tagName:"a",textContent:"Clear",href:"#",className:"htUIClearAll"});this.items=[];this.itemsBox=null;this.registerHooks()};var I=x;$traceurRuntime.createClass(x,{registerHooks:function F(){var e=this;this.searchInput.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)});this.searchInput.addLocalHook("input",function(t){return e.onInput(t)});this.selectAllUI.addLocalHook("click",function(t){return e.onSelectAllClick(t)});this.clearAllUI.addLocalHook("click",function(t){return e.onClearAllClick(t)})},setItems:function B(e){this.items=e;if(this.itemsBox){this.itemsBox.loadData(this.items)}},getItems:function j(){return $traceurRuntime.spread(this.items)},getValue:function W(){return L(this.items)},isSelectedAllValues:function $(){return this.items.length===this.getValue().length},build:function U(){var e=this;$traceurRuntime.superGet(this,I.prototype,"build").call(this);var t=document.createElement("div");var r=new v(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element);this._element.appendChild(r.element);this._element.appendChild(t);var n=function o(t){if(!e._element){return}if(e.itemsBox){e.itemsBox.destroy()}g(t,"htUIMultipleSelectHot");e.itemsBox=new p(t,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],autoWrapCol:true,colWidths:150,height:110,width:168,copyPaste:false,disableVisualSelection:"area",fillHandle:false,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function r(t){return e.onItemsBoxBeforeKeyDown(t)}})};n(t);setTimeout(function(){return n(t)},100)},reset:function G(){this.searchInput.reset()},update:function Y(){if(!this.isBuilt()){return}this.itemsBox.loadData(P(this.items,this.options.value));$traceurRuntime.superGet(this,I.prototype,"update").call(this)},destroy:function z(){if(this.itemsBox){this.itemsBox.destroy()}this.itemsBox=null;this.searchInput=null;this.items=null;$traceurRuntime.superGet(this,I.prototype,"destroy").call(this);
},onInput:function K(e){var t=e.target.value.toLowerCase();var r;if(t===""){r=$traceurRuntime.spread(this.items)}else{r=E(this.items,function(e){return(e.value+"").toLowerCase().indexOf(t)>=0})}this.itemsBox.loadData(r)},onInputKeyDown:function q(e){this.runLocalHooks("keydown",e,this);var t=T(O,e.keyCode);if(t("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()){A(e);this.itemsBox.listen();this.itemsBox.selectCell(0,0)}},onItemsBoxBeforeKeyDown:function X(e){var t=T(O,e.keyCode);if(t("ESCAPE")){this.runLocalHooks("keydown",e,this)}if(!t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")){A(e);this.itemsBox.unlisten();this.itemsBox.deselectCell();this.searchInput.focus()}},onSelectAllClick:function J(e){e.preventDefault();M(this.itemsBox.getSourceData(),function(e){e.checked=true});this.itemsBox.render()},onClearAllClick:function Z(e){e.preventDefault();M(this.itemsBox.getSourceData(),function(e){e.checked=false});this.itemsBox.render()}},{get DEFAULTS(){return y({className:"htUIMultipleSelect",value:[]})}},v);function P(e,t){var r=D(t);return R(e,function(e){e.checked=r(e.value);return e})}function L(e){var t=[];M(e,function(e){if(e.checked){t.push(e.value)}});return t}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../browser":141,_base:186,input:187,utils:190}],189:[function(e,t,r){"use strict";Object.defineProperties(r,{SelectUI:{get:function E(){return C}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var d=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),f=d.addClass,c=d.getWindowScrollTop,h=d.getWindowScrollLeft;var m=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),i&&i.__esModule&&i||{"default":i}).Menu;var p=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),a&&a.__esModule&&a||{"default":a}),v=p.clone,g=p.extend;var w=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{"default":s}).arrayEach;var b=(l=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),l&&l.__esModule&&l||{"default":l}).SEPARATOR;var y=new WeakMap;var C=function R(e,t){y.set(this,{});$traceurRuntime.superConstructor(_).call(this,e,g(_.DEFAULTS,t));this.menu=null;this.items=[];this.registerHooks()};var _=C;$traceurRuntime.createClass(C,{registerHooks:function M(){var e=this;this.addLocalHook("click",function(t){return e.onClick(t)})},setItems:function S(e){this.items=e;if(this.menu){this.menu.setMenuItems(this.items)}},build:function O(){var e=this;$traceurRuntime.superGet(this,_.prototype,"build").call(this);this.menu=new m(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:false,standalone:true});this.menu.setMenuItems(this.items);var t=new u(this.hot,{className:"htUISelectCaption"});var r=new u(this.hot,{className:"htUISelectDropdown"});y.get(this).caption=t.element;w([t,r],function(t){return e._element.appendChild(t.element)});this.menu.addLocalHook("select",function(t){return e.onMenuSelect(t)});this.update()},update:function T(){if(!this.isBuilt()){return}y.get(this).caption.textContent=this.options.value?this.options.value.name:"None";$traceurRuntime.superGet(this,_.prototype,"update").call(this)},openOptions:function A(){var e=this.element.getBoundingClientRect();if(this.menu){this.menu.open();this.menu.setPosition({left:e.left-5,top:e.top,width:e.width,height:e.height})}},closeOptions:function N(){if(this.menu){this.menu.close()}},onMenuSelect:function D(e){if(e.name!==b){this.options.value=e;this.closeOptions();this.update();this.runLocalHooks("select",this.options.value)}},onClick:function k(e){this.openOptions()},destroy:function x(){if(this.menu){this.menu.destroy();this.menu=null}$traceurRuntime.superGet(this,_.prototype,"destroy").call(this)}},{get DEFAULTS(){return v({className:"htUISelect",wrapIt:false})}},u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":75,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,_base:186}],190:[function(e,t,r){"use strict";Object.defineProperties(r,{sortComparison:{get:function b(){return f}},toVisualValue:{get:function y(){return c}},createArrayAssertion:{get:function C(){return p}},toEmptyString:{get:function _(){return v}},unifyColumnValues:{get:function E(){return g}},intersectValues:{get:function R(){return w}},__esModule:{value:true}});var n,o;var i=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature"),n&&n.__esModule&&n||{"default":n}).getComparisonFunction;var a=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}),s=a.arrayMap,l=a.arrayUnique,u=a.arrayEach;var d=i();function f(e,t){if(typeof e==="number"&&typeof t==="number"){return e-t}return d(e,t)}function c(e){if(e===""){e="(Blank cells)"}return e}var h=new Set([1]).has(1);var m=h&&typeof Array.from==="function";function p(e){if(h){e=new Set(e)}return function(t){var r;if(h){r=e.has(t)}else{r=!!~e.indexOf(t)}return r}}function v(e){return e==null?"":e}function g(e){if(m){e=Array.from(new Set(e))}else{e=l(e)}e=e.sort(function(e,t){if(typeof e==="number"&&typeof t==="number"){return e-t}if(e===t){return 0}return e>t?1:-1});return e}function w(e,t,r){var n=[];var o=e===t;var i;if(!o){i=p(t)}u(e,function(e){var t=false;if(o||i(e)){t=true}var a={checked:t,value:e,visualValue:c(e)};if(r){r(a)}n.push(a)});return n}},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature":49}],191:[function(e,t,r){"use strict";Object.defineProperties(r,{AlterManager:{get:function E(){return y}},registerOperation:{get:function R(){return _}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).mixin;var h=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),i&&i.__esModule&&i||{"default":i}).localHooks;var m=(a=e("alterOperation/columnSorting"),a&&a.__esModule&&a||{"default":a});var p=(s=e("alterOperation/insertColumn"),s&&s.__esModule&&s||{"default":s});var v=(l=e("alterOperation/insertRow"),l&&l.__esModule&&l||{"default":l});var g=(u=e("alterOperation/removeColumn"),u&&u.__esModule&&u||{"default":u});var w=(d=e("alterOperation/removeRow"),d&&d.__esModule&&d||{"default":d});var b=new Map;_(m.OPERATION_NAME,m);_(p.OPERATION_NAME,p);_(v.OPERATION_NAME,v);_(g.OPERATION_NAME,g);_(w.OPERATION_NAME,w);var y=function M(e){this.sheet=e;this.hot=e.hot;this.dataProvider=e.dataProvider;this.matrix=e.matrix};$traceurRuntime.createClass(y,{prepareAlter:function S(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r]}if(!b.has(e)){throw Error('Alter operation "'+e+'" not exist.')}b.get(e).prepare.apply(this,t)},triggerAlter:function O(e){var t;for(var r=[],n=1;n<arguments.length;n++){r[n-1]=arguments[n]}if(!b.has(e)){throw Error('Alter operation "'+e+'" not exist.')}b.get(e).operate.apply(this,r);(t=this).runLocalHooks.apply(t,$traceurRuntime.spread(["afterAlter"],r))},destroy:function T(){this.sheet=null;this.hot=null;this.dataProvider=null;this.matrix=null}},{});c(y,h);var C=function A(){};function _(e,t){if(!b.has(e)){b.set(e,{prepare:t.prepare||C,operate:t.operate||C})}}},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"alterOperation/columnSorting":192,"alterOperation/insertColumn":193,"alterOperation/insertRow":194,"alterOperation/removeColumn":195,"alterOperation/removeRow":196}],192:[function(e,t,r){"use strict";Object.defineProperties(r,{OPERATION_NAME:{get:function p(){return f}},prepare:{get:function v(){return h}},operate:{get:function g(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("utils"),o&&o.__esModule&&o||{"default":o}).isFormulaExpression;var u=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var d=(a=e("expressionModifier"),a&&a.__esModule&&a||{"default":a}).ExpressionModifier;var f="column_sorting";var c;function h(){var e=this,t=e.matrix,r=e.dataProvider;c=new WeakMap;s(t.data,function(e){c.set(e,r.t.toVisualRow(e.row))})}function m(){var e=this,t=e.matrix,r=e.dataProvider;t.cellReferences.length=0;s(t.data,function(e){e.setState(u.STATE_OUT_OFF_DATE);e.clearPrecedents();var t=e,n=t.row,o=t.column;var i=r.getSourceDataAtCell(n,o);if(l(i)){var a=c.get(e);var s=new d(i);s.translate({row:r.t.toVisualRow(n)-a});r.updateSourceData(n,o,s.toString())}});c=null}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],193:[function(e,t,r){"use strict";Object.defineProperties(r,{OPERATION_NAME:{get:function v(){return h}},operate:{get:function g(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("utils"),o&&o.__esModule&&o||{"default":o}),u=l.cellCoordFactory,d=l.isFormulaExpression;var f=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var c=(a=e("expressionModifier"),a&&a.__esModule&&a||{"default":a}).ExpressionModifier;var h="insert_column";function m(e,t){var r=arguments[2]!==void 0?arguments[2]:true;var n=this,o=n.matrix,i=n.dataProvider;var a=[0,t];s(o.cellReferences,function(t){var r;if(t.column>=e){(r=t).translateTo.apply(r,$traceurRuntime.spread(a))}});s(o.data,function(n){var o;var s=n,l=s.row,h=s.column;if(n.column>=e){(o=n).translateTo.apply(o,$traceurRuntime.spread(a));n.setState(f.STATE_OUT_OFF_DATE)}if(r){var m=n,v=m.row,g=m.column;var w=i.getSourceDataAtCell(v,g);if(d(w)){var b=u("column",e);var y=new c(w);y.useCustomModifier(p);y.translate({column:t},b({row:l,column:h}));i.updateSourceData(v,g,y.toString())}}})}function p(e,t,r,n){var o=e,i=o.start,a=o.end;var s=i[t].index;var l=a[t].index;var u=r;var d=r;if(n>s){u=0}if(n>l){d=0}return[u,d,false]}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],194:[function(e,t,r){"use strict";Object.defineProperties(r,{OPERATION_NAME:{get:function v(){return h}},operate:{get:function g(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("utils"),o&&o.__esModule&&o||{"default":o}),u=l.cellCoordFactory,d=l.isFormulaExpression;var f=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var c=(a=e("expressionModifier"),a&&a.__esModule&&a||{"default":a}).ExpressionModifier;var h="insert_row";function m(e,t){var r=arguments[2]!==void 0?arguments[2]:true;var n=this,o=n.matrix,i=n.dataProvider;var a=[t,0];s(o.cellReferences,function(t){var r;if(t.row>=e){(r=t).translateTo.apply(r,$traceurRuntime.spread(a))}});s(o.data,function(n){var o;var s=n,l=s.row,h=s.column;if(n.row>=e){(o=n).translateTo.apply(o,$traceurRuntime.spread(a));n.setState(f.STATE_OUT_OFF_DATE)}if(r){var m=n,v=m.row,g=m.column;var w=i.getSourceDataAtCell(v,g);if(d(w)){var b=u("row",e);var y=new c(w);y.useCustomModifier(p);y.translate({row:t},b({row:l,column:h}));i.updateSourceData(v,g,y.toString())}}})}function p(e,t,r,n){var o=e,i=o.start,a=o.end;var s=i[t].index;var l=a[t].index;var u=r;var d=r;if(n>s){u=0}if(n>l){d=0}return[u,d,false]}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],195:[function(e,t,r){"use strict";Object.defineProperties(r,{OPERATION_NAME:{get:function v(){return h}},operate:{get:function g(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("utils"),o&&o.__esModule&&o||{"default":o}),u=l.cellCoordFactory,d=l.isFormulaExpression;var f=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var c=(a=e("expressionModifier"),a&&a.__esModule&&a||{"default":a}).ExpressionModifier;var h="remove_column";function m(e,t){var r=arguments[2]!==void 0?arguments[2]:true;t=-t;var n=this,o=n.matrix,i=n.dataProvider,a=n.sheet;var l=[0,t];var h=Math.abs(t)-1;var m=o.removeCellRefsAtRange({column:e},{column:e+h});var v=[];s(o.data,function(t){s(m,function(e){if(!t.hasPrecedent(e)){return}t.removePrecedent(e);t.setState(f.STATE_OUT_OFF_DATE);s(a.getCellDependencies(t.row,t.column),function(e){e.setState(f.STATE_OUT_OFF_DATE)})});if(t.column>=e&&t.column<=e+h){v.push(t)}});o.remove(v);s(o.cellReferences,function(t){var r;if(t.column>=e){(r=t).translateTo.apply(r,$traceurRuntime.spread(l))}});s(o.data,function(n){var o;var a=n,s=a.row,h=a.column;if(n.column>=e){(o=n).translateTo.apply(o,$traceurRuntime.spread(l));n.setState(f.STATE_OUT_OFF_DATE)}if(r){var m=n,v=m.row,g=m.column;var w=i.getSourceDataAtCell(v,g);if(d(w)){var b=u("column",e);var y=new c(w);y.useCustomModifier(p);y.translate({column:t},b({row:s,column:h}));i.updateSourceData(v,g,y.toString())}}})}function p(e,t,r,n){var o=e,i=o.start,a=o.end,s=o.type;var l=i[t].index;var u=a[t].index;var d=Math.abs(r)-1;var f=r;var c=r;var h=false;if(l>=n&&u<=n+d){h=true}if(!h&&s==="cell"){if(n>=l){f=0;c=0}}if(!h&&s==="range"){if(n>=l){f=0}if(n>u){c=0}else if(u<=n+d){c-=Math.min(u-(n+d),0)}}if(l+f<0){f-=l+f}return[f,c,h]}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],196:[function(e,t,r){"use strict";Object.defineProperties(r,{OPERATION_NAME:{get:function v(){return h}},operate:{get:function g(){return m}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("utils"),o&&o.__esModule&&o||{"default":o}),u=l.cellCoordFactory,d=l.isFormulaExpression;var f=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var c=(a=e("expressionModifier"),a&&a.__esModule&&a||{"default":a}).ExpressionModifier;var h="remove_row";function m(e,t){var r=arguments[2]!==void 0?arguments[2]:true;t=-t;var n=this,o=n.matrix,i=n.dataProvider,a=n.sheet;var l=[t,0];var h=Math.abs(t)-1;var m=o.removeCellRefsAtRange({row:e},{row:e+h});var v=[];s(o.data,function(t){s(m,function(e){if(!t.hasPrecedent(e)){return}t.removePrecedent(e);t.setState(f.STATE_OUT_OFF_DATE);s(a.getCellDependencies(t.row,t.column),function(e){e.setState(f.STATE_OUT_OFF_DATE)})});if(t.row>=e&&t.row<=e+h){v.push(t)}});o.remove(v);s(o.cellReferences,function(t){var r;if(t.row>=e){(r=t).translateTo.apply(r,$traceurRuntime.spread(l))}});s(o.data,function(n){var o;var a=n,s=a.row,h=a.column;if(n.row>=e){(o=n).translateTo.apply(o,$traceurRuntime.spread(l));n.setState(f.STATE_OUT_OFF_DATE)}if(r){var m=n,v=m.row,g=m.column;var w=i.getSourceDataAtCell(v,g);if(d(w)){var b=u("row",e);var y=new c(w);y.useCustomModifier(p);y.translate({row:t},b({row:s,column:h}));i.updateSourceData(v,g,y.toString())}}})}function p(e,t,r,n){var o=e,i=o.start,a=o.end,s=o.type;var l=i[t].index;var u=a[t].index;var d=Math.abs(r)-1;var f=r;var c=r;var h=false;if(l>=n&&u<=n+d){h=true}if(!h&&s==="cell"){if(n>=l){f=0;c=0}}if(!h&&s==="range"){if(n>=l){f=0}if(n>u){c=0}else if(u<=n+d){c-=Math.min(u-(n+d),0)}}if(l+f<0){f-=l+f}return[f,c,h]}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199,expressionModifier:201,utils:206}],197:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseCell:{get:function l(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),n&&n.__esModule&&n||{"default":n}).isObject;var a=(o=e("hot-formula-parser"),o&&o.__esModule&&o||{"default":o}).toLabel;var s=function u(e,t){var r=i(e);var n=i(t);this._row=r?e.index:e;this.rowAbsolute=r?e.isAbsolute:true;this._column=n?t.index:t;this.columnAbsolute=n?t.isAbsolute:true;this.rowOffset=0;this.columnOffset=0;Object.defineProperty(this,"row",{get:function o(){return this.rowOffset+this._row},set:function a(e){this._row=e},enumerable:true,configurable:true});Object.defineProperty(this,"column",{get:function s(){return this.columnOffset+this._column},set:function l(e){this._column=e},enumerable:true,configurable:true})};$traceurRuntime.createClass(s,{translateTo:function d(e,t){this.row=this.row+e;this.column=this.column+t},isEqual:function f(e){return e.row===this.row&&e.column===this.column},toString:function c(){return a({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"hot-formula-parser":"hot-formula-parser"}],198:[function(e,t,r){"use strict";Object.defineProperties(r,{CellReference:{get:function u(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseCell;var a=(o=e("hot-formula-parser"),o&&o.__esModule&&o||{"default":o}).toLabel;var s=function d(e,t){$traceurRuntime.superConstructor(l).call(this,e,t)};var l=s;$traceurRuntime.createClass(s,{toString:function f(){return a({index:this.row,isAbsolute:false},{index:this.column,isAbsolute:false})}},{},i)},{_base:197,"hot-formula-parser":"hot-formula-parser"}],199:[function(e,t,r){"use strict";Object.defineProperties(r,{CellValue:{get:function p(){return h}},__esModule:{value:true}});var n,o,i;var a=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseCell;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayFilter;var l=(i=e("hot-formula-parser"),i&&i.__esModule&&i||{"default":i}).ERROR_REF;var u=1;var d=2;var f=3;var c=[u,d,f];var h=function v(e,t){$traceurRuntime.superConstructor(m).call(this,e,t);this.precedents=[];this.value=null;this.error=null;this.state=m.STATE_UP_TO_DATE};var m=h;$traceurRuntime.createClass(h,{setValue:function g(e){this.value=e},getValue:function w(){return this.value},setError:function b(e){this.error=e},getError:function y(){return this.error},hasError:function C(){return this.error!==null},setState:function _(e){if(c.indexOf(e)===-1){throw Error("Unrecognized state: "+e)}this.state=e},isState:function E(e){return this.state===e},addPrecedent:function R(e){if(this.isEqual(e)){throw Error(l)}if(!this.hasPrecedent(e)){this.precedents.push(e)}},removePrecedent:function M(e){if(this.isEqual(e)){throw Error(l)}this.precedents=s(this.precedents,function(t){return!t.isEqual(e)})},clearPrecedents:function S(){this.precedents.length=0},getPrecedents:function O(){return this.precedents},hasPrecedents:function T(){return this.precedents.length>0},hasPrecedent:function A(e){return s(this.precedents,function(t){return t.isEqual(e)}).length?true:false}},{get STATE_OUT_OFF_DATE(){return 1},get STATE_COMPUTING(){return 2},get STATE_UP_TO_DATE(){return 3}},a)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,_base:197,"hot-formula-parser":"hot-formula-parser"}],200:[function(e,t,r){"use strict";Object.defineProperties(r,{DataProvider:{get:function c(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach;var u=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),i&&i.__esModule&&i||{"default":i}).getTranslator;var d=(a=e("utils"),a&&a.__esModule&&a||{"default":a}).isFormulaExpression;var f=function h(e){this.hot=e;this.changes={};this.t=u(this.hot)};$traceurRuntime.createClass(f,{collectChanges:function m(e,t,r){if(!d(r)){this.changes[this._coordId(e,t)]=r}},clearChanges:function p(){this.changes={}},isInDataRange:function v(e,t){return e>=0&&e<this.hot.countRows()&&t>=0&&t<this.hot.countCols()},getDataAtCell:function g(e,t){var r;var n=(r=this)._coordId.apply(r,$traceurRuntime.spread(this.t.toPhysical(e,t)));var o;if(this.changes.hasOwnProperty(n)){o=this.changes[n]}else{o=this.hot.getDataAtCell(e,t)}return o},getDataByRange:function w(e,t,r,n){var o=this;var i=this.hot.getData(e,t,r,n);s(i,function(r,n){s(r,function(r,a){var s;var l=(s=o)._coordId.apply(s,$traceurRuntime.spread(o.t.toPhysical(n+e,a+t)));if(o.changes.hasOwnProperty(l)){i[n][a]=o.changes[l]}})});return i},getSourceDataAtCell:function b(e,t){return this.hot.getSourceDataAtCell(e,t)},getRawDataAtCell:function y(e,t){var r;return(r=this).getSourceDataAtCell.apply(r,$traceurRuntime.spread(this.t.toPhysical(e,t)))},getSourceDataByRange:function C(e,t,r,n){return this.hot.getSourceDataArray(e,t,r,n)},getRawDataByRange:function _(e,t,r,n){var o;var i=$traceurRuntime.spread(this.t.toPhysical(e,t),this.t.toPhysical(r,n));return(o=this).getSourceDataByRange.apply(o,$traceurRuntime.spread(i))},updateSourceData:function E(e,t,r){this.hot.getSourceData()[e][this.hot.colToProp(t)]=r},_coordId:function R(e,t){return e+":"+t},destroy:function M(){this.hot=null;this.changes=null;this.t=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132,utils:206}],201:[function(e,t,r){"use strict";Object.defineProperties(r,{ExpressionModifier:{get:function A(){return T}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;var f=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}),c=f.arrayEach,h=f.arrayFilter;var m=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),i&&i.__esModule&&i||{"default":i}).startsWith;var p=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),a&&a.__esModule&&a||{"default":a}).mixin;var v=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),s&&s.__esModule&&s||{"default":s}).localHooks;var g=(l=e("utils"),l&&l.__esModule&&l||{"default":l}).toUpperCaseFormula;var w=(u=e("hot-formula-parser"),u&&u.__esModule&&u||{"default":u}),b=w.toLabel,y=w.extractLabel,C=w.error,_=w.ERROR_REF;var E=/^\$?[A-Z]+\$?\d+$/;var R=/\$?[A-Z]+\$?\d+/;var M=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g;var S=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g;var O=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g;var T=function N(e){this.expression="";this.cells=[];this.customModifier=null;if(typeof e==="string"){this.setExpression(e)}};$traceurRuntime.createClass(T,{setExpression:function D(e){this.cells.length=0;this.expression=g(e);this._extractCells();this._extractCellsRange();return this},useCustomModifier:function k(e){this.customModifier=e},translate:function x(e){var t=e,r=t.row,n=t.column;var o=arguments[1]!==void 0?arguments[1]:{};var i=this;c(this.cells,function(e){if(r!=null){i._translateCell(e,"row",r,o.row)}if(n!=null){i._translateCell(e,"column",n,o.column)}});return this},toString:function I(){var e=this;var t=this.expression.replace(O,function(t,r,n){var o=t.indexOf(":")===-1;var i=t;var a=t;var s=null;if(o){a=E.test(r)?r:n}var l=e._searchCell(a);if(l){s=l.refError?C(_):l.toLabel();if(o){i=t.replace(a,s)}else{i=s}}return i});if(!m(t,"=")){t="="+t}return t},_translateCell:function P(e,t,r,n){var o;var i=e,a=i.start,s=i.end;var l=a[t].index;var u=s[t].index;var d=r;var f=r;var c=false;if(this.customModifier){o=this.customModifier(e,t,r,n),d=o[0],f=o[1],c=o[2],o}else{if(a[t].isAbsolute){d=0}if(s[t].isAbsolute){f=0}}if(d&&!c){if(l+d<0){c=true}a[t].index=Math.max(l+d,0)}if(f&&!c){if(u+f<0){c=true}s[t].index=Math.max(u+f,0)}if(c){e.refError=true}},_extractCells:function L(){var e=this;var t=this.expression.match(M);if(!t){return}c(t,function(t){t=t.match(R);if(!t){return}var r=y(t[0]),n=r[0],o=r[1];e.cells.push(e._createCell({row:n,column:o},{row:n,column:o},t[0]))})},_extractCellsRange:function H(){var e=this;var t=this.expression.match(S);if(!t){return}c(t,function(t){var r=t.split(":"),n=r[0],o=r[1];var i=y(n),a=i[0],s=i[1];var l=y(o),u=l[0],d=l[1];var f={row:a,column:s};var c={row:u,column:d};e.cells.push(e._createCell(f,c,t))})},_searchCell:function V(e){var t=h(this.cells,function(t){return t.origLabel===e})[0];return t||null},_createCell:function F(e,t,r){return{start:e,end:t,origLabel:r,type:r.indexOf(":")===-1?"cell":"range",refError:false,toLabel:function n(){var e=b(this.start.row,this.start.column);if(this.type==="range"){e+=":"+b(this.end.row,this.end.column)}return e}}}},{});p(T,v);d.utils.FormulasUtils=d.utils.FormulasUtils||{};d.utils.FormulasUtils.ExpressionModifier=T},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../browser":141,"hot-formula-parser":"hot-formula-parser",utils:206}],202:[function(e,t,r){"use strict";Object.defineProperties(r,{Formulas:{get:function A(){return O}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f;var c=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var h=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var m=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{"default":i}),p=m.isObject,v=m.objectEach;var g=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),a&&a.__esModule&&a||{"default":a}).EventManager;var w=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),s&&s.__esModule&&s||{"default":s}).registerPlugin;var b=(l=e("utils"),l&&l.__esModule&&l||{"default":l}),y=b.isFormulaExpression,C=b.toUpperCaseFormula,_=b.isFormulaExpressionEscaped,E=b.unescapeFormulaExpression;var R=(u=e("sheet"),u&&u.__esModule&&u||{"default":u}).Sheet;var M=(d=e("dataProvider"),d&&d.__esModule&&d||{"default":d}).DataProvider;var S=(f=e("undoRedoSnapshot"),f&&f.__esModule&&f||{"default":f}).UndoRedoSnapshot;var O=function N(e){$traceurRuntime.superConstructor(T).call(this,e);this.eventManager=new g(this);this.dataProvider=new M(this.hot);this.sheet=new R(this.hot,this.dataProvider);this.undoRedoSnapshot=new S(this.sheet);this._skipRendering=false};var T=O;$traceurRuntime.createClass(O,{isEnabled:function D(){return this.hot.getSettings().formulas?true:false},enablePlugin:function k(){var e=this;if(this.enabled){return}var t=this.hot.getSettings().formulas;if(p(t)){if(p(t.variables)){v(t.variables,function(t,r){return e.setVariable(r,t)})}}this.addHook("afterColumnSort",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterColumnSort.apply(t,$traceurRuntime.spread(r))});this.addHook("afterCreateCol",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterCreateCol.apply(t,$traceurRuntime.spread(r))});this.addHook("afterCreateRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterCreateRow.apply(t,$traceurRuntime.spread(r))});this.addHook("afterLoadData",function(){return e.onAfterLoadData()});this.addHook("afterRemoveCol",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterRemoveCol.apply(t,$traceurRuntime.spread(r))});this.addHook("afterRemoveRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterRemoveRow.apply(t,$traceurRuntime.spread(r))});this.addHook("afterSetDataAtCell",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterSetDataAtCell.apply(t,$traceurRuntime.spread(r))});this.addHook("afterSetDataAtRowProp",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterSetDataAtCell.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeColumnSort",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeColumnSort.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeCreateCol",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeCreateCol.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeCreateRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeCreateRow.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeRemoveCol",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeRemoveCol.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeRemoveRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeRemoveRow.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeValidate",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeValidate.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeValueRender",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeValueRender.apply(t,$traceurRuntime.spread(r))});this.addHook("modifyData",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onModifyData.apply(t,$traceurRuntime.spread(r))});this.sheet.addLocalHook("afterRecalculate",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onSheetAfterRecalculate.apply(t,$traceurRuntime.spread(r))});$traceurRuntime.superGet(this,T.prototype,"enablePlugin").call(this)},disablePlugin:function x(){$traceurRuntime.superGet(this,T.prototype,"disablePlugin").call(this);
},getCellValue:function I(e,t){var r=this.sheet.getCellAt(e,t);return r?r.getError()||r.getValue():void 0},hasComputedCellValue:function P(e,t){return this.sheet.getCellAt(e,t)?true:false},recalculate:function L(){this.sheet.recalculate()},recalculateFull:function H(){this.sheet.recalculateFull()},recalculateOptimized:function V(){this.sheet.recalculateOptimized()},setVariable:function F(e,t){this.sheet.setVariable(e,t)},getVariable:function B(e){return this.sheet.getVariable(e)},onSheetAfterRecalculate:function j(e,t){if(this._skipRendering){this._skipRendering=false;return}var r=this.hot;h(e,function(e){var t=e,n=t.row,o=t.column;r.validateCell(r.getDataAtCell(n,o),r.getCellMeta(n,o),function(){})});r.render()},onModifyData:function W(e,t,r,n){if(n==="get"&&this.hasComputedCellValue(e,t)){r.value=this.getCellValue(e,t)}else if(n==="set"&&y(r.value)){r.value=C(r.value)}},onBeforeValueRender:function $(e){if(_(e)){e=E(e)}return e},onBeforeValidate:function U(e,t,r,n){var o=this.hot.propToCol(r);if(this.hasComputedCellValue(t,o)){e=this.getCellValue(t,o)}return e},onAfterSetDataAtCell:function G(e,t){var r=this;if(t==="loadData"){return}this.dataProvider.clearChanges();h(e,function(e){var t=e,n=t[0],o=t[1],i=t[2],a=t[3];o=r.hot.propToCol(o);n=r.t.toPhysicalRow(n);if(y(a)){a=C(a)}r.dataProvider.collectChanges(n,o,a);if(i!==a){r.sheet.applyChanges(n,o,a)}});this.recalculate()},onBeforeCreateRow:function Y(e,t,r){if(r==="UndoRedo.undo"){this.undoRedoSnapshot.restore()}},onAfterCreateRow:function z(e,t,r){this.sheet.alterManager.triggerAlter("insert_row",e,t,r!=="UndoRedo.undo")},onBeforeRemoveRow:function K(e,t){this.undoRedoSnapshot.save("row",e,t)},onAfterRemoveRow:function q(e,t){this.sheet.alterManager.triggerAlter("remove_row",e,t)},onBeforeCreateCol:function X(e,t,r){if(r==="UndoRedo.undo"){this.undoRedoSnapshot.restore()}},onAfterCreateCol:function J(e,t,r){this.sheet.alterManager.triggerAlter("insert_column",e,t,r!=="UndoRedo.undo")},onBeforeRemoveCol:function Z(e,t){this.undoRedoSnapshot.save("column",e,t)},onAfterRemoveCol:function Q(e,t){this.sheet.alterManager.triggerAlter("remove_column",e,t)},onBeforeColumnSort:function ee(e,t){this.sheet.alterManager.prepareAlter("column_sorting",e,t)},onAfterColumnSort:function te(e,t){this.sheet.alterManager.triggerAlter("column_sorting",e,t)},onAfterLoadData:function re(){this._skipRendering=true;this.recalculateFull()},destroy:function ne(){this.dataProvider.destroy();this.dataProvider=null;this.sheet.destroy();this.sheet=null;$traceurRuntime.superGet(this,T.prototype,"destroy").call(this)}},{},c);w("formulas",O)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:200,sheet:204,undoRedoSnapshot:205,utils:206}],203:[function(e,t,r){"use strict";Object.defineProperties(r,{Matrix:{get:function f(){return d}},__esModule:{value:true}});var n,o;var i=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}),a=i.arrayEach,s=i.arrayFilter,l=i.arrayReduce;var u=(o=e("cell/value"),o&&o.__esModule&&o||{"default":o}).CellValue;var d=function c(e){this.t=e;this.data=[];this.cellReferences=[]};$traceurRuntime.createClass(d,{getCellAt:function h(e,t){var r=null;a(this.data,function(n){if(n.row===e&&n.column===t){r=n;return false}});return r},getOutOfDateCells:function m(){return s(this.data,function(e){return e.isState(u.STATE_OUT_OFF_DATE)})},add:function p(e){if(!s(this.data,function(t){return t.isEqual(e)}).length){this.data.push(e)}},remove:function v(e){var t=Array.isArray(e);var r=function n(e,r){var n=false;if(t){a(r,function(t){if(e.isEqual(t)){n=true;return false}})}else{n=e.isEqual(r)}return n};this.data=s(this.data,function(t){return!r(t,e)})},getDependencies:function g(e){var t=this;var g=function n(e){return l(t.data,function(t,r){if(r.hasPrecedent(e)&&t.indexOf(r)===-1){t.push(r)}return t},[])};var r=function o(e){var r=g(e);if(r.length){a(r,function(e){if(e.hasPrecedents()){r=r.concat(o(t.t.toVisual(e)))}})}return r};return r(e)},registerCellRef:function w(e){if(!s(this.cellReferences,function(t){return t.isEqual(e)}).length){this.cellReferences.push(e)}},removeCellRefsAtRange:function b(e,t){var r=e,n=r.row,o=r.column,i=t,a=i.row,l=i.column;var u=[];var d=function c(e){return n===void 0?true:e.row>=n&&e.row<=a};var f=function h(e){return o===void 0?true:e.column>=o&&e.column<=l};this.cellReferences=s(this.cellReferences,function(e){if(d(e)&&f(e)){u.push(e);return false}return true});return u},reset:function y(){this.data.length=0;this.cellReferences.length=0}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":199}],204:[function(e,t,r){"use strict";Object.defineProperties(r,{Sheet:{get:function H(){return L}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f,c,h;var m=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}),p=m.arrayEach,v=m.arrayMap;var g=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach;var w=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var b=(a=e("cell/reference"),a&&a.__esModule&&a||{"default":a}).CellReference;var y=(s=e("utils"),s&&s.__esModule&&s||{"default":s}),C=y.isFormulaExpression,_=y.toUpperCaseFormula;var E=(l=e("matrix"),l&&l.__esModule&&l||{"default":l}).Matrix;var R=(u=e("alterManager"),u&&u.__esModule&&u||{"default":u}).AlterManager;var M=(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),d&&d.__esModule&&d||{"default":d}).localHooks;var S=(f=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),f&&f.__esModule&&f||{"default":f}).getTranslator;var O=(c=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),c&&c.__esModule&&c||{"default":c}),T=O.objectEach,A=O.mixin;var N=(h=e("hot-formula-parser"),h&&h.__esModule&&h||{"default":h}),D=N.Parser,k=N.ERROR_REF;var x=1;var I=2;var P=3;var L=function V(e,t){var r=this;this.hot=e;this.t=S(this.hot);this.dataProvider=t;this.parser=new D;this.matrix=new E(this.t);this.alterManager=new R(this);this._processingCell=null;this._state=P;this.parser.on("callCellValue",function(){var e;for(var t=[],n=0;n<arguments.length;n++){t[n]=arguments[n]}return(e=r)._onCallCellValue.apply(e,$traceurRuntime.spread(t))});this.parser.on("callRangeValue",function(){var e;for(var t=[],n=0;n<arguments.length;n++){t[n]=arguments[n]}return(e=r)._onCallRangeValue.apply(e,$traceurRuntime.spread(t))});this.alterManager.addLocalHook("afterAlter",function(){var e;for(var t=[],n=0;n<arguments.length;n++){t[n]=arguments[n]}return(e=r)._onAfterAlter.apply(e,$traceurRuntime.spread(t))})};$traceurRuntime.createClass(L,{recalculate:function F(){switch(this._state){case P:this.recalculateFull();break;case I:this.recalculateOptimized();break}},recalculateOptimized:function B(){var e=this;var t=this.matrix.getOutOfDateCells();p(t,function(t){var r=e.dataProvider.getSourceDataAtCell(t.row,t.column);if(C(r)){e.parseExpression(t,r.substr(1))}});this._state=x;this.runLocalHooks("afterRecalculate",t,"optimized")},recalculateFull:function j(){var e=this;var t=this.dataProvider.getSourceDataByRange();this.matrix.reset();p(t,function(t,r){p(t,function(t,n){if(C(t)){e.parseExpression(new w(r,n),t.substr(1))}})});this._state=x;this.runLocalHooks("afterRecalculate",t,"full")},setVariable:function W(e,t){this.parser.setVariable(e,t)},getVariable:function $(e){return this.parser.getVariable(e)},applyChanges:function U(e,t,r){var n;this.matrix.remove({row:e,column:t});if(C(r)){this.parseExpression(new w(e,t),r.substr(1))}var o=(n=this).getCellDependencies.apply(n,$traceurRuntime.spread(this.t.toVisual(e,t)));p(o,function(e){e.setState(w.STATE_OUT_OFF_DATE)});this._state=I},parseExpression:function G(e,t){e.setState(w.STATE_COMPUTING);this._processingCell=e;var r=this.parser.parse(_(t)),n=r.error,o=r.result;if(t.indexOf("!")!=-1&&n=="#ERROR!"){n=null;o=this.hot.getInstance().gridRef.getRefValue(t)}e.setValue(o);e.setError(n);e.setState(w.STATE_UP_TO_DATE);this.matrix.add(e);this._processingCell=null},getCellAt:function Y(e,t){return this.matrix.getCellAt(e,t)},getCellDependencies:function z(e,t){return this.matrix.getDependencies({row:e,column:t})},_onCallCellValue:function K(e,t){var r=e,n=r.row,o=r.column;var i=new b(n,o);if(!this.dataProvider.isInDataRange(i.row,i.column)){throw Error(k)}this.matrix.registerCellRef(i);this._processingCell.addPrecedent(i);t(this.dataProvider.getDataAtCell(n.index,o.index))},_onCallRangeValue:function q(e,t,r){var n=e,o=n.row,i=n.column,a=t,s=a.row,l=a.column;var u=this;g(o.index,s.index,function(e){g(i.index,l.index,function(t){var r=new b(e,t);u.matrix.registerCellRef(r);u._processingCell.addPrecedent(r)})});r(this.dataProvider.getDataByRange(o.index,i.index,s.index,l.index))},_onAfterAlter:function X(){this.recalculateOptimized()},destroy:function J(){this.hot=null;this.t=null;this.dataProvider.destroy();this.dataProvider=null;this.alterManager.destroy();this.alterManager=null;this.parser=null;this.matrix.reset();this.matrix=null}},{});A(L,M)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132,alterManager:191,"cell/reference":198,"cell/value":199,"hot-formula-parser":"hot-formula-parser",matrix:203,utils:206}],205:[function(e,t,r){"use strict";Object.defineProperties(r,{UndoRedoSnapshot:{get:function c(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach;var u=(i=e("cell/value"),i&&i.__esModule&&i||{"default":i}).CellValue;var d=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack"),a&&a.__esModule&&a||{"default":a}).Stack;var f=function h(e){this.sheet=e;this.stack=new d};$traceurRuntime.createClass(f,{save:function m(e,t,r){var n=this.sheet,o=n.matrix,i=n.dataProvider;var a=[];s(o.data,function(n){var o=n,s=o.row,l=o.column;if(n[e]<t||n[e]>t+(r-1)){var u=i.getSourceDataAtCell(s,l);a.push({row:s,column:l,value:u})}});this.stack.push({axis:e,index:t,amount:r,changes:a})},restore:function p(){var e=this.sheet,t=e.matrix,r=e.dataProvider;var n=this.stack.pop(),o=n.axis,i=n.index,a=n.amount,l=n.changes;if(l){s(l,function(e){if(e[o]>i+(a-1)){e[o]-=a}var n=e,s=n.row,l=n.column,d=n.value;var f=r.getSourceDataAtCell(s,l);if(f!==d){r.updateSourceData(s,l,d);t.getCellAt(s,l).setState(u.STATE_OUT_OFF_DATE)}})}},destroy:function v(){this.sheet=null;this.stack=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack":129,"cell/value":199}],206:[function(e,t,r){"use strict";Object.defineProperties(r,{isFormulaExpression:{get:function d(){return i}},isFormulaExpressionEscaped:{get:function f(){return a}},unescapeFormulaExpression:{get:function c(){return s}},toUpperCaseFormula:{get:function h(){return l}},cellCoordFactory:{get:function m(){return u}},__esModule:{value:true}});var n;var o=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;function i(e){e=e+"";return e&&e.length>=2&&e.charAt(0)==="="?true:false}function a(e){return e&&(e+"").charAt(0)==="'"&&(e+"").charAt(1)==="="?true:false}function s(e){return a(e)?e.substr(1):e}function l(e){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g;var r=e.match(t)||[];var n=-1;return e.toUpperCase().replace(t,function(){++n;return r[n]})}function u(e,t){return function(r){return{row:e==="row"?t:r.row,column:e==="column"?t:r.column}}}o.utils.FormulasUtils=o.utils.FormulasUtils||{};o.utils.FormulasUtils.isFormulaExpression=i;o.utils.FormulasUtils.isFormulaExpressionEscaped=a;o.utils.FormulasUtils.unescapeFormulaExpression=s;o.utils.FormulasUtils.toUpperCaseFormula=l},{"../../browser":141}],207:[function(e,t,r){"use strict";Object.defineProperties(r,{DateCalculator:{get:function l(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),n&&n.__esModule&&n||{"default":n}).arrayEach;var a=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).objectEach;var s=function u(e){this.year=e;this.firstWeekDay="monday";this.weekSectionCount=0;this.monthList=this.calculateMonthData();this.daysInColumns={};this.calculateWeekStructure()};$traceurRuntime.createClass(s,{setYear:function d(e){this.year=e;this.monthList=this.calculateMonthData();this.calculateWeekStructure()},setFirstWeekDay:function f(e){var t=e.toLowerCase();if(t!=="monday"&&t!=="sunday"){console.warn("First day of the week must be set to either Monday or Sunday")}this.firstWeekDay=t;this.calculateWeekStructure()},countWeekSections:function c(){return this.weekSectionCount},getFirstWeekDay:function h(){return this.firstWeekDay},getYear:function m(){return this.year},getMonthList:function p(){return this.monthList},parseDate:function v(e){if(!(e instanceof Date)){e=new Date(e);if(e.toString()==="Invalid Date"){return null}}return e},dateToColumn:function g(e){e=this.parseDate(e);if(!e||e.getFullYear()!==this.year){return false}var t=e.getMonth();var r=e.getDate()-1;var n=this.daysInColumns[t];var o=null;a(n,function(e,t){if(e.indexOf(r+1)>-1){o=parseInt(t,10);return false}});return o},columnToDate:function w(e){var t=null;a(this.daysInColumns,function(r,n){if(r[e]){t=n;return false}});if(this.daysInColumns[t][e].length===1){return new Date(this.year,t,this.daysInColumns[t][e][0])}else{return this.daysInColumns[t][e]}},isOnTheEdgeOfWeek:function b(e){e=this.parseDate(e);if(!e){return null}var t=e.getMonth();var r=e.getDate()-1;var n=this.daysInColumns[t];var b=false;a(n,function(e){var t=e.indexOf(r+1);if(t===0){b=[1,0];return false}else if(t===e.length-1){b=[0,1];return false}});return b},addDaysToCache:function y(e,t,r,n){if(!this.daysInColumns[e]){this.daysInColumns[e]={}}if(!this.daysInColumns[e][t]){this.daysInColumns[e][t]=[]}for(var o=r;o<=n;o++){this.daysInColumns[e][t].push(o)}},isValidRangeBarData:function C(e,t){var r=this.parseDate(e);var n=this.parseDate(t);return r&&n&&r.getTime()<=n.getTime()},calculateMonthData:function _(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}]},countMonths:function E(){return this.monthList.length},countMonthDays:function R(e){return this.monthList[e-1].days},countMonthFullWeeks:function M(e){return this.monthList[e-1].fullWeeks},calculateWeekStructure:function S(){var e=0;var t=0;var r=this.getFirstWeekDay();var n=this.getMonthList();var o=this.getYear();if(r==="monday"){e=1}i(n,function(r,n){var i=new Date(o,n,1).getDay();r.daysBeforeFullWeeks=(7-i+e)%7;r.fullWeeks=Math.floor((r.days-r.daysBeforeFullWeeks)/7);r.daysAfterFullWeeks=r.days-r.daysBeforeFullWeeks-7*r.fullWeeks;t+=r.fullWeeks+(r.daysBeforeFullWeeks?1:0)+(r.daysAfterFullWeeks?1:0)});this.weekSectionCount=t}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],208:[function(e,t,r){"use strict";Object.defineProperties(r,{GanttChart:{get:function T(){return S}},__esModule:{value:true}});var n,o,i,a,s,l,u,d,f;var c=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),h=c.addClass,m=c.removeClass;var p=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}),v=p.objectEach,g=p.deepClone,w=p.extend;var b=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var y=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),a&&a.__esModule&&a||{"default":a}).rangeEach;var C=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data"),s&&s.__esModule&&s||{"default":s}).createEmptySpreadsheetData;var _=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),l&&l.__esModule&&l||{"default":l}).registerPlugin;var E=(u=e("dateCalculator"),u&&u.__esModule&&u||{"default":u}).DateCalculator;var R=(d=e("ganttChartDataFeed"),d&&d.__esModule&&d||{"default":d}).GanttChartDataFeed;var M=(f=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),f&&f.__esModule&&f||{"default":f}).default;var S=function A(e){$traceurRuntime.superConstructor(O).call(this,e);this.settings={};this.dateCalculator=null;this.currentYear=null;this.monthList=[];this.monthHeadersArray=[];this.weekHeadersArray=[];this.rangeBars={};this.rangeList={};this.nestedHeadersPlugin=null;this.hotSource=null;this.overallWeekSectionCount=null;this.initialSettings=null;this.dataFeed=null;this.colorData={};this.rangeBarMeta=Object.create(null)};var O=S;$traceurRuntime.createClass(S,{checkDependencies:function N(){if(!this.hot.getSettings().colHeaders){console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},isEnabled:function D(){return!!this.hot.getSettings().ganttChart},enablePlugin:function k(){var e=this;if(this.enabled){return}this.checkDependencies();this.parseSettings();this.currentYear=this.settings.startYear||(new Date).getFullYear();this.dateCalculator=new E(this.currentYear);this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay);this.monthList=this.dateCalculator.getMonthList();this.monthHeadersArray=this.generateMonthHeaders();this.weekHeadersArray=this.generateWeekHeaders();this.overallWeekSectionCount=this.dateCalculator.countWeekSections();this.assignGanttSettings();if(this.nestedHeadersPlugin){this.applyDataSource();if(this.colorData){this.setRangeBarColors(this.colorData)}}this.addHook("afterInit",function(){return e.onAfterInit()});h(this.hot.rootElement,"ganttChart");$traceurRuntime.superGet(this,O.prototype,"enablePlugin").call(this)},disablePlugin:function x(){if(this.internalUpdateSettings){return}if(this.dataFeed&&this.dataFeed.hotSource){this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource)}this.settings={};this.dataFeed={};this.currentYear=null;this.monthList=[];this.rangeBars={};this.rangeList={};this.rangeBarMeta={};this.hotSource=null;this.deassignGanttSettings();this.hot.getPlugin("collapsibleColumns").disablePlugin();this.hot.getPlugin("nestedHeaders").disablePlugin();m(this.hot.rootElement,"ganttChart");$traceurRuntime.superGet(this,O.prototype,"disablePlugin").call(this)},updatePlugin:function I(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,O.prototype,"updatePlugin").call(this)},parseSettings:function P(){this.settings=this.hot.getSettings().ganttChart;if(typeof this.settings==="boolean"){this.settings={}}if(!this.settings.firstWeekDay){this.settings.firstWeekDay="monday"}},applyDataSource:function L(){if(this.settings.dataSource){var e=this.settings.dataSource;if(e.instance){this.loadData(e.instance,e.startDateColumn,e.endDateColumn,e.additionalData,e.asyncUpdates)}else{this.loadData(e)}}},loadData:function H(e,t,r,n,o){if(e.length>1){this.hot.alter("insert_row",0,e.length-1,this.pluginName+".loadData")}this.dataFeed=new R(this.hot,e,t,r,n,o);this.hot.render()},clearRangeBars:function V(){this.rangeBars={}},clearRangeList:function F(){this.rangeList={}},getRangeBarCoordinates:function B(e){return this.rangeList[e]},generateHeaderSet:function j(e){var t=this;var r=[];v(this.monthList,function(n,o){var i=n.daysBeforeFullWeeks>0?1:0;var a=n.daysAfterFullWeeks>0?1:0;var s=n.fullWeeks+i+a;var l=parseInt(o,10);if(e==="months"){r.push({label:n.name,colspan:s})}else if(e==="weeks"){for(var u=0;u<s;u++){if(i&&u===0){var d=u+1;var f=n.daysBeforeFullWeeks;if(d===f){r.push(d)}else{r.push(d+" - "+f)}t.dateCalculator.addDaysToCache(l,r.length-1,d,f)}else if(a&&u===s-1){var c=n.days-n.daysAfterFullWeeks+1;var h=n.days;if(c===h){r.push(c)}else{r.push(c+" - "+h)}t.dateCalculator.addDaysToCache(l,r.length-1,c,h)}else{var m=n.daysBeforeFullWeeks+(u-i)*7+1;var p=m+6;r.push(m+" - "+p);t.dateCalculator.addDaysToCache(l,r.length-1,m,p)}}}else if(e==="days"){for(var v=0;v<n.days;v++){r.push(v+1)}}});return r},generateMonthHeaders:function W(){return this.generateHeaderSet("months")},generateWeekHeaders:function $(){return this.generateHeaderSet("weeks")},generateDayHeaders:function U(){return this.generateHeaderSet("days")},assignGanttSettings:function G(){var e=this;this.initialSettings=g(this.hot.getSettings());var t={data:C(1,this.overallWeekSectionCount),readOnly:true,renderer:function r(t,n,o,i,a,s,l){return e.uniformBackgroundRenderer(t,n,o,i,a,s,l)},colWidths:60,hiddenColumns:true,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:true,columnSorting:false};this.internalUpdateSettings=true;this.hot.updateSettings(t);this.internalUpdateSettings=void 0},deassignGanttSettings:function Y(){this.internalUpdateSettings=true;if(this.initialSettings){this.hot.updateSettings(this.initialSettings)}this.internalUpdateSettings=void 0},cacheRangeBarMeta:function z(e,t,r,n){if(!this.rangeBarMeta[e]){this.rangeBarMeta[e]={}}if(!this.rangeBarMeta[e][t]){this.rangeBarMeta[e][t]={}}this.rangeBarMeta[e][t][r]=n},applyRangeBarMetaCache:function K(){var e=this;v(this.rangeBarMeta,function(t,r){v(t,function(t,n){v(t,function(t,o){e.hot.setCellMeta(r,n,o,t)})})})},addRangeBar:function q(e,t,r,n){var o=this;var i=this.dateCalculator.dateToColumn(t);var a=this.dateCalculator.dateToColumn(r);if(!this.dateCalculator.isValidRangeBarData(t,r)||i==null||a==null){return false}if(!this.rangeBars[e]){this.rangeBars[e]={}}this.rangeBars[e][i]={barLength:a-i+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(r)[1],additionalData:{}};v(n,function(t,r){o.rangeBars[e][i].additionalData[r]=t});if(this.colorData[e]){this.rangeBars[e][i].colors=this.colorData[e]}this.rangeList[e]=[e,i];this.renderRangeBar(e,i,a,n);return[e,i]},getRangeBarData:function X(e,t){var r=this.getRangeBarCoordinates(e);if(!r){return false}var n=this.rangeBars[r[0]][r[1]];if(n&&e===r[0]&&(t===r[1]||t>r[1]&&t<r[1]+n.barLength)){return n}else{return false}},updateRangeBarData:function J(e,t,r){var n=this.getRangeBarData(e,t);v(r,function(e,t){if(n[t]!==e){n[t]=e}})},renderRangeBar:function Z(e,t,r,n){var o=this.rangeBars[e][t];for(var i=t;i<=r;i++){var a=this.hot.getCellMeta(e,i);var s=(a.className||"")+" rangeBar";if(i===t&&o.partialStart||i===r&&o.partialEnd){s+=" partial"}if(i===r){s+=" last"}this.hot.setCellMeta(e,i,"originalClassName",a.className);this.hot.setCellMeta(e,i,"className",s);this.hot.setCellMeta(e,i,"additionalData",o.additionalData);this.cacheRangeBarMeta(e,i,"originalClassName",a.className);this.cacheRangeBarMeta(e,i,"className",s);this.cacheRangeBarMeta(e,i,"additionalData",o.additionalData)}},removeRangeBarByDate:function Q(e,t){var r=this.dateCalculator.dateToColumn(t);this.removeRangeBarByColumn(e,r)},removeRangeBarByColumn:function ee(e,t){var r=this;var n=this.rangeBars[e][t];if(!n){return}this.unrenderRangeBar(e,t,t+n.barLength-1);this.rangeBars[e][t]=null;v(this.rangeList,function(n,o){o=parseInt(o,10);if(JSON.stringify(n)===JSON.stringify([e,t])){r.rangeList[o]=null}})},removeAllRangeBars:function te(){var e=this;v(this.rangeBars,function(t,r){v(t,function(t,n){e.removeRangeBarByColumn(r,n)})})},unrenderRangeBar:function re(e,t,r){for(var n=t;n<=r;n++){var o=this.hot.getCellMeta(e,n);this.hot.setCellMeta(e,n,"className",o.originalClassName);this.hot.setCellMeta(e,n,"originalClassName",void 0);this.cacheRangeBarMeta(e,n,"className",o.originalClassName);this.cacheRangeBarMeta(e,n,"originalClassName",void 0)}this.hot.render()},uniformBackgroundRenderer:function ne(e,t,r,n,o,i,a){var s=this.getRangeBarData(r,n);var l=this.getRangeBarCoordinates(r);if(a.className){t.className=a.className}var u="";v(a.additionalData,function(e,t){u+=t+": "+e+"\n"});u=u.replace(/\n$/,"");t.title=u;if(s&&s.colors){if(n===l[1]&&s.partialStart||n===l[1]+s.barLength-1&&s.partialEnd){t.style.background=s.colors[1]}else{t.style.background=s.colors[0]}}else{t.style.background=""}},setRangeBarColors:function oe(e){var t=this;this.colorData=e;v(e,function(e,r){var n=t.getRangeBarCoordinates(r);if(n){t.updateRangeBarData(n[0],n[1],{colors:e})}});this.hot.render()},setYear:function ie(e){var t=w(this.hot.getSettings().ganttChart,{startYear:e});this.hot.updateSettings({ganttChart:t})},onAfterInit:function ae(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders");this.applyDataSource()},onUpdateSettings:function se(){if(this.internalUpdateSettings){this.applyRangeBarMetaCache();return}$traceurRuntime.superGet(this,O.prototype,"onUpdateSettings").call(this)},destroy:function le(){if(this.hotSource){this.dataFeed.removeSourceHotHooks(this.hotSource)}$traceurRuntime.superGet(this,O.prototype,"destroy").call(this)}},{},M);_("ganttChart",S)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data":45,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,dateCalculator:207,ganttChartDataFeed:209}],209:[function(e,t,r){"use strict";Object.defineProperties(r,{GanttChartDataFeed:{get:function c(){return f}},__esModule:{value:true}});var n,o,i;var a=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),n&&n.__esModule&&n||{"default":n}),s=a.objectEach,l=a.deepClone;var u=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var d=(i=e("dateCalculator"),i&&i.__esModule&&i||{"default":i}).DateCalculator;var f=function h(e,t,r,n,o,i){this.data=t;this.chartInstance=e;this.chartPlugin=this.chartInstance.getPlugin("ganttChart");this.hotSource=null;this.sourceHooks={};this.ongoingAsync=false;this.applyData(t,r,n,o,i||false)};$traceurRuntime.createClass(f,{applyData:function m(e,t,r,n,o){if(Object.prototype.toString.call(e)==="[object Array]"){this.loadData(e)}else if(e.guid){this.bindWithHotInstance(e,t,r,n,o)}},bindWithHotInstance:function p(e,t,r,n,o){this.hotSource={instance:e,startColumn:t,endColumn:r,additionalData:n,asyncUpdates:o};this.addSourceHotHooks();this.asyncCall(this.updateFromSource)},asyncCall:function v(e){var t=this;if(!this.hotSource.asyncUpdates){e.call(this);return}this.asyncStart();setTimeout(function(){e.call(t);t.asyncEnd()},0)},asyncStart:function g(){this.ongoingAsync=true},asyncEnd:function w(){this.ongoingAsync=false},addSourceHotHooks:function b(){var e=this;this.sourceHooks={afterLoadData:function t(r){return e.onAfterSourceLoadData(r)},afterChange:function r(t,n){return e.onAfterSourceChange(t,n)},afterColumnSort:function n(t,r){return e.onAfterColumnSort(t,r)}};this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData);this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange);this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)},removeSourceHotHooks:function y(e){if(this.sourceHooks.afterLoadData){e.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData)}if(this.sourceHooks.afterChange){e.instance.removeHook("afterChange",this.sourceHooks.afterChange)}if(this.sourceHooks.afterColumnSort){e.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},getDataFromSource:function C(e){var t={};var r=this.hotSource;var n;var o=[];if(e===void 0){n=r.instance.getData(0,0,r.instance.countRows()-1,r.instance.countCols()-1)}else{n=[];n[e]=r.instance.getDataAtRow(e)}var i=function d(e,i){t={};var a=n[e];if(a[r.startColumn]===null||a[r.startColumn]===""){return 0}s(r.additionalData,function(e,r){t[r]=a[e]});o.push([e,a[r.startColumn],a[r.endColumn],t,e])},a;e:for(var l=e||0,u=n.length;l<(e?e+1:u);l++){a=i(l,u);switch(a){case 0:continue e}}return o},updateFromSource:function _(e){var t=this;var r=this.getDataFromSource(e);if(!e&&isNaN(e)){this.chartPlugin.clearRangeBars();this.chartPlugin.clearRangeList()}u(r,function(e){e=t.trimRangeIfNeeded(e);t.chartPlugin.addRangeBar.apply(t.chartPlugin,e)})},loadData:function E(e){var t=this;u(e,function(e,r){e=t.trimRangeIfNeeded(e);t.chartPlugin.addRangeBar(r,e.startDate,e.endDate,e.additionalData)})},trimRangeIfNeeded:function R(e){var t=null;if(e[1]){t={startDate:1,endDate:2}}else{t={startDate:"startDate",endDate:"endDate"}}var r=new Date(e[t.startDate]);var n=new Date(e[t.endDate]);if(typeof r==="string"||typeof n==="string"){return false}var o=r.getFullYear();var i=n.getFullYear();if(o<this.chartPlugin.currentYear&&i>=this.chartPlugin.currentYear){e[t.startDate]="01/01/"+this.chartPlugin.currentYear}if(i>this.chartPlugin.currentYear&&o<=this.chartPlugin.currentYear){e[t.endDate]="12/31/"+this.chartPlugin.currentYear}return e},onAfterSourceChange:function M(e,t){var r=this;this.asyncCall(function(){if(!e){return}var t={};for(var n=0,o=e.length;n<o;n++){var i=e[n];var a=parseInt(i[0],10);var l=parseInt(i[1],10);if(!t[a]){t[a]={}}t[a][l]=[i[2],i[3]]}s(t,function(e,t){t=parseInt(t,10);if(r.chartPlugin.getRangeBarCoordinates(t)){r.chartPlugin.removeRangeBarByColumn(t,r.chartPlugin.rangeList[t][1])}r.updateFromSource(t)})})},onAfterSourceLoadData:function S(e){var t=this;this.asyncCall(function(e){t.chartPlugin.removeAllRangeBars();t.updateFromSource()})},onAfterColumnSort:function O(e,t){var r=this;this.asyncCall(function(){r.chartPlugin.removeAllRangeBars();r.updateFromSource()})}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,dateCalculator:207}],210:[function(e,t,r){"use strict";Object.defineProperties(r,{HeaderTooltips:{get:function h(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js"),n&&n.__esModule&&n||{"default":n}).outerWidth;var l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),o&&o.__esModule&&o||{"default":o}).registerPlugin;var u=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),
i&&i.__esModule&&i||{"default":i}).rangeEach;var d=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),a&&a.__esModule&&a||{"default":a}).default;var f=function m(e){$traceurRuntime.superConstructor(c).call(this,e);this.settings=null};var c=f;$traceurRuntime.createClass(f,{isEnabled:function p(){return!!this.hot.getSettings().headerTooltips},enablePlugin:function v(){var e=this;if(this.enabled){return}this.settings=this.hot.getSettings().headerTooltips;this.parseSettings();this.addHook("afterGetColHeader",function(t,r){return e.onAfterGetHeader(t,r)});this.addHook("afterGetRowHeader",function(t,r){return e.onAfterGetHeader(t,r)});$traceurRuntime.superGet(this,c.prototype,"enablePlugin").call(this)},disablePlugin:function g(){this.settings=null;this.clearTitleAttributes();$traceurRuntime.superGet(this,c.prototype,"disablePlugin").call(this)},parseSettings:function w(){if(typeof this.settings==="boolean"){this.settings={rows:true,columns:true,onlyTrimmed:false}}},clearTitleAttributes:function b(){var e=this.hot.view.wt.getSetting("columnHeaders").length;var t=this.hot.view.wt.wtTable.THEAD;var r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;var n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;u(0,e-1,function(e){var o=t.childNodes[e];var i=r.childNodes[e];var a=n?n.childNodes[e]:null;u(0,o.childNodes.length-1,function(e){o.childNodes[e].removeAttribute("title");if(i&&i.childNodes[e]){i.childNodes[e].removeAttribute("title")}if(n&&a&&a.childNodes[e]){a.childNodes[e].removeAttribute("title")}})},true)},onAfterGetHeader:function y(e,t){var r=t.querySelector("span");var n=t.parentNode.parentNode.nodeName==="THEAD";if(n&&this.settings.columns||!n&&this.settings.rows){if(this.settings.onlyTrimmed){if(s(r)>=s(t)&&s(r)!==0){t.setAttribute("title",r.textContent)}}else{t.setAttribute("title",r.textContent)}}},destroy:function C(){this.settings=null;$traceurRuntime.superGet(this,c.prototype,"destroy").call(this)}},{},d);l("headerTooltips",f)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63}],211:[function(e,t,r){"use strict";Object.defineProperties(r,{hideColumnItem:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;function i(e){return{key:"hidden_columns_hide",name:"Hide column",callback:function t(){var t=this.getSelectedRange(),r=t.from,n=t.to;var i=Math.min(r.col,n.col);var a=Math.max(r.col,n.col);o(i,a,function(t){return e.hideColumn(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function r(){return!this.selection.selectedHeader.cols}}}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],212:[function(e,t,r){"use strict";Object.defineProperties(r,{showColumnItem:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;function i(e){var t=[];var r=[];return{key:"hidden_columns_show",name:"Show column",callback:function n(){var n=this.getSelectedRange(),i=n.from,a=n.to;var s=Math.min(i.col,a.col);var l=Math.max(i.col,a.col);if(s===l){if(t.length===s){e.showColumns(t);t.length=0}if(r.length===this.countSourceCols()-(s+1)){e.showColumns(r);r.length=0}}else{o(s,l,function(t){return e.showColumn(t)})}this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function i(){if(!e.hiddenColumns.length||!this.selection.selectedHeader.cols){return true}t.length=0;r.length=0;var n=this.getSelectedRange(),i=n.from,a=n.to;var s=Math.min(i.col,a.col);var l=Math.max(i.col,a.col);var u=false;if(s===l){var d=this.countSourceCols();o(0,d,function(n){var o=t.length+r.length;if(o===e.hiddenColumns.length){return false}if(n<s&&e.isHidden(n)){t.push(n)}else if(e.isHidden(n)){r.push(n)}});d=d-1;if(t.length===s&&s>0||r.length===d-s&&s<d){u=true}}else{o(s,l,function(t){if(e.isHidden(t)){u=true;return false}})}return!u}}}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],213:[function(e,t,r){"use strict";Object.defineProperties(r,{HiddenColumns:{get:function S(){return E}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),h=c.addClass,m=c.removeClass;var p=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var v=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var g=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),s&&s.__esModule&&s||{"default":s}),w=g.registerPlugin,b=g.getPlugin;var y=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),l&&l.__esModule&&l||{"default":l}).SEPARATOR;var C=(u=e("contextMenuItem/hideColumn"),u&&u.__esModule&&u||{"default":u}).hideColumnItem;var _=(d=e("contextMenuItem/showColumn"),d&&d.__esModule&&d||{"default":d}).showColumnItem;var E=function O(e){$traceurRuntime.superConstructor(R).call(this,e);this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1};var R=E;$traceurRuntime.createClass(E,{isEnabled:function T(){return!!this.hot.getSettings().hiddenColumns},enablePlugin:function A(){var e=this;if(this.enabled){return}if(this.hot.hasColHeaders()){this.addHook("afterGetColHeader",function(t,r){return e.onAfterGetColHeader(t,r)})}else{this.addHook("afterRenderer",function(t,r,n){return e.onAfterGetColHeader(n,t)})}this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)});this.addHook("afterGetCellMeta",function(t,r,n){return e.onAfterGetCellMeta(t,r,n)});this.addHook("modifyColWidth",function(t,r){return e.onModifyColWidth(t,r)});this.addHook("beforeSetRangeStartOnly",function(t){return e.onBeforeSetRangeStart(t)});this.addHook("beforeSetRangeEnd",function(t){return e.onBeforeSetRangeEnd(t)});this.addHook("hiddenColumn",function(t){return e.isHidden(t)});this.addHook("beforeStretchingColumnWidth",function(t,r){return e.onBeforeStretchingColumnWidth(t,r)});this.addHook("afterCreateCol",function(t,r){return e.onAfterCreateCol(t,r)});this.addHook("afterRemoveCol",function(t,r){return e.onAfterRemoveCol(t,r)});if(this.hot.view){this.onAfterPluginsInitialized()}$traceurRuntime.superGet(this,R.prototype,"enablePlugin").call(this)},updatePlugin:function N(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,R.prototype,"updatePlugin").call(this)},disablePlugin:function D(){this.settings={};this.hiddenColumns=[];this.lastSelectedColumn=-1;this.hot.render();$traceurRuntime.superGet(this,R.prototype,"disablePlugin").call(this);this.resetCellsMeta()},showColumns:function k(e){var t=this;v(e,function(e){e=parseInt(e,10);e=t.getLogicalColumnIndex(e);if(t.isHidden(e,true)){t.hiddenColumns.splice(t.hiddenColumns.indexOf(e),1)}})},showColumn:function x(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.showColumns(e)},hideColumns:function I(e){var t=this;v(e,function(e){e=parseInt(e,10);e=t.getLogicalColumnIndex(e);if(!t.isHidden(e,true)){t.hiddenColumns.push(e)}})},hideColumn:function P(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.hideColumns(e)},isHidden:function L(e){var t=arguments[1]!==void 0?arguments[1]:false;if(!t){e=this.getLogicalColumnIndex(e)}return this.hiddenColumns.indexOf(e)>-1},resetCellsMeta:function H(){v(this.hot.getCellsMeta(),function(e){if(e){e.skipColumnOnPaste=false;if(e.baseRenderer!==null){e.renderer=e.baseRenderer;e.baseRenderer=null}}})},getLogicalColumnIndex:function V(e){return this.hot.runHooks("modifyCol",e)},onBeforeStretchingColumnWidth:function F(e,t){if(this.isHidden(t)){e=0}return e},onModifyColWidth:function B(e,t){if(this.isHidden(t)){return.1}else if(this.settings.indicators&&(this.isHidden(t+1)||this.isHidden(t-1))){return e+(this.hot.hasColHeaders()?15:0)}},onAfterGetCellMeta:function j(e,t,r){t=this.hot.runHooks("unmodifyCol",t);if(this.settings.copyPasteEnabled===false&&this.isHidden(t)){r.skipColumnOnPaste=true}if(this.isHidden(t)){if(r.renderer!==M){r.baseRenderer=r.renderer}r.renderer=M}else{if(r.baseRenderer!==null){r.renderer=r.baseRenderer;r.baseRenderer=null}}if(this.isHidden(r.visualCol-1)){var n=true;var o=r.visualCol-1;r.className=r.className||"";if(r.className.indexOf("afterHiddenColumn")===-1){r.className+=" afterHiddenColumn"}do{if(!this.isHidden(o)){n=false;break}o--}while(o>=0);if(n&&r.className.indexOf("firstVisibleColumn")===-1){r.className+=" firstVisibleColumn"}}else if(r.className){var i=r.className.split(" ");if(i.length){var a=i.indexOf("afterHiddenColumn");var s=i.indexOf("firstVisibleColumn");if(a>-1){i.splice(a,1)}if(s>-1){i.splice(s,1)}r.className=i.join(" ")}}},onModifyCopyableRange:function W(e){var t=this;var r=[];var n=function o(e,t,n,i){r.push({startRow:e,endRow:t,startCol:n,endCol:i})};v(e,function(e){var r=true;var o=0;p(e.startCol,e.endCol,function(i){if(t.isHidden(i)){if(!r){n(e.startRow,e.endRow,o,i-1)}r=true}else{if(r){o=i}if(i===e.endCol){n(e.startRow,e.endRow,o,i)}r=false}})});return r},onAfterGetColHeader:function $(e,t){if(this.isHidden(e)){return}var r=true;var n=e-1;do{if(!this.isHidden(n)){r=false;break}n--}while(n>=0);if(r){h(t,"firstVisibleColumn")}if(!this.settings.indicators){return}if(this.isHidden(e-1)){h(t,"afterHiddenColumn")}if(this.isHidden(e+1)&&e>-1){h(t,"beforeHiddenColumn")}},onBeforeSetRangeStart:function U(e){var t=this;if(e.col>0){return}e.col=0;var r=function n(e){var r=t.getLogicalColumnIndex(e);if(t.isHidden(r,true)){e=n(++e)}return e};e.col=r(e.col)},onBeforeSetRangeEnd:function G(e){var t=this;var r=this.hot.countCols();var n=function o(n){var i=t.getLogicalColumnIndex(n);if(t.isHidden(i,true)){if(t.lastSelectedColumn>n||e.col===r-1){if(n>0){n=o(--n)}else{p(0,t.lastSelectedColumn,function(e){if(!t.isHidden(e)){n=e;return false}})}}else{n=o(++n)}}return n};e.col=n(e.col);this.lastSelectedColumn=e.col},onAfterContextMenuDefaultOptions:function Y(e){e.items.push({name:y},C(this),_(this))},onAfterCreateCol:function z(e,t){var r=[];v(this.hiddenColumns,function(n){if(n>=e){n+=t}r.push(n)});this.hiddenColumns=r},onAfterRemoveCol:function K(e,t){var r=[];v(this.hiddenColumns,function(n){if(n>=e){n-=t}r.push(n)});this.hiddenColumns=r},onAfterPluginsInitialized:function q(){var e=this;var t=this.hot.getSettings().hiddenColumns;if((typeof t==="undefined"?"undefined":_typeof(t))==="object"){this.settings=t;if(t.copyPasteEnabled===void 0){t.copyPasteEnabled=true}if(Array.isArray(t.columns)){this.hideColumns(t.columns)}if(!t.copyPasteEnabled){this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)})}}},destroy:function X(){$traceurRuntime.superGet(this,R.prototype,"destroy").call(this)}},{},f);function M(e,t){t.textContent=""}w("hiddenColumns",E)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":76,"contextMenuItem/hideColumn":211,"contextMenuItem/showColumn":212}],214:[function(e,t,r){"use strict";Object.defineProperties(r,{hideRowItem:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;function i(e){return{key:"hidden_rows_hide",name:"Hide row",callback:function t(){var t=this.getSelectedRange(),r=t.from,n=t.to;var i=Math.min(r.row,n.row);var a=Math.max(r.row,n.row);o(i,a,function(t){return e.hideRow(t)});this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function r(){return!this.selection.selectedHeader.rows}}}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],215:[function(e,t,r){"use strict";Object.defineProperties(r,{showRowItem:{get:function a(){return i}},__esModule:{value:true}});var n;var o=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;function i(e){var t=[];var r=[];return{key:"hidden_rows_show",name:"Show row",callback:function n(){var n=this.getSelectedRange(),i=n.from,a=n.to;var s=Math.min(i.row,a.row);var l=Math.max(i.row,a.row);if(s===l){if(t.length===s){e.showRows(t);t.length=0}if(r.length===this.countSourceRows()-(s+1)){e.showRows(r);r.length=0}}else{o(s,l,function(t){return e.showRow(t)})}this.render();this.view.wt.wtOverlays.adjustElementsSize(true)},disabled:false,hidden:function i(){if(!e.hiddenRows.length||!this.selection.selectedHeader.rows){return true}t.length=0;r.length=0;var n=this.getSelectedRange(),i=n.from,a=n.to;var s=Math.min(i.row,a.row);var l=Math.max(i.row,a.row);var u=false;if(s===l){var d=this.countSourceRows();o(0,d,function(n){var o=t.length+r.length;if(o===e.hiddenRows.length){return false}if(n<s){if(e.isHidden(n)){t.push(n)}}else{if(e.isHidden(n)){r.push(n)}}});d=d-1;if(t.length===s&&s>0||r.length===d-s&&s<d){u=true}}else{o(s,l,function(t){if(e.isHidden(t)){u=true;return false}})}return!u}}}},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],216:[function(e,t,r){"use strict";Object.defineProperties(r,{HiddenRows:{get:function M(){return E}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var f=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),c=f.addClass,h=f.removeClass;var m=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var p=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{"default":a}),v=p.arrayEach,g=p.arrayFilter;var w=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),s&&s.__esModule&&s||{"default":s}),b=w.registerPlugin,y=w.getPlugin;var C=(l=e("contextMenuItem/hideRow"),l&&l.__esModule&&l||{"default":l}).hideRowItem;var _=(u=e("contextMenuItem/showRow"),u&&u.__esModule&&u||{"default":u}).showRowItem;var E=function S(e){$traceurRuntime.superConstructor(R).call(this,e);this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1};var R=E;$traceurRuntime.createClass(E,{isEnabled:function O(){return!!this.hot.getSettings().hiddenRows},enablePlugin:function T(){var e=this;if(this.enabled){return}if(this.hot.hasRowHeaders()){this.addHook("afterGetRowHeader",function(t,r){return e.onAfterGetRowHeader(t,r)})}else{this.addHook("afterRenderer",function(t,r){return e.onAfterGetRowHeader(r,t)})}this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)});this.addHook("afterGetCellMeta",function(t,r,n){return e.onAfterGetCellMeta(t,r,n)});this.addHook("modifyRowHeight",function(t,r){return e.onModifyRowHeight(t,r)});this.addHook("beforeSetRangeStartOnly",function(t){return e.onBeforeSetRangeStartOnly(t)});this.addHook("beforeSetRangeStart",function(t){return e.onBeforeSetRangeStart(t)});this.addHook("beforeSetRangeEnd",function(t){return e.onBeforeSetRangeEnd(t)});this.addHook("hiddenRow",function(t){return e.isHidden(t)});this.addHook("afterCreateRow",function(t,r){return e.onAfterCreateRow(t,r)});this.addHook("afterRemoveRow",function(t,r){return e.onAfterRemoveRow(t,r)});if(this.hot.view){this.onAfterPluginsInitialized()}$traceurRuntime.superGet(this,R.prototype,"enablePlugin").call(this)},updatePlugin:function A(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();$traceurRuntime.superGet(this,R.prototype,"updatePlugin").call(this)},disablePlugin:function N(){this.settings={};this.hiddenRows=[];this.lastSelectedRow=-1;$traceurRuntime.superGet(this,R.prototype,"disablePlugin").call(this);this.resetCellsMeta()},showRows:function D(e){var t=this;v(e,function(e){e=parseInt(e,10);e=t.getLogicalRowIndex(e);if(t.isHidden(e,true)){t.hiddenRows.splice(t.hiddenRows.indexOf(e),1)}})},showRow:function k(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.showRows(e)},hideRows:function x(e){var t=this;v(e,function(e){e=parseInt(e,10);e=t.getLogicalRowIndex(e);if(!t.isHidden(e,true)){t.hiddenRows.push(e)}})},hideRow:function I(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.hideRows(e)},isHidden:function P(e){var t=arguments[1]!==void 0?arguments[1]:false;if(!t){e=this.getLogicalRowIndex(e)}return this.hiddenRows.indexOf(e)>-1},resetCellsMeta:function L(){v(this.hot.getCellsMeta(),function(e){if(e){e.skipRowOnPaste=false}})},getLogicalRowIndex:function H(e){return this.hot.runHooks("modifyRow",e)},onAfterGetCellMeta:function V(e,t,r){e=this.hot.runHooks("unmodifyRow",e);if(this.settings.copyPasteEnabled===false&&this.isHidden(e)){r.skipRowOnPaste=true}else{r.skipRowOnPaste=false}if(this.isHidden(e-1)){var n=true;var o=e-1;r.className=r.className||"";if(r.className.indexOf("afterHiddenRow")===-1){r.className+=" afterHiddenRow"}do{if(!this.isHidden(o)){n=false;break}o--}while(o>=0);if(n&&r.className.indexOf("firstVisibleRow")===-1){r.className+=" firstVisibleRow"}}else if(r.className){var i=r.className.split(" ");if(i.length){var a=i.indexOf("afterHiddenRow");var s=i.indexOf("firstVisibleRow");if(a>-1){i.splice(a,1)}if(s>-1){i.splice(s,1)}r.className=i.join(" ")}}},onAfterGetRowHeader:function F(e,t){var r=t.parentNode;if(r){if(this.isHidden(e)){c(r,"hide")}else{h(r,"hide")}}var n=true;var o=e-1;do{if(!this.isHidden(o)){n=false;break}o--}while(o>=0);if(n){c(t,"firstVisibleRow")}if(this.settings.indicators&&this.hot.hasRowHeaders()){if(this.isHidden(e-1)){c(t,"afterHiddenRow")}if(this.isHidden(e+1)){c(t,"beforeHiddenRow")}}},onModifyRowHeight:function B(e,t){if(this.isHidden(t)){return.1}return e},onModifyCopyableRange:function j(e){var t=this;var r=[];var n=function o(e,t,n,i){r.push({startRow:e,endRow:t,startCol:n,endCol:i})};v(e,function(e){var r=true;var o=0;m(e.startRow,e.endRow,function(i){if(t.isHidden(i)){if(!r){n(o,i-1,e.startCol,e.endCol)}r=true}else{if(r){o=i}if(i===e.endRow){n(o,i,e.startCol,e.endCol)}r=false}})});return r},onBeforeSetRangeStart:function W(e){var t=this;var r=this.hot.getSelected()||false;var n=this.hot.countRows()-1;var o=function i(e){var o=0;if(r){o=e>r[0]?1:-1;t.lastSelectedRow=r[0]}if(n<e||e<0){return t.lastSelectedRow}if(t.isHidden(e)){e=i(e+o)}return e};e.row=o(e.row)},onBeforeSetRangeStartOnly:function $(e){var t=this;if(e.row>0){return}e.row=0;var r=function n(e){if(t.isHidden(e)){e=n(++e)}return e};e.row=r(e.row)},onBeforeSetRangeEnd:function U(e){var t=this;var r=this.hot.countRows();var n=function o(n){if(t.isHidden(n)){if(t.lastSelectedRow>n||e.row===r-1){if(n>0){n=o(--n)}else{m(0,t.lastSelectedRow,function(e){if(!t.isHidden(e)){n=e;return false}})}}else{n=o(++n)}}return n};e.row=n(e.row);this.lastSelectedRow=e.row},onAfterContextMenuDefaultOptions:function G(e){e.items.push(Handsontable.plugins.ContextMenu.SEPARATOR,C(this),_(this))},onAfterCreateRow:function Y(e,t){var r=[];v(this.hiddenRows,function(n){if(n>=e){n+=t}r.push(n)});this.hiddenRows=r},onAfterRemoveRow:function z(e,t){var r=[];v(this.hiddenRows,function(n){if(n>=e){n-=t}r.push(n)});this.hiddenRows=r},onAfterPluginsInitialized:function K(){var e=this;var t=this.hot.getSettings().hiddenRows;if((typeof t==="undefined"?"undefined":_typeof(t))==="object"){this.settings=t;if(t.copyPasteEnabled===void 0){t.copyPasteEnabled=true}if(Array.isArray(t.rows)){this.hideRows(t.rows)}if(!t.copyPasteEnabled){this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)})}}},destroy:function q(){$traceurRuntime.superGet(this,R.prototype,"destroy").call(this)}},{},d);b("hiddenRows",E)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"contextMenuItem/hideRow":214,"contextMenuItem/showRow":215}],217:[function(e,t,r){"use strict";Object.defineProperties(r,{NestedHeaders:{get:function S(){return R}},__esModule:{value:true}});var n,o,i,a,s,l,u;var d=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),n&&n.__esModule&&n||{"default":n}),f=d.addClass,c=d.removeClass,h=d.hasClass,m=d.fastInnerHTML,p=d.empty;var v=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach;var g=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var w=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),a&&a.__esModule&&a||{"default":a}).objectEach;var b=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),s&&s.__esModule&&s||{"default":s}),y=b.registerPlugin,C=b.getPlugin;var _=(l=e("utils/ghostTable"),l&&l.__esModule&&l||{"default":l}).GhostTable;var E=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),u&&u.__esModule&&u||{"default":u}).default;var R=function O(e){$traceurRuntime.superConstructor(M).call(this,e);this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable=new _(this)};var M=R;$traceurRuntime.createClass(R,{isEnabled:function T(){return!!this.hot.getSettings().nestedHeaders},enablePlugin:function A(){var e=this;if(this.enabled){return}this.settings=this.hot.getSettings().nestedHeaders;this.addHook("afterGetColumnHeaderRenderers",function(t){return e.onAfterGetColumnHeaderRenderers(t)});this.addHook("afterInit",function(){return e.onAfterInit()});this.addHook("afterOnCellMouseDown",function(t,r,n){return e.onAfterOnCellMouseDown(t,r,n)});this.addHook("beforeOnCellMouseOver",function(t,r,n,o){return e.onBeforeOnCellMouseOver(t,r,n,o)});this.addHook("afterViewportColumnCalculatorOverride",function(t){return e.onAfterViewportColumnCalculatorOverride(t)});this.addHook("modifyColWidth",function(t,r){return e.onModifyColWidth(t,r)});this.setupColspanArray();this.checkForFixedColumnsCollision();this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0;$traceurRuntime.superGet(this,M.prototype,"enablePlugin").call(this)},disablePlugin:function N(){this.clearColspans();this.settings=[];this.columnHeaderLevelCount=0;this.colspanArray=[];this.ghostTable.clear();$traceurRuntime.superGet(this,M.prototype,"disablePlugin").call(this)},updatePlugin:function D(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,M.prototype,"updatePlugin").call(this);this.ghostTable.buildWidthsMapper()},clearColspans:function k(){if(!this.hot.view){return}var e=this.hot.view.wt.getSetting("columnHeaders").length;var t=this.hot.view.wt.wtTable.THEAD;var r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;var n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;for(var o=0;o<e;o++){var i=t.childNodes[o];if(!i){break}var a=r.childNodes[o];var s=n?n.childNodes[o]:null;for(var l=0,u=i.childNodes.length;l<u;l++){i.childNodes[l].removeAttribute("colspan");if(a&&a.childNodes[l]){a.childNodes[l].removeAttribute("colspan")}if(n&&s&&s.childNodes[l]){s.childNodes[l].removeAttribute("colspan")}}}},checkForFixedColumnsCollision:function x(){var e=this;var t=this.hot.getSettings().fixedColumnsLeft;g(this.colspanArray,function(r,n){if(e.getNestedParent(n,t)!==t){console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. "+"To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")}})},checkForOverlappingHeaders:function I(){var e=this;g(this.colspanArray,function(t,r){g(e.colspanArray[r],function(t,n){if(t.colspan>1){var o=e.levelToRowCoords(r);var i=e.getChildHeaders(o,n);if(i.length>0){var a=0;g(i,function(t,r){a+=e.getColspan(o+1,t)});if(a>t.colspan){console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is "+"currently not supported and might result in glitches.")}return false}}})})},setupColspanArray:function P(){var e=this;function t(e,t){if(!e[t]){e[t]=[]}}w(this.settings,function(r,n){w(r,function(r,o,i){t(e.colspanArray,n);if(i[o].colspan===void 0){e.colspanArray[n].push({label:i[o]||"",colspan:1,hidden:false})}else{var a=i[o].colspan||1;e.colspanArray[n].push({label:i[o].label||"",colspan:a,hidden:false});e.fillColspanArrayWithDummies(a,n)}})})},fillColspanArrayWithDummies:function L(e,t){var r=this;v(0,e-2,function(e){r.colspanArray[t].push({label:"",colspan:1,hidden:true})})},headerRendererFactory:function H(e){var t=this;return function(r,n){n.removeAttribute("colspan");c(n,"hiddenHeader");if(t.colspanArray[e][r]&&t.colspanArray[e][r].colspan){var o=t.colspanArray[e][r].colspan;var i=t.hot.getSettings().fixedColumnsLeft||0;var a=t.hot.view.wt.wtOverlays.topLeftCornerOverlay;var s=t.hot.view.wt.wtOverlays.leftOverlay;var l=a?a.clone.wtTable.THEAD.contains(n):false;var u=s?s.clone.wtTable.THEAD.contains(n):false;if(o>1){n.setAttribute("colspan",l||u?Math.min(o,i-r):o)}if(l||u&&r===i-1){f(n,"overlayEdge")}}if(t.colspanArray[e][r]&&t.colspanArray[e][r].hidden){f(n,"hiddenHeader")}p(n);var d=document.createElement("DIV");f(d,"relative");var h=document.createElement("SPAN");f(h,"colHeader");m(h,t.colspanArray[e][r]?t.colspanArray[e][r].label||"":"");d.appendChild(h);n.appendChild(d);t.hot.runHooks("afterGetColHeader",r,n)}},getColspan:function V(e,t){var r=this.colspanArray[this.rowCoordsToLevel(e)][t];return r?r.colspan:1},levelToRowCoords:function F(e){return e-this.columnHeaderLevelCount},rowCoordsToLevel:function B(e){return e+this.columnHeaderLevelCount},getNestedParent:function j(e,t){if(e<0){return false}var r=this.colspanArray[e][t]?this.colspanArray[e][t].colspan:1;var n=this.colspanArray[e][t]?this.colspanArray[e][t].hidden:false;if(r>1||r===1&&n===false){return t}else{var o=t-1;do{if(this.colspanArray[e][o].colspan>1){break}o--}while(t>=0);return o}},getChildHeaders:function W(e,t){var r=this.rowCoordsToLevel(e);var n=this.colspanArray[r+1];var o=this.getNestedParent(r,t);var i=this.colspanArray[r][t].colspan;var a=[];if(!n){return a}v(o,o+i-1,function(e){if(n[e]&&n[e].colspan>1){i-=n[e].colspan-1}if(n[e]&&!n[e].hidden&&a.indexOf(e)===-1){a.push(e)}});return a},fillTheRemainingColspans:function $(){var e=this;w(this.settings,function(t,r){v(e.colspanArray[r].length-1,e.hot.countCols()-1,function(n){e.colspanArray[r].push({label:t[n]||"",colspan:1,hidden:false})},true)})},updateHeadersHighlight:function U(){var e=this;var t=this.hot.getSelected();if(t===void 0){return}var r="ht__highlight";var n=this.hot.view.wt.wtOverlays;var o=this.hot.selection.selectedHeader.cols;var i=Math.min(t[1],t[3]);var a=Math.max(t[1],t[3]);var s=o?-1:this.columnHeaderLevelCount-1;v(i,a,function(t){var l=function d(l){var u=e.getNestedParent(l,t);var d=n.topOverlay?n.topOverlay.clone.wtTable.getColumnHeader(u,l):void 0;var m=n.topLeftCornerOverlay?n.topLeftCornerOverlay.clone.wtTable.getColumnHeader(u,l):void 0;var p=[d,m];var v=e.getColspan(l-e.columnHeaderLevelCount,u);var w=u>=i&&u+v-1<=a;g(p,function(e,t,n){if(e===void 0){return false}if(!o&&l<s||o&&!w){if(h(e,r)){c(e,r)}}else if(!h(e,r)){f(e,r)}})};for(var u=e.columnHeaderLevelCount-1;u>-1;u--){l(u)}})},onAfterViewportColumnCalculatorOverride:function G(e){var t=this;var r=e.startColumn;v(0,Math.max(this.columnHeaderLevelCount-1,0),function(n){var o=t.getNestedParent(n,e.startColumn);if(o<e.startColumn){var i=Math.min(r,o);r=i}});e.startColumn=r},onAfterOnCellMouseDown:function Y(e,t,r){if(t.row<0){var n=this.getColspan(t.row,t.col);var o=t.col+n-1;if(n>1){var i=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new WalkontableCellCoords(i,o))}}},onBeforeOnCellMouseOver:function z(e,t,r,n){var o;if(t.row<0&&t.col>=0&&this.hot.view.isMouseDown()){var i=this.hot.getSelectedRange(),a=i.from,s=i.to;var l=this.getColspan(t.row,t.col);var u=t.col+l-1;var d=false;if(a.col<=s.col){if(t.col<a.col&&u===s.col||t.col<a.col&&u<a.col||t.col<a.col&&u>=a.col&&u<s.col){d=true}}else{if(t.col<s.col&&u>a.col||t.col>a.col||t.col<=s.col&&u>a.col||t.col>s.col&&u>a.col){d=true}}if(d){o=[s.col,a.col],a.col=o[0],s.col=o[1],o}if(l>1){n.column=true;n.cell=true;this.hot.selection.setSelectedHeaders(false,true);if(a.col===s.col){if(u<=a.col&&t.col<a.col){this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,s.col));this.hot.selection.setRangeEnd(new WalkontableCellCoords(s.row,t.col))}else{this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,t.col<a.col?t.col:a.col));this.hot.selection.setRangeEnd(new WalkontableCellCoords(s.row,u>s.col?u:s.col))}}if(a.col<s.col){this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,t.col<a.col?t.col:a.col));this.hot.selection.setRangeEnd(new WalkontableCellCoords(s.row,u))}if(a.col>s.col){this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(a.row,a.col));this.hot.selection.setRangeEnd(new WalkontableCellCoords(s.row,t.col))}}}},onAfterInit:function K(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length;this.fillTheRemainingColspans();this.checkForOverlappingHeaders();this.ghostTable.buildWidthsMapper()},onAfterGetColumnHeaderRenderers:function q(e){if(e){e.length=0;for(var t=this.colspanArray.length,r=t-1;r>=0;r--){e.push(this.headerRendererFactory(r))}e.reverse()}this.updateHeadersHighlight()},onModifyColWidth:function X(e,t){var r=this.ghostTable.widthsCache[t];return e>r?e:r},destroy:function J(){this.settings=null;this.columnHeaderLevelCount=null;this.colspanArray=null;$traceurRuntime.superGet(this,M.prototype,"destroy").call(this)}},{},E);y("nestedHeaders",R)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"utils/ghostTable":218}],218:[function(e,t,r){"use strict";Object.defineProperties(r,{GhostTable:{get:function l(){return s}},__esModule:{value:true}});var n,o;var i=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),
n&&n.__esModule&&n||{"default":n}).fastInnerHTML;var a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}).clone;var s=function u(e){this.nestedHeaders=e;this.container=void 0;this.widthsCache=[]};$traceurRuntime.createClass(s,{buildWidthsMapper:function d(){this.container=document.createElement("div");this.buildGhostTable(this.container);this.nestedHeaders.hot.rootElement.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th");var t=e.length;for(var r=0;r<t;r++){this.widthsCache.push(e[r].offsetWidth)}this.container.parentNode.removeChild(this.container);this.container=null;this.nestedHeaders.hot.render()},buildGhostTable:function f(e){var t=document;var r=t.createDocumentFragment();var n=t.createElement("table");var o=false;var s=!!this.nestedHeaders.hot.getSettings().dropdownMenu;var l=this.nestedHeaders.colspanArray.length;var u=this.nestedHeaders.hot.countCols();var d=l-1;for(var f=0;f<l;f++){var c=t.createElement("tr");o=false;for(var h=0;h<u;h++){var m=t.createElement("th");var p=a(this.nestedHeaders.colspanArray[f][h]);if(p&&!p.hidden){if(f===d){if(p.colspan>1){o=true}if(s){p.label+='<button class="changeType"></button>'}}i(m,p.label);m.colSpan=p.colspan;c.appendChild(m)}}n.appendChild(c)}if(o){{var v=t.createElement("tr");for(var g=0;g<u;g++){var w=t.createElement("th");v.appendChild(w)}n.appendChild(v)}}r.appendChild(n);e.appendChild(r)},clear:function c(){this.container=null;this.widthsCache.length=0}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],219:[function(e,t,r){"use strict";Object.defineProperties(r,{DataManager:{get:function m(){return h}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),n&&n.__esModule&&n||{"default":n}).rangeEach;var l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{"default":o}),u=l.objectEach,d=l.extend;var f=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var c=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),a&&a.__esModule&&a||{"default":a}).getTranslator;var h=function p(e,t,r){this.hot=t;this.data=r;this.plugin=e;this.parentReference=new WeakMap;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};this.recordTranslator=c(this.hot)};$traceurRuntime.createClass(h,{rewriteCache:function v(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap};s(0,this.data.length-1,function(t){e.cacheNode(e.data[t],0,null)})},cacheNode:function g(e,t,r){var n=this;if(!this.cache.levels[t]){this.cache.levels[t]=[];this.cache.levelCount++}this.cache.levels[t].push(e);this.cache.rows.push(e);this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t});if(this.hasChildren(e)){f(e.__children,function(r,o){n.cacheNode(r,t+1,e)})}},getDataObject:function w(e){return e==null?null:this.cache.rows[e]},readTreeNodes:function b(e,t,r,n){var o=this;var i=false;if(isNaN(t)&&t.end){return t}if(!e){e={__children:this.data};i=true;t--}if(r!=null&&t===r){return{result:e,end:true}}if(n!=null&&e===n){return{result:t,end:true}}t++;if(e.__children){f(e.__children,function(a,s){o.parentReference.set(a,i?null:e);t=o.readTreeNodes(a,t,r,n);if(isNaN(t)&&t.end){return false}})}return t},updateParentReference:function y(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())},mockParent:function C(){var e=this.mockNode();e.__children=this.data;return e},mockNode:function _(){var e={};u(this.data[0],function(t,r){e[r]=null});return e},getRowIndex:function E(e){return e==null?null:this.cache.nodeInfo.get(e).row},getRowIndexWithinParent:function R(e){var t=null;if(isNaN(e)){t=e}else{t=this.getDataObject(e)}var r=this.getRowParent(e);if(r==null){return this.data.indexOf(t)}else{return r.__children.indexOf(t)}},countAllRows:function M(){var e={__children:this.data};return this.countChildren(e)},countChildren:function S(e){var t=this;var r=0;if(!isNaN(e)){e=this.getDataObject(e)}if(!e||!e.__children){return 0}f(e.__children,function(e,n){r++;if(e.__children){r+=t.countChildren(e)}});return r},getRowParent:function O(e){var t;if(isNaN(e)){t=e}else{t=this.getDataObject(e)}return this.getRowObjectParent(t)},getRowObjectParent:function T(e){if((typeof e==="undefined"?"undefined":_typeof(e))!=="object"){return null}return this.cache.nodeInfo.get(e).parent},getRowLevel:function A(e){var t=null;if(isNaN(e)){t=e}else{t=this.getDataObject(e)}return t?this.getRowObjectLevel(t):null},getRowObjectLevel:function N(e){return e==null?null:this.cache.nodeInfo.get(e).level},hasChildren:function D(e){if(!isNaN(e)){e=this.getDataObject(e)}return!!(e.__children&&e.__children.length)},isParent:function k(e){if(!isNaN(e)){e=this.getDataObject(e)}return!!e.hasOwnProperty("__children")},addChild:function x(e,t){this.hot.runHooks("beforeAddChild",e,t);var r=null;if(e){r=this.getRowIndex(e)}this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);var n=e;if(!e){n=this.mockParent()}if(!n.__children){n.__children=[]}if(!t){t=this.mockNode()}n.__children.push(t);this.rewriteCache();var o=this.getRowIndex(t);this.hot.runHooks("afterCreateRow",o,1);this.hot.runHooks("afterAddChild",e,t)},addChildAtIndex:function I(e,t,r,n){this.hot.runHooks("beforeAddChild",e,r,t);this.hot.runHooks("beforeCreateRow",n+1,1);var o=e;if(!e){o=this.mockParent()}if(!o.__children){o.__children=[]}if(!r){r=this.mockNode()}o.__children.splice(t,null,r);this.rewriteCache();this.hot.runHooks("afterCreateRow",n+1,1);this.hot.runHooks("afterAddChild",e,r,t)},addSibling:function P(e){var t=arguments[1]!==void 0?arguments[1]:"below";var r=this.translateTrimmedRow(e);var n=this.getRowParent(r);var o=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(n,o+1,null,e);break;case"above":this.addChildAtIndex(n,o,null,e);break}},detachFromParent:function L(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=this;var n=null;var o=[];if(Array.isArray(e)){s(e[0],e[2],function(e){var t=r.translateTrimmedRow(e);o.push(r.getDataObject(t))});s(0,o.length-2,function(e){r.detachFromParent(o[e],false)});n=o[o.length-1]}else{n=e}var i=this.getRowIndex(n);var a=this.getRowIndexWithinParent(n);var l=this.getRowParent(n);var u=this.getRowParent(l);var d=this.getRowIndex(u);var f=null;this.hot.runHooks("beforeDetachChild",l,n);if(a!=null){this.hot.runHooks("beforeRemoveRow",i,1,[i],this.plugin.pluginName);l.__children.splice(a,1);this.rewriteCache();this.hot.runHooks("afterRemoveRow",i,1,[i],this.plugin.pluginName);if(u){f=d+this.countChildren(u);this.hot.runHooks("beforeCreateRow",f,1,this.plugin.pluginName);u.__children.push(n)}else{f=this.hot.countRows()+1;this.hot.runHooks("beforeCreateRow",f,1,this.plugin.pluginName);this.data.push(n)}}this.rewriteCache();this.hot.runHooks("afterCreateRow",f,1,this.plugin.pluginName);if(t){this.hot.render()}this.hot.runHooks("afterDetachChild",l,n)},filterData:function H(e,t,r){var n=this;var o=[];f(r,function(e,t){o.push(n.getDataObject(e))});f(o,function(e,t){var r=n.getRowIndexWithinParent(e);var o=n.getRowParent(e);if(o===null){n.data.splice(r,1)}else{o.__children.splice(r,1)}});this.rewriteCache()},spliceData:function V(e,t,r){e=this.translateTrimmedRow(e);if(e==null){return}var n=this.getDataObject(e-1);var o=null;var i=null;if(n&&n.__children&&n.__children.length===0){o=n;i=0}else{o=this.getRowParent(e);i=this.getRowIndexWithinParent(e)}if(o){if(r){o.__children.splice(i,t,r)}else{o.__children.splice(i,t)}}else{if(r){this.data.splice(i,t,r)}else{this.data.splice(i,t)}}this.rewriteCache()},moveRow:function F(e,t){var r=this.isParent(t);var n=this.getRowParent(e);var o=this.getRowIndexWithinParent(e);var i=this.getRowParent(t);if(i==null){i=this.getRowParent(t-1)}if(i==null){i=this.getDataObject(t-1)}if(!i){i=this.getDataObject(t);i.__children=[]}else if(!i.__children){i.__children=[]}var a=this.getRowParent(t-1);var s=r?this.countChildren(a):this.getRowIndexWithinParent(t);var l=n.__children.slice(o,o+1);n.__children.splice(o,1);i.__children.splice(s,0,l[0])},moveCellMeta:function B(e,t){var r=this.hot.getCellMetaAtRow(e);this.hot.spliceCellsMeta(t,0,r);this.hot.spliceCellsMeta(e+(e<t?0:1),1)},translateTrimmedRow:function j(e){if(this.plugin.collapsingUI){return this.plugin.collapsingUI.translateTrimmedRow(e)}else{return e}}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":132}],220:[function(e,t,r){"use strict";Object.defineProperties(r,{NestedRows:{get:function R(){return _}},__esModule:{value:true}});var n,o,i,a,s,l,u,d;var f=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin;var h=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}),m=h.rangeEach,p=h.rangeEachReverse;var v=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{"default":a}).arrayEach;var g=(s=e("data/dataManager"),s&&s.__esModule&&s||{"default":s}).DataManager;var w=(l=e("ui/collapsing"),l&&l.__esModule&&l||{"default":l}).CollapsingUI;var b=(u=e("ui/headers"),u&&u.__esModule&&u||{"default":u}).HeadersUI;var y=(d=e("ui/contextMenu"),d&&d.__esModule&&d||{"default":d}).ContextMenuUI;var C=new WeakMap;var _=function M(e){C.set(this,{changeSelection:false,movedToFirstChild:false,movedToCollapsed:false,skipRender:null});this.sourceData=null;this.trimRowsPlugin=null;this.bindRowsWithHeadersPlugin=null;this.dataManager=null;this.headersUI=null;$traceurRuntime.superConstructor(E).call(this,e)};var E=_;$traceurRuntime.createClass(_,{isEnabled:function S(){return!!this.hot.getSettings().nestedRows},enablePlugin:function O(){var e=this;this.sourceData=this.hot.getSourceData();this.trimRowsPlugin=this.hot.getPlugin("trimRows");this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove");this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders");this.dataManager=new g(this,this.hot,this.sourceData);this.collapsingUI=new w(this,this.hot,this.trimRowsPlugin);this.headersUI=new b(this,this.hot);this.contextMenuUI=new y(this,this.hot);this.dataManager.rewriteCache();this.addHook("afterInit",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterInit.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeRender",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeRender.apply(t,$traceurRuntime.spread(r))});this.addHook("modifyRowData",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onModifyRowData.apply(t,$traceurRuntime.spread(r))});this.addHook("modifySourceLength",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onModifySourceLength.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeDataSplice",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeDataSplice.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeDataFilter",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeDataFilter.apply(t,$traceurRuntime.spread(r))});this.addHook("afterContextMenuDefaultOptions",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterContextMenuDefaultOptions.apply(t,$traceurRuntime.spread(r))});this.addHook("afterGetRowHeader",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterGetRowHeader.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeOnCellMouseDown",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeOnCellMouseDown.apply(t,$traceurRuntime.spread(r))});this.addHook("afterRemoveRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterRemoveRow.apply(t,$traceurRuntime.spread(r))});this.addHook("modifyRemovedAmount",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onModifyRemovedAmount.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeAddChild",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeAddChild.apply(t,$traceurRuntime.spread(r))});this.addHook("afterAddChild",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterAddChild.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeDetachChild",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeDetachChild.apply(t,$traceurRuntime.spread(r))});this.addHook("afterDetachChild",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterDetachChild.apply(t,$traceurRuntime.spread(r))});this.addHook("modifyRowHeaderWidth",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onModifyRowHeaderWidth.apply(t,$traceurRuntime.spread(r))});this.addHook("afterCreateRow",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterCreateRow.apply(t,$traceurRuntime.spread(r))});this.addHook("beforeRowMove",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onBeforeRowMove.apply(t,$traceurRuntime.spread(r))});this.addHook("afterRowMove",function(){var t;for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n]}return(t=e).onAfterRowMove.apply(t,$traceurRuntime.spread(r))});if(!this.trimRowsPlugin.isEnabled()){this.trimRowsPlugin.enablePlugin();this.hot.getSettings().trimRows=true}$traceurRuntime.superGet(this,E.prototype,"enablePlugin").call(this)},disablePlugin:function T(){$traceurRuntime.superGet(this,E.prototype,"disablePlugin").call(this)},updatePlugin:function A(){this.disablePlugin();this.enablePlugin();$traceurRuntime.superGet(this,E.prototype,"updatePlugin").call(this)},onBeforeRowMove:function N(e,t){var r;var n=C.get(this);var o=e.length;var i=[];var a=this.dataManager.translateTrimmedRow(t);var s=true;var l;var u=null;var d=null;var f=null;for(l=0;l<o;l++){i.push(this.dataManager.translateTrimmedRow(e[l]));if(this.dataManager.isParent(i[l])){s=false}}if(i.indexOf(a)>-1||!s){return false}u=this.dataManager.getRowParent(i[0]);d=this.dataManager.getRowParent(a);if(d==null){d=this.dataManager.getRowParent(a-1)}if(d==null){d=this.dataManager.getDataObject(a-1);n.movedToFirstChild=true}if(!d){return false}f=u===d;n.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d);this.collapsingUI.collapsedRowsStash.stash();if(!f){if((r=Math).max.apply(r,$traceurRuntime.spread(i))<=a){this.collapsingUI.collapsedRowsStash.shiftStash(i[0],-1*e.length)}else{this.collapsingUI.collapsedRowsStash.shiftStash(a,e.length)}}n.changeSelection=true;if(i[o-1]<=a&&f||n.movedToFirstChild===true){e.reverse();i.reverse();if(n.movedToFirstChild!==true){a--}}for(l=0;l<o;l++){this.dataManager.moveRow(i[l],a)}var c=i[i.length-1]<a;if(c){for(l=o-1;l>=0;l--){this.dataManager.moveCellMeta(i[l],a)}}else{for(l=0;l<o;l++){this.dataManager.moveCellMeta(i[l],a)}}if(i[o-1]<=a&&f||this.dataManager.isParent(a)){e.reverse()}this.dataManager.rewriteCache();return false},onAfterRowMove:function D(e,t){var r;var n=C.get(this);if(!n.changeSelection){return}var o=e.length;var i=0;var a=0;var s=null;var l=null;var u=null;this.collapsingUI.collapsedRowsStash.applyStash();s=this.dataManager.translateTrimmedRow(t);if(n.movedToFirstChild){n.movedToFirstChild=false;i=t;a=t+o-1;if(t>=(r=Math).max.apply(r,$traceurRuntime.spread(e))){i-=o;a-=o}}else if(n.movedToCollapsed){var d=this.dataManager.getRowParent(s-1);if(d==null){d=this.dataManager.getDataObject(s-1)}var f=this.dataManager.getRowIndex(d);i=f;a=i}else{if(e[o-1]<t){a=t-1;i=a-o+1}else{i=t;a=i+o-1}}l=this.hot.selection;u=this.hot.countCols()-1;l.setRangeStart(new WalkontableCellCoords(i,0));l.setRangeEnd(new WalkontableCellCoords(a,u),true);n.changeSelection=false},onBeforeOnCellMouseDown:function k(e,t,r){this.collapsingUI.toggleState(e,t,r)},onModifyRowData:function x(e){return this.dataManager.getDataObject(e)},onModifySourceLength:function I(){return this.dataManager.countAllRows()},onBeforeDataSplice:function P(e,t,r){this.dataManager.spliceData(e,t,r);return false},onBeforeDataFilter:function L(e,t,r){var n=[];var o=this.dataManager.translateTrimmedRow(e);var i=C.get(this);m(o,o+t-1,function(e){n.push(e)});this.collapsingUI.collapsedRowsStash.stash();this.collapsingUI.collapsedRowsStash.trimStash(o,t);this.collapsingUI.collapsedRowsStash.shiftStash(o,-1*t);this.dataManager.filterData(e,t,n);i.skipRender=true;return false},onAfterContextMenuDefaultOptions:function H(e){return this.contextMenuUI.appendOptions(e)},onAfterGetRowHeader:function V(e,t){this.headersUI.appendLevelIndicators(e,t)},onModifyRowHeaderWidth:function F(e){return this.headersUI.rowHeaderWidthCache||e},onAfterRemoveRow:function B(e,t,r,n){var o=this;if(n===this.pluginName){return}var i=C.get(this);setTimeout(function(){i.skipRender=null;o.headersUI.updateRowHeaderWidth();o.collapsingUI.collapsedRowsStash.applyStash()},0)},onModifyRemovedAmount:function j(e,t){var r=this;var n=[];var o=0;m(t,t+e-1,function(e){var t=false;var i=r.collapsingUI.translateTrimmedRow(e);var a=r.dataManager.getDataObject(i);if(r.dataManager.hasChildren(a)){n.push(a);v(n,function(e){if(e.__children.indexOf(a)>-1){t=true;return false}});if(!t){o+=r.dataManager.countChildren(a)}}t=false;v(n,function(e){if(e.__children.indexOf(a)>-1){t=true;return false}});if(t){o--}});return e+o},onBeforeAddChild:function W(e,t){this.collapsingUI.collapsedRowsStash.stash()},onAfterAddChild:function $(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()},onBeforeDetachChild:function U(e,t){this.collapsingUI.collapsedRowsStash.stash()},onAfterDetachChild:function G(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t));this.collapsingUI.collapsedRowsStash.applyStash();this.headersUI.updateRowHeaderWidth()},onAfterCreateRow:function Y(e,t,r){if(r===this.pluginName){return}this.dataManager.rewriteCache()},onAfterInit:function z(){var e;if(this.bindRowsWithHeadersPlugin.bindStrategy.strategy){this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows())}var t=(e=Math).max.apply(e,$traceurRuntime.spread(this.dataManager.cache.levels));if(t>0){this.headersUI.updateRowHeaderWidth(t)}},onBeforeRender:function K(e,t){var r=C.get(this);if(r.skipRender){t.skipRender=true}}},{},f);c("nestedRows",_)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"data/dataManager":219,"ui/collapsing":222,"ui/contextMenu":223,"ui/headers":224}],221:[function(e,t,r){"use strict";Object.defineProperties(r,{BaseUI:{get:function o(){return n}},__esModule:{value:true}});var n=function i(e,t){this.hot=t;this.plugin=e};$traceurRuntime.createClass(n,{},{})},{}],222:[function(e,t,r){"use strict";Object.defineProperties(r,{CollapsingUI:{get:function g(){return p}},__esModule:{value:true}});var n,o,i,a,s,l;var u=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var d=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),o&&o.__esModule&&o||{"default":o}).stopImmediatePropagation;var f=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var c=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),a&&a.__esModule&&a||{"default":a}).rangeEach;var h=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),s&&s.__esModule&&s||{"default":s}).hasClass;var m=(l=e("headers"),l&&l.__esModule&&l||{"default":l}).HeadersUI;var p=function w(e,t){var r=this;$traceurRuntime.superConstructor(v).call(this,e,t);this.trimRowsPlugin=e.trimRowsPlugin;this.dataManager=this.plugin.dataManager;this.collapsedRows=[];this.collapsedRowsStash={stash:function n(){r.lastCollapsedRows=r.collapsedRows.slice(0);r.expandMultipleChildren(r.lastCollapsedRows,false)},shiftStash:function o(e){var t=arguments[1]!==void 0?arguments[1]:1;e=r.translateTrimmedRow(e);f(r.lastCollapsedRows,function(n,o){if(n>e-1){r.lastCollapsedRows[o]=n+t}})},applyStash:function i(){r.hot.runHooks("skipLengthCache",100);r.collapseMultipleChildren(r.lastCollapsedRows,true);r.lastCollapsedRows=void 0},trimStash:function a(e,t){c(e,e+t-1,function(e){var t=r.lastCollapsedRows.indexOf(e);if(t>-1){r.lastCollapsedRows.splice(t,1)}})}}};var v=p;$traceurRuntime.createClass(p,{collapseChildren:function b(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=arguments[2]!==void 0?arguments[2]:true;var n=this;var o=[];var i=null;var a=null;var s=null;if(isNaN(e)){i=e;a=this.dataManager.getRowIndex(i)}else{i=this.dataManager.getDataObject(e);a=e}if(this.dataManager.hasChildren(i)){f(i.__children,function(e,t){o.push(n.dataManager.getRowIndex(e))})}s=this.collapseRows(o,true,false);if(r){this.trimRowsPlugin.trimRows(s)}if(t){this.renderAndAdjust()}if(this.collapsedRows.indexOf(a)===-1){this.collapsedRows.push(a)}return s},collapseMultipleChildren:function y(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=arguments[2]!==void 0?arguments[2]:true;var n=this;var o=[];f(e,function(e,t){o=o.concat(n.collapseChildren(e,false,false))});if(r){this.trimRowsPlugin.trimRows(o)}if(t){this.renderAndAdjust()}},collapseRow:function C(e){var t=arguments[1]!==void 0?arguments[1]:true;this.collapseRows([e],t)},collapseRows:function _(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=arguments[2]!==void 0?arguments[2]:false;var n=this;var o=[];f(e,function(e,r){o.push(e);if(t){n.collapseChildRows(e,o)}});if(r){this.trimRowsPlugin.trimRows(o)}return o},collapseChildRows:function E(e){var t=arguments[1]!==void 0?arguments[1]:[];var r=arguments[2]!==void 0?arguments[2]:true;var n=arguments[3]!==void 0?arguments[3]:false;var o=this;if(this.dataManager.hasChildren(e)){var i=this.dataManager.getDataObject(e);f(i.__children,function(e,r){var n=o.dataManager.getRowIndex(e);t.push(n);o.collapseChildRows(n,t)})}if(n){this.trimRowsPlugin.trimRows(t)}},expandRow:function R(e){var t=arguments[1]!==void 0?arguments[1]:true;this.expandRows([e],t)},expandRows:function M(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=arguments[2]!==void 0?arguments[2]:false;var n=this;var o=[];f(e,function(e,r){o.push(e);if(t){n.expandChildRows(e,o)}});if(r){this.trimRowsPlugin.untrimRows(o)}return o},expandChildRows:function S(e){var t=arguments[1]!==void 0?arguments[1]:[];var r=arguments[2]!==void 0?arguments[2]:true;var n=arguments[3]!==void 0?arguments[3]:false;var o=this;if(this.dataManager.hasChildren(e)){var i=this.dataManager.getDataObject(e);f(i.__children,function(e,r){if(!o.isAnyParentCollapsed(e)){var n=o.dataManager.getRowIndex(e);t.push(n);o.expandChildRows(n,t)}})}if(n){this.trimRowsPlugin.untrimRows(t)}},expandChildren:function O(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=arguments[2]!==void 0?arguments[2]:true;var n=this;var o=[];var i=null;var a=null;var s=null;if(isNaN(e)){i=e;a=this.dataManager.getRowIndex(e)}else{i=this.dataManager.getDataObject(e);a=e}this.collapsedRows.splice(this.collapsedRows.indexOf(a),1);if(this.dataManager.hasChildren(i)){f(i.__children,function(e,t){var r=n.dataManager.getRowIndex(e);o.push(r)})}s=this.expandRows(o,true,false);if(r){this.trimRowsPlugin.untrimRows(s)}if(t){this.renderAndAdjust()}return s},expandMultipleChildren:function T(e){var t=arguments[1]!==void 0?arguments[1]:true;var r=arguments[2]!==void 0?arguments[2]:true;var n=this;var o=[];f(e,function(e,t){o=o.concat(n.expandChildren(e,false,false))});if(r){this.trimRowsPlugin.untrimRows(o)}if(t){this.renderAndAdjust()}},collapseAll:function A(){var e=this;var t=this.hot.getSourceData();var r=[];f(t,function(t,n){if(e.dataManager.hasChildren(t)){r.push(t)}});this.collapseMultipleChildren(r);this.renderAndAdjust()},expandAll:function N(){var e=this;var t=this.hot.getSourceData();var r=[];f(t,function(t,n){if(e.dataManager.hasChildren(t)){r.push(t)}});this.expandMultipleChildren(r);this.renderAndAdjust()},areChildrenCollapsed:function D(e){var t=this;var r=null;var n=true;if(isNaN(e)){r=e}else{r=this.dataManager.getDataObject(e)}if(this.dataManager.hasChildren(r)){f(r.__children,function(e,r){var o=t.dataManager.getRowIndex(e);if(!t.trimRowsPlugin.isTrimmed(o)){n=false;return false}})}return n},isAnyParentCollapsed:function k(e){var t=e;while(t!==null){t=this.dataManager.getRowParent(t);var r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1){return true}}return false},toggleState:function x(e,t,r){if(t.col>=0){return}var n=this.translateTrimmedRow(t.row);if(h(e.target,m.CSS_CLASSES.button)){if(this.areChildrenCollapsed(n)){this.expandChildren(n)}else{this.collapseChildren(n)}d(e)}},translateTrimmedRow:function I(e){return this.trimRowsPlugin.rowsMapper.getValueByIndex(e)},renderAndAdjust:function P(){this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize()}},{},u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221,headers:224}],223:[function(e,t,r){"use strict";Object.defineProperties(r,{ContextMenuUI:{get:function c(){return d}},__esModule:{value:true}});var n,o,i;var a=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach;var l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{"default":i}).arrayEach;var u=new WeakMap;var d=function h(e,t){var r=this;u.set(this,{row_above:function n(e,t){r.dataManager.addSibling(t.start.row,"above")},row_below:function o(e,t){r.dataManager.addSibling(t.start.row,"below")}});$traceurRuntime.superConstructor(f).call(this,e,t);this.dataManager=this.plugin.dataManager};var f=d;$traceurRuntime.createClass(d,{appendOptions:function m(e){var t=this;var r=[{key:"add_child",name:function n(){return"Insert child row"},callback:function o(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelected()[0]);var r=t.dataManager.getDataObject(e);t.dataManager.addChild(r)},disabled:function i(){var e=t.hot.getSelected();return!e||e[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function a(){return"Detach from parent"},callback:function u(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelected()[0]);var r=t.dataManager.getDataObject(e);t.dataManager.detachFromParent(t.hot.getSelected())},disabled:function d(){var e=t.hot.getSelected();var r=t.dataManager.translateTrimmedRow(e[0]);var n=t.dataManager.getRowParent(r);return!n||!e||e[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},Handsontable.plugins.ContextMenu.SEPARATOR];s(0,e.items.length-1,function(t){if(t===0){l(r,function(r,n){e.items.splice(t+n,0,r)});return false}});e=this.modifyRowInsertingOptions(e);return e},modifyRowInsertingOptions:function p(e){var t=u.get(this);s(0,e.items.length-1,function(r){if(t[e.items[r].key]!=null){e.items[r].callback=t[e.items[r].key]}});return e}},{},a)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221}],224:[function(e,t,r){"use strict";Object.defineProperties(r,{HeadersUI:{get:function h(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("_base"),n&&n.__esModule&&n||{"default":n}).BaseUI;var l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var d=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),a&&a.__esModule&&a||{"default":a}).addClass;var f=function m(e,t){$traceurRuntime.superConstructor(c).call(this,e,t);this.dataManager=this.plugin.dataManager;this.collapsingUI=this.plugin.collapsingUI;this.rowHeaderWidthCache=null;this.trimRowsPlugin=e.trimRowsPlugin};var c=f;$traceurRuntime.createClass(f,{appendLevelIndicators:function p(e,t){e=this.trimRowsPlugin.rowsMapper.getValueByIndex(e);var r=this.dataManager.getRowLevel(e);var n=this.dataManager.getDataObject(e);var o=t.getElementsByTagName("DIV")[0];var i=o.querySelector("span.rowHeader");var a=o.querySelectorAll('[class^="ht_nesting"]');l(a,function(e,t){if(e){o.removeChild(e)}});d(t,c.CSS_CLASSES.indicatorContainer);if(r){var s=i.cloneNode(true);o.innerHTML="";u(0,r-1,function(e){var t=document.createElement("SPAN");d(t,c.CSS_CLASSES.emptyIndicator);o.appendChild(t)});o.appendChild(s)}if(this.dataManager.hasChildren(n)){var f=document.createElement("DIV");d(t,c.CSS_CLASSES.parent);if(this.collapsingUI.areChildrenCollapsed(e)){d(f,c.CSS_CLASSES.button+" "+c.CSS_CLASSES.expandButton)}else{d(f,c.CSS_CLASSES.button+" "+c.CSS_CLASSES.collapseButton)}o.appendChild(f)}},updateRowHeaderWidth:function v(e){if(!e){e=this.dataManager.cache.levelCount}this.rowHeaderWidthCache=Math.max(50,11+10*e+25);this.hot.render()}},{get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}},s)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:221}],225:[function(e,t,r){"use strict";Object.defineProperties(r,{RowsMapper:{get:function c(){return f}},__esModule:{value:true}});var n,o,i,a;var s=(n=e("../../browser"),n&&n.__esModule&&n||{"default":n}).default;var l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),o&&o.__esModule&&o||{"default":o}).arrayMapper;var u=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{"default":i}).mixin;var d=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),a&&a.__esModule&&a||{"default":a}).rangeEach;var f=function h(e){this.trimRows=e};$traceurRuntime.createClass(f,{createMap:function m(e){var t=this;var r=0;var n=e===void 0?this._arrayMap.length:e;
this._arrayMap.length=0;d(n-1,function(e){if(t.trimRows.isTrimmed(e)){r++}else{t._arrayMap[e-r]=e}})},destroy:function p(){this._arrayMap=null}},{});u(f,l);s.utils.TrimRowsRowsMapper=f},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":141}],226:[function(e,t,r){"use strict";Object.defineProperties(r,{TrimRows:{get:function p(){return h}},__esModule:{value:true}});var n,o,i,a,s;var l=(n=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),n&&n.__esModule&&n||{"default":n}).default;var u=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach;var d=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{"default":i}).rangeEach;var f=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),a&&a.__esModule&&a||{"default":a}).registerPlugin;var c=(s=e("rowsMapper"),s&&s.__esModule&&s||{"default":s}).RowsMapper;var h=function v(e){$traceurRuntime.superConstructor(m).call(this,e);this.trimmedRows=[];this.removedRows=[];this.rowsMapper=new c(this)};var m=h;$traceurRuntime.createClass(h,{isEnabled:function g(){return!!this.hot.getSettings().trimRows},enablePlugin:function w(){var e=this;if(this.enabled){return}var t=this.hot.getSettings().trimRows;if(Array.isArray(t)){this.trimmedRows=t}this.rowsMapper.createMap(this.hot.countSourceRows());this.addHook("modifyRow",function(t,r){return e.onModifyRow(t,r)});this.addHook("unmodifyRow",function(t,r){return e.onUnmodifyRow(t,r)});this.addHook("afterCreateRow",function(t,r){return e.onAfterCreateRow(t,r)});this.addHook("beforeRemoveRow",function(t,r){return e.onBeforeRemoveRow(t,r)});this.addHook("afterRemoveRow",function(t,r){return e.onAfterRemoveRow(t,r)});this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)});$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this)},updatePlugin:function b(){var e=this.hot.getSettings().trimRows;if(Array.isArray(e)){this.disablePlugin();this.enablePlugin()}$traceurRuntime.superGet(this,m.prototype,"updatePlugin").call(this)},disablePlugin:function y(){this.trimmedRows=[];this.removedRows.length=0;this.rowsMapper.clearMap();$traceurRuntime.superGet(this,m.prototype,"disablePlugin").call(this)},trimRows:function C(e){var t=this;u(e,function(e){e=parseInt(e,10);if(!t.isTrimmed(e)){t.trimmedRows.push(e)}});this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterTrimRow",e)},trimRow:function _(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.trimRows(e)},untrimRows:function E(e){var t=this;u(e,function(e){e=parseInt(e,10);if(t.isTrimmed(e)){t.trimmedRows.splice(t.trimmedRows.indexOf(e),1)}});this.rowsMapper.createMap(this.hot.countSourceRows());this.hot.runHooks("afterUntrimRow",e)},untrimRow:function R(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t]}this.untrimRows(e)},isTrimmed:function M(e){return this.trimmedRows.indexOf(e)>-1},untrimAll:function S(){this.untrimRows([].concat(this.trimmedRows))},onModifyRow:function O(e,t){if(t!==this.pluginName){e=this.rowsMapper.getValueByIndex(e)}return e},onUnmodifyRow:function T(e,t){if(t!==this.pluginName){e=this.rowsMapper.getIndexByValue(e)}return e},onAfterCreateRow:function A(e,t){this.rowsMapper.shiftItems(e,t)},onBeforeRemoveRow:function N(e,t){var r=this;this.removedRows.length=0;if(e!==false){d(e,e+t-1,function(e){r.removedRows.push(r.hot.runHooks("modifyRow",e,r.pluginName))})}},onAfterRemoveRow:function D(e,t){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function k(e){if(!e){this.rowsMapper.createMap(this.hot.countSourceRows())}},destroy:function x(){this.rowsMapper.destroy();$traceurRuntime.superGet(this,m.prototype,"destroy").call(this)}},{},l);f("trimRows",h)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,rowsMapper:225}],SheetClip:[function(e,t,r){(function(e){"use strict";function t(e){return e.split('"').length-1}var n={parse:function o(e){var r,n,o,i=[],a=0,s,l,u,d;o=e.split("\n");if(o.length>1&&o[o.length-1]===""){o.pop()}for(r=0,n=o.length;r<n;r+=1){o[r]=o[r].split("	");for(s=0,l=o[r].length;s<l;s+=1){if(!i[a]){i[a]=[]}if(u&&s===0){d=i[a].length-1;i[a][d]=i[a][d]+"\n"+o[r][0];if(u&&t(o[r][0])&1){u=false;i[a][d]=i[a][d].substring(0,i[a][d].length-1).replace(/""/g,'"')}}else{if(s===l-1&&o[r][s].indexOf('"')===0&&t(o[r][s])&1){i[a].push(o[r][s].substring(1).replace(/""/g,'"'));u=true}else{i[a].push(o[r][s].replace(/""/g,'"'));u=false}}}if(!u){a+=1}}return i},stringify:function i(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){o=e[t].length;for(n=0;n<o;n+=1){if(n>0){i+="	"}a=e[t][n];if(typeof a==="string"){if(a.indexOf("\n")>-1){i+='"'+a.replace(/"/g,'""')+'"'}else{i+=a}}else if(a===null||a===void 0){i+=""}else{i+=a}}i+="\n"}return i}};if(typeof r!=="undefined"){r.parse=n.parse;r.stringify=n.stringify}else{e.SheetClip=n}})(window)},{}],autoResize:[function(e,t,r){function n(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function c(e,t,r){if(window.attachEvent){e.attachEvent("on"+t,r)}else{e.addEventListener(t,r,false)}},a=function h(e,t,r){if(window.removeEventListener){e.removeEventListener(t,r,false)}else{e.detachEvent("on"+t,r)}},s=function m(i){var a,s;if(!i){i=""}else if(!/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)){i="."}if(n.textContent!==void 0){n.textContent=t.value+i}else{n.data=t.value+i}o.style.fontSize=f(t).fontSize;o.style.fontFamily=f(t).fontFamily;o.style.whiteSpace="pre";r.appendChild(o);a=o.clientWidth+2;r.removeChild(o);t.style.height=e.minHeight+"px";if(e.minWidth>a){t.style.width=e.minWidth+"px"}else if(a>e.maxWidth){t.style.width=e.maxWidth+"px"}else{t.style.width=a+"px"}s=t.scrollHeight?t.scrollHeight-1:0;if(e.minHeight>s){t.style.height=e.minHeight+"px"}else if(e.maxHeight<s){t.style.height=e.maxHeight+"px";t.style.overflowY="visible"}else{t.style.height=s+"px"}},l=function p(){window.setTimeout(s,0)},u=function v(r){if(r&&r.minHeight){if(r.minHeight=="inherit"){e.minHeight=t.clientHeight}else{var i=parseInt(r.minHeight);if(!isNaN(i)){e.minHeight=i}}}if(r&&r.maxHeight){if(r.maxHeight=="inherit"){e.maxHeight=t.clientHeight}else{var a=parseInt(r.maxHeight);if(!isNaN(a)){e.maxHeight=a}}}if(r&&r.minWidth){if(r.minWidth=="inherit"){e.minWidth=t.clientWidth}else{var s=parseInt(r.minWidth);if(!isNaN(s)){e.minWidth=s}}}if(r&&r.maxWidth){if(r.maxWidth=="inherit"){e.maxWidth=t.clientWidth}else{var l=parseInt(r.maxWidth);if(!isNaN(l)){e.maxWidth=l}}}if(!o.firstChild){o.className="autoResize";o.style.display="inline-block";o.appendChild(n)}},d=function g(r,n,o){t=r;u(n);if(t.nodeName=="TEXTAREA"){t.style.resize="none";t.style.overflowY="";t.style.height=e.minHeight+"px";t.style.minWidth=e.minWidth+"px";t.style.maxWidth=e.maxWidth+"px";t.style.overflowY="hidden"}if(o){i(t,"change",s);i(t,"cut",l);i(t,"paste",l);i(t,"drop",l);i(t,"keydown",l);i(t,"focus",s)}s()};function f(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function w(e,t,r){d(e,t,r)},unObserve:function b(){a(t,"change",s);a(t,"cut",l);a(t,"paste",l);a(t,"drop",l);a(t,"keydown",l);a(t,"focus",s)},resize:s}}if(typeof r!=="undefined"){t.exports=n}},{}],copyPaste:[function(e,t,r){var n;function o(){if(!n){n=new i}else if(n.hasBeenDestroyed()){n.init()}n.refCounter++;return n}if(typeof r!=="undefined"){t.exports=o}function i(){this.refCounter=0;this.init()}i.prototype.init=function(){var e,t;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];t=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("div");this.elDiv.id="CopyPasteDiv";e=this.elDiv.style;e.position="fixed";e.top="-10000px";e.left="-10000px";t.appendChild(this.elDiv);this.elTextarea=document.createElement("textarea");this.elTextarea.className="copyPaste";this.elTextarea.onpaste=function(e){var t,r;if("WebkitAppearance"in document.documentElement.style){t=e.clipboardData.getData("Text");if(navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1){r=t.split("\n");if(r[r.length-1]===""){r.pop()}t=r.join("\n")}this.value=t;e.preventDefault()}};e=this.elTextarea.style;e.width="10000px";e.height="10000px";e.overflow="hidden";this.elDiv.appendChild(this.elTextarea);if(typeof e.opacity!=="undefined"){e.opacity=0}}this.onKeyDownRef=this.onKeyDown.bind(this);document.documentElement.addEventListener("keydown",this.onKeyDownRef,false)};i.prototype.onKeyDown=function(e){var t=this,r=false;function n(){var e=document.activeElement;if(e.shadowRoot&&e.shadowRoot.activeElement){e=e.shadowRoot.activeElement}return["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||e.contentEditable==="true"}if(e.metaKey){r=true}else if(e.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){r=true}if(r){if(document.activeElement!==this.elTextarea&&(this.getSelectionText()!==""||n())){return}this.selectNodeText(this.elTextarea);setTimeout(function(){if(document.activeElement!==t.elTextarea){t.selectNodeText(t.elTextarea)}},0)}if(e.isImmediatePropagationEnabled!==false&&r&&(e.keyCode===67||e.keyCode===86||e.keyCode===88)){if(e.keyCode===88){setTimeout(function(){t.triggerCut(e)},0)}else if(e.keyCode===86){setTimeout(function(){t.triggerPaste(e)},0)}}};i.prototype.selectNodeText=function(e){if(e){e.select()}};i.prototype.getSelectionText=function(){var e="";if(window.getSelection){e=window.getSelection().toString()}else if(document.selection&&document.selection.type!=="Control"){e=document.selection.createRange().text}return e};i.prototype.copyable=function(e){if(typeof e!=="string"&&e.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=e;this.selectNodeText(this.elTextarea)};i.prototype.onCut=function(e){this.cutCallbacks.push(e)};i.prototype.onPaste=function(e){this.pasteCallbacks.push(e)};i.prototype.removeCallback=function(e){var t,r;for(t=0,r=this.copyCallbacks.length;t<r;t++){if(this.copyCallbacks[t]===e){this.copyCallbacks.splice(t,1);return true}}for(t=0,r=this.cutCallbacks.length;t<r;t++){if(this.cutCallbacks[t]===e){this.cutCallbacks.splice(t,1);return true}}for(t=0,r=this.pasteCallbacks.length;t<r;t++){if(this.pasteCallbacks[t]===e){this.pasteCallbacks.splice(t,1);return true}}return false};i.prototype.triggerCut=function(e){var t=this;if(t.cutCallbacks){setTimeout(function(){for(var r=0,n=t.cutCallbacks.length;r<n;r++){t.cutCallbacks[r](e)}},50)}};i.prototype.triggerPaste=function(e,t){var r=this;if(r.pasteCallbacks){setTimeout(function(){var n=t||r.elTextarea.value;for(var o=0,i=r.pasteCallbacks.length;o<i;o++){r.pasteCallbacks[o](n,e)}},50)}};i.prototype.destroy=function(){if(!this.hasBeenDestroyed()&&--this.refCounter===0){if(this.elDiv&&this.elDiv.parentNode){this.elDiv.parentNode.removeChild(this.elDiv);this.elDiv=null;this.elTextarea=null}document.documentElement.removeEventListener("keydown",this.onKeyDownRef);this.onKeyDownRef=null}};i.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],es6collections:[function(e,t,r){/*!
 * Copyright (C) 2011 by Andrea Giammarchi, @WebReflection
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
(function(e){"use strict";var t;var r=Object.defineProperty,n=function C(e,t){return isNaN(e)?isNaN(t):e===t};if(typeof WeakMap=="undefined"){e.WeakMap=o({"delete":a,clear:h,get:s,has:d,set:f},true)}if(typeof Map=="undefined"){e.Map=o({"delete":a,has:d,get:s,set:f,keys:m,values:p,entries:v,forEach:y,clear:h})}if(typeof Set=="undefined"){e.Set=o({has:u,add:c,"delete":a,clear:h,keys:p,values:p,entries:g,forEach:y})}if(typeof WeakSet=="undefined"){e.WeakSet=o({"delete":a,add:c,clear:h,has:u},true)}function o(e,t){function n(e){if(!this||this.constructor!==n)return new n(e);this._keys=[];this._values=[];this._itp=[];this.objectOnly=t;if(e)i.call(this,e)}if(!t){r(e,"size",{get:b})}e.constructor=n;n.prototype=e;return n}function i(e){var t;if(this.add)e.forEach(this.add,this);else e.forEach(function(e){this.set(e[0],e[1])},this)}function a(e){if(this.has(e)){this._keys.splice(t,1);this._values.splice(t,1);this._itp.forEach(function(e){if(t<e[0])e[0]--})}return-1<t}function s(e){return this.has(e)?this._values[t]:undefined}function l(e,r){if(this.objectOnly&&r!==Object(r))throw new TypeError("Invalid value used as weak collection key");if(r!=r||r===0)for(t=e.length;t--&&!n(e[t],r);){}else t=e.indexOf(r);return-1<t}function u(e){return l.call(this,this._values,e)}function d(e){return l.call(this,this._keys,e)}function f(e,r){this.has(e)?this._values[t]=r:this._values[this._keys.push(e)-1]=r;return this}function c(e){if(!this.has(e))this._values.push(e);return this}function h(){this._values.length=0}function m(){return w(this._itp,this._keys)}function p(){return w(this._itp,this._values)}function v(){return w(this._itp,this._keys,this._values)}function g(){return w(this._itp,this._values,this._values)}function w(e,t,r){var n=[0],o=false;e.push(n);return{next:function i(){var i,a=n[0];if(!o&&a<t.length){i=r?[t[a],r[a]]:t[a];n[0]++}else{o=true;e.splice(e.indexOf(n),1)}return{done:o,value:i}}}}function b(){return this._values.length}function y(e,t){var r=this.entries();for(;;){var n=r.next();if(n.done)break;e.call(t,n.value[1],n.value[0],this)}}})(typeof r!="undefined"&&typeof global!="undefined"?global:window)},{}],"hot-formula-parser":[function(_dereq_,module,exports){(function e(t,r){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&(typeof module==="undefined"?"undefined":_typeof(module))==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define([],r);else if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object")exports["formulaParser"]=r();else t["formulaParser"]=r()})(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:false,exports:{}};e[n].call(o.exports,o,o.exports,r);o.l=true;return o.exports}r.m=e;r.c=t;r.i=function(e){return e};r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.n=function(e){var t=e&&e.__esModule?function n(){return e["default"]}:function o(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=81)}([function(e,t){t.nil=new Error("#NULL!");t.div0=new Error("#DIV/0!");t.value=new Error("#VALUE!");t.ref=new Error("#REF!");t.name=new Error("#NAME?");t.num=new Error("#NUM!");t.na=new Error("#N/A");t.error=new Error("#ERROR!");t.data=new Error("#GETTING_DATA")},function(e,t,r){"use strict";t.__esModule=true;var n;t["default"]=h;t.isValidStrict=m;var o=t.ERROR="ERROR";var i=t.ERROR_DIV_ZERO="DIV/0";var a=t.ERROR_NAME="NAME";var s=t.ERROR_NOT_AVAILABLE="N/A";var l=t.ERROR_NULL="NULL";var u=t.ERROR_NUM="NUM";var d=t.ERROR_REF="REF";var f=t.ERROR_VALUE="VALUE";var c=(n={},n[o]="#ERROR!",n[i]="#DIV/0!",n[a]="#NAME?",n[s]="#N/A",n[l]="#NULL!",n[u]="#NUM!",n[d]="#REF!",n[f]="#VALUE!",n);function h(e){var t=void 0;e=(e+"").replace(/#|!|\?/g,"");if(c[e]){t=c[e]}return t?t:null}function m(e){var t=false;for(var r in c){if(Object.prototype.hasOwnProperty.call(c,r)&&c[r]===e){t=true;break}}return t}},function(e,t,r){var n=r(0);t.flattenShallow=function(e){if(!e||!e.reduce){return e}return e.reduce(function(e,t){var r=Array.isArray(e);var n=Array.isArray(t);if(r&&n){return e.concat(t)}if(r){e.push(t);return e}if(n){return[e].concat(t)}return[e,t]})};t.isFlat=function(e){if(!e){return false}for(var t=0;t<e.length;++t){if(Array.isArray(e[t])){return false}}return true};t.flatten=function(){var e=t.argsToArray.apply(null,arguments);while(!t.isFlat(e)){e=t.flattenShallow(e)}return e};t.argsToArray=function(e){var r=[];t.arrayEach(e,function(e){r.push(e)});return r};t.numbers=function(){var e=this.flatten.apply(null,arguments);return e.filter(function(e){return typeof e==="number"})};t.cleanFloat=function(e){var t=1e14;return Math.round(e*t)/t};t.parseBool=function(e){if(typeof e==="boolean"){return e}if(e instanceof Error){return e}if(typeof e==="number"){return e!==0}if(typeof e==="string"){var t=e.toUpperCase();if(t==="TRUE"){return true}if(t==="FALSE"){return false}}if(e instanceof Date&&!isNaN(e)){return true}return n.value};t.parseNumber=function(e){if(e===undefined||e===""){return n.value}if(!isNaN(e)){return parseFloat(e)}return n.value};t.parseNumberArray=function(e){var r;if(!e||(r=e.length)===0){return n.value}var o;while(r--){o=t.parseNumber(e[r]);if(o===n.value){return o}e[r]=o}return e};t.parseMatrix=function(e){var r;if(!e||(r=e.length)===0){return n.value}var o;for(var i=0;i<e.length;i++){o=t.parseNumberArray(e[i]);e[i]=o;if(o instanceof Error){return o}}return e};var o=new Date(1900,0,1);t.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date){return new Date(e)}var t=parseInt(e,10);if(t<0){return n.num}if(t<=60){return new Date(o.getTime()+(t-1)*864e5)}return new Date(o.getTime()+(t-2)*864e5)}if(typeof e==="string"){e=new Date(e);if(!isNaN(e)){return e}}return n.value};t.parseDateArray=function(e){var t=e.length;var r;while(t--){r=this.parseDate(e[t]);if(r===n.value){return r}e[t]=r}return e};t.anyIsError=function(){var e=arguments.length;while(e--){if(arguments[e]instanceof Error){return true}}return false};t.arrayValuesToNumbers=function(e){var t=e.length;var r;while(t--){r=e[t];if(typeof r==="number"){continue}if(r===true){e[t]=1;continue}if(r===false){e[t]=0;continue}if(typeof r==="string"){var n=this.parseNumber(r);if(n instanceof Error){e[t]=0}else{e[t]=n}}}return e};t.rest=function(e,t){t=t||1;if(!e||typeof e.slice!=="function"){return e}return e.slice(t)};t.initial=function(e,t){t=t||1;if(!e||typeof e.slice!=="function"){return e}return e.slice(0,e.length-t)};t.arrayEach=function(e,t){var r=-1,n=e.length;while(++r<n){if(t(e[r],r,e)===false){break}}return e}},function(e,t,r){"use strict";t.__esModule=true;t.toNumber=n;t.invertNumber=o;function n(e){var t=void 0;if(typeof e==="number"){t=e}else if(typeof e==="string"){t=e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)}return t}function o(e){return-1*n(e)}},function(module,exports,__webpack_require__){var utils=__webpack_require__(2);var error=__webpack_require__(0);var statistical=__webpack_require__(5);var information=__webpack_require__(7);exports.ABS=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.abs(e);return t};exports.ACOS=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.acos(e);if(isNaN(t)){t=error.num}return t};exports.ACOSH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.log(e+Math.sqrt(e*e-1));if(isNaN(t)){t=error.num}return t};exports.ACOT=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.atan(1/e);return t};exports.ACOTH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=.5*Math.log((e+1)/(e-1));if(isNaN(t)){t=error.num}return t};exports.AGGREGATE=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(e);if(utils.anyIsError(e,t)){return error.value}switch(e){case 1:return statistical.AVERAGE(r);case 2:return statistical.COUNT(r);case 3:return statistical.COUNTA(r);case 4:return statistical.MAX(r);case 5:return statistical.MIN(r);case 6:return exports.PRODUCT(r);case 7:return statistical.STDEV.S(r);case 8:return statistical.STDEV.P(r);case 9:return exports.SUM(r);case 10:return statistical.VAR.S(r);case 11:return statistical.VAR.P(r);case 12:return statistical.MEDIAN(r);case 13:return statistical.MODE.SNGL(r);case 14:return statistical.LARGE(r,n);case 15:return statistical.SMALL(r,n);case 16:return statistical.PERCENTILE.INC(r,n);case 17:return statistical.QUARTILE.INC(r,n);case 18:return statistical.PERCENTILE.EXC(r,n);case 19:return statistical.QUARTILE.EXC(r,n)}};exports.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e)){return error.value}var t=0;e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]});return t};exports.ASIN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.asin(e);if(isNaN(t)){t=error.num}return t};exports.ASINH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.log(e+Math.sqrt(e*e+1))};exports.ATAN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.atan(e)};exports.ATAN2=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return Math.atan2(e,t)};exports.ATANH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.log((1+e)/(1-e))/2;if(isNaN(t)){t=error.num}return t};exports.BASE=function(e,t,r){r=r||0;e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}r=r===undefined?0:r;var n=e.toString(t);return new Array(Math.max(r+1-n.length,0)).join("0")+n};exports.CEILING=function(e,t,r){t=t===undefined?1:Math.abs(t);r=r||0;e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}if(t===0){return 0}var n=-Math.floor(Math.log(t)/Math.log(10));if(e>=0){return exports.ROUND(Math.ceil(e/t)*t,n)}else{if(r===0){return-exports.ROUND(Math.floor(Math.abs(e)/t)*t,n)}else{return-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,n)}}};exports.CEILING.MATH=exports.CEILING;exports.CEILING.PRECISE=exports.CEILING;exports.COMBIN=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))};exports.COMBINA=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return e===0&&t===0?1:exports.COMBIN(e+t-1,e-1)};exports.COS=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.cos(e)};exports.COSH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return(Math.exp(e)+Math.exp(-e))/2};exports.COT=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return 1/Math.tan(e)};exports.COTH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.exp(2*e);return(t+1)/(t-1)};exports.CSC=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return 1/Math.sin(e)};exports.CSCH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return 2/(Math.exp(e)-Math.exp(-e))};exports.DECIMAL=function(e,t){if(arguments.length<1){return error.value}return parseInt(e,t)};exports.DEGREES=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return e*180/Math.PI};exports.EVEN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return exports.CEILING(e,-2,-1)};exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.floor(e);if(t===0||t===1){return 1}else if(MEMOIZED_FACT[t]>0){return MEMOIZED_FACT[t]}else{MEMOIZED_FACT[t]=exports.FACT(t-1)*t;return MEMOIZED_FACT[t]}};exports.FACTDOUBLE=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.floor(e);if(t<=0){return 1}else{return t*exports.FACTDOUBLE(t-2)}};exports.FLOOR=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}if(t===0){return 0}if(!(e>0&&t>0)&&!(e<0&&t<0)){return error.num}t=Math.abs(t);var r=-Math.floor(Math.log(t)/Math.log(10));if(e>=0){return exports.ROUND(Math.floor(e/t)*t,r)}else{return-exports.ROUND(Math.ceil(Math.abs(e)/t),r)}};exports.FLOOR.MATH=function(e,t,r){t=t===undefined?1:t;r=r===undefined?0:r;e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}if(t===0){return 0}t=t?Math.abs(t):1;var n=-Math.floor(Math.log(t)/Math.log(10));if(e>=0){return exports.ROUND(Math.floor(e/t)*t,n)}else if(r===0||r===undefined){return-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,n)}return-exports.ROUND(Math.floor(Math.abs(e)/t)*t,n)};exports.FLOOR.PRECISE=exports.FLOOR.MATH;exports.GCD=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=e.length;var r=e[0];var n=r<0?-r:r;for(var o=1;o<t;o++){var i=e[o];var a=i<0?-i:i;while(n&&a){if(n>a){n%=a}else{a%=n}}n+=a}return n};exports.INT=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.floor(e)};exports.ISO={CEILING:exports.CEILING};exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}for(var t,r,n,o,i=1;(n=e.pop())!==undefined;){while(n>1){if(n%2){for(t=3,r=Math.floor(Math.sqrt(n));t<=r&&n%t;t+=2){}o=t<=r?t:n}else{o=2}for(n/=o,i*=o,t=e.length;t;e[--t]%o===0&&(e[t]/=o)===1&&e.splice(t,1)){}}}return i};exports.LN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.log(e)};exports.LN10=function(){return Math.log(10)};exports.LN2=function(){return Math.log(2)};exports.LOG10E=function(){return Math.LOG10E};exports.LOG2E=function(){return Math.LOG2E};exports.LOG=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}t=t===undefined?10:t;return Math.log(e)/Math.log(t)};exports.LOG10=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.log(e)/Math.log(10)};exports.MOD=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}if(t===0){return error.div0}var r=Math.abs(e%t);return t>0?r:-r};exports.MROUND=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}if(e*t<0){return error.num}return Math.round(e/t)*t};exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=0;var r=1;for(var n=0;n<e.length;n++){t+=e[n];r*=exports.FACT(e[n])}return exports.FACT(t)/r};exports.ODD=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.ceil(Math.abs(e));t=t&1?t:t+1;return e>0?t:-t};exports.PI=function(){return Math.PI};exports.E=function(){return Math.E};exports.POWER=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}var r=Math.pow(e,t);if(isNaN(r)){return error.num}return r};exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=1;for(var r=0;r<e.length;r++){t*=e[r]}return t};exports.QUOTIENT=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return parseInt(e/t,10)};exports.RADIANS=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return e*Math.PI/180};exports.RAND=function(){return Math.random()};exports.RANDBETWEEN=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return e+Math.ceil((t-e+1)*Math.random())-1};exports.ROMAN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=String(e).split("");var r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];var n="";var o=3;while(o--){n=(r[+t.pop()+o*10]||"")+n}return new Array(+t.join("")+1).join("M")+n};exports.ROUND=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};exports.ROUNDDOWN=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}var r=e>0?1:-1;return r*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)};exports.ROUNDUP=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}var r=e>0?1:-1;return r*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)};exports.SEC=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return 1/Math.cos(e)};exports.SECH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return 2/(Math.exp(e)+Math.exp(-e))};exports.SERIESSUM=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);n=utils.parseNumberArray(n);if(utils.anyIsError(e,t,r,n)){return error.value}var o=n[0]*Math.pow(e,t);for(var i=1;i<n.length;i++){o+=n[i]*Math.pow(e,t+i*r)}return o};exports.SIGN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}if(e<0){return-1}else if(e===0){return 0}else{return 1}};exports.SIN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.sin(e)};exports.SINH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return(Math.exp(e)-Math.exp(-e))/2};exports.SQRT=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}if(e<0){return error.num}return Math.sqrt(e)};exports.SQRTPI=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.sqrt(e*Math.PI)};exports.SQRT1_2=function(){return 1/Math.sqrt(2)};exports.SQRT2=function(){return Math.sqrt(2)};exports.SUBTOTAL=function(e,t){e=utils.parseNumber(e);if(e instanceof Error){return e}switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 101:return statistical.AVERAGE(t);case 102:return statistical.COUNT(t);case 103:return statistical.COUNTA(t);case 104:return statistical.MAX(t);case 105:return statistical.MIN(t);case 106:return exports.PRODUCT(t);case 107:return statistical.STDEV.S(t);case 108:return statistical.STDEV.P(t);case 109:return exports.SUM(t);case 110:return statistical.VAR.S(t);case 111:return statistical.VAR.P(t)}};exports.ADD=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return e+t};exports.MINUS=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return e-t};exports.DIVIDE=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}if(t===0){return error.div0}return e/t};exports.MULTIPLY=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return e*t};exports.GTE=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.error}return e>=t};exports.LT=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.error}return e<t};exports.LTE=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.error}return e<=t};exports.EQ=function(e,t){if(arguments.length!==2){return error.na}return e===t};exports.NE=function(e,t){if(arguments.length!==2){return error.na}return e!==t};exports.POW=function(e,t){if(arguments.length!==2){return error.na}e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.error}return exports.POWER(e,t)};exports.SUM=function(){var e=0;utils.arrayEach(utils.argsToArray(arguments),function(t){if(typeof t==="number"){e+=t}else if(typeof t==="string"){var r=parseFloat(t);!isNaN(r)&&(e+=r)}else if(Array.isArray(t)){e+=exports.SUM.apply(null,t)}});return e};exports.SUMIF=function(range,criteria){range=utils.parseNumberArray(utils.flatten(range));if(range instanceof Error){return range}var result=0;for(var i=0;i<range.length;i++){result+=eval(range[i]+criteria)?range[i]:0}return result};exports.SUMIFS=function(){var args=utils.argsToArray(arguments);var range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error){return range}var criteria=args;var n_range_elements=range.length;var n_criterias=criteria.length;var result=0;for(var i=0;i<n_range_elements;i++){var el=range[i];var condition="";for(var c=0;c<n_criterias;c++){condition+=el+criteria[c];if(c!==n_criterias-1){condition+="&&"}}if(eval(condition)){result+=el}}return result};exports.SUMPRODUCT=function(){if(!arguments||arguments.length===0){return error.value}var e=arguments.length+1;var t=0;var r;var n;var o;var i;for(var a=0;a<arguments[0].length;a++){if(!(arguments[0][a]instanceof Array)){r=1;for(n=1;n<e;n++){o=utils.parseNumber(arguments[n-1][a]);if(o instanceof Error){return o}r*=o}t+=r}else{for(var s=0;s<arguments[0][a].length;s++){r=1;for(n=1;n<e;n++){i=utils.parseNumber(arguments[n-1][a][s]);if(i instanceof Error){return i}r*=i}t+=r}}}return t};exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=0;var r=e.length;for(var n=0;n<r;n++){t+=information.ISNUMBER(e[n])?e[n]*e[n]:0}return t};exports.SUMX2MY2=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=0;for(var n=0;n<e.length;n++){r+=e[n]*e[n]-t[n]*t[n]}return r};exports.SUMX2PY2=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=0;e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++){r+=e[n]*e[n]+t[n]*t[n]}return r};exports.SUMXMY2=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=0;e=utils.flatten(e);t=utils.flatten(t);for(var n=0;n<e.length;n++){r+=Math.pow(e[n]-t[n],2)}return r};exports.TAN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.tan(e)};exports.TANH=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.exp(2*e);return(t-1)/(t+1)};exports.TRUNC=function(e,t){t=t===undefined?0:t;e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}var r=e>0?1:-1;return r*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(4);var text=__webpack_require__(8);var jStat=__webpack_require__(13).jStat;var utils=__webpack_require__(2);var error=__webpack_require__(0);var misc=__webpack_require__(12);var SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}return jStat.sum(jStat(e).subtract(jStat.mean(e)).abs()[0])/e.length};exports.AVERAGE=function(){var e=utils.numbers(utils.flatten(arguments));var t=e.length;var r=0;var n=0;var o;for(var i=0;i<t;i++){r+=e[i];n+=1}o=r/n;if(isNaN(o)){o=error.num}return o};exports.AVERAGEA=function(){var e=utils.flatten(arguments);var t=e.length;var r=0;var n=0;var o;for(var i=0;i<t;i++){var a=e[i];if(typeof a==="number"){r+=a}if(a===true){r++}if(a!==null){n++}}o=r/n;if(isNaN(o)){o=error.num}return o};exports.AVERAGEIF=function(range,criteria,average_range){if(arguments.length<=1){return error.na}average_range=average_range||range;range=utils.flatten(range);average_range=utils.parseNumberArray(utils.flatten(average_range));if(average_range instanceof Error){return average_range}var average_count=0;var result=0;for(var i=0;i<range.length;i++){if(eval(range[i]+criteria)){result+=average_range[i];average_count++}}return result/average_count};exports.AVERAGEIFS=function(){var args=utils.argsToArray(arguments);var criteria=(args.length-1)/2;var range=utils.flatten(args[0]);var count=0;var result=0;for(var i=0;i<range.length;i++){var condition="";for(var j=0;j<criteria;j++){condition+=args[2*j+1][i]+args[2*j+2];if(j!==criteria-1){condition+="&&"}}if(eval(condition)){result+=range[i];count++}}var average=result/count;if(isNaN(average)){return 0}else{return average}};exports.BETA={};exports.BETA.DIST=function(e,t,r,n,o,i){if(arguments.length<4){return error.value}o=o===undefined?0:o;i=i===undefined?1:i;e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);o=utils.parseNumber(o);i=utils.parseNumber(i);if(utils.anyIsError(e,t,r,o,i)){return error.value}e=(e-o)/(i-o);return n?jStat.beta.cdf(e,t,r):jStat.beta.pdf(e,t,r)};exports.BETA.INV=function(e,t,r,n,o){n=n===undefined?0:n;o=o===undefined?1:o;e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);n=utils.parseNumber(n);o=utils.parseNumber(o);if(utils.anyIsError(e,t,r,n,o)){return error.value}return jStat.beta.inv(e,t,r)*(o-n)+n};exports.BINOM={};exports.BINOM.DIST=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);n=utils.parseNumber(n);if(utils.anyIsError(e,t,r,n)){return error.value}return n?jStat.binomial.cdf(e,t,r):jStat.binomial.pdf(e,t,r)};exports.BINOM.DIST.RANGE=function(e,t,r,n){n=n===undefined?r:n;e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);n=utils.parseNumber(n);if(utils.anyIsError(e,t,r,n)){return error.value}var o=0;for(var i=r;i<=n;i++){o+=mathTrig.COMBIN(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i)}return o};exports.BINOM.INV=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}var n=0;while(n<=e){if(jStat.binomial.cdf(n,e,t)>=r){return n}n++}};exports.CHISQ={};exports.CHISQ.DIST=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return r?jStat.chisquare.cdf(e,t):jStat.chisquare.pdf(e,t)};exports.CHISQ.DIST.RT=function(e,t){if(!e|!t){return error.na}if(e<1||t>Math.pow(10,10)){return error.num}if(typeof e!=="number"||typeof t!=="number"){return error.value}return 1-jStat.chisquare.cdf(e,t)};exports.CHISQ.INV=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return jStat.chisquare.inv(e,t)};exports.CHISQ.INV.RT=function(e,t){if(!e|!t){return error.na}if(e<0||e>1||t<1||t>Math.pow(10,10)){return error.num}if(typeof e!=="number"||typeof t!=="number"){return error.value}return jStat.chisquare.inv(1-e,t)};exports.CHISQ.TEST=function(e,t){if(arguments.length!==2){return error.na}if(!(e instanceof Array)||!(t instanceof Array)){return error.value}if(e.length!==t.length){return error.value}if(e[0]&&t[0]&&e[0].length!==t[0].length){return error.value}var r=e.length;var n,o,i;for(o=0;o<r;o++){if(!(e[o]instanceof Array)){n=e[o];e[o]=[];e[o].push(n)}if(!(t[o]instanceof Array)){n=t[o];t[o]=[];t[o].push(n)}}var a=e[0].length;var s=a===1?r-1:(r-1)*(a-1);var l=0;var u=Math.PI;for(o=0;o<r;o++){for(i=0;i<a;i++){l+=Math.pow(e[o][i]-t[o][i],2)/t[o][i]}}function d(e,t){var r=Math.exp(-.5*e);if(t%2===1){r=r*Math.sqrt(2*e/u)}var n=t;while(n>=2){r=r*e/n;n=n-2}var o=r;var i=t;while(o>1e-10*r){i=i+2;o=o*e/i;r=r+o}return 1-r}return Math.round(d(l,s)*1e6)/1e6};exports.COLUMN=function(e,t){if(arguments.length!==2){return error.na}if(t<0){return error.num}if(!(e instanceof Array)||typeof t!=="number"){return error.value}if(e.length===0){return undefined}return jStat.col(e,t)};exports.COLUMNS=function(e){if(arguments.length!==1){return error.na}if(!(e instanceof Array)){return error.value}if(e.length===0){return 0}return jStat.cols(e)};exports.CONFIDENCE={};exports.CONFIDENCE.NORM=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return jStat.normalci(1,e,t,r)[1]-1};exports.CONFIDENCE.T=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return jStat.tci(1,e,t,r)[1]-1};exports.CORREL=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}return jStat.corrcoeff(e,t)};exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length};exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)};exports.COUNTIN=function(e,t){var r=0;e=utils.flatten(e);for(var n=0;n<e.length;n++){if(e[n]===t){r++}}return r};exports.COUNTBLANK=function(){var e=utils.flatten(arguments);var t=0;var r;for(var n=0;n<e.length;n++){r=e[n];if(r===null||r===""){t++}}return t};exports.COUNTIF=function(range,criteria){range=utils.flatten(range);if(!/[<>=!]/.test(criteria)){criteria='=="'+criteria+'"'}var matches=0;for(var i=0;i<range.length;i++){if(typeof range[i]!=="string"){if(eval(range[i]+criteria)){matches++}}else{if(eval('"'+range[i]+'"'+criteria)){matches++}}}return matches};exports.COUNTIFS=function(){var args=utils.argsToArray(arguments);var results=new Array(utils.flatten(args[0]).length);for(var i=0;i<results.length;i++){results[i]=true}for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]);var criteria=args[i+1];if(!/[<>=!]/.test(criteria)){criteria='=="'+criteria+'"'}for(var j=0;j<range.length;j++){if(typeof range[j]!=="string"){results[j]=results[j]&&eval(range[j]+criteria)}else{results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}}}var result=0;for(i=0;i<results.length;i++){if(results[i]){result++}}return result};exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length};exports.COVARIANCE={};exports.COVARIANCE.P=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=jStat.mean(e);var n=jStat.mean(t);var o=0;var i=e.length;for(var a=0;a<i;a++){o+=(e[a]-r)*(t[a]-n)}return o/i};exports.COVARIANCE.S=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}return jStat.covariance(e,t)};exports.DEVSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=jStat.mean(e);var r=0;for(var n=0;n<e.length;n++){r+=Math.pow(e[n]-t,2)}return r};exports.EXPON={};exports.EXPON.DIST=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return r?jStat.exponential.cdf(e,t):jStat.exponential.pdf(e,t)};exports.F={};exports.F.DIST=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return n?jStat.centralF.cdf(e,t,r):jStat.centralF.pdf(e,t,r)};exports.F.DIST.RT=function(e,t,r){if(arguments.length!==3){return error.na}if(e<0||t<1||r<1){return error.num}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return error.value}return 1-jStat.centralF.cdf(e,t,r)};exports.F.INV=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}if(e<=0||e>1){return error.num}return jStat.centralF.inv(e,t,r)};exports.F.INV.RT=function(e,t,r){if(arguments.length!==3){return error.na}if(e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)){
return error.num}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return error.value}return jStat.centralF.inv(1-e,t,r)};exports.F.TEST=function(e,t){if(!e||!t){return error.na}if(!(e instanceof Array)||!(t instanceof Array)){return error.na}if(e.length<2||t.length<2){return error.div0}var r=function s(e,t){var r=0;for(var n=0;n<e.length;n++){r+=Math.pow(e[n]-t,2)}return r};var n=mathTrig.SUM(e)/e.length;var o=mathTrig.SUM(t)/t.length;var i=r(e,n)/(e.length-1);var a=r(t,o)/(t.length-1);return i/a};exports.FISHER=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return Math.log((1+e)/(1-e))/2};exports.FISHERINV=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}var t=Math.exp(2*e);return(t-1)/(t+1)};exports.FORECAST=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumberArray(utils.flatten(t));r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,t,r)){return error.value}var n=jStat.mean(r);var o=jStat.mean(t);var i=r.length;var a=0;var s=0;for(var l=0;l<i;l++){a+=(r[l]-n)*(t[l]-o);s+=Math.pow(r[l]-n,2)}var u=a/s;var d=o-u*n;return d+u*e};exports.FREQUENCY=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=e.length;var n=t.length;var o=[];for(var i=0;i<=n;i++){o[i]=0;for(var a=0;a<r;a++){if(i===0){if(e[a]<=t[0]){o[0]+=1}}else if(i<n){if(e[a]>t[i-1]&&e[a]<=t[i]){o[i]+=1}}else if(i===n){if(e[a]>t[n-1]){o[n]+=1}}}}return o};exports.GAMMA=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}if(e===0){return error.num}if(parseInt(e,10)===e&&e<0){return error.num}return jStat.gammafn(e)};exports.GAMMA.DIST=function(e,t,r,n){if(arguments.length!==4){return error.na}if(e<0||t<=0||r<=0){return error.value}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return error.value}return n?jStat.gamma.cdf(e,t,r,true):jStat.gamma.pdf(e,t,r,false)};exports.GAMMA.INV=function(e,t,r){if(arguments.length!==3){return error.na}if(e<0||e>1||t<=0||r<=0){return error.num}if(typeof e!=="number"||typeof t!=="number"||typeof r!=="number"){return error.value}return jStat.gamma.inv(e,t,r)};exports.GAMMALN=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return jStat.gammaln(e)};exports.GAMMALN.PRECISE=function(e){if(arguments.length!==1){return error.na}if(e<=0){return error.num}if(typeof e!=="number"){return error.value}return jStat.gammaln(e)};exports.GAUSS=function(e){e=utils.parseNumber(e);if(e instanceof Error){return e}return jStat.normal.cdf(e,0,1)-.5};exports.GEOMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}return jStat.geomean(e)};exports.GROWTH=function(e,t,r,n){e=utils.parseNumberArray(e);if(e instanceof Error){return e}var o;if(t===undefined){t=[];for(o=1;o<=e.length;o++){t.push(o)}}if(r===undefined){r=[];for(o=1;o<=e.length;o++){r.push(o)}}t=utils.parseNumberArray(t);r=utils.parseNumberArray(r);if(utils.anyIsError(t,r)){return error.value}if(n===undefined){n=true}var i=e.length;var a=0;var s=0;var l=0;var u=0;for(o=0;o<i;o++){var d=t[o];var f=Math.log(e[o]);a+=d;s+=f;l+=d*f;u+=d*d}a/=i;s/=i;l/=i;u/=i;var c;var h;if(n){c=(l-a*s)/(u-a*a);h=s-c*a}else{c=l/u;h=0}var m=[];for(o=0;o<r.length;o++){m.push(Math.exp(h+c*r[o]))}return m};exports.HARMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=e.length;var r=0;for(var n=0;n<t;n++){r+=1/e[n]}return t/r};exports.HYPGEOM={};exports.HYPGEOM.DIST=function(e,t,r,n,o){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);n=utils.parseNumber(n);if(utils.anyIsError(e,t,r,n)){return error.value}function i(e,t,r,n){return mathTrig.COMBIN(r,e)*mathTrig.COMBIN(n-r,t-e)/mathTrig.COMBIN(n,t)}function a(e,t,r,n){var o=0;for(var a=0;a<=e;a++){o+=i(a,t,r,n)}return o}return o?a(e,t,r,n):i(e,t,r,n)};exports.INTERCEPT=function(e,t){e=utils.parseNumberArray(e);t=utils.parseNumberArray(t);if(utils.anyIsError(e,t)){return error.value}if(e.length!==t.length){return error.na}return exports.FORECAST(0,e,t)};exports.KURT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=jStat.mean(e);var r=e.length;var n=0;for(var o=0;o<r;o++){n+=Math.pow(e[o]-t,4)}n=n/Math.pow(jStat.stdev(e,true),4);return r*(r+1)/((r-1)*(r-2)*(r-3))*n-3*(r-1)*(r-1)/((r-2)*(r-3))};exports.LARGE=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return e}return e.sort(function(e,t){return t-e})[t-1]};exports.LINEST=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=jStat.mean(e);var n=jStat.mean(t);var o=t.length;var i=0;var a=0;for(var s=0;s<o;s++){i+=(t[s]-n)*(e[s]-r);a+=Math.pow(t[s]-n,2)}var l=i/a;var u=r-l*n;return[l,u]};exports.LOGEST=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}for(var r=0;r<e.length;r++){e[r]=Math.log(e[r])}var n=exports.LINEST(e,t);n[0]=Math.round(Math.exp(n[0])*1e6)/1e6;n[1]=Math.round(Math.exp(n[1])*1e6)/1e6;return n};exports.LOGNORM={};exports.LOGNORM.DIST=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return n?jStat.lognormal.cdf(e,t,r):jStat.lognormal.pdf(e,t,r)};exports.LOGNORM.INV=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return jStat.lognormal.inv(e,t,r)};exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return e.length===0?0:Math.max.apply(Math,e)};exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return e.length===0?0:Math.max.apply(Math,e)};exports.MEDIAN=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));var t=jStat.median(e);if(isNaN(t)){t=error.num}return t};exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return e.length===0?0:Math.min.apply(Math,e)};exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return e.length===0?0:Math.min.apply(Math,e)};exports.MODE={};exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=e.length;var r={};var n=[];var o=0;var i;for(var a=0;a<t;a++){i=e[a];r[i]=r[i]?r[i]+1:1;if(r[i]>o){o=r[i];n=[]}if(r[i]===o){n[n.length]=i}}return n};exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}return exports.MODE.MULT(e).sort(function(e,t){return e-t})[0]};exports.NEGBINOM={};exports.NEGBINOM.DIST=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return n?jStat.negbin.cdf(e,t,r):jStat.negbin.pdf(e,t,r)};exports.NORM={};exports.NORM.DIST=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}if(r<=0){return error.num}return n?jStat.normal.cdf(e,t,r):jStat.normal.pdf(e,t,r)};exports.NORM.INV=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return jStat.normal.inv(e,t,r)};exports.NORM.S={};exports.NORM.S.DIST=function(e,t){e=utils.parseNumber(e);if(e instanceof Error){return error.value}return t?jStat.normal.cdf(e,0,1):jStat.normal.pdf(e,0,1)};exports.NORM.S.INV=function(e){e=utils.parseNumber(e);if(e instanceof Error){return error.value}return jStat.normal.inv(e,0,1)};exports.PEARSON=function(e,t){t=utils.parseNumberArray(utils.flatten(t));e=utils.parseNumberArray(utils.flatten(e));if(utils.anyIsError(t,e)){return error.value}var r=jStat.mean(e);var n=jStat.mean(t);var o=e.length;var i=0;var a=0;var s=0;for(var l=0;l<o;l++){i+=(e[l]-r)*(t[l]-n);a+=Math.pow(e[l]-r,2);s+=Math.pow(t[l]-n,2)}return i/Math.sqrt(a*s)};exports.PERCENTILE={};exports.PERCENTILE.EXC=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}e=e.sort(function(e,t){{return e-t}});var r=e.length;if(t<1/(r+1)||t>1-1/(r+1)){return error.num}var n=t*(r+1)-1;var o=Math.floor(n);return utils.cleanFloat(n===o?e[n]:e[o]+(n-o)*(e[o+1]-e[o]))};exports.PERCENTILE.INC=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}e=e.sort(function(e,t){return e-t});var r=e.length;var n=t*(r-1);var o=Math.floor(n);return utils.cleanFloat(n===o?e[n]:e[o]+(n-o)*(e[o+1]-e[o]))};exports.PERCENTRANK={};exports.PERCENTRANK.EXC=function(e,t,r){r=r===undefined?3:r;e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}e=e.sort(function(e,t){return e-t});var n=misc.UNIQUE.apply(null,e);var o=e.length;var i=n.length;var a=Math.pow(10,r);var s=0;var l=false;var u=0;while(!l&&u<i){if(t===n[u]){s=(e.indexOf(n[u])+1)/(o+1);l=true}else if(t>=n[u]&&(t<n[u+1]||u===i-1)){s=(e.indexOf(n[u])+1+(t-n[u])/(n[u+1]-n[u]))/(o+1);l=true}u++}return Math.floor(s*a)/a};exports.PERCENTRANK.INC=function(e,t,r){r=r===undefined?3:r;e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}e=e.sort(function(e,t){return e-t});var n=misc.UNIQUE.apply(null,e);var o=e.length;var i=n.length;var a=Math.pow(10,r);var s=0;var l=false;var u=0;while(!l&&u<i){if(t===n[u]){s=e.indexOf(n[u])/(o-1);l=true}else if(t>=n[u]&&(t<n[u+1]||u===i-1)){s=(e.indexOf(n[u])+(t-n[u])/(n[u+1]-n[u]))/(o-1);l=true}u++}return Math.floor(s*a)/a};exports.PERMUT=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return mathTrig.FACT(e)/mathTrig.FACT(e-t)};exports.PERMUTATIONA=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return Math.pow(e,t)};exports.PHI=function(e){e=utils.parseNumber(e);if(e instanceof Error){return error.value}return Math.exp(-.5*e*e)/SQRT2PI};exports.POISSON={};exports.POISSON.DIST=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return r?jStat.poisson.cdf(e,t):jStat.poisson.pdf(e,t)};exports.PROB=function(e,t,r,n){if(r===undefined){return 0}n=n===undefined?r:n;e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));r=utils.parseNumber(r);n=utils.parseNumber(n);if(utils.anyIsError(e,t,r,n)){return error.value}if(r===n){return e.indexOf(r)>=0?t[e.indexOf(r)]:0}var o=e.sort(function(e,t){return e-t});var i=o.length;var a=0;for(var s=0;s<i;s++){if(o[s]>=r&&o[s]<=n){a+=t[e.indexOf(o[s])]}}return a};exports.QUARTILE={};exports.QUARTILE.EXC=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}};exports.QUARTILE.INC=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}};exports.RANK={};exports.RANK.AVG=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}t=utils.flatten(t);r=r||false;var n=r?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(n);var o=t.length;var i=0;for(var a=0;a<o;a++){if(t[a]===e){i++}}return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1};exports.RANK.EQ=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}r=r||false;var n=r?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(n);return t.indexOf(e)+1};exports.ROW=function(e,t){if(arguments.length!==2){return error.na}if(t<0){return error.num}if(!(e instanceof Array)||typeof t!=="number"){return error.value}if(e.length===0){return undefined}return jStat.row(e,t)};exports.ROWS=function(e){if(arguments.length!==1){return error.na}if(!(e instanceof Array)){return error.value}if(e.length===0){return 0}return jStat.rows(e)};exports.RSQ=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}return Math.pow(exports.PEARSON(e,t),2)};exports.SKEW=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=jStat.mean(e);var r=e.length;var n=0;for(var o=0;o<r;o++){n+=Math.pow(e[o]-t,3)}return r*n/((r-1)*(r-2)*Math.pow(jStat.stdev(e,true),3))};exports.SKEW.P=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error){return e}var t=jStat.mean(e);var r=e.length;var n=0;var o=0;for(var i=0;i<r;i++){o+=Math.pow(e[i]-t,3);n+=Math.pow(e[i]-t,2)}o=o/r;n=n/r;return o/Math.pow(n,3/2)};exports.SLOPE=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=jStat.mean(t);var n=jStat.mean(e);var o=t.length;var i=0;var a=0;for(var s=0;s<o;s++){i+=(t[s]-r)*(e[s]-n);a+=Math.pow(t[s]-r,2)}return i/a};exports.SMALL=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return e}return e.sort(function(e,t){return e-t})[t-1]};exports.STANDARDIZE=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return(e-t)/r};exports.STDEV={};exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);var t=Math.sqrt(e);if(isNaN(t)){t=error.num}return t};exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);var t=Math.sqrt(e);return t};exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);var t=Math.sqrt(e);return t};exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);var t=Math.sqrt(e);if(isNaN(t)){t=error.num}return t};exports.STEYX=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=jStat.mean(t);var n=jStat.mean(e);var o=t.length;var i=0;var a=0;var s=0;for(var l=0;l<o;l++){i+=Math.pow(e[l]-n,2);a+=(t[l]-r)*(e[l]-n);s+=Math.pow(t[l]-r,2)}return Math.sqrt((i-a*a/s)/(o-2))};exports.TRANSPOSE=function(e){if(!e){return error.na}return jStat.transpose(e)};exports.T=text.T;exports.T.DIST=function(e,t,r){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return r?jStat.studentt.cdf(e,t):jStat.studentt.pdf(e,t)};exports.T.DIST["2T"]=function(e,t){if(arguments.length!==2){return error.na}if(e<0||t<1){return error.num}if(typeof e!=="number"||typeof t!=="number"){return error.value}return(1-jStat.studentt.cdf(e,t))*2};exports.T.DIST.RT=function(e,t){if(arguments.length!==2){return error.na}if(e<0||t<1){return error.num}if(typeof e!=="number"||typeof t!=="number"){return error.value}return 1-jStat.studentt.cdf(e,t)};exports.T.INV=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}return jStat.studentt.inv(e,t)};exports.T.INV["2T"]=function(e,t){e=utils.parseNumber(e);t=utils.parseNumber(t);if(e<=0||e>1||t<1){return error.num}if(utils.anyIsError(e,t)){return error.value}return Math.abs(jStat.studentt.inv(e/2,t))};exports.T.TEST=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));if(utils.anyIsError(e,t)){return error.value}var r=jStat.mean(e);var n=jStat.mean(t);var o=0;var i=0;var a;for(a=0;a<e.length;a++){o+=Math.pow(e[a]-r,2)}for(a=0;a<t.length;a++){i+=Math.pow(t[a]-n,2)}o=o/(e.length-1);i=i/(t.length-1);var s=Math.abs(r-n)/Math.sqrt(o/e.length+i/t.length);return exports.T.DIST["2T"](s,e.length+t.length-2)};exports.TREND=function(e,t,r){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumberArray(utils.flatten(t));r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,t,r)){return error.value}var n=exports.LINEST(e,t);var o=n[0];var i=n[1];var a=[];r.forEach(function(e){a.push(o*e+i)});return a};exports.TRIMMEAN=function(e,t){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}var r=mathTrig.FLOOR(e.length*t,2)/2;return jStat.mean(utils.initial(utils.rest(e.sort(function(e,t){return e-t}),r),r))};exports.VAR={};exports.VAR.P=function(){var e=utils.numbers(utils.flatten(arguments));var t=e.length;var r=0;var n=exports.AVERAGE(e);var o;for(var i=0;i<t;i++){r+=Math.pow(e[i]-n,2)}o=r/t;if(isNaN(o)){o=error.num}return o};exports.VAR.S=function(){var e=utils.numbers(utils.flatten(arguments));var t=e.length;var r=0;var n=exports.AVERAGE(e);for(var o=0;o<t;o++){r+=Math.pow(e[o]-n,2)}return r/(t-1)};exports.VARA=function(){var e=utils.flatten(arguments);var t=e.length;var r=0;var n=0;var o=exports.AVERAGEA(e);for(var i=0;i<t;i++){var a=e[i];if(typeof a==="number"){r+=Math.pow(a-o,2)}else if(a===true){r+=Math.pow(1-o,2)}else{r+=Math.pow(0-o,2)}if(a!==null){n++}}return r/(n-1)};exports.VARPA=function(){var e=utils.flatten(arguments);var t=e.length;var r=0;var n=0;var o=exports.AVERAGEA(e);var i;for(var a=0;a<t;a++){var s=e[a];if(typeof s==="number"){r+=Math.pow(s-o,2)}else if(s===true){r+=Math.pow(1-o,2)}else{r+=Math.pow(0-o,2)}if(s!==null){n++}}i=r/n;if(isNaN(i)){i=error.num}return i};exports.WEIBULL={};exports.WEIBULL.DIST=function(e,t,r,n){e=utils.parseNumber(e);t=utils.parseNumber(t);r=utils.parseNumber(r);if(utils.anyIsError(e,t,r)){return error.value}return n?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)};exports.Z={};exports.Z.TEST=function(e,t,r){e=utils.parseNumberArray(utils.flatten(e));t=utils.parseNumber(t);if(utils.anyIsError(e,t)){return error.value}r=r||exports.STDEV.S(e);var n=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(r/Math.sqrt(n)),true)}},function(e,t,r){var n=r(0);var o=r(2);var i=new Date(1900,0,1);var a=[undefined,0,1,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,2,3,4,5,6,0];var s=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];var l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],undefined,undefined,undefined,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];t.DATE=function(e,t,r){var i;e=o.parseNumber(e);t=o.parseNumber(t);r=o.parseNumber(r);if(o.anyIsError(e,t,r)){i=n.value}else if(e<0||t<0||r<0){i=n.num}else{i=new Date(e,t-1,r)}return i};t.DATEVALUE=function(e){if(typeof e!=="string"){return n.value}var t=Date.parse(e);if(isNaN(t)){return n.value}if(t<=-22038912e5){return(t-i)/864e5+1}return(t-i)/864e5+2};t.DAY=function(e){var t=o.parseDate(e);if(t instanceof Error){return t}return t.getDate()};t.DAYS=function(e,t){e=o.parseDate(e);t=o.parseDate(t);if(e instanceof Error){return e}if(t instanceof Error){return t}return f(e)-f(t)};t.DAYS360=function(e,t,r){r=o.parseBool(r);e=o.parseDate(e);t=o.parseDate(t);if(e instanceof Error){return e}if(t instanceof Error){return t}if(r instanceof Error){return r}var n=e.getMonth();var i=t.getMonth();var a,s;if(r){a=e.getDate()===31?30:e.getDate();s=t.getDate()===31?30:t.getDate()}else{var l=new Date(e.getFullYear(),n+1,0).getDate();var u=new Date(t.getFullYear(),i+1,0).getDate();a=e.getDate()===l?30:e.getDate();if(t.getDate()===u){if(a<30){i++;s=1}else{s=30}}else{s=t.getDate()}}return 360*(t.getFullYear()-e.getFullYear())+30*(i-n)+(s-a)};t.EDATE=function(e,t){e=o.parseDate(e);if(e instanceof Error){return e}if(isNaN(t)){return n.value}t=parseInt(t,10);e.setMonth(e.getMonth()+t);return f(e)};t.EOMONTH=function(e,t){e=o.parseDate(e);if(e instanceof Error){return e}if(isNaN(t)){return n.value}t=parseInt(t,10);return f(new Date(e.getFullYear(),e.getMonth()+t+1,0))};t.HOUR=function(e){e=o.parseDate(e);if(e instanceof Error){return e}return e.getHours()};t.INTERVAL=function(e){if(typeof e!=="number"&&typeof e!=="string"){return n.value}else{e=parseInt(e,10)}var t=Math.floor(e/94608e4);e=e%94608e4;var r=Math.floor(e/2592e3);e=e%2592e3;var o=Math.floor(e/86400);e=e%86400;var i=Math.floor(e/3600);e=e%3600;var a=Math.floor(e/60);e=e%60;var s=e;t=t>0?t+"Y":"";r=r>0?r+"M":"";o=o>0?o+"D":"";i=i>0?i+"H":"";a=a>0?a+"M":"";s=s>0?s+"S":"";return"P"+t+r+o+"T"+i+a+s};t.ISOWEEKNUM=function(e){e=o.parseDate(e);if(e instanceof Error){return e}e.setHours(0,0,0);e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)};t.MINUTE=function(e){e=o.parseDate(e);if(e instanceof Error){return e}return e.getMinutes()};t.MONTH=function(e){e=o.parseDate(e);if(e instanceof Error){return e}return e.getMonth()+1};t.NETWORKDAYS=function(e,t,r){return this.NETWORKDAYS.INTL(e,t,1,r)};t.NETWORKDAYS.INTL=function(e,t,r,i){e=o.parseDate(e);if(e instanceof Error){return e}t=o.parseDate(t);if(t instanceof Error){return t}if(r===undefined){r=l[1]}else{r=l[r]}if(!(r instanceof Array)){return n.value}if(i===undefined){i=[]}else if(!(i instanceof Array)){i=[i]}for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error){return s}i[a]=s}var u=(t-e)/(1e3*60*60*24)+1;var d=u;var f=e;for(a=0;a<u;a++){var c=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay();var h=false;if(c===r[0]||c===r[1]){h=true}for(var m=0;m<i.length;m++){var p=i[m];if(p.getDate()===f.getDate()&&p.getMonth()===f.getMonth()&&p.getFullYear()===f.getFullYear()){h=true;break}}if(h){d--}f.setDate(f.getDate()+1)}return d};t.NOW=function(){return new Date};t.SECOND=function(e){e=o.parseDate(e);if(e instanceof Error){return e}return e.getSeconds()};t.TIME=function(e,t,r){e=o.parseNumber(e);t=o.parseNumber(t);r=o.parseNumber(r);if(o.anyIsError(e,t,r)){return n.value}if(e<0||t<0||r<0){return n.num}return(3600*e+60*t+r)/86400};t.TIMEVALUE=function(e){e=o.parseDate(e);if(e instanceof Error){return e}return(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400};t.TODAY=function(){return new Date};t.WEEKDAY=function(e,t){e=o.parseDate(e);if(e instanceof Error){return e}if(t===undefined){t=1}var r=e.getDay();return s[t][r]};t.WEEKNUM=function(e,t){e=o.parseDate(e);if(e instanceof Error){return e}if(t===undefined){t=1}if(t===21){return this.ISOWEEKNUM(e)}var r=a[t];var n=new Date(e.getFullYear(),0,1);var i=n.getDay()<r?1:0;n-=Math.abs(n.getDay()-r)*24*60*60*1e3;return Math.floor((e-n)/(1e3*60*60*24)/7+1)+i};t.WORKDAY=function(e,t,r){return this.WORKDAY.INTL(e,t,1,r)};t.WORKDAY.INTL=function(e,t,r,i){e=o.parseDate(e);if(e instanceof Error){return e}t=o.parseNumber(t);if(t instanceof Error){return t}if(t<0){return n.num}if(r===undefined){r=l[1]}else{r=l[r]}if(!(r instanceof Array)){return n.value}if(i===undefined){i=[]}else if(!(i instanceof Array)){i=[i]}for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error){return s}i[a]=s}var u=0;while(u<t){e.setDate(e.getDate()+1);var d=e.getDay();if(d===r[0]||d===r[1]){continue}for(var f=0;f<i.length;f++){var c=i[f];if(c.getDate()===e.getDate()&&c.getMonth()===e.getMonth()&&c.getFullYear()===e.getFullYear()){u--;break}}u++}return e};t.YEAR=function(e){e=o.parseDate(e);if(e instanceof Error){return e}return e.getFullYear()};function u(e){return new Date(e,1,29).getMonth()===1}function d(e,t){return Math.ceil((t-e)/1e3/60/60/24)}t.YEARFRAC=function(e,t,r){e=o.parseDate(e);if(e instanceof Error){return e}t=o.parseDate(t);if(t instanceof Error){return t}r=r||0;var n=e.getDate();var i=e.getMonth()+1;var a=e.getFullYear();var s=t.getDate();var l=t.getMonth()+1;var f=t.getFullYear();switch(r){case 0:if(n===31&&s===31){n=30;s=30}else if(n===31){n=30}else if(n===30&&s===31){s=30}return(s+l*30+f*360-(n+i*30+a*360))/360;case 1:var c=function g(e,t){var r=e.getFullYear();var n=new Date(r,2,1);if(u(r)&&e<n&&t>=n){return true}var o=t.getFullYear();var i=new Date(o,2,1);return u(o)&&t>=i&&e<i};var h=365;if(a===f||a+1===f&&(i>l||i===l&&n>=s)){if(a===f&&u(a)||c(e,t)||l===1&&s===29){h=366}return d(e,t)/h}var m=f-a+1;var p=(new Date(f+1,0,1)-new Date(a,0,1))/1e3/60/60/24;var v=p/m;return d(e,t)/v;case 2:return d(e,t)/360;case 3:return d(e,t)/365;case 4:return(s+l*30+f*360-(n+i*30+a*360))/360}};function f(e){var t=e>-22038912e5?2:1;return(e-i)/864e5+t}},function(e,t,r){var n=r(0);t.CELL=function(){throw new Error("CELL is not implemented")};t.ERROR={};t.ERROR.TYPE=function(e){switch(e){case n.nil:return 1;case n.div0:return 2;case n.value:return 3;case n.ref:return 4;case n.name:return 5;case n.num:return 6;case n.na:return 7;case n.data:return 8}return n.na};t.INFO=function(){throw new Error("INFO is not implemented")};t.ISBLANK=function(e){return e===null};t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)};t.ISERR=function(e){return[n.value,n.ref,n.div0,n.num,n.name,n.nil].indexOf(e)>=0||typeof e==="number"&&(isNaN(e)||!isFinite(e))};t.ISERROR=function(e){return t.ISERR(e)||e===n.na};t.ISEVEN=function(e){return Math.floor(Math.abs(e))&1?false:true};t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")};t.ISLOGICAL=function(e){return e===true||e===false};t.ISNA=function(e){return e===n.na};t.ISNONTEXT=function(e){return typeof e!=="string"};t.ISNUMBER=function(e){return typeof e==="number"&&!isNaN(e)&&isFinite(e)};t.ISODD=function(e){return Math.floor(Math.abs(e))&1?true:false};t.ISREF=function(){throw new Error("ISREF is not implemented")};t.ISTEXT=function(e){return typeof e==="string"};t.N=function(e){if(this.ISNUMBER(e)){return e}if(e instanceof Date){return e.getTime()}if(e===true){return 1}if(e===false){return 0}if(this.ISERROR(e)){return e}return 0};t.NA=function(){return n.na};t.SHEET=function(){throw new Error("SHEET is not implemented")};t.SHEETS=function(){throw new Error("SHEETS is not implemented")};t.TYPE=function(e){if(this.ISNUMBER(e)){return 1}if(this.ISTEXT(e)){return 2}if(this.ISLOGICAL(e)){return 4}if(this.ISERROR(e)){return 16}if(Array.isArray(e)){return 64}}},function(e,t,r){var n=r(2);var o=r(0);var i=r(14);t.ASC=function(){throw new Error("ASC is not implemented")};t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")};t.CHAR=function(e){e=n.parseNumber(e);if(e instanceof Error){return e}return String.fromCharCode(e)};t.CLEAN=function(e){e=e||"";var t=/[\0-\x1F]/g;return e.replace(t,"")};t.CODE=function(e){e=e||"";var t=e.charCodeAt(0);if(isNaN(t)){t=o.na}return t};t.CONCATENATE=function(){var e=n.flatten(arguments);var t=0;while((t=e.indexOf(true))>-1){e[t]="TRUE"}var r=0;while((r=e.indexOf(false))>-1){e[r]="FALSE"}return e.join("")};t.DBCS=function(){throw new Error("DBCS is not implemented")};t.DOLLAR=function(e,t){t=t===undefined?2:t;e=n.parseNumber(e);t=n.parseNumber(t);if(n.anyIsError(e,t)){return o.value}var r="";if(t<=0){e=Math.round(e*Math.pow(10,t))/Math.pow(10,t);r="($0,0)"}else if(t>0){r="($0,0."+new Array(t+1).join("0")+")"}return i(e).format(r)};t.EXACT=function(e,t){if(arguments.length!==2){return o.na}return e===t};t.FIND=function(e,t,r){if(arguments.length<2){return o.na}r=r===undefined?0:r;return t?t.indexOf(e,r-1)+1:null};t.FIXED=function(e,t,r){t=t===undefined?2:t;r=r===undefined?false:r;e=n.parseNumber(e);t=n.parseNumber(t);if(n.anyIsError(e,t)){return o.value}var a=r?"0":"0,0";if(t<=0){e=Math.round(e*Math.pow(10,t))/Math.pow(10,t)}else if(t>0){a+="."+new Array(t+1).join("0")}return i(e).format(a)};t.HTML2TEXT=function(e){var t="";if(e){if(e instanceof Array){e.forEach(function(e){if(t!==""){t+="\n"}t+=e.replace(/<(?:.|\n)*?>/gm,"")})}else{t=e.replace(/<(?:.|\n)*?>/gm,"")}}return t};t.LEFT=function(e,t){t=t===undefined?1:t;t=n.parseNumber(t);if(t instanceof Error||typeof e!=="string"){return o.value}return e?e.substring(0,t):null};t.LEN=function(e){if(arguments.length===0){return o.error}if(typeof e==="string"){return e?e.length:0}if(e.length){return e.length}return o.value};t.LOWER=function(e){if(typeof e!=="string"){return o.value}return e?e.toLowerCase():e};t.MID=function(e,t,r){t=n.parseNumber(t);r=n.parseNumber(r);if(n.anyIsError(t,r)||typeof e!=="string"){return r}var o=t-1;var i=o+r;return e.substring(o,i)};t.NUMBERVALUE=function(e,t,r){t=typeof t==="undefined"?".":t;r=typeof r==="undefined"?",":r;return Number(e.replace(t,".").replace(r,""))};t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")};t.PROPER=function(e){if(e===undefined||e.length===0){return o.value}if(e===true){e="TRUE"}if(e===false){e="FALSE"}if(isNaN(e)&&typeof e==="number"){return o.value}if(typeof e==="number"){e=""+e}return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})};t.REGEXEXTRACT=function(e,t){if(arguments.length<2){return o.na}var r=e.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null};t.REGEXMATCH=function(e,t,r){if(arguments.length<2){return o.na}var n=e.match(new RegExp(t));return r?n:!!n};t.REGEXREPLACE=function(e,t,r){if(arguments.length<3){return o.na}return e.replace(new RegExp(t),r)};t.REPLACE=function(e,t,r,i){t=n.parseNumber(t);r=n.parseNumber(r);if(n.anyIsError(t,r)||typeof e!=="string"||typeof i!=="string"){return o.value}return e.substr(0,t-1)+i+e.substr(t-1+r)};t.REPT=function(e,t){t=n.parseNumber(t);if(t instanceof Error){return t}return new Array(t+1).join(e)};t.RIGHT=function(e,t){t=t===undefined?1:t;t=n.parseNumber(t);if(t instanceof Error){return t}return e?e.substring(e.length-t):o.na};t.SEARCH=function(e,t,r){var n;if(typeof e!=="string"||typeof t!=="string"){return o.value}r=r===undefined?0:r;n=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1;return n===0?o.value:n};t.SPLIT=function(e,t){return e.split(t)};t.SUBSTITUTE=function(e,t,r,n){if(arguments.length<2){return o.na}if(!e||!t||!r){return e}else if(n===undefined){return e.replace(new RegExp(t,"g"),r)}else{var i=0;var a=0;while(e.indexOf(t,i)>0){i=e.indexOf(t,i+1);a++;if(a===n){return e.substring(0,i)+r+e.substring(i+t.length)}}}};t.T=function(e){return typeof e==="string"?e:""};t.TEXT=function(e,t){e=n.parseNumber(e);if(n.anyIsError(e)){return o.na}return i(e).format(t)};t.TRIM=function(e){if(typeof e!=="string"){return o.value}return e.replace(/ +/g," ").trim()};t.UNICHAR=t.CHAR;t.UNICODE=t.CODE;t.UPPER=function(e){if(typeof e!=="string"){return o.value}return e.toUpperCase()};t.VALUE=function(e){if(typeof e!=="string"){return o.value}var t=i().unformat(e);return t===void 0?0:t}},function(e,t,r){"use strict";t.__esModule=true;t.rowLabelToIndex=n;t.rowIndexToLabel=o;t.columnLabelToIndex=s;t.columnIndexToLabel=l;t.extractLabel=d;t.toLabel=f;function n(e){var t=parseInt(e,10);if(isNaN(t)){t=-1}else{t=Math.max(t-1,-1)}return t}function o(e){var t="";if(e>=0){t=""+(e+1)}return t}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var a=i.length;function s(e){var t=0;if(typeof e==="string"){e=e.toUpperCase();for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1){t+=Math.pow(a,n)*(i.indexOf(e[r])+1)}}--t;return t}function l(e){var t="";while(e>=0){t=String.fromCharCode(e%a+97)+t;e=Math.floor(e/a)-1}return t.toUpperCase()}var u=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function d(e){if(typeof e!=="string"||!u.test(e)){return[]}var t=e.toUpperCase().match(u),r=t[1],o=t[2],i=t[3],a=t[4];return[{index:n(a),label:a,isAbsolute:i==="$"},{index:s(o),label:o,isAbsolute:r==="$"}]}function f(e,t){var r=(e.isAbsolute?"$":"")+o(e.index);var n=(t.isAbsolute?"$":"")+l(t.index);return n+r}},function(e,t,r){"use strict";t.__esModule=true;var n=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"];
t["default"]=n},function(e,t,r){var n=r(0);var o=r(13).jStat;var i=r(8);var a=r(2);var s=r(32);function l(e){return/^[01]{1,10}$/.test(e)}t.BESSELI=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}return s.besseli(e,t)};t.BESSELJ=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}return s.besselj(e,t)};t.BESSELK=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}return s.besselk(e,t)};t.BESSELY=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}return s.bessely(e,t)};t.BIN2DEC=function(e){if(!l(e)){return n.num}var t=parseInt(e,2);var r=e.toString();if(r.length===10&&r.substring(0,1)==="1"){return parseInt(r.substring(1),2)-512}else{return t}};t.BIN2HEX=function(e,t){if(!l(e)){return n.num}var r=e.toString();if(r.length===10&&r.substring(0,1)==="1"){return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16)}var o=parseInt(e,2).toString(16);if(t===undefined){return o}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=o.length?i.REPT("0",t-o.length)+o:n.num}};t.BIN2OCT=function(e,t){if(!l(e)){return n.num}var r=e.toString();if(r.length===10&&r.substring(0,1)==="1"){return(1073741312+parseInt(r.substring(1),2)).toString(8)}var o=parseInt(e,2).toString(8);if(t===undefined){return o}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=o.length?i.REPT("0",t-o.length)+o:n.num}};t.BITAND=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}if(e<0||t<0){return n.num}if(Math.floor(e)!==e||Math.floor(t)!==t){return n.num}if(e>0xffffffffffff||t>0xffffffffffff){return n.num}return e&t};t.BITLSHIFT=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}if(e<0){return n.num}if(Math.floor(e)!==e){return n.num}if(e>0xffffffffffff){return n.num}if(Math.abs(t)>53){return n.num}return t>=0?e<<t:e>>-t};t.BITOR=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}if(e<0||t<0){return n.num}if(Math.floor(e)!==e||Math.floor(t)!==t){return n.num}if(e>0xffffffffffff||t>0xffffffffffff){return n.num}return e|t};t.BITRSHIFT=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}if(e<0){return n.num}if(Math.floor(e)!==e){return n.num}if(e>0xffffffffffff){return n.num}if(Math.abs(t)>53){return n.num}return t>=0?e>>t:e<<-t};t.BITXOR=function(e,t){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}if(e<0||t<0){return n.num}if(Math.floor(e)!==e||Math.floor(t)!==t){return n.num}if(e>0xffffffffffff||t>0xffffffffffff){return n.num}return e^t};t.COMPLEX=function(e,t,r){e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return e}r=r===undefined?"i":r;if(r!=="i"&&r!=="j"){return n.value}if(e===0&&t===0){return 0}else if(e===0){return t===1?r:t.toString()+r}else if(t===0){return e.toString()}else{var o=t>0?"+":"";return e.toString()+o+(t===1?r:t.toString()+r)}};t.CONVERT=function(e,t,r){e=a.parseNumber(e);if(e instanceof Error){return e}var o=[["a.u. of action","?",null,"action",false,false,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",false,false,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",false,false,4.35974417757576e-18],["a.u. of length","a?",null,"length",false,false,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",false,false,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",false,false,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",false,true,.514773333],["ampere","A",null,"electric_current",true,false,1],["ampere per meter","A/m",null,"magnetic_field_intensity",true,false,1],["ngstrm","",["ang"],"length",false,true,1e-10],["are","ar",null,"area",false,true,100],["astronomical unit","ua",null,"length",false,false,1.49597870691667e-11],["bar","bar",null,"pressure",false,false,1e5],["barn","b",null,"area",false,false,1e-28],["becquerel","Bq",null,"radioactivity",true,false,1],["bit","bit",["b"],"information",false,true,1],["btu","BTU",["btu"],"energy",false,true,1055.05585262],["byte","byte",null,"information",false,true,8],["candela","cd",null,"luminous_intensity",true,false,1],["candela per square metre","cd/m?",null,"luminance",true,false,1],["coulomb","C",null,"electric_charge",true,false,1],["cubic ngstrm","ang3",["ang^3"],"volume",false,true,1e-30],["cubic foot","ft3",["ft^3"],"volume",false,true,.028316846592],["cubic inch","in3",["in^3"],"volume",false,true,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",false,true,8.46786664623715e-47],["cubic metre","m?",null,"volume",true,true,1],["cubic mile","mi3",["mi^3"],"volume",false,true,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",false,true,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",false,true,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",false,true,.764554857984],["cup","cup",null,"volume",false,true,.0002365882365],["dalton","Da",["u"],"mass",false,false,1.66053886282828e-27],["day","d",["day"],"time",false,true,86400],["degree","",null,"angle",false,false,.0174532925199433],["degrees Rankine","Rank",null,"temperature",false,true,.555555555555556],["dyne","dyn",["dy"],"force",false,true,1e-5],["electronvolt","eV",["ev"],"energy",false,true,1.60217656514141],["ell","ell",null,"length",false,true,1.143],["erg","erg",["e"],"energy",false,true,1e-7],["farad","F",null,"electric_capacitance",true,false,1],["fluid ounce","oz",null,"volume",false,true,295735295625e-16],["foot","ft",null,"length",false,true,.3048],["foot-pound","flb",null,"energy",false,true,1.3558179483314],["gal","Gal",null,"acceleration",false,false,.01],["gallon","gal",null,"volume",false,true,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",false,true,1],["grain","grain",null,"mass",false,true,647989e-10],["gram","g",null,"mass",false,true,.001],["gray","Gy",null,"absorbed_dose",true,false,1],["gross registered ton","GRT",["regton"],"volume",false,true,2.8316846592],["hectare","ha",null,"area",false,true,1e4],["henry","H",null,"inductance",true,false,1],["hertz","Hz",null,"frequency",true,false,1],["horsepower","HP",["h"],"power",false,true,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",false,true,2684519.538],["hour","h",["hr"],"time",false,true,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",false,true,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",false,true,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",false,true,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",false,true,1016.046909],["inch","in",null,"length",false,true,.0254],["international acre","uk_acre",null,"area",false,true,4046.8564224],["IT calorie","cal",null,"energy",false,true,4.1868],["joule","J",null,"energy",true,true,1],["katal","kat",null,"catalytic_activity",true,false,1],["kelvin","K",["kel"],"temperature",true,true,1],["kilogram","kg",null,"mass",true,true,1],["knot","kn",null,"speed",false,true,.514444444444444],["light-year","ly",null,"length",false,true,9460730472580800],["litre","L",["l","lt"],"volume",false,true,.001],["lumen","lm",null,"luminous_flux",true,false,1],["lux","lx",null,"illuminance",true,false,1],["maxwell","Mx",null,"magnetic_flux",false,false,1e-18],["measurement ton","MTON",null,"volume",false,true,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",false,true,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",true,true,1],["meter per second squared","m?s??",null,"acceleration",true,false,1],["parsec","pc",["parsec"],"length",false,true,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",true,false,1],["metre","m",null,"length",true,true,1],["miles per hour","mph",null,"speed",false,true,.44704],["millimetre of mercury","mmHg",null,"pressure",false,false,133.322],["minute","?",null,"angle",false,false,.000290888208665722],["minute","min",["mn"],"time",false,true,60],["modern teaspoon","tspm",null,"volume",false,true,5e-6],["mole","mol",null,"amount_of_substance",true,false,1],["morgen","Morgen",null,"area",false,true,2500],["n.u. of action","?",null,"action",false,false,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",false,false,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",false,false,299792458],["n.u. of time","?/(me?c??)",null,"time",false,false,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",false,true,1852],["newton","N",null,"force",true,true,1],["rsted","Oe ",null,"magnetic_field_intensity",false,false,79.5774715459477],["ohm","",null,"electric_resistance",true,false,1],["ounce mass","ozm",null,"mass",false,true,.028349523125],["pascal","Pa",null,"pressure",true,false,1],["pascal second","Pa?s",null,"dynamic_viscosity",true,false,1],["pferdestrke","PS",null,"power",false,true,735.49875],["phot","ph",null,"illuminance",false,false,1e-4],["pica (1/6 inch)","pica",null,"length",false,true,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",false,true,.00423333333333333],["poise","P",null,"dynamic_viscosity",false,false,.1],["pond","pond",null,"force",false,true,.00980665],["pound force","lbf",null,"force",false,true,4.4482216152605],["pound mass","lbm",null,"mass",false,true,.45359237],["quart","qt",null,"volume",false,true,.000946352946],["radian","rad",null,"angle",true,false,1],["second","?",null,"angle",false,false,484813681109536e-20],["second","s",["sec"],"time",true,true,1],["short hundredweight","cwt",["shweight"],"mass",false,true,45.359237],["siemens","S",null,"electrical_conductance",true,false,1],["sievert","Sv",null,"equivalent_dose",true,false,1],["slug","sg",null,"mass",false,true,14.59390294],["square ngstrm","ang2",["ang^2"],"area",false,true,1e-20],["square foot","ft2",["ft^2"],"area",false,true,.09290304],["square inch","in2",["in^2"],"area",false,true,64516e-8],["square light-year","ly2",["ly^2"],"area",false,true,8.95054210748189e31],["square meter","m?",null,"area",true,true,1],["square mile","mi2",["mi^2"],"area",false,true,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",false,true,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",false,true,1792111111111e-17],["square yard","yd2",["yd^2"],"area",false,true,.83612736],["statute mile","mi",null,"length",false,true,1609.344],["steradian","sr",null,"solid_angle",true,false,1],["stilb","sb",null,"luminance",false,false,1e-4],["stokes","St",null,"kinematic_viscosity",false,false,1e-4],["stone","stone",null,"mass",false,true,6.35029318],["tablespoon","tbs",null,"volume",false,true,147868e-10],["teaspoon","tsp",null,"volume",false,true,492892e-11],["tesla","T",null,"magnetic_flux_density",true,true,1],["thermodynamic calorie","c",null,"energy",false,true,4.184],["ton","ton",null,"mass",false,true,907.18474],["tonne","t",null,"mass",false,false,1e3],["U.K. pint","uk_pt",null,"volume",false,true,.00056826125],["U.S. bushel","bushel",null,"volume",false,true,.03523907],["U.S. oil barrel","barrel",null,"volume",false,true,.158987295],["U.S. pint","pt",["us_pt"],"volume",false,true,.000473176473],["U.S. survey mile","survey_mi",null,"length",false,true,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",false,true,4046.87261],["volt","V",null,"voltage",true,false,1],["watt","W",null,"power",true,true,1],["watt-hour","Wh",["wh"],"energy",false,true,3600],["weber","Wb",null,"magnetic_flux",true,false,1],["yard","yd",null,"length",false,true,.9144],["year","yr",null,"time",false,true,31557600]];var i={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]};var s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};var l=null;var u=null;var d=t;var f=r;var c=1;var h=1;var m;for(var p=0;p<o.length;p++){m=o[p][2]===null?[]:o[p][2];if(o[p][1]===d||m.indexOf(d)>=0){l=o[p]}if(o[p][1]===f||m.indexOf(f)>=0){u=o[p]}}if(l===null){var v=i[t.substring(0,2)];var g=s[t.substring(0,1)];if(t.substring(0,2)==="da"){g=["dekao",10,"da"]}if(v){c=v[2];d=t.substring(2)}else if(g){c=g[1];d=t.substring(g[2].length)}for(var w=0;w<o.length;w++){m=o[w][2]===null?[]:o[w][2];if(o[w][1]===d||m.indexOf(d)>=0){l=o[w]}}}if(u===null){var b=i[r.substring(0,2)];var y=s[r.substring(0,1)];if(r.substring(0,2)==="da"){y=["dekao",10,"da"]}if(b){h=b[2];f=r.substring(2)}else if(y){h=y[1];f=r.substring(y[2].length)}for(var C=0;C<o.length;C++){m=o[C][2]===null?[]:o[C][2];if(o[C][1]===f||m.indexOf(f)>=0){u=o[C]}}}if(l===null||u===null){return n.na}if(l[3]!==u[3]){return n.na}return e*l[6]*c/(u[6]*h)};t.DEC2BIN=function(e,t){e=a.parseNumber(e);if(e instanceof Error){return e}if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511){return n.num}if(e<0){return"1"+i.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2)}var r=parseInt(e,10).toString(2);if(typeof t==="undefined"){return r}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=r.length?i.REPT("0",t-r.length)+r:n.num}};t.DEC2HEX=function(e,t){e=a.parseNumber(e);if(e instanceof Error){return e}if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887){return n.num}if(e<0){return(1099511627776+e).toString(16)}var r=parseInt(e,10).toString(16);if(typeof t==="undefined"){return r}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=r.length?i.REPT("0",t-r.length)+r:n.num}};t.DEC2OCT=function(e,t){e=a.parseNumber(e);if(e instanceof Error){return e}if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911){return n.num}if(e<0){return(1073741824+e).toString(8)}var r=parseInt(e,10).toString(8);if(typeof t==="undefined"){return r}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=r.length?i.REPT("0",t-r.length)+r:n.num}};t.DELTA=function(e,t){t=t===undefined?0:t;e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}return e===t?1:0};t.ERF=function(e,t){t=t===undefined?0:t;e=a.parseNumber(e);t=a.parseNumber(t);if(a.anyIsError(e,t)){return n.value}return o.erf(e)};t.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")};t.ERFC=function(e){if(isNaN(e)){return n.value}return o.erfc(e)};t.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")};t.GESTEP=function(e,t){t=t||0;e=a.parseNumber(e);if(a.anyIsError(t,e)){return e}return e>=t?1:0};t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e)){return n.num}var r=e.length===10&&e.substring(0,1).toLowerCase()==="f"?true:false;var o=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(o<-512||o>511){return n.num}if(r){return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2)}var a=o.toString(2);if(t===undefined){return a}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=a.length?i.REPT("0",t-a.length)+a:n.num}};t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e)){return n.num}var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t};t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e)){return n.num}var r=parseInt(e,16);if(r>536870911&&r<0xffe0000000){return n.num}if(r>=0xffe0000000){return(r-0xffc0000000).toString(8)}var o=r.toString(8);if(t===undefined){return o}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=o.length?i.REPT("0",t-o.length)+o:n.num}};t.IMABS=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))};t.IMAGINARY=function(e){if(e===undefined||e===true||e===false){return n.value}if(e===0||e==="0"){return 0}if(["i","j"].indexOf(e)>=0){return 1}e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=e.indexOf("+");var r=e.indexOf("-");if(t===0){t=e.indexOf("+",1)}if(r===0){r=e.indexOf("-",1)}var o=e.substring(e.length-1,e.length);var i=o==="i"||o==="j";if(t>=0||r>=0){if(!i){return n.num}if(t>=0){return isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(t+1,e.length-1))}else{return isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:-Number(e.substring(r+1,e.length-1))}}else{if(i){return isNaN(e.substring(0,e.length-1))?n.num:e.substring(0,e.length-1)}else{return isNaN(e)?n.num:0}}};t.IMARGUMENT=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}if(r===0&&o===0){return n.div0}if(r===0&&o>0){return Math.PI/2}if(r===0&&o<0){return-Math.PI/2}if(o===0&&r>0){return 0}if(o===0&&r<0){return-Math.PI}if(r>0){return Math.atan(o/r)}else if(r<0&&o>=0){return Math.atan(o/r)+Math.PI}else{return Math.atan(o/r)-Math.PI}};t.IMCONJUGATE=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return o!==0?t.COMPLEX(r,-o,i):e};t.IMCOS=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.cos(r)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(r)*(Math.exp(o)-Math.exp(-o))/2,i)};t.IMCOSH=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.cos(o)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(o)*(Math.exp(r)-Math.exp(-r))/2,i)};t.IMCOT=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}return t.IMDIV(t.IMCOS(e),t.IMSIN(e))};t.IMDIV=function(e,r){var o=t.IMREAL(e);var i=t.IMAGINARY(e);var s=t.IMREAL(r);var l=t.IMAGINARY(r);if(a.anyIsError(o,i,s,l)){return n.value}var u=e.substring(e.length-1);var d=r.substring(r.length-1);var f="i";if(u==="j"){f="j"}else if(d==="j"){f="j"}if(s===0&&l===0){return n.num}var c=s*s+l*l;return t.COMPLEX((o*s+i*l)/c,(i*s-o*l)/c,f)};t.IMEXP=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";var s=Math.exp(r);return t.COMPLEX(s*Math.cos(o),s*Math.sin(o),i)};t.IMLN=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.log(Math.sqrt(r*r+o*o)),Math.atan(o/r),i)};t.IMLOG10=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.log(Math.sqrt(r*r+o*o))/Math.log(10),Math.atan(o/r)/Math.log(10),i)};t.IMLOG2=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.log(Math.sqrt(r*r+o*o))/Math.log(2),Math.atan(o/r)/Math.log(2),i)};t.IMPOWER=function(e,r){r=a.parseNumber(r);var o=t.IMREAL(e);var i=t.IMAGINARY(e);if(a.anyIsError(r,o,i)){return n.value}var s=e.substring(e.length-1);s=s==="i"||s==="j"?s:"i";var l=Math.pow(t.IMABS(e),r);var u=t.IMARGUMENT(e);return t.COMPLEX(l*Math.cos(r*u),l*Math.sin(r*u),s)};t.IMPRODUCT=function(){var e=arguments[0];if(!arguments.length){return n.value}for(var r=1;r<arguments.length;r++){var o=t.IMREAL(e);var i=t.IMAGINARY(e);var s=t.IMREAL(arguments[r]);var l=t.IMAGINARY(arguments[r]);if(a.anyIsError(o,i,s,l)){return n.value}e=t.COMPLEX(o*s-i*l,o*l+i*s)}return e};t.IMREAL=function(e){if(e===undefined||e===true||e===false){return n.value}if(e===0||e==="0"){return 0}if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0){return 0}var t=e.indexOf("+");var r=e.indexOf("-");if(t===0){t=e.indexOf("+",1)}if(r===0){r=e.indexOf("-",1)}var o=e.substring(e.length-1,e.length);var i=o==="i"||o==="j";if(t>=0||r>=0){if(!i){return n.num}if(t>=0){return isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(0,t))}else{return isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:Number(e.substring(0,r))}}else{if(i){return isNaN(e.substring(0,e.length-1))?n.num:0}else{return isNaN(e)?n.num:e}}};t.IMSEC=function(e){if(e===true||e===false){return n.value}var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}return t.IMDIV("1",t.IMCOS(e))};t.IMSECH=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}return t.IMDIV("1",t.IMCOSH(e))};t.IMSIN=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.sin(r)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(r)*(Math.exp(o)-Math.exp(-o))/2,i)};t.IMSINH=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";return t.COMPLEX(Math.cos(o)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(o)*(Math.exp(r)+Math.exp(-r))/2,i)};t.IMSQRT=function(e){var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}var i=e.substring(e.length-1);i=i==="i"||i==="j"?i:"i";var s=Math.sqrt(t.IMABS(e));var l=t.IMARGUMENT(e);return t.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),i)};t.IMCSC=function(e){if(e===true||e===false){return n.value}var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.num}return t.IMDIV("1",t.IMSIN(e))};t.IMCSCH=function(e){if(e===true||e===false){return n.value}var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.num}return t.IMDIV("1",t.IMSINH(e))};t.IMSUB=function(e,t){var r=this.IMREAL(e);var o=this.IMAGINARY(e);var i=this.IMREAL(t);var s=this.IMAGINARY(t);if(a.anyIsError(r,o,i,s)){return n.value}var l=e.substring(e.length-1);var u=t.substring(t.length-1);var d="i";if(l==="j"){d="j"}else if(u==="j"){d="j"}return this.COMPLEX(r-i,o-s,d)};t.IMSUM=function(){if(!arguments.length){return n.value}var e=a.flatten(arguments);var t=e[0];for(var r=1;r<e.length;r++){var o=this.IMREAL(t);var i=this.IMAGINARY(t);var s=this.IMREAL(e[r]);var l=this.IMAGINARY(e[r]);if(a.anyIsError(o,i,s,l)){return n.value}t=this.COMPLEX(o+s,i+l)}return t};t.IMTAN=function(e){if(e===true||e===false){return n.value}var r=t.IMREAL(e);var o=t.IMAGINARY(e);if(a.anyIsError(r,o)){return n.value}return this.IMDIV(this.IMSIN(e),this.IMCOS(e))};t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e)){return n.num}var r=e.length===10&&e.substring(0,1)==="7"?true:false;var o=r?parseInt(e,8)-1073741824:parseInt(e,8);if(o<-512||o>511){return n.num}if(r){return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2)}var a=o.toString(2);if(typeof t==="undefined"){return a}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=a.length?i.REPT("0",t-a.length)+a:n.num}};t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e)){return n.num}var t=parseInt(e,8);return t>=536870912?t-1073741824:t};t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e)){return n.num}var r=parseInt(e,8);if(r>=536870912){return"ff"+(r+3221225472).toString(16)}var o=r.toString(16);if(t===undefined){return o}else{if(isNaN(t)){return n.value}if(t<0){return n.num}t=Math.floor(t);return t>=o.length?i.REPT("0",t-o.length)+o:n.num}}},function(e,t,r){var n=r(2);var o=r(14);var i=r(0);t.UNIQUE=function(){var e=[];for(var t=0;t<arguments.length;++t){var r=false;var n=arguments[t];for(var o=0;o<e.length;++o){r=e[o]===n;if(r){break}}if(!r){e.push(n)}}return e};t.FLATTEN=n.flatten;t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};t.REFERENCE=function(e,t){if(!arguments.length){return l.error}try{var r=t.split(".");var n=e;for(var o=0;o<r.length;++o){var i=r[o];if(i[i.length-1]==="]"){var a=i.indexOf("[");var s=i.substring(a+1,i.length-1);n=n[i.substring(0,a)][s]}else{n=n[i]}}return n}catch(l){}};t.JOIN=function(e,t){return e.join(t)};t.NUMBERS=function(){var e=n.flatten(arguments);return e.filter(function(e){return typeof e==="number"})};t.NUMERAL=function(e,t){return o(e).format(t)}},function(e,t){this.j$=this.jStat=function(e,t){var r=Array.prototype.concat;var n=Array.prototype.slice;var o=Object.prototype.toString;function a(t,r){var n=t>r?t:r;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))}var s=Array.isArray||function v(e){return o.call(e)==="[object Array]"};function l(e){return o.call(e)==="[object Function]"}function u(e){return typeof e==="number"&&e===e}function d(e){return r.apply([],e)}function f(){return new f._init(arguments)}f.fn=f.prototype;f._init=function g(e){var t;if(s(e[0])){if(s(e[0][0])){if(l(e[1]))e[0]=f.map(e[0],e[1]);for(var t=0;t<e[0].length;t++){this[t]=e[0][t]}this.length=e[0].length}else{this[0]=l(e[1])?f.map(e[0],e[1]):e[0];this.length=1}}else if(u(e[0])){this[0]=f.seq.apply(null,e);this.length=1}else if(e[0]instanceof f){return f(e[0].toArray())}else{this[0]=[];this.length=1}return this};f._init.prototype=f.prototype;f._init.constructor=f;f.utils={calcRdx:a,isArray:s,isFunction:l,isNumber:u,toVector:d};f.extend=function w(e){var t,r;if(arguments.length===1){for(r in e){f[r]=e[r]}return this}for(var t=1;t<arguments.length;t++){for(r in arguments[t]){e[r]=arguments[t][r]}}return e};f.rows=function b(e){return e.length||1};f.cols=function y(e){return e[0].length||1};f.dimensions=function C(e){return{rows:f.rows(e),cols:f.cols(e)}};f.row=function _(e,t){if(s(t)){return t.map(function(t){return f.row(e,t)})}return e[t]};f.rowa=function E(e,t){return f.row(e,t)};f.col=function R(e,t){if(s(t)){var r=f.arange(e.length).map(function(e){return new Array(t.length)});t.forEach(function(t,n){f.arange(e.length).forEach(function(o){r[o][n]=e[o][t]})});return r}var n=new Array(e.length);for(var o=0;o<e.length;o++){n[o]=[e[o][t]]}return n};f.cola=function M(e,t){return f.col(e,t).map(function(e){return e[0]})};f.diag=function S(e){var t=f.rows(e);var r=new Array(t);for(var n=0;n<t;n++){r[n]=[e[n][n]]}return r};f.antidiag=function O(e){var t=f.rows(e)-1;var r=new Array(t);for(var n=0;t>=0;t--,n++){r[n]=[e[n][t]]}return r};f.transpose=function T(e){var t=[];var r,n,o,i,a;if(!s(e[0]))e=[e];n=e.length;o=e[0].length;for(var a=0;a<o;a++){r=new Array(n);for(i=0;i<n;i++){r[i]=e[i][a]}t.push(r)}return t.length===1?t[0]:t};f.map=function A(e,t,r){var n,o,i,a,l;if(!s(e[0]))e=[e];o=e.length;i=e[0].length;a=r?e:new Array(o);for(n=0;n<o;n++){if(!a[n])a[n]=new Array(i);for(l=0;l<i;l++){a[n][l]=t(e[n][l],n,l)}}return a.length===1?a[0]:a};f.cumreduce=function N(e,t,r){var n,o,i,a,l;if(!s(e[0]))e=[e];o=e.length;i=e[0].length;a=r?e:new Array(o);for(n=0;n<o;n++){if(!a[n])a[n]=new Array(i);if(i>0)a[n][0]=e[n][0];for(l=1;l<i;l++){a[n][l]=t(a[n][l-1],e[n][l])}}return a.length===1?a[0]:a};f.alter=function D(e,t){return f.map(e,t,true)};f.create=function k(e,t,r){var n=new Array(e);var o,i;if(l(t)){r=t;t=e}for(var o=0;o<e;o++){n[o]=new Array(t);for(i=0;i<t;i++){n[o][i]=r(o,i)}}return n};function c(){return 0}f.zeros=function x(e,t){if(!u(t))t=e;return f.create(e,t,c)};function h(){return 1}f.ones=function I(e,t){if(!u(t))t=e;return f.create(e,t,h)};f.rand=function P(t,r){if(!u(r))r=t;return f.create(t,r,e.random)};function m(e,t){return e===t?1:0}f.identity=function L(e,t){if(!u(t))t=e;return f.create(e,t,m)};f.symmetric=function H(e){var t=true;var r=e.length;var n,o;if(e.length!==e[0].length)return false;for(n=0;n<r;n++){for(o=0;o<r;o++){if(e[o][n]!==e[n][o])return false}}return true};f.clear=function V(e){return f.alter(e,c)};f.seq=function F(e,t,r,n){if(!l(n))n=false;var o=[];var i=a(e,t);var s=(t*i-e*i)/((r-1)*i);var u=e;var d;for(d=0;u<=t;d++,u=(e*i+s*i*d)/i){o.push(n?n(u,d):u)}return o};f.arange=function B(e,r,n){var o=[];n=n||1;if(r===t){r=e;e=0}if(e===r||n===0){return[]}if(e<r&&n<0){return[]}if(e>r&&n>0){return[]}if(n>0){for(i=e;i<r;i+=n){o.push(i)}}else{for(i=e;i>r;i+=n){o.push(i)}}return o};f.slice=function(){function e(e,r,n,o){var i;var a=[];var s=e.length;if(r===t&&n===t&&o===t){return f.copy(e)}r=r||0;n=n||e.length;r=r>=0?r:s+r;n=n>=0?n:s+n;o=o||1;if(r===n||o===0){return[]}if(r<n&&o<0){return[]}if(r>n&&o>0){return[]}if(o>0){for(i=r;i<n;i+=o){a.push(e[i])}}else{for(i=r;i>n;i+=o){a.push(e[i])}}return a}function r(t,r){r=r||{};if(u(r.row)){if(u(r.col))return t[r.row][r.col];var n=f.rowa(t,r.row);var o=r.col||{};return e(n,o.start,o.end,o.step)}if(u(r.col)){var i=f.cola(t,r.col);var a=r.row||{};return e(i,a.start,a.end,a.step)}var a=r.row||{};var o=r.col||{};var s=e(t,a.start,a.end,a.step);return s.map(function(t){return e(t,o.start,o.end,o.step)})}return r}();f.sliceAssign=function j(r,n,o){if(u(n.row)){if(u(n.col))return r[n.row][n.col]=o;n.col=n.col||{};n.col.start=n.col.start||0;n.col.end=n.col.end||r[0].length;n.col.step=n.col.step||1;var i=f.arange(n.col.start,e.min(r.length,n.col.end),n.col.step);var a=n.row;i.forEach(function(e,t){r[a][e]=o[t]});return r}if(u(n.col)){n.row=n.row||{};n.row.start=n.row.start||0;n.row.end=n.row.end||r.length;n.row.step=n.row.step||1;var s=f.arange(n.row.start,e.min(r[0].length,n.row.end),n.row.step);var l=n.col;s.forEach(function(e,t){r[e][l]=o[t]});return r}if(o[0].length===t){o=[o]}n.row.start=n.row.start||0;n.row.end=n.row.end||r.length;n.row.step=n.row.step||1;n.col.start=n.col.start||0;n.col.end=n.col.end||r[0].length;n.col.step=n.col.step||1;var s=f.arange(n.row.start,e.min(r.length,n.row.end),n.row.step);var i=f.arange(n.col.start,e.min(r[0].length,n.col.end),n.col.step);s.forEach(function(e,t){i.forEach(function(n,i){r[e][n]=o[t][i]})});return r};f.diagonal=function W(e){var t=f.zeros(e.length,e.length);e.forEach(function(e,r){t[r][r]=e});return t};f.copy=function $(e){return e.map(function(e){if(u(e))return e;return e.map(function(e){return e})})};var p=f.prototype;p.length=0;p.push=Array.prototype.push;p.sort=Array.prototype.sort;p.splice=Array.prototype.splice;p.slice=Array.prototype.slice;p.toArray=function U(){return this.length>1?n.call(this):n.call(this)[0]};p.map=function G(e,t){return f(f.map(this,e,t))};p.cumreduce=function Y(e,t){return f(f.cumreduce(this,e,t))};p.alter=function z(e){f.alter(this,e);return this};(function(e){for(var t=0;t<e.length;t++){(function(e){p[e]=function(t){var r=this,n;if(t){setTimeout(function(){t.call(r,p[e].call(r))});return this}n=f[e](this);return s(n)?f(n):n}})(e[t])}})("transpose clear symmetric rows cols dimensions diag antidiag".split(" "));(function(e){for(var t=0;t<e.length;t++){(function(e){p[e]=function(t,r){var n=this;if(r){setTimeout(function(){r.call(n,p[e].call(n,t))});return this}return f(f[e](this,t))}})(e[t])}})("row col".split(" "));(function(e){for(var t=0;t<e.length;t++){(function(e){p[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")})(e[t])}})("create zeros ones rand identity".split(" "));return f}(Math);(function(e,t){var r=e.utils.isFunction;function n(e,t){return e-t}function o(e,r,n){return t.max(r,t.min(e,n))}e.sum=function a(e){var a=0;var t=e.length;while(--t>=0){a+=e[t]}return a};e.sumsqrd=function s(e){var t=0;var r=e.length;while(--r>=0){t+=e[r]*e[r]}return t};e.sumsqerr=function l(t){var r=e.mean(t);var n=0;var o=t.length;var i;while(--o>=0){i=t[o]-r;n+=i*i}return n};e.sumrow=function u(e){var t=0;var r=e.length;while(--r>=0){t+=e[r]}return t};e.product=function d(e){var t=1;var r=e.length;while(--r>=0){t*=e[r]}return t};e.min=function f(e){var t=e[0];var r=0;while(++r<e.length){if(e[r]<t)t=e[r]}return t};e.max=function c(e){var t=e[0];var r=0;while(++r<e.length){if(e[r]>t)t=e[r]}return t};e.unique=function h(e){var t={},r=[];for(var n=0;n<e.length;n++){if(!t[e[n]]){t[e[n]]=true;r.push(e[n])}}return r};e.mean=function m(t){return e.sum(t)/t.length};e.meansqerr=function p(t){return e.sumsqerr(t)/t.length;
};e.geomean=function v(r){return t.pow(e.product(r),1/r.length)};e.median=function g(e){var t=e.length;var r=e.slice().sort(n);return!(t&1)?(r[t/2-1]+r[t/2])/2:r[t/2|0]};e.cumsum=function w(t){return e.cumreduce(t,function(e,t){return e+t})};e.cumprod=function b(t){return e.cumreduce(t,function(e,t){return e*t})};e.diff=function y(e){var t=[];var r=e.length;var n;for(var n=1;n<r;n++){t.push(e[n]-e[n-1])}return t};e.rank=function(e){var t=e.length;var r=e.slice().sort(n);var o=new Array(t);for(var i=0;i<t;i++){var a=r.indexOf(e[i]);var s=r.lastIndexOf(e[i]);if(a===s){var l=a}else{var l=(a+s)/2}o[i]=l+1}return o};e.mode=function C(e){var t=e.length;var r=e.slice().sort(n);var o=1;var i=0;var a=0;var s=[];var l;for(var l=0;l<t;l++){if(r[l]===r[l+1]){o++}else{if(o>i){s=[r[l]];i=o;a=0}else if(o===i){s.push(r[l]);a++}o=1}}return a===0?s[0]:s};e.range=function _(t){return e.max(t)-e.min(t)};e.variance=function E(t,r){return e.sumsqerr(t)/(t.length-(r?1:0))};e.deviation=function(t){var r=e.mean(t);var n=t.length;var o=new Array(n);for(var i=0;i<n;i++){o[i]=t[i]-r}return o};e.stdev=function R(r,n){return t.sqrt(e.variance(r,n))};e.meandev=function M(r){var n=0;var o=e.mean(r);var i;for(var i=r.length-1;i>=0;i--){n+=t.abs(r[i]-o)}return n/r.length};e.meddev=function S(r){var n=0;var o=e.median(r);var i;for(var i=r.length-1;i>=0;i--){n+=t.abs(r[i]-o)}return n/r.length};e.coeffvar=function O(t){return e.stdev(t)/e.mean(t)};e.quartiles=function T(e){var r=e.length;var o=e.slice().sort(n);return[o[t.round(r/4)-1],o[t.round(r/2)-1],o[t.round(r*3/4)-1]]};e.quantiles=function A(e,r,i,a){var s=e.slice().sort(n);var l=[r.length];var u=e.length;var d,f,c,h,m,p;if(typeof i==="undefined")i=3/8;if(typeof a==="undefined")a=3/8;for(var d=0;d<r.length;d++){f=r[d];c=i+f*(1-i-a);h=u*f+c;m=t.floor(o(h,1,u-1));p=o(h-m,0,1);l[d]=(1-p)*s[m-1]+p*s[m]}return l};e.percentile=function N(e,t){var r=e.slice().sort(n);var o=t*(r.length-1);var i=parseInt(o);var a=o-i;if(i+1<r.length){return r[i]*(1-a)+r[i+1]*a}else{return r[i]}};e.percentileOfScore=function D(e,t,r){var n=0;var o=e.length;var i=false;var a,s;if(r==="strict")i=true;for(var s=0;s<o;s++){a=e[s];if(i&&a<t||!i&&a<=t){n++}}return n/o};e.histogram=function k(r,n){var o=e.min(r);var i=n||4;var a=(e.max(r)-o)/i;var s=r.length;var n=[];var l;for(var l=0;l<i;l++){n[l]=0}for(var l=0;l<s;l++){n[t.min(t.floor((r[l]-o)/a),i-1)]+=1}return n};e.covariance=function x(t,r){var n=e.mean(t);var o=e.mean(r);var i=t.length;var a=new Array(i);var s;for(var s=0;s<i;s++){a[s]=(t[s]-n)*(r[s]-o)}return e.sum(a)/(i-1)};e.corrcoeff=function I(t,r){return e.covariance(t,r)/e.stdev(t,1)/e.stdev(r,1)};e.spearmancoeff=function(r,n){r=e.rank(r);n=e.rank(n);var o=e.deviation(r);var i=e.deviation(n);return e.sum(o.map(function(e,t){return e*i[t]}))/t.sqrt(e.sum(o.map(function(e){return t.pow(e,2)}))*e.sum(i.map(function(e){return t.pow(e,2)})))};e.stanMoment=function P(r,n){var o=e.mean(r);var i=e.stdev(r);var a=r.length;var s=0;for(var l=0;l<a;l++){s+=t.pow((r[l]-o)/i,n)}return s/r.length};e.skewness=function L(t){return e.stanMoment(t,3)};e.kurtosis=function H(t){return e.stanMoment(t,4)-3};var i=e.prototype;(function(t){for(var n=0;n<t.length;n++){(function(t){i[t]=function(n,o){var a=[];var s=0;var l=this;if(r(n)){o=n;n=false}if(o){setTimeout(function(){o.call(l,i[t].call(l,n))});return this}if(this.length>1){l=n===true?this:this.transpose();for(;s<l.length;s++){a[s]=e[t](l[s])}return a}return e[t](this[0],n)}})(t[n])}})("cumsum cumprod".split(" "));(function(t){for(var n=0;n<t.length;n++){(function(t){i[t]=function(n,o){var a=[];var s=0;var l=this;if(r(n)){o=n;n=false}if(o){setTimeout(function(){o.call(l,i[t].call(l,n))});return this}if(this.length>1){if(t!=="sumrow")l=n===true?this:this.transpose();for(;s<l.length;s++){a[s]=e[t](l[s])}return n===true?e[t](e.utils.toVector(a)):a}return e[t](this[0],n)}})(t[n])}})(("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr "+"geomean median diff rank mode range variance deviation stdev meandev "+"meddev coeffvar quartiles histogram skewness kurtosis").split(" "));(function(t){for(var n=0;n<t.length;n++){(function(t){i[t]=function(){var n=[];var o=0;var a=this;var s=Array.prototype.slice.call(arguments);if(r(s[s.length-1])){var l=s[s.length-1];var u=s.slice(0,s.length-1);setTimeout(function(){l.call(a,i[t].apply(a,u))});return this}else{var l=undefined;var d=function f(r){return e[t].apply(a,[r].concat(s))}}if(this.length>1){a=a.transpose();for(;o<a.length;o++){n[o]=d(a[o])}return n}return d(this[0])}})(t[n])}})("quantiles percentileOfScore".split(" "))})(this.jStat,Math);(function(e,t){e.gammaln=function r(e){var r=0;var n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];var o=1.000000000190015;var i,a,s;s=(a=i=e)+5.5;s-=(i+.5)*t.log(s);for(;r<6;r++){o+=n[r]/++a}return t.log(2.5066282746310007*o/i)-s};e.gammafn=function n(e){var r=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054];var n=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];var o=false;var i=0;var a=0;var s=0;var l=e;var u,d,f,c,h,m;if(l<=0){c=l%1+3.6e-16;if(c){o=(!(l&1)?1:-1)*t.PI/t.sin(t.PI*c);l=1-l}else{return Infinity}}f=l;if(l<1){d=l++}else{d=(l-=i=(l|0)-1)-1}for(var u=0;u<8;++u){s=(s+r[u])*d;a=a*d+n[u]}c=s/a+1;if(f<l){c/=f}else if(f>l){for(var u=0;u<i;++u){c*=l;l++}}if(o){c=o/c}return c};e.gammap=function o(t,r){return e.lowRegGamma(t,r)*e.gammafn(t)};e.lowRegGamma=function i(r,n){var o=e.gammaln(r);var i=r;var a=1/r;var s=a;var l=n+1-r;var u=1/1e-30;var d=1/l;var f=d;var c=1;var h=-~(t.log(r>=1?r:1/r)*8.5+r*.4+17);var m,p;if(n<0||r<=0){return NaN}else if(n<r+1){for(;c<=h;c++){a+=s*=n/++i}return a*t.exp(-n+r*t.log(n)-o)}for(;c<=h;c++){m=-c*(c-r);l+=2;d=m*d+l;u=l+m/u;d=1/d;f*=d*u}return 1-f*t.exp(-n+r*t.log(n)-o)};e.factorialln=function a(t){return t<0?NaN:e.gammaln(t+1)};e.factorial=function s(t){return t<0?NaN:e.gammafn(t+1)};e.combination=function l(r,n){return r>170||n>170?t.exp(e.combinationln(r,n)):e.factorial(r)/e.factorial(n)/e.factorial(r-n)};e.combinationln=function u(t,r){return e.factorialln(t)-e.factorialln(r)-e.factorialln(t-r)};e.permutation=function d(t,r){return e.factorial(t)/e.factorial(t-r)};e.betafn=function f(r,n){if(r<=0||n<=0)return undefined;return r+n>170?t.exp(e.betaln(r,n)):e.gammafn(r)*e.gammafn(n)/e.gammafn(r+n)};e.betaln=function c(t,r){return e.gammaln(t)+e.gammaln(r)-e.gammaln(t+r)};e.betacf=function h(e,r,n){var o=1e-30;var i=1;var a=r+n;var s=r+1;var l=r-1;var u=1;var d=1-a*e/s;var f,c,h,m;if(t.abs(d)<o)d=o;d=1/d;m=d;for(;i<=100;i++){f=2*i;c=i*(n-i)*e/((l+f)*(r+f));d=1+c*d;if(t.abs(d)<o)d=o;u=1+c/u;if(t.abs(u)<o)u=o;d=1/d;m*=d*u;c=-(r+i)*(a+i)*e/((r+f)*(s+f));d=1+c*d;if(t.abs(d)<o)d=o;u=1+c/u;if(t.abs(u)<o)u=o;d=1/d;h=d*u;m*=h;if(t.abs(h-1)<3e-7)break}return m};e.gammapinv=function m(r,n){var o=0;var i=n-1;var a=1e-8;var s=e.gammaln(n);var l,u,d,f,c,h,m;if(r>=1)return t.max(100,n+100*t.sqrt(n));if(r<=0)return 0;if(n>1){h=t.log(i);m=t.exp(i*(h-1)-s);c=r<.5?r:1-r;d=t.sqrt(-2*t.log(c));l=(2.30753+d*.27061)/(1+d*(.99229+d*.04481))-d;if(r<.5)l=-l;l=t.max(.001,n*t.pow(1-1/(9*n)-l/(3*t.sqrt(n)),3))}else{d=1-n*(.253+n*.12);if(r<d)l=t.pow(r/d,1/n);else l=1-t.log(1-(r-d)/(1-d))}for(;o<12;o++){if(l<=0)return 0;u=e.lowRegGamma(n,l)-r;if(n>1)d=m*t.exp(-(l-i)+i*(t.log(l)-h));else d=t.exp(-l+i*t.log(l)-s);f=u/d;l-=d=f/(1-.5*t.min(1,f*((n-1)/l-1)));if(l<=0)l=.5*(l+d);if(t.abs(d)<a*l)break}return l};e.erf=function p(e){var r=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17];var n=r.length-1;var o=false;var i=0;var a=0;var s,l,u,d;if(e<0){e=-e;o=true}s=2/(2+e);l=4*s-2;for(;n>0;n--){u=i;i=l*i-a+r[n];a=u}d=s*t.exp(-e*e+.5*(r[0]+l*i)-a);return o?d-1:1-d};e.erfc=function v(t){return 1-e.erf(t)};e.erfcinv=function g(r){var n=0;var o,i,a,s;if(r>=2)return-100;if(r<=0)return 100;s=r<1?r:2-r;a=t.sqrt(-2*t.log(s/2));o=-.70711*((2.30753+a*.27061)/(1+a*(.99229+a*.04481))-a);for(;n<2;n++){i=e.erfc(o)-s;o+=i/(1.1283791670955126*t.exp(-o*o)-o*i)}return r<1?o:-o};e.ibetainv=function w(r,n,o){var i=1e-8;var a=n-1;var s=o-1;var l=0;var u,d,f,c,h,m,p,v,g,w,b;if(r<=0)return 0;if(r>=1)return 1;if(n>=1&&o>=1){f=r<.5?r:1-r;c=t.sqrt(-2*t.log(f));p=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c;if(r<.5)p=-p;v=(p*p-3)/6;g=2/(1/(2*n-1)+1/(2*o-1));w=p*t.sqrt(v+g)/g-(1/(2*o-1)-1/(2*n-1))*(v+5/6-2/(3*g));p=n/(n+o*t.exp(2*w))}else{u=t.log(n/(n+o));d=t.log(o/(n+o));c=t.exp(n*u)/n;h=t.exp(o*d)/o;w=c+h;if(r<c/w)p=t.pow(n*w*r,1/n);else p=1-t.pow(o*w*(1-r),1/o)}b=-e.gammaln(n)-e.gammaln(o)+e.gammaln(n+o);for(;l<10;l++){if(p===0||p===1)return p;m=e.ibeta(p,n,o)-r;c=t.exp(a*t.log(p)+s*t.log(1-p)+b);h=m/c;p-=c=h/(1-.5*t.min(1,h*(a/p-s/(1-p))));if(p<=0)p=.5*(p+c);if(p>=1)p=.5*(p+c+1);if(t.abs(c)<i*p&&l>0)break}return p};e.ibeta=function b(r,n,o){var i=r===0||r===1?0:t.exp(e.gammaln(n+o)-e.gammaln(n)-e.gammaln(o)+n*t.log(r)+o*t.log(1-r));if(r<0||r>1)return false;if(r<(n+1)/(n+o+2))return i*e.betacf(r,n,o)/n;return 1-i*e.betacf(1-r,o,n)/o};e.randn=function y(r,n){var o,i,a,s,l,u;if(!n)n=r;if(r)return e.create(r,n,function(){return e.randn()});do{o=t.random();i=1.7156*(t.random()-.5);a=o-.449871;s=t.abs(i)+.386595;l=a*a+s*(.196*s-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*t.log(o)*o*o));return i/o};e.randg=function C(r,n,o){var i=r;var a,s,l,u,d,f;if(!o)o=n;if(!r)r=1;if(n){f=e.zeros(n,o);f.alter(function(){return e.randg(r)});return f}if(r<1)r+=1;a=r-1/3;s=1/t.sqrt(9*a);do{do{d=e.randn();u=1+s*d}while(u<=0);u=u*u*u;l=t.random()}while(l>1-.331*t.pow(d,4)&&t.log(l)>.5*d*d+a*(1-u+t.log(u)));if(r==i)return a*u;do{l=t.random()}while(l===0);return t.pow(l,1/i)*a*u};(function(t){for(var r=0;r<t.length;r++){(function(t){e.fn[t]=function(){return e(e.map(this,function(r){return e[t](r)}))}})(t[r])}})("gammaln gammafn factorial factorialln".split(" "));(function(t){for(var r=0;r<t.length;r++){(function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}})(t[r])}})("randn".split(" "))})(this.jStat,Math);(function(e,t){(function(t){for(var r=0;r<t.length;r++){(function(t){e[t]=function(e,t,r){if(!(this instanceof arguments.callee))return new arguments.callee(e,t,r);this._a=e;this._b=t;this._c=r;return this};e.fn[t]=function(r,n,o){var i=e[t](r,n,o);i.data=this;return i};e[t].prototype.sample=function(r){var n=this._a;var o=this._b;var i=this._c;if(r)return e.alter(r,function(){return e[t].sample(n,o,i)});else return e[t].sample(n,o,i)};(function(r){for(var n=0;n<r.length;n++){(function(r){e[t].prototype[r]=function(n){var o=this._a;var i=this._b;var a=this._c;if(!n&&n!==0)n=this.data;if(typeof n!=="number"){return e.fn.map.call(n,function(n){return e[t][r](n,o,i,a)})}return e[t][r](n,o,i,a)}})(r[n])}})("pdf cdf inv".split(" "));(function(r){for(var n=0;n<r.length;n++){(function(r){e[t].prototype[r]=function(){return e[t][r](this._a,this._b,this._c)}})(r[n])}})("mean median mode variance".split(" "))})(t[r])}})(("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy "+"laplace lognormal noncentralt normal pareto studentt weibull uniform "+"binomial negbin hypgeom poisson triangular").split(" "));e.extend(e.beta,{pdf:function n(r,o,i){if(r>1||r<0)return 0;if(o==1&&i==1)return 1;if(o<512&&i<512){return t.pow(r,o-1)*t.pow(1-r,i-1)/e.betafn(o,i)}else{return t.exp((o-1)*t.log(r)+(i-1)*t.log(1-r)-e.betaln(o,i))}},cdf:function o(t,r,n){return t>1||t<0?(t>1)*1:e.ibeta(t,r,n)},inv:function i(t,r,n){return e.ibetainv(t,r,n)},mean:function a(e,t){return e/(e+t)},median:function s(t,r){return e.ibetainv(.5,t,r)},mode:function l(e,t){return(e-1)/(e+t-2)},sample:function u(t,r){var n=e.randg(t);return n/(n+e.randg(r))},variance:function d(e,r){return e*r/(t.pow(e+r,2)*(e+r+1))}});e.extend(e.centralF,{pdf:function f(r,n,o){var i,a,s;if(r<0)return 0;if(n<=2){if(r===0&&n<2){return Infinity}if(r===0&&n===2){return 1}return t.sqrt(t.pow(n*r,n)*t.pow(o,o)/t.pow(n*r+o,n+o))/(r*e.betafn(n/2,o/2))}i=n*r/(o+r*n);a=o/(o+r*n);s=n*a/2;return s*e.binomial.pdf((n-2)/2,(n+o-2)/2,i)},cdf:function c(t,r,n){if(t<0)return 0;return e.ibeta(r*t/(r*t+n),r/2,n/2)},inv:function h(t,r,n){return n/(r*(1/e.ibetainv(t,r/2,n/2)-1))},mean:function m(e,t){return t>2?t/(t-2):undefined},mode:function p(e,t){return e>2?t*(e-2)/(e*(t+2)):undefined},sample:function v(t,r){var n=e.randg(t/2)*2;var o=e.randg(r/2)*2;return n/t/(o/r)},variance:function g(e,t){if(t<=4)return undefined;return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}});e.extend(e.cauchy,{pdf:function w(e,r,n){if(n<0){return 0}return n/(t.pow(e-r,2)+t.pow(n,2))/t.PI},cdf:function b(e,r,n){return t.atan((e-r)/n)/t.PI+.5},inv:function y(e,r,n){return r+n*t.tan(t.PI*(e-.5))},median:function C(e,t){return e},mode:function _(e,t){return e},sample:function E(r,n){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*n+r}});e.extend(e.chisquare,{pdf:function R(r,n){if(r<0)return 0;return r===0&&n===2?.5:t.exp((n/2-1)*t.log(r)-r/2-n/2*t.log(2)-e.gammaln(n/2))},cdf:function M(t,r){if(t<0)return 0;return e.lowRegGamma(r/2,t/2)},inv:function S(t,r){return 2*e.gammapinv(t,.5*r)},mean:function O(e){return e},median:function T(e){return e*t.pow(1-2/(9*e),3)},mode:function A(e){return e-2>0?e-2:0},sample:function N(t){return e.randg(t/2)*2},variance:function D(e){return 2*e}});e.extend(e.exponential,{pdf:function k(e,r){return e<0?0:r*t.exp(-r*e)},cdf:function x(e,r){return e<0?0:1-t.exp(-r*e)},inv:function I(e,r){return-t.log(1-e)/r},mean:function P(e){return 1/e},median:function L(e){return 1/e*t.log(2)},mode:function H(e){return 0},sample:function V(e){return-1/e*t.log(t.random())},variance:function F(e){return t.pow(e,-2)}});e.extend(e.gamma,{pdf:function B(r,n,o){if(r<0)return 0;return r===0&&n===1?1/o:t.exp((n-1)*t.log(r)-r/o-e.gammaln(n)-n*t.log(o))},cdf:function j(t,r,n){if(t<0)return 0;return e.lowRegGamma(r,t/n)},inv:function W(t,r,n){return e.gammapinv(t,r)*n},mean:function $(e,t){return e*t},mode:function U(e,t){if(e>1)return(e-1)*t;return undefined},sample:function G(t,r){return e.randg(t)*r},variance:function Y(e,t){return e*t*t}});e.extend(e.invgamma,{pdf:function z(r,n,o){if(r<=0)return 0;return t.exp(-(n+1)*t.log(r)-o/r-e.gammaln(n)+n*t.log(o))},cdf:function K(t,r,n){if(t<=0)return 0;return 1-e.lowRegGamma(r,n/t)},inv:function q(t,r,n){return n/e.gammapinv(1-t,r)},mean:function X(e,t){return e>1?t/(e-1):undefined},mode:function J(e,t){return t/(e+1)},sample:function Z(t,r){return r/e.randg(t)},variance:function Q(e,t){if(e<=2)return undefined;return t*t/((e-1)*(e-1)*(e-2))}});e.extend(e.kumaraswamy,{pdf:function ee(e,r,n){if(e===0&&r===1)return n;else if(e===1&&n===1)return r;return t.exp(t.log(r)+t.log(n)+(r-1)*t.log(e)+(n-1)*t.log(1-t.pow(e,r)))},cdf:function te(e,r,n){if(e<0)return 0;else if(e>1)return 1;return 1-t.pow(1-t.pow(e,r),n)},inv:function re(e,r,n){return t.pow(1-t.pow(1-e,1/n),1/r)},mean:function ne(t,r){return r*e.gammafn(1+1/t)*e.gammafn(r)/e.gammafn(1+1/t+r)},median:function oe(e,r){return t.pow(1-t.pow(2,-1/r),1/e)},mode:function ie(e,r){if(!(e>=1&&r>=1&&e!==1&&r!==1))return undefined;return t.pow((e-1)/(e*r-1),1/e)},variance:function ae(e,t){throw new Error("variance not yet implemented")}});e.extend(e.lognormal,{pdf:function se(e,r,n){if(e<=0)return 0;return t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(n)-t.pow(t.log(e)-r,2)/(2*n*n))},cdf:function le(r,n,o){if(r<0)return 0;return.5+.5*e.erf((t.log(r)-n)/t.sqrt(2*o*o))},inv:function ue(r,n,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*r)+n)},mean:function de(e,r){return t.exp(e+r*r/2)},median:function fe(e,r){return t.exp(e)},mode:function ce(e,r){return t.exp(e-r*r)},sample:function he(r,n){return t.exp(e.randn()*n+r)},variance:function me(e,r){return(t.exp(r*r)-1)*t.exp(2*e+r*r)}});e.extend(e.noncentralt,{pdf:function pe(r,n,o){var i=1e-14;if(t.abs(o)<i)return e.studentt.pdf(r,n);if(t.abs(r)<i){return t.exp(e.gammaln((n+1)/2)-o*o/2-.5*t.log(t.PI*n)-e.gammaln(n/2))}return n/r*(e.noncentralt.cdf(r*t.sqrt(1+2/n),n+2,o)-e.noncentralt.cdf(r,n,o))},cdf:function ve(r,n,o){var i=1e-14;var a=200;if(t.abs(o)<i)return e.studentt.cdf(r,n);var s=false;if(r<0){s=true;o=-o}var l=e.normal.cdf(-o,0,1);var u=i+1;var d=u;var f=r*r/(r*r+n);var c=0;var h=t.exp(-o*o/2);var m=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(3/2))*o;while(c<a||d>i||u>i){d=u;if(c>0){h*=o*o/(2*c);m*=o*o/(2*(c+1/2))}u=h*e.beta.cdf(f,c+.5,n/2)+m*e.beta.cdf(f,c+1,n/2);l+=.5*u;c++}return s?1-l:l}});e.extend(e.normal,{pdf:function ge(e,r,n){return t.exp(-.5*t.log(2*t.PI)-t.log(n)-t.pow(e-r,2)/(2*n*n))},cdf:function we(r,n,o){return.5*(1+e.erf((r-n)/t.sqrt(2*o*o)))},inv:function be(t,r,n){return-1.4142135623730951*n*e.erfcinv(2*t)+r},mean:function ye(e,t){return e},median:function Ce(e,t){return e},mode:function _e(e,t){return e},sample:function Ee(t,r){return e.randn()*r+t},variance:function Re(e,t){return t*t}});e.extend(e.pareto,{pdf:function Me(e,r,n){if(e<r)return 0;return n*t.pow(r,n)/t.pow(e,n+1)},cdf:function Se(e,r,n){if(e<r)return 0;return 1-t.pow(r/e,n)},inv:function Oe(e,r,n){return r/t.pow(1-e,1/n)},mean:function Te(e,r){if(r<=1)return undefined;return r*t.pow(e,r)/(r-1)},median:function Ae(e,r){return e*(r*t.SQRT2)},mode:function Ne(e,t){return e},variance:function De(e,r){if(r<=2)return undefined;return e*e*r/(t.pow(r-1,2)*(r-2))}});e.extend(e.studentt,{pdf:function ke(r,n){n=n>1e100?1e100:n;return 1/(t.sqrt(n)*e.betafn(.5,n/2))*t.pow(1+r*r/n,-((n+1)/2))},cdf:function xe(r,n){var o=n/2;return e.ibeta((r+t.sqrt(r*r+n))/(2*t.sqrt(r*r+n)),o,o)},inv:function Ie(r,n){var o=e.ibetainv(2*t.min(r,1-r),.5*n,.5);o=t.sqrt(n*(1-o)/o);return r>.5?o:-o},mean:function Pe(e){return e>1?0:undefined},median:function Le(e){return 0},mode:function He(e){return 0},sample:function Ve(r){return e.randn()*t.sqrt(r/(2*e.randg(r/2)))},variance:function Fe(e){return e>2?e/(e-2):e>1?Infinity:undefined}});e.extend(e.weibull,{pdf:function Be(e,r,n){if(e<0||r<0||n<0)return 0;return n/r*t.pow(e/r,n-1)*t.exp(-t.pow(e/r,n))},cdf:function je(e,r,n){return e<0?0:1-t.exp(-t.pow(e/r,n))},inv:function We(e,r,n){return r*t.pow(-t.log(1-e),1/n)},mean:function $e(t,r){return t*e.gammafn(1+1/r)},median:function Ue(e,r){return e*t.pow(t.log(2),1/r)},mode:function Ge(e,r){if(r<=1)return 0;return e*t.pow((r-1)/r,1/r)},sample:function Ye(e,r){return e*t.pow(-t.log(t.random()),1/r)},variance:function ze(r,n){return r*r*e.gammafn(1+2/n)-t.pow(e.weibull.mean(r,n),2)}});e.extend(e.uniform,{pdf:function Ke(e,t,r){return e<t||e>r?0:1/(r-t)},cdf:function qe(e,t,r){if(e<t)return 0;else if(e<r)return(e-t)/(r-t);return 1},inv:function Xe(e,t,r){return t+e*(r-t)},mean:function Je(e,t){return.5*(e+t)},median:function Ze(t,r){return e.mean(t,r)},mode:function Qe(e,t){throw new Error("mode is not yet implemented")},sample:function et(e,r){return e/2+r/2+(r/2-e/2)*(2*t.random()-1)},variance:function tt(e,r){return t.pow(r-e,2)/12}});e.extend(e.binomial,{pdf:function rt(r,n,o){return o===0||o===1?n*o===r?1:0:e.combination(n,r)*t.pow(o,r)*t.pow(1-o,n-r)},cdf:function nt(t,r,n){var o=[],i=0;if(t<0){return 0}if(t<r){for(;i<=t;i++){o[i]=e.binomial.pdf(i,r,n)}return e.sum(o)}return 1}});e.extend(e.negbin,{pdf:function ot(r,n,o){if(r!==r>>>0)return false;if(r<0)return 0;return e.combination(r+n-1,n-1)*t.pow(1-o,r)*t.pow(o,n)},cdf:function it(t,r,n){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++){o+=e.negbin.pdf(i,r,n)}return o}});e.extend(e.hypgeom,{pdf:function at(r,n,o,i){if(r!==r|0){return false}else if(r<0||r<o-(n-i)){return 0}else if(r>i||r>o){return 0}else if(o*2>n){if(i*2>n){return e.hypgeom.pdf(n-o-i+r,n,n-o,n-i)}else{return e.hypgeom.pdf(i-r,n,n-o,i)}}else if(i*2>n){return e.hypgeom.pdf(o-r,n,o,n-i)}else if(o<i){return e.hypgeom.pdf(r,n,i,o)}else{var a=1;var s=0;for(var l=0;l<r;l++){while(a>1&&s<i){a*=1-o/(n-s);s++}a*=(i-l)*(o-l)/((l+1)*(n-o-i+l+1))}for(;s<i;s++){a*=1-o/(n-s)}return t.min(1,t.max(0,a))}},cdf:function st(r,n,o,i){if(r<0||r<o-(n-i)){return 0}else if(r>=i||r>=o){return 1}else if(o*2>n){if(i*2>n){return e.hypgeom.cdf(n-o-i+r,n,n-o,n-i)}else{return 1-e.hypgeom.cdf(i-r-1,n,n-o,i)}}else if(i*2>n){return 1-e.hypgeom.cdf(o-r-1,n,o,n-i)}else if(o<i){return e.hypgeom.cdf(r,n,i,o)}else{var a=1;var s=1;var l=0;for(var u=0;u<r;u++){while(a>1&&l<i){var d=1-o/(n-l);s*=d;a*=d;l++}s*=(i-u)*(o-u)/((u+1)*(n-o-i+u+1));a+=s}for(;l<i;l++){a*=1-o/(n-l)}return t.min(1,t.max(0,a))}}});e.extend(e.poisson,{pdf:function lt(r,n){if(n<0||r%1!==0||r<0){return 0}return t.pow(n,r)*t.exp(-n)/e.factorial(r)},cdf:function ut(t,r){var n=[],o=0;if(t<0)return 0;for(;o<=t;o++){n.push(e.poisson.pdf(o,r))}return e.sum(n)},mean:function dt(e){return e},variance:function ft(e){return e},sample:function ct(e){var r=1,n=0,o=t.exp(-e);do{n++;r*=t.random()}while(r>o);return n-1}});e.extend(e.triangular,{pdf:function ht(e,t,r,n){if(r<=t||n<t||n>r){return NaN}else{if(e<t||e>r){return 0}else if(e<n){return 2*(e-t)/((r-t)*(n-t))}else if(e===n){return 2/(r-t)}else{return 2*(r-e)/((r-t)*(r-n))}}},cdf:function mt(e,r,n,o){if(n<=r||o<r||o>n)return NaN;if(e<=r)return 0;else if(e>=n)return 1;if(e<=o)return t.pow(e-r,2)/((n-r)*(o-r));else return 1-t.pow(n-e,2)/((n-r)*(n-o))},inv:function pt(e,r,n,o){if(n<=r||o<r||o>n){return NaN}else{if(e<=(o-r)/(n-r)){return r+(n-r)*t.sqrt(e*((o-r)/(n-r)))}else{return r+(n-r)*(1-t.sqrt((1-e)*(1-(o-r)/(n-r))))}}},mean:function vt(e,t,r){return(e+t+r)/3},median:function gt(e,r,n){if(n<=(e+r)/2){return r-t.sqrt((r-e)*(r-n))/t.sqrt(2)}else if(n>(e+r)/2){return e+t.sqrt((r-e)*(n-e))/t.sqrt(2)}},mode:function wt(e,t,r){return r},sample:function bt(e,r,n){var o=t.random();if(o<(n-e)/(r-e))return e+t.sqrt(o*(r-e)*(n-e));return r-t.sqrt((1-o)*(r-e)*(r-n))},variance:function yt(e,t,r){return(e*e+t*t+r*r-e*t-e*r-t*r)/18}});function r(e){return e/t.abs(e)}e.extend(e.laplace,{pdf:function Ct(e,r,n){return n<=0?0:t.exp(-t.abs(e-r)/n)/(2*n)},cdf:function _t(e,r,n){if(n<=0){return 0}if(e<r){return.5*t.exp((e-r)/n)}else{return 1-.5*t.exp(-(e-r)/n)}},mean:function Et(e,t){return e},median:function Rt(e,t){return e},mode:function Mt(e,t){return e},variance:function St(e,t){return 2*t*t},sample:function Ot(e,n){var o=t.random()-.5;return e-n*r(o)*t.log(1-2*t.abs(o))}})})(this.jStat,Math);(function(e,t){var r=Array.prototype.push;var n=e.utils.isArray;function o(t){return n(t)||t instanceof e}e.extend({add:function a(t,r){if(o(r)){if(!o(r[0]))r=[r];return e.map(t,function(e,t,n){return e+r[t][n]})}return e.map(t,function(e){return e+r})},subtract:function s(t,r){if(o(r)){if(!o(r[0]))r=[r];return e.map(t,function(e,t,n){return e-r[t][n]||0})}return e.map(t,function(e){return e-r})},divide:function l(t,r){if(o(r)){if(!o(r[0]))r=[r];return e.multiply(t,e.inv(r))}return e.map(t,function(e){return e/r})},multiply:function u(t,r){var n,i,a,s,l,u,d,f;if(t.length===undefined&&r.length===undefined){return t*r}l=t.length,u=t[0].length,d=e.zeros(l,a=o(r)?r[0].length:u),f=0;if(o(r)){for(;f<a;f++){for(n=0;n<l;n++){s=0;for(i=0;i<u;i++){s+=t[n][i]*r[i][f]}d[n][f]=s}}return l===1&&f===1?d[0][0]:d}return e.map(t,function(e){return e*r})},outer:function d(t,r){return e.multiply(t.map(function(e){return[e]}),[r])},dot:function f(t,r){if(!o(t[0]))t=[t];if(!o(r[0]))r=[r];var n=t[0].length===1&&t.length!==1?e.transpose(t):t,i=r[0].length===1&&r.length!==1?e.transpose(r):r,a=[],s=0,l=n.length,u=n[0].length,d,f;for(;s<l;s++){a[s]=[];d=0;for(f=0;f<u;f++){d+=n[s][f]*i[s][f]}a[s]=d}return a.length===1?a[0]:a},pow:function h(r,n){return e.map(r,function(e){return t.pow(e,n)})},exp:function m(r){return e.map(r,function(e){return t.exp(e)})},log:function p(r){return e.map(r,function(e){return t.log(e)})},abs:function v(r){return e.map(r,function(e){return t.abs(e)})},norm:function g(e,r){var n=0,i=0;if(isNaN(r))r=2;if(o(e[0]))e=e[0];for(;i<e.length;i++){n+=t.pow(t.abs(e[i]),r)}return t.pow(n,1/r)},angle:function w(r,n){return t.acos(e.dot(r,n)/(e.norm(r)*e.norm(n)))},aug:function b(e,t){var n=[];for(var o=0;o<e.length;o++){n.push(e[o].slice())}for(var o=0;o<n.length;o++){r.apply(n[o],t[o])}return n},inv:function y(t){var r=t.length;var n=t[0].length;var o=e.identity(r,n);var i=e.gauss_jordan(t,o);var a=[];var s=0;var l;for(;s<r;s++){a[s]=[];for(l=n;l<i[0].length;l++){a[s][l-n]=i[s][l]}}return a},det:function C(e){var t=e.length,r=t*2,n=new Array(r),o=t-1,i=r-1,a=o-t+1,s=i,l=0,u=0,d;if(t===2){return e[0][0]*e[1][1]-e[0][1]*e[1][0]}for(;l<r;l++){n[l]=1}for(var l=0;l<t;l++){for(d=0;d<t;d++){n[a<0?a+t:a]*=e[l][d];n[s<t?s+t:s]*=e[l][d];a++;s--}a=--o-t+1;s=--i}for(var l=0;l<t;l++){u+=n[l]}for(;l<r;l++){u-=n[l]}return u},gauss_elimination:function _(r,n){var o=0,i=0,a=r.length,s=r[0].length,l=1,u=0,d=[],f,c,h,m;r=e.aug(r,n);f=r[0].length;for(var o=0;o<a;o++){c=r[o][o];i=o;for(m=o+1;m<s;m++){if(c<t.abs(r[m][o])){c=r[m][o];i=m}}if(i!=o){for(m=0;m<f;m++){h=r[o][m];r[o][m]=r[i][m];r[i][m]=h}}for(i=o+1;i<a;i++){l=r[i][o]/r[o][o];for(m=o;m<f;m++){r[i][m]=r[i][m]-l*r[o][m]}}}for(var o=a-1;o>=0;o--){u=0;for(i=o+1;i<=a-1;i++){u=u+d[i]*r[o][i]}d[o]=(r[o][f-1]-u)/r[o][o]}return d},gauss_jordan:function E(r,n){var o=e.aug(r,n),i=o.length,a=o[0].length;for(var s=0;s<i;s++){var l=s;for(var u=s+1;u<i;u++){if(t.abs(o[u][s])>t.abs(o[l][s]))l=u}var d=o[s];o[s]=o[l];o[l]=d;for(var u=s+1;u<i;u++){c=o[u][s]/o[s][s];for(var f=s;f<a;f++){o[u][f]-=o[s][f]*c}}}for(var s=i-1;s>=0;s--){c=o[s][s];for(var u=0;u<s;u++){for(var f=a-1;f>s-1;f--){o[u][f]-=o[s][f]*o[u][s]/c}}o[s][s]/=c;for(var f=i;f<a;f++){o[s][f]/=c}}return o},triaUpSolve:function R(t,r){var n=t[0].length;var o=e.zeros(1,n)[0];var i;var a=false;if(r[0].length!=undefined){r=r.map(function(e){return e[0]});a=true}e.arange(n-1,-1,-1).forEach(function(a){i=e.arange(a+1,n).map(function(e){return o[e]*t[a][e]});o[a]=(r[a]-e.sum(i))/t[a][a]});if(a)return o.map(function(e){return[e]});return o},triaLowSolve:function M(t,r){var n=t[0].length;var o=e.zeros(1,n)[0];var i;var a=false;if(r[0].length!=undefined){r=r.map(function(e){return e[0]});a=true}e.arange(n).forEach(function(n){i=e.arange(n).map(function(e){return t[n][e]*o[e]});o[n]=(r[n]-e.sum(i))/t[n][n]});if(a)return o.map(function(e){return[e]});return o},lu:function S(t){var r=t.length;var n=e.identity(r);var o=e.zeros(t.length,t[0].length);var a;e.arange(r).forEach(function(e){o[0][e]=t[0][e]});e.arange(1,r).forEach(function(s){e.arange(s).forEach(function(r){a=e.arange(r).map(function(e){return n[s][e]*o[e][r]});n[s][r]=(t[s][r]-e.sum(a))/o[r][r]});e.arange(s,r).forEach(function(r){a=e.arange(s).map(function(e){return n[s][e]*o[e][r]});o[s][r]=t[i][r]-e.sum(a)})});return[n,o]},cholesky:function O(r){var n=r.length;var o=e.zeros(r.length,r[0].length);var i;e.arange(n).forEach(function(a){i=e.arange(a).map(function(e){return t.pow(o[a][e],2)});o[a][a]=t.sqrt(r[a][a]-e.sum(i));e.arange(a+1,n).forEach(function(t){i=e.arange(a).map(function(e){return o[a][e]*o[t][e]});o[t][a]=(r[a][t]-e.sum(i))/o[a][a]})});return o},gauss_jacobi:function T(r,n,o,i){var a=0;var s=0;var l=r.length;var u=[];var d=[];var f=[];var c,h,m,p;for(;a<l;a++){u[a]=[];d[a]=[];f[a]=[];for(s=0;s<l;s++){if(a>s){u[a][s]=r[a][s];d[a][s]=f[a][s]=0}else if(a<s){d[a][s]=r[a][s];u[a][s]=f[a][s]=0}else{f[a][s]=r[a][s];u[a][s]=d[a][s]=0}}}m=e.multiply(e.multiply(e.inv(f),e.add(u,d)),-1);h=e.multiply(e.inv(f),n);c=o;p=e.add(e.multiply(m,o),h);a=2;while(t.abs(e.norm(e.subtract(p,c)))>i){c=p;p=e.add(e.multiply(m,c),h);a++}return p},gauss_seidel:function A(r,n,o,i){var a=0;var s=r.length;var l=[];var u=[];var d=[];var f,c,h,m,p;for(;a<s;a++){l[a]=[];u[a]=[];d[a]=[];for(f=0;f<s;f++){if(a>f){l[a][f]=r[a][f];u[a][f]=d[a][f]=0}else if(a<f){u[a][f]=r[a][f];l[a][f]=d[a][f]=0}else{d[a][f]=r[a][f];l[a][f]=u[a][f]=0}}}m=e.multiply(e.multiply(e.inv(e.add(d,l)),u),-1);h=e.multiply(e.inv(e.add(d,l)),n);c=o;p=e.add(e.multiply(m,o),h);a=2;while(t.abs(e.norm(e.subtract(p,c)))>i){c=p;p=e.add(e.multiply(m,c),h);a=a+1}return p},SOR:function N(r,n,o,i,a){var s=0;var l=r.length;var u=[];var d=[];var f=[];var c,h,m,p,v;for(;s<l;s++){u[s]=[];d[s]=[];f[s]=[];for(c=0;c<l;c++){if(s>c){u[s][c]=r[s][c];d[s][c]=f[s][c]=0}else if(s<c){d[s][c]=r[s][c];u[s][c]=f[s][c]=0}else{f[s][c]=r[s][c];u[s][c]=d[s][c]=0}}}p=e.multiply(e.inv(e.add(f,e.multiply(u,a))),e.subtract(e.multiply(f,1-a),e.multiply(d,a)));m=e.multiply(e.multiply(e.inv(e.add(f,e.multiply(u,a))),n),a);h=o;v=e.add(e.multiply(p,o),m);s=2;while(t.abs(e.norm(e.subtract(v,h)))>i){h=v;v=e.add(e.multiply(p,h),m);s++}return v},householder:function D(r){var n=r.length;var o=r[0].length;var i=0;var a=[];var s=[];var l,u,d,f,c;for(;i<n-1;i++){l=0;for(f=i+1;f<o;f++){l+=r[f][i]*r[f][i]}c=r[i+1][i]>0?-1:1;l=c*t.sqrt(l);u=t.sqrt((l*l-r[i+1][i]*l)/2);a=e.zeros(n,1);a[i+1][0]=(r[i+1][i]-l)/(2*u);for(d=i+2;d<n;d++){a[d][0]=r[d][i]/(2*u)}s=e.subtract(e.identity(n,o),e.multiply(e.multiply(a,e.transpose(a)),2));r=e.multiply(s,e.multiply(r,s))}return r},QR:function(){function t(t){var r=t.length;var n=e.norm(t,2);var o=e.zeros(1,r)[0];o[0]=1;var i=e.add(e.multiply(e.multiply(o,n),-1),t);var a=e.norm(i,2);var s=e.divide(i,a);var l=e.subtract(e.identity(r),e.multiply(e.outer(s,s),2));return l}function r(r){var n=r[0].length;var o=[];e.arange(n).forEach(function(n){var i=e.slice(r,{row:{start:n},col:n});var a=t(i);var s=e.identity(r.length);s=e.sliceAssign(s,{row:{start:n},col:{start:n}},a);r=e.multiply(s,r);o.push(s)});var i=o.reduce(function(t,r){return e.multiply(t,r)});var a=r;return[i,a]}return r}(),lstsq:function(t,r){function n(t){t=e.copy(t);var r=t.length;var n=e.identity(r);e.arange(r-1,-1,-1).forEach(function(r){e.sliceAssign(n,{row:r},e.divide(e.slice(n,{row:r}),t[r][r]));e.sliceAssign(t,{row:r},e.divide(e.slice(t,{row:r}),t[r][r]));e.arange(r).forEach(function(o){var i=e.multiply(t[o][r],-1);var a=e.slice(t,{row:o});var s=e.multiply(e.slice(t,{row:r}),i);e.sliceAssign(t,{row:o},e.add(a,s));var l=e.slice(n,{row:o});var u=e.multiply(e.slice(n,{row:r}),i);e.sliceAssign(n,{row:o},e.add(l,u))})});return n}function o(t,r){var o=false;if(r[0].length===undefined){r=r.map(function(e){return[e]});o=true}var i=e.QR(t);var a=i[0];var s=i[1];var l=t[0].length;var u=e.slice(a,{col:{end:l}});var d=e.slice(s,{row:{end:l}});var f=n(d);var c=e.multiply(e.multiply(f,e.transpose(u)),r);if(o)return c.map(function(e){return e[0]});return c}return o}(),jacobi:function k(r){var n=1;var o=0;var i=r.length;var a=e.identity(i,i);var s=[];var l,u,d,f,c,h,m,p;while(n===1){o++;h=r[0][1];f=0;c=1;for(var u=0;u<i;u++){for(d=0;d<i;d++){if(u!=d){if(h<t.abs(r[u][d])){h=t.abs(r[u][d]);f=u;c=d}}}}if(r[f][f]===r[c][c])m=r[f][c]>0?t.PI/4:-t.PI/4;else m=t.atan(2*r[f][c]/(r[f][f]-r[c][c]))/2;p=e.identity(i,i);p[f][f]=t.cos(m);p[f][c]=-t.sin(m);p[c][f]=t.sin(m);p[c][c]=t.cos(m);a=e.multiply(a,p);l=e.multiply(e.multiply(e.inv(p),r),p);r=l;n=0;for(var u=1;u<i;u++){for(d=1;d<i;d++){if(u!=d&&t.abs(r[u][d])>.001){n=1}}}}for(var u=0;u<i;u++){s.push(r[u][u])}return[a,s]},rungekutta:function x(e,t,r,n,o,i){var a,s,l,u,d;if(i===2){while(n<=r){a=t*e(n,o);s=t*e(n+t,o+a);l=o+(a+s)/2;o=l;n=n+t}}if(i===4){while(n<=r){a=t*e(n,o);s=t*e(n+t/2,o+a/2);u=t*e(n+t/2,o+s/2);d=t*e(n+t,o+u);l=o+(a+2*s+2*u+d)/6;o=l;n=n+t}}return o},romberg:function I(e,r,n,o){var i=0;var a=(n-r)/2;var s=[];var l=[];var u=[];var d,f,c,h,m,p;while(i<o/2){m=e(r);for(c=r,h=0;c<=n;c=c+a,h++){s[h]=c}d=s.length;for(c=1;c<d-1;c++){m+=(c%2!==0?4:2)*e(s[c])}m=a/3*(m+e(n));u[i]=m;a/=2;i++}f=u.length;d=1;while(f!==1){for(c=0;c<f-1;c++){l[c]=(t.pow(4,d)*u[c+1]-u[c])/(t.pow(4,d)-1)}f=l.length;u=l;l=[];d++}return u},richardson:function P(e,r,n,o){function i(e,t){var r=0;var n=e.length;var o;for(;r<n;r++){if(e[r]===t)o=r}return o}var a=e.length,s=t.abs(n-e[i(e,n)+1]),l=0,u=[],d=[],f,c,h,m,p;while(o>=s){
f=i(e,n+o);c=i(e,n);u[l]=(r[f]-2*r[c]+r[2*c-f])/(o*o);o/=2;l++}m=u.length;h=1;while(m!=1){for(p=0;p<m-1;p++){d[p]=(t.pow(4,h)*u[p+1]-u[p])/(t.pow(4,h)-1)}m=d.length;u=d;d=[];h++}return u},simpson:function L(e,t,r,n){var o=(r-t)/n;var i=e(t);var a=[];var s=t;var l=0;var u=1;var d;for(;s<=r;s=s+o,l++){a[l]=s}d=a.length;for(;u<d-1;u++){i+=(u%2!==0?4:2)*e(a[u])}return o/3*(i+e(r))},hermite:function H(e,t,r,n){var o=e.length;var i=0;var a=0;var s=[];var l=[];var u=[];var d=[];var f;for(;a<o;a++){s[a]=1;for(f=0;f<o;f++){if(a!=f)s[a]*=(n-e[f])/(e[a]-e[f])}l[a]=0;for(f=0;f<o;f++){if(a!=f)l[a]+=1/(e[a]-e[f])}u[a]=(1-2*(n-e[a])*l[a])*(s[a]*s[a]);d[a]=(n-e[a])*(s[a]*s[a]);i+=u[a]*t[a]+d[a]*r[a]}return i},lagrange:function V(e,t,r){var n=0;var o=0;var i,a;var s=e.length;for(;o<s;o++){a=t[o];for(i=0;i<s;i++){if(o!=i)a*=(r-e[i])/(e[o]-e[i])}n+=a}return n},cubic_spline:function F(t,r,n){var o=t.length;var i=0,a;var s=[];var l=[];var u=[];var d=[];var f=[];var c=[];var h=[];for(;i<o-1;i++){f[i]=t[i+1]-t[i]}u[0]=0;for(var i=1;i<o-1;i++){u[i]=3/f[i]*(r[i+1]-r[i])-3/f[i-1]*(r[i]-r[i-1])}for(var i=1;i<o-1;i++){s[i]=[];l[i]=[];s[i][i-1]=f[i-1];s[i][i]=2*(f[i-1]+f[i]);s[i][i+1]=f[i];l[i][0]=u[i]}d=e.multiply(e.inv(s),l);for(a=0;a<o-1;a++){c[a]=(r[a+1]-r[a])/f[a]-f[a]*(d[a+1][0]+2*d[a][0])/3;h[a]=(d[a+1][0]-d[a][0])/(3*f[a])}for(a=0;a<o;a++){if(t[a]>n)break}a-=1;return r[a]+(n-t[a])*c[a]+e.sq(n-t[a])*d[a]+(n-t[a])*e.sq(n-t[a])*h[a]},gauss_quadrature:function B(){throw new Error("gauss_quadrature not yet implemented")},PCA:function j(t){var r=t.length;var n=t[0].length;var o=false;var i=0;var a,s;var l=[];var u=[];var d=[];var f=[];var c=[];var h=[];var m=[];var p=[];var v=[];var g=[];for(var i=0;i<r;i++){l[i]=e.sum(t[i])/n}for(var i=0;i<n;i++){m[i]=[];for(a=0;a<r;a++){m[i][a]=t[a][i]-l[a]}}m=e.transpose(m);for(var i=0;i<r;i++){p[i]=[];for(a=0;a<r;a++){p[i][a]=e.dot([m[i]],[m[a]])/(n-1)}}d=e.jacobi(p);v=d[0];u=d[1];g=e.transpose(v);for(var i=0;i<u.length;i++){for(a=i;a<u.length;a++){if(u[i]<u[a]){s=u[i];u[i]=u[a];u[a]=s;f=g[i];g[i]=g[a];g[a]=f}}}h=e.transpose(m);for(var i=0;i<r;i++){c[i]=[];for(a=0;a<h.length;a++){c[i][a]=e.dot([g[i]],[h[a]])}}return[t,u,g,c]}});(function(t){for(var r=0;r<t.length;r++){(function(t){e.fn[t]=function(r,n){var o=this;if(n){setTimeout(function(){n.call(o,e.fn[t].call(o,r))},15);return this}if(typeof e[t](this,r)==="number")return e[t](this,r);else return e(e[t](this,r))}})(t[r])}})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(this.jStat,Math);(function(e,t){var r=[].slice;var n=e.utils.isNumber;var o=e.utils.isArray;e.extend({zscore:function a(){var t=r.call(arguments);if(n(t[1])){return(t[0]-t[1])/t[2]}return(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function s(){var n=r.call(arguments);var i;if(o(n[1])){i=e.zscore(n[0],n[1],n[3]);return n[2]===1?e.normal.cdf(-t.abs(i),0,1):e.normal.cdf(-t.abs(i),0,1)*2}else{if(n.length>2){i=e.zscore(n[0],n[1],n[2]);return n[3]===1?e.normal.cdf(-t.abs(i),0,1):e.normal.cdf(-t.abs(i),0,1)*2}else{i=n[0];return n[1]===1?e.normal.cdf(-t.abs(i),0,1):e.normal.cdf(-t.abs(i),0,1)*2}}}});e.extend(e.fn,{zscore:function l(e,t){return(e-this.mean())/this.stdev(t)},ztest:function u(r,n,o){var i=t.abs(this.zscore(r,o));return n===1?e.normal.cdf(-i,0,1):e.normal.cdf(-i,0,1)*2}});e.extend({tscore:function d(){var n=r.call(arguments);return n.length===4?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],true)/t.sqrt(n[1].length))},ttest:function f(){var o=r.call(arguments);var i;if(o.length===5){i=t.abs(e.tscore(o[0],o[1],o[2],o[3]));return o[4]===1?e.studentt.cdf(-i,o[3]-1):e.studentt.cdf(-i,o[3]-1)*2}if(n(o[1])){i=t.abs(o[0]);return o[2]==1?e.studentt.cdf(-i,o[1]-1):e.studentt.cdf(-i,o[1]-1)*2}i=t.abs(e.tscore(o[0],o[1]));return o[2]==1?e.studentt.cdf(-i,o[1].length-1):e.studentt.cdf(-i,o[1].length-1)*2}});e.extend(e.fn,{tscore:function c(e){return(e-this.mean())/(this.stdev(true)/t.sqrt(this.cols()))},ttest:function h(r,n){return n===1?1-e.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):e.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)*2}});e.extend({anovafscore:function m(){var n=r.call(arguments),o,i,a,s,l,u,d,f;if(n.length===1){l=new Array(n[0].length);for(var d=0;d<n[0].length;d++){l[d]=n[0][d]}n=l}if(n.length===2){return e.variance(n[0])/e.variance(n[1])}i=new Array;for(var d=0;d<n.length;d++){i=i.concat(n[d])}a=e.mean(i);o=0;for(var d=0;d<n.length;d++){o=o+n[d].length*t.pow(e.mean(n[d])-a,2)}o/=n.length-1;u=0;for(var d=0;d<n.length;d++){s=e.mean(n[d]);for(f=0;f<n[d].length;f++){u+=t.pow(n[d][f]-s,2)}}u/=i.length-n.length;return o/u},anovaftest:function p(){var t=r.call(arguments),o,i,a,s;if(n(t[0])){return 1-e.centralF.cdf(t[0],t[1],t[2])}anovafscore=e.anovafscore(t);o=t.length-1;a=0;for(var s=0;s<t.length;s++){a=a+t[s].length}i=a-o-1;return 1-e.centralF.cdf(anovafscore,o,i)},ftest:function v(t,r,n){return 1-e.centralF.cdf(t,r,n)}});e.extend(e.fn,{anovafscore:function g(){return e.anovafscore(this.toArray())},anovaftes:function w(){var t=0;var r;for(var r=0;r<this.length;r++){t=t+this[r].length}return e.ftest(this.anovafscore(),this.length-1,t-this.length)}});e.extend({normalci:function b(){var n=r.call(arguments),o=new Array(2),i;if(n.length===4){i=t.abs(e.normal.inv(n[1]/2,0,1)*n[2]/t.sqrt(n[3]))}else{i=t.abs(e.normal.inv(n[1]/2,0,1)*e.stdev(n[2])/t.sqrt(n[2].length))}o[0]=n[0]-i;o[1]=n[0]+i;return o},tci:function y(){var n=r.call(arguments),o=new Array(2),i;if(n.length===4){i=t.abs(e.studentt.inv(n[1]/2,n[3]-1)*n[2]/t.sqrt(n[3]))}else{i=t.abs(e.studentt.inv(n[1]/2,n[2].length-1)*e.stdev(n[2],true)/t.sqrt(n[2].length))}o[0]=n[0]-i;o[1]=n[0]+i;return o},significant:function C(e,t){return e<t}});e.extend(e.fn,{normalci:function _(t,r){return e.normalci(t,r,this.toArray())},tci:function E(t,r){return e.tci(t,r,this.toArray())}});function i(e,r,n,o){if(e>1||n>1||e<=0||n<=0){throw new Error("Proportions should be greater than 0 and less than 1")}var i=(e*r+n*o)/(r+o);var a=t.sqrt(i*(1-i)*(1/r+1/o));return(e-n)/a}e.extend(e.fn,{oneSidedDifferenceOfProportions:function R(t,r,n,o){var a=i(t,r,n,o);return e.ztest(a,1)},twoSidedDifferenceOfProportions:function M(t,r,n,o){var a=i(t,r,n,o);return e.ztest(a,2)}})})(this.jStat,Math);this.jStat.models=function(){function e(e,r){return t(e,r)}function e(e){var r=e[0].length;var n=jStat.arange(r).map(function(n){var o=jStat.arange(r).filter(function(e){return e!==n});return t(jStat.col(e,n).map(function(e){return e[0]}),jStat.col(e,o))});return n}function t(e,t){var r=e.length;var n=t[0].length-1;var o=r-n-1;var i=jStat.lstsq(t,e);var a=jStat.multiply(t,i.map(function(e){return[e]})).map(function(e){return e[0]});var s=jStat.subtract(e,a);var l=jStat.mean(e);var u=jStat.sum(a.map(function(e){return Math.pow(e-l,2)}));var d=jStat.sum(e.map(function(e,t){return Math.pow(e-a[t],2)}));var f=u+d;var c=u/f;return{exog:t,endog:e,nobs:r,df_model:n,df_resid:o,coef:i,predict:a,resid:s,ybar:l,SST:f,SSE:u,SSR:d,R2:c}}function r(t){var r=e(t.exog);var n=Math.sqrt(t.SSR/t.df_resid);var o=r.map(function(e){var t=e.SST;var r=e.R2;return n/Math.sqrt(t*(1-r))});var i=t.coef.map(function(e,t){return(e-0)/o[t]});var a=i.map(function(e){var r=jStat.studentt.cdf(e,t.df_resid);return(r>.5?1-r:r)*2});var s=jStat.studentt.inv(.975,t.df_resid);var l=t.coef.map(function(e,t){var r=s*o[t];return[e-r,e+r]});return{se:o,t:i,p:a,sigmaHat:n,interval95:l}}function n(e){var t=e.R2/e.df_model/((1-e.R2)/e.df_resid);var r=function o(e,t,r){return jStat.beta.cdf(e/(r/t+e),t/2,r/2)};var n=1-r(t,e.df_model,e.df_resid);return{F_statistic:t,pvalue:n}}function o(e,o){var i=t(e,o);var a=r(i);var s=n(i);var l=1-(1-i.rsquared)*((i.nobs-1)/i.df_resid);i.t=a;i.f=s;i.adjust_R2=l;return i}return{ols:o}}()},function(e,t,r){(function(n){var o,i;/*!
 * numbro.js
 * version : 1.9.3
 * author : Fretagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";var a,s="1.9.3",l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],d={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:l,marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f=[d.general,d.binary,d.decimal],c={},h=c,m="en-US",p=null,v="0,0",g="0$",w=typeof e!=="undefined"&&e.exports,b={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function V(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};function y(e){this._value=e}function C(e){var t,r="";for(t=0;t<e;t++){r+="0"}return r}function _(e,t){var r,n,o,i,a,s,l,u;u=e.toString();r=u.split("e")[0];i=u.split("e")[1];n=r.split(".")[0];o=r.split(".")[1]||"";if(+i>0){u=n+o+C(i-o.length)}else{if(+n<0){a="-0"}else{a="0"}if(t>0){a+="."}l=C(-1*i-1);s=(l+Math.abs(n)+o).substr(0,t);u=a+s}if(+i>0&&t>0){u+="."+C(t)}return u}function E(e,t,r,n){var o=Math.pow(10,t),i,a;if(e.toString().indexOf("e")>-1){a=_(e,t);if(a.charAt(0)==="-"&&+a>=0){a=a.substr(1)}}else{a=(r(e+"e+"+t)/o).toFixed(t)}if(n){i=new RegExp("0{1,"+n+"}$");a=a.replace(i,"")}return a}function R(e,t,r){var n,o=t.replace(/\{[^\{\}]*\}/g,"");if(o.indexOf("$")>-1){n=S(e,c[m].currency.symbol,t,r)}else if(o.indexOf("%")>-1){n=T(e,t,r)}else if(o.indexOf(":")>-1){n=A(e,t)}else{n=k(e._value,t,r)}return n}function M(e,t){var r=t,n,o,i,a,s=false,d;if(t.indexOf(":")>-1){e._value=N(t)}else{if(t===p){e._value=0}else{if(c[m].delimiters.decimal!=="."){t=t.replace(/\./g,"").replace(c[m].delimiters.decimal,".")}n=new RegExp("[^a-zA-Z]"+c[m].abbreviations.thousand+"(?:\\)|(\\"+c[m].currency.symbol+")?(?:\\))?)?$");o=new RegExp("[^a-zA-Z]"+c[m].abbreviations.million+"(?:\\)|(\\"+c[m].currency.symbol+")?(?:\\))?)?$");i=new RegExp("[^a-zA-Z]"+c[m].abbreviations.billion+"(?:\\)|(\\"+c[m].currency.symbol+")?(?:\\))?)?$");a=new RegExp("[^a-zA-Z]"+c[m].abbreviations.trillion+"(?:\\)|(\\"+c[m].currency.symbol+")?(?:\\))?)?$");for(d=1;d<l.length&&!s;++d){if(t.indexOf(l[d])>-1){s=Math.pow(1024,d)}else if(t.indexOf(u[d])>-1){s=Math.pow(1e3,d)}}var f=t.replace(/[^0-9\.]+/g,"");if(f===""){e._value=NaN}else{e._value=(s?s:1)*(r.match(n)?Math.pow(10,3):1)*(r.match(o)?Math.pow(10,6):1)*(r.match(i)?Math.pow(10,9):1)*(r.match(a)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(f);e._value=s?Math.ceil(e._value):e._value}}}return e._value}function S(e,t,r,n){var o=r,i=o.indexOf("$"),a=o.indexOf("("),s=o.indexOf("+"),l=o.indexOf("-"),u="",d="",f,h;if(o.indexOf("$")===-1){if(c[m].currency.position==="infix"){d=t;if(c[m].currency.spaceSeparated){d=" "+d+" "}}else if(c[m].currency.spaceSeparated){u=" "}}else{if(o.indexOf(" $")>-1){u=" ";o=o.replace(" $","")}else if(o.indexOf("$ ")>-1){u=" ";o=o.replace("$ ","")}else{o=o.replace("$","")}}h=k(e._value,o,n,d);if(r.indexOf("$")===-1){switch(c[m].currency.position){case"postfix":if(h.indexOf(")")>-1){h=h.split("");h.splice(-1,0,u+t);h=h.join("")}else{h=h+u+t}break;case"infix":break;case"prefix":if(h.indexOf("(")>-1||h.indexOf("-")>-1){h=h.split("");f=Math.max(a,l)+1;h.splice(f,0,t+u);h=h.join("")}else{h=t+u+h}break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}}else{if(i<=1){if(h.indexOf("(")>-1||h.indexOf("+")>-1||h.indexOf("-")>-1){h=h.split("");f=1;if(i<a||i<s||i<l){f=0}h.splice(f,0,t+u);h=h.join("")}else{h=t+u+h}}else{if(h.indexOf(")")>-1){h=h.split("");h.splice(-1,0,u+t);h=h.join("")}else{h=h+u+t}}}return h}function O(e,t,r,n){return S(e,t,r,n)}function T(e,t,r){var n="",o,i=e._value*100;if(t.indexOf(" %")>-1){n=" ";t=t.replace(" %","")}else{t=t.replace("%","")}o=k(i,t,r);if(o.indexOf(")")>-1){o=o.split("");o.splice(-1,0,n+"%");o=o.join("")}else{o=o+n+"%"}return o}function A(e){var t=Math.floor(e._value/60/60),r=Math.floor((e._value-t*60*60)/60),n=Math.round(e._value-t*60*60-r*60);return t+":"+(r<10?"0"+r:r)+":"+(n<10?"0"+n:n)}function N(e){var t=e.split(":"),r=0;if(t.length===3){r=r+Number(t[0])*60*60;r=r+Number(t[1])*60;r=r+Number(t[2])}else if(t.length===2){r=r+Number(t[0])*60;r=r+Number(t[1])}return Number(r)}function D(e,t,r){var n=t[0],o,i,a,s=Math.abs(e);if(s>=r){for(o=1;o<t.length;++o){i=Math.pow(r,o);a=Math.pow(r,o+1);if(s>=i&&s<a){n=t[o];e=e/i;break}}if(n===t[0]){e=e/Math.pow(r,t.length-1);n=t[t.length-1]}}return{value:e,suffix:n}}function k(e,t,r,n){var o=false,i=false,a=false,s="",l=false,u=false,d=false,h=false,v=false,g="",w,b,y="",_=Math.abs(e),R,M,S,O,T,A,N,k,x,I,P="",L=false,H=false,V,F,B,j="",W,$;if(e===0&&p!==null){return p}if(!isFinite(e)){return""+e}if(t.indexOf("{")===0){var U=t.indexOf("}");if(U===-1){throw Error('Format should also contain a "}"')}k=t.slice(1,U);t=t.slice(U+1)}else{k=""}if(t.indexOf("}")===t.length-1){var G=t.indexOf("{");if(G===-1){throw Error('Format should also contain a "{"')}x=t.slice(G+1,-1);t=t.slice(0,G+1)}else{x=""}var Y;if(t.indexOf(".")===-1){Y=t.match(/([0-9]+).*/)}else{Y=t.match(/([0-9]+)\..*/)}W=Y===null?-1:Y[1].length;if(t.indexOf("-")!==-1){L=true}if(t.indexOf("(")>-1){o=true;t=t.slice(1,-1)}else if(t.indexOf("+")>-1){i=true;t=t.replace(/\+/g,"")}if(t.indexOf("a")>-1){A=t.split(".")[0].match(/[0-9]+/g)||["0"];A=parseInt(A[0],10);l=t.indexOf("aK")>=0;u=t.indexOf("aM")>=0;d=t.indexOf("aB")>=0;h=t.indexOf("aT")>=0;v=l||u||d||h;if(t.indexOf(" a")>-1){s=" ";t=t.replace(" a","")}else{t=t.replace("a","")}R=Math.floor(Math.log(_)/Math.LN10)+1;S=R%3;S=S===0?3:S;if(A&&_!==0){M=Math.floor(Math.log(_)/Math.LN10)+1-A;O=3*~~((Math.min(A,R)-S)/3);_=_/Math.pow(10,O);if(t.indexOf(".")===-1&&A>3){t+="[.]";F=M===0?0:3*~~(M/3)-M;F=F<0?F+3:F;t+=C(F)}}if(Math.floor(Math.log(Math.abs(e))/Math.LN10)+1!==A){if(_>=Math.pow(10,12)&&!v||h){s=s+c[m].abbreviations.trillion;e=e/Math.pow(10,12)}else if(_<Math.pow(10,12)&&_>=Math.pow(10,9)&&!v||d){s=s+c[m].abbreviations.billion;e=e/Math.pow(10,9)}else if(_<Math.pow(10,9)&&_>=Math.pow(10,6)&&!v||u){s=s+c[m].abbreviations.million;e=e/Math.pow(10,6)}else if(_<Math.pow(10,6)&&_>=Math.pow(10,3)&&!v||l){s=s+c[m].abbreviations.thousand;e=e/Math.pow(10,3)}}}for($=0;$<f.length;++$){w=f[$];if(t.indexOf(w.marker)>-1){if(t.indexOf(" "+w.marker)>-1){g=" "}t=t.replace(g+w.marker,"");b=D(e,w.suffixes,w.scale);e=b.value;g=g+b.suffix;break}}if(t.indexOf("o")>-1){if(t.indexOf(" o")>-1){y=" ";t=t.replace(" o","")}else{t=t.replace("o","")}if(c[m].ordinal){y=y+c[m].ordinal(e)}}if(t.indexOf("[.]")>-1){a=true;t=t.replace("[.]",".")}T=e.toString().split(".")[0];N=t.split(".")[1];I=t.indexOf(",");if(N){if(N.indexOf("*")!==-1){P=E(e,e.toString().split(".")[1].length,r)}else{if(N.indexOf("[")>-1){N=N.replace("]","");N=N.split("[");P=E(e,N[0].length+N[1].length,r,N[1].length)}else{P=E(e,N.length,r)}}T=P.split(".")[0];if(P.split(".")[1].length){var z=n?s+n:c[m].delimiters.decimal;P=z+P.split(".")[1]}else{P=""}if(a&&Number(P.slice(1))===0){P=""}}else{T=E(e,0,r)}if(T.indexOf("-")>-1){T=T.slice(1);H=true}if(T.length<W){T=C(W-T.length)+T}if(I>-1){T=T.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+c[m].delimiters.thousands)}if(t.indexOf(".")===0){T=""}V=t.indexOf("(");B=t.indexOf("-");if(V<B){j=(o&&H?"(":"")+(L&&H||!o&&H?"-":"")}else{j=(L&&H||!o&&H?"-":"")+(o&&H?"(":"")}return k+j+(!H&&i&&e!==0?"+":"")+T+P+(y?y:"")+(s&&!n?s:"")+(g?g:"")+(o&&H?")":"")+x}a=function F(e){if(a.isNumbro(e)){e=e.value()}else if(e===0||typeof e==="undefined"){e=0}else if(!Number(e)){e=a.fn.unformat(e)}return new y(Number(e))};a.version=s;a.isNumbro=function(e){return e instanceof y};a.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var r=e,n=e.split("-")[0],o=null;if(!h[r]){Object.keys(h).forEach(function(e){if(!o&&e.split("-")[0]===n){o=e}});r=o||t||"en-US"}I(r)};a.setCulture=function(e,t){var r=e,n=e.split("-")[1],o=null;if(!c[r]){if(n){Object.keys(c).forEach(function(e){if(!o&&e.split("-")[1]===n){o=e}})}r=o||t||"en-US"}I(r)};a.language=function(e,t){console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead");if(!e){return m}if(e&&!t){if(!h[e]){throw new Error("Unknown language : "+e)}I(e)}if(t||!h[e]){x(e,t)}return a};a.culture=function(e,t){if(!e){return m}if(e&&!t){if(!c[e]){throw new Error("Unknown culture : "+e)}I(e)}if(t||!c[e]){x(e,t)}return a};a.languageData=function(e){console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead");if(!e){return h[m]}if(!h[e]){throw new Error("Unknown language : "+e)}return h[e]};a.cultureData=function(e){if(!e){return c[m]}if(!c[e]){throw new Error("Unknown culture : "+e)}return c[e]};a.culture("en-US",b);a.languages=function(){console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead");return h};a.cultures=function(){return c};a.zeroFormat=function(e){p=typeof e==="string"?e:null};a.defaultFormat=function(e){v=typeof e==="string"?e:"0.0"};a.defaultCurrencyFormat=function(e){g=typeof e==="string"?e:"0$"};a.validate=function(e,t){var r,n,o,i,s,l,u,d;if(typeof e!=="string"){e+="";if(console.warn){console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)}}e=e.trim();e=e.replace(/^[+-]?/,"");if(!!e.match(/^\d+$/)){return true}if(e===""){return false}try{u=a.cultureData(t)}catch(f){u=a.cultureData(a.culture())}o=u.currency.symbol;s=u.abbreviations;r=u.delimiters.decimal;if(u.delimiters.thousands==="."){n="\\."}else{n=u.delimiters.thousands}d=e.match(/^[^\d\.\,]+/);if(d!==null){e=e.substr(1);if(d[0]!==o){return false}}d=e.match(/[^\d]+$/);if(d!==null){e=e.slice(0,-1);if(d[0]!==s.thousand&&d[0]!==s.million&&d[0]!==s.billion&&d[0]!==s.trillion){return false}}l=new RegExp(n+"{2}");if(!e.match(/[^\d.,]/g)){i=e.split(r);if(i.length>2){return false}else{if(i.length<2){return!!i[0].match(/^\d+.*\d$/)&&!i[0].match(l)}else{if(i[0]===""){return!i[0].match(l)&&!!i[1].match(/^\d+$/)}else if(i[0].length===1){return!!i[0].match(/^\d+$/)&&!i[0].match(l)&&!!i[1].match(/^\d+$/)}else{return!!i[0].match(/^\d+.*\d$/)&&!i[0].match(l)&&!!i[1].match(/^\d+$/)}}}}return false};a.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead");a.loadCulturesInNode()};a.loadCulturesInNode=function(){var e=r(58);for(var t in e){if(t){a.culture(t,e[t])}}};function x(e,t){c[e]=t}function I(e){m=e;var t=c[e].defaults;if(t&&t.format){a.defaultFormat(t.format)}if(t&&t.currencyFormat){a.defaultCurrencyFormat(t.currencyFormat)}}function P(){return typeof n!=="undefined"&&n.browser===undefined&&n.title&&(n.title.indexOf("node")===0||n.title.indexOf("meteor-tool")>0||n.title==="grunt"||n.title==="gulp")&&"function"!=="undefined"}if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(e,t){if(null===this||"undefined"===typeof this){throw new TypeError("Array.prototype.reduce called on null or undefined")}if("function"!==typeof e){throw new TypeError(e+" is not a function")}var r,n,o=this.length>>>0,i=false;if(1<arguments.length){n=t;i=true}for(r=0;o>r;++r){if(this.hasOwnProperty(r)){if(i){n=e(n,this[r],r,this)}else{n=this[r];i=true}}}if(!i){throw new TypeError("Reduce of empty array with no initial value")}return n}}function L(e){var t=e.toString().split(".");if(t.length<2){return 1}return Math.pow(10,t[1].length)}function H(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var r=L(e),n=L(t);return r>n?r:n},-Infinity)}a.fn=y.prototype={clone:function B(){return a(this)},format:function j(e,t){return R(this,e?e:v,t!==undefined?t:Math.round)},formatCurrency:function W(e,t){return S(this,c[m].currency.symbol,e?e:g,t!==undefined?t:Math.round)},formatForeignCurrency:function $(e,t,r){return O(this,e,t?t:g,r!==undefined?r:Math.round)},unformat:function U(e){if(typeof e==="number"){return e}else if(typeof e==="string"){var t=M(this,e);return isNaN(t)?undefined:t}else{return undefined}},binaryByteUnits:function G(){return D(this._value,d.binary.suffixes,d.binary.scale).suffix},byteUnits:function Y(){return D(this._value,d.general.suffixes,d.general.scale).suffix},decimalByteUnits:function z(){return D(this._value,d.decimal.suffixes,d.decimal.scale).suffix},value:function K(){return this._value},valueOf:function q(){return this._value},set:function X(e){this._value=Number(e);return this},add:function J(e){var t=H.call(null,this._value,e);function r(e,r){return e+t*r}this._value=[this._value,e].reduce(r,0)/t;return this},subtract:function Z(e){var t=H.call(null,this._value,e);function r(e,r){return e-t*r}this._value=[e].reduce(r,this._value*t)/t;return this},multiply:function Q(e){function t(e,t){var r=H(e,t),n=e*r;n*=t*r;n/=r*r;return n}this._value=[this._value,e].reduce(t,1);return this},divide:function ee(e){function t(e,t){var r=H(e,t);return e*r/(t*r)}this._value=[this._value,e].reduce(t);return this},difference:function te(e){return Math.abs(a(this._value).subtract(e).value())}};if(P()){a.loadCulturesInNode()}if(w){e.exports=a}else{if(typeof ender==="undefined"){this.numbro=a}if(true){!(o=[],i=function(){return a}.apply(t,o),i!==undefined&&(e.exports=i))}}}).call(typeof window==="undefined"?this:window)}).call(t,r(15))},function(e,t){var r=e.exports={};var n;var o;function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=i}}catch(e){n=i}try{if(typeof clearTimeout==="function"){o=clearTimeout}else{o=a}}catch(e){o=a}})();function s(e){if(n===setTimeout){return setTimeout(e,0)}if((n===i||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function l(e){if(o===clearTimeout){return clearTimeout(e)}if((o===a||!o)&&clearTimeout){o=clearTimeout;return clearTimeout(e)}try{return o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}var u=[];var d=false;var f;var c=-1;function h(){if(!d||!f){return}d=false;if(f.length){u=f.concat(u)}else{c=-1}if(u.length){m()}}function m(){if(d){return}var e=s(h);d=true;var t=u.length;while(t){f=u;u=[];while(++c<t){if(f){f[c].run()}}c=-1;t=u.length}f=null;d=false;l(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}u.push(new p(e,t));if(u.length===1&&!d){s(m)}};function p(e,t){this.fun=e;this.array=t}p.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function v(){}r.on=v;r.addListener=v;r.once=v;r.off=v;r.removeListener=v;r.removeAllListeners=v;r.emit=v;r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t,r){"use strict";t.__esModule=true;var n=r(78);var o=h(n);var i=r(17);var a=h(i);var s=r(80);var l=r(31);var u=r(3);var d=r(1);var f=h(d);var c=r(9);function h(e){return e&&e.__esModule?e:{"default":e}}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&((typeof t==="undefined"?"undefined":_typeof(t))==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof t==="undefined"?"undefined":_typeof(t)))}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var g=function(e){v(t,e);function t(){m(this,t);var r=p(this,e.call(this));r.parser=new s.Parser;r.parser.yy={toNumber:u.toNumber,trimEdges:l.trimEdges,invertNumber:u.invertNumber,throwError:function n(e){return r._throwError(e)},callVariable:function o(e){return r._callVariable(e)},evaluateByOperator:a["default"],callFunction:a["default"],cellValue:function i(e){return r._callCellValue(e)},rangeValue:function d(e,t){return r._callRangeValue(e,t)}};r.variables=Object.create(null);r.setVariable("TRUE",true).setVariable("FALSE",false).setVariable("NULL",null);return r}t.prototype.parse=function r(e){var t=null;var r=null;try{if(e===""){t=""}else{t=this.parser.parse(e)}}catch(n){var o=(0,f["default"])(n.message);if(o){r=o}else{r=(0,f["default"])(d.ERROR)}}if(t instanceof Error){r=(0,f["default"])(t.message)||(0,f["default"])(d.ERROR);t=null}return{error:r,result:t}};t.prototype.setVariable=function n(e,t){this.variables[e]=t;return this};t.prototype.getVariable=function o(e){return this.variables[e]};t.prototype._callVariable=function i(e){var t=this.getVariable(e);this.emit("callVariable",e,function(e){if(e!==void 0){t=e}});if(t===void 0){throw Error(d.ERROR_NAME)}return t};t.prototype._callCellValue=function h(e){e=e.toUpperCase();var t=(0,c.extractLabel)(e),r=t[0],n=t[1];var o=void 0;this.emit("callCellValue",{label:e,row:r,column:n},function(e){o=e});return o};t.prototype._callRangeValue=function g(e,t){e=e.toUpperCase();t=t.toUpperCase();var r=(0,c.extractLabel)(e),n=r[0],o=r[1];var i=(0,c.extractLabel)(t),a=i[0],s=i[1];var l={};var u={};if(n.index<=a.index){l.row=n;u.row=a}else{l.row=a;u.row=n}if(o.index<=s.index){l.column=o;u.column=s}else{l.column=s;u.column=o}l.label=(0,c.toLabel)(l.row,l.column);u.label=(0,c.toLabel)(u.row,u.column);var d=[];this.emit("callRangeValue",l,u,function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];d=e});return d};t.prototype._throwError=function w(e){if((0,d.isValidStrict)(e)){throw Error(e)}throw Error(d.ERROR)};return t}(o["default"]);t["default"]=g},function(e,t,r){"use strict";t.__esModule=true;t["default"]=k;t.registerOperation=x;var n=r(18);var o=N(n);var i=r(19);var a=N(i);var s=r(20);var l=N(s);var u=r(21);var d=N(u);var f=r(22);var c=N(f);var h=r(24);var m=N(h);var p=r(23);var v=N(p);var g=r(26);var w=N(g);var b=r(25);var y=N(b);var C=r(27);var _=N(C);var E=r(28);var R=N(E);var M=r(29);var S=N(M);var O=r(30);var T=N(O);var A=r(1);function N(e){return e&&e.__esModule?e:{"default":e}}var D=Object.create(null);function k(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];e=e.toUpperCase();if(!D[e]){throw Error(A.ERROR_NAME)}return D[e].apply(D,t)}function x(e,t){if(!Array.isArray(e)){e=[e.toUpperCase()]}e.forEach(function(e){if(t.isFactory){D[e]=t(e)}else{D[e]=t}})}x(o["default"].SYMBOL,o["default"]);x(a["default"].SYMBOL,a["default"]);x(l["default"].SYMBOL,l["default"]);x(d["default"].SYMBOL,d["default"]);x(T["default"].SYMBOL,T["default"]);x(c["default"].SYMBOL,c["default"]);x(m["default"].SYMBOL,m["default"]);x(v["default"].SYMBOL,v["default"]);x(w["default"].SYMBOL,w["default"]);x(y["default"].SYMBOL,y["default"]);x(R["default"].SYMBOL,R["default"]);x(S["default"].SYMBOL,S["default"]);x(_["default"].SYMBOL,_["default"])},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=a;var n=r(3);var o=r(1);var i=t.SYMBOL="+";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}var a=r.reduce(function(e,t){return e+(0,n.toNumber)(t)},(0,n.toNumber)(e));if(isNaN(a)){throw Error(o.ERROR_VALUE)}return a}a.SYMBOL=i},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL="&";function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}return t.reduce(function(e,t){return e+t.toString()},"")}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=a;var n=r(3);var o=r(1);var i=t.SYMBOL="/";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}var a=r.reduce(function(e,t){return e/(0,n.toNumber)(t)},(0,n.toNumber)(e));if(a===Infinity){throw Error(o.ERROR_DIV_ZERO)}if(isNaN(a)){throw Error(o.ERROR_VALUE)}return a}a.SYMBOL=i},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL="=";function o(e,t){return e===t}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=f;var n=r(33);var o=u(n);var i=r(10);var a=l(i);var s=r(1);function l(e){return e&&e.__esModule?e:{"default":e}}function u(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t["default"]=e;return t}}var d=t.SYMBOL=a["default"];function f(e){return function t(){e=e.toUpperCase();var t=e.split(".");var r=false;var n=void 0;if(t.length===1){if(o[t[0]]){r=true;n=o[t[0]].apply(o,arguments)}}else{var i=t.length;var a=0;var l=o;while(a<i){l=l[t[a]];a++;if(!l){l=null;break}}if(l){r=true;n=l.apply(undefined,arguments)}}if(!r){throw Error(s.ERROR_NAME)}return n}}f.isFactory=true;f.SYMBOL=d},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL=">=";function o(e,t){return e>=t}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL=">";function o(e,t){return e>t}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL="<=";function o(e,t){return e<=t}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL="<";function o(e,t){return e<t}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=a;var n=r(3);var o=r(1);var i=t.SYMBOL="-";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}var a=r.reduce(function(e,t){return e-(0,n.toNumber)(t)},(0,n.toNumber)(e));if(isNaN(a)){throw Error(o.ERROR_VALUE)}return a}a.SYMBOL=i},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=a;var n=r(3);var o=r(1);var i=t.SYMBOL="*";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}var a=r.reduce(function(e,t){return e*(0,n.toNumber)(t)},(0,n.toNumber)(e));if(isNaN(a)){throw Error(o.ERROR_VALUE)}return a}a.SYMBOL=i},function(e,t,r){"use strict";t.__esModule=true;t["default"]=o;var n=t.SYMBOL="<>";function o(e,t){return e!==t}o.SYMBOL=n},function(e,t,r){"use strict";t.__esModule=true;t.SYMBOL=undefined;t["default"]=a;var n=r(3);var o=r(1);var i=t.SYMBOL="^";function a(e,t){var r=Math.pow((0,n.toNumber)(e),(0,n.toNumber)(t));if(isNaN(r)){throw Error(o.ERROR_VALUE)}return r}a.SYMBOL=i},function(e,t,r){"use strict";t.__esModule=true;t.trimEdges=n;function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;e=e.substring(t,e.length-t);return e}},function(e,t,r){var n=Math;function o(e,t){return e.reduce(function(e,r){return t*e+r},0)}function i(e,t,r,n,o){if(!o)o=-1;var i=2/e,a;if(t===0)return r;if(t===1)return n;for(var s=1;s!=t;++s){a=n*s*i+o*r;r=n;n=a}return n}function a(e,t,r,n,o){return function a(s,l){if(l===0)return e(s);if(l===1)return t(s);if(l<0)throw r+": Order ("+l+") must be nonnegative";if(n==1&&s===0)throw r+": Undefined when x == 0";if(n==2&&s<=0)throw r+": Undefined when x <= 0";var u=e(s),d=t(s);return i(s,l,u,d,o)}}var s=function(){var e=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse();var t=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse();var r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse();var a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();var s=.636619772;function l(i){var l,u,d,f=i*i,c=n.abs(i)-.785398164;if(n.abs(i)<8){u=o(e,f);d=o(t,f);l=u/d}else{f=64/f;u=o(r,f);d=o(a,f);l=n.sqrt(s/n.abs(i))*(n.cos(c)*u-n.sin(c)*d*8/n.abs(i))}return l}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse();var d=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse();var f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse();var c=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function h(e){var t,r,i,a=e*e,l=n.abs(e)-2.356194491;if(Math.abs(e)<8){r=e*o(u,a);i=o(d,a);t=r/i}else{a=64/a;r=o(f,a);i=o(c,a);t=n.sqrt(s/n.abs(e))*(n.cos(l)*r-n.sin(l)*i*8/n.abs(e));if(e<0)t=-t}return t}return function m(e,t){t=Math.round(t);if(t===0)return l(n.abs(e));if(t===1)return h(n.abs(e));if(t<0)throw"BESSELJ: Order ("+t+") must be nonnegative";if(n.abs(e)===0)return 0;var r,o,a=2/n.abs(e),s,u,d,f,c,m;if(n.abs(e)>t){r=i(e,t,l(n.abs(e)),h(n.abs(e)),-1)}else{s=2*n.floor((t+n.floor(n.sqrt(40*t)))/2);u=0;f=r=d=0;c=1;for(o=s;o>0;o--){m=o*a*c-f;f=c;c=m;if(n.abs(c)>1e10){c*=1e-10;f*=1e-10;r*=1e-10;d*=1e-10}if(u)d+=c;u=!u;if(o==t)r=f}d=2*d-c;r/=d}return e<0&&t%2?-r:r}}();var l=function(){var e=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse();var t=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse();var r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse();var i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse();var l=.636619772;function u(a){var u,d,f,c=a*a,h=a-.785398164;if(a<8){d=o(e,c);f=o(t,c);u=d/f+l*s(a,0)*n.log(a)}else{c=64/c;d=o(r,c);f=o(i,c);u=n.sqrt(l/a)*(n.sin(h)*d+n.cos(h)*f*8/a)}return u}var d=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse();var f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse();var c=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse();var h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function m(e){var t,r,i,a=e*e,u=e-2.356194491;if(e<8){r=e*o(d,a);i=o(f,a);t=r/i+l*(s(e,1)*n.log(e)-1/e)}else{a=64/a;r=o(c,a);i=o(h,a);t=n.sqrt(l/e)*(n.sin(u)*r+n.cos(u)*i*8/e)}return t}return a(u,m,"BESSELY",1,-1)}();var u=function(){var e=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse();var t=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function r(r){if(r<=3.75)return o(e,r*r/(3.75*3.75));return n.exp(n.abs(r))/n.sqrt(n.abs(r))*o(t,3.75/n.abs(r))}var i=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse();var a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(e){if(e<3.75)return e*o(i,e*e/(3.75*3.75));return(e<0?-1:1)*n.exp(n.abs(e))/n.sqrt(n.abs(e))*o(a,3.75/n.abs(e))}return function l(e,t){t=Math.round(t);if(t===0)return r(e);if(t==1)return s(e);if(t<0)throw"BESSELI Order ("+t+") must be nonnegative";if(n.abs(e)===0)return 0;var o,i,a=2/n.abs(e),u,d,f,c;u=2*n.round((t+n.round(n.sqrt(40*t)))/2);d=o=0;f=1;for(i=u;i>0;i--){c=i*a*f+d;d=f;f=c;if(n.abs(f)>1e10){f*=1e-10;d*=1e-10;o*=1e-10}if(i==t)o=d}o*=l(e,0)/f;return e<0&&t%2?-o:o}}();var d=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse();var t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function r(r){if(r<=2)return-n.log(r/2)*u(r,0)+o(e,r*r/4);return n.exp(-r)/n.sqrt(r)*o(t,2/r)}var i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse();var s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function l(e){if(e<=2)return n.log(e/2)*u(e,1)+1/e*o(i,e*e/4);return n.exp(-e)/n.sqrt(e)*o(s,2/e)}return a(r,l,"BESSELK",2,1)}();if(true){t.besselj=s;t.bessely=l;t.besseli=u;t.besselk=d}},function(e,t,r){var n=[r(34),r(35),r(11),r(37),r(4),r(8),r(6),r(36),r(7),r(38),r(5),r(12)];for(var o in n){var i=n[o];for(var a in i){t[a]=t[a]||i[a]}}},function(e,t,r){var n=r(4);var o=r(5);var i=r(11);var a=r(6);function s(e,t){if(t){for(var r in t){e[r]=t[r]}}return e}t.BETADIST=o.BETA.DIST;t.BETAINV=o.BETA.INV;t.BINOMDIST=o.BINOM.DIST;t.CEILING=t.ISOCEILING=s(n.CEILING.MATH,n.CEILING);t.CEILINGMATH=n.CEILING.MATH;t.CEILINGPRECISE=n.CEILING.PRECISE;t.CHIDIST=o.CHISQ.DIST;t.CHIDISTRT=o.CHISQ.DIST.RT;t.CHIINV=o.CHISQ.INV;t.CHIINVRT=o.CHISQ.INV.RT;t.CHITEST=o.CHISQ.TEST;t.CONFIDENCE=s(o.CONFIDENCE.NORM,o.CONFIDENCE);t.COVAR=o.COVARIANCE.P;t.COVARIANCEP=o.COVARIANCE.P;t.COVARIANCES=o.COVARIANCE.S;t.CRITBINOM=o.BINOM.INV;t.EXPONDIST=o.EXPON.DIST;t.ERFCPRECISE=i.ERFC.PRECISE;t.ERFPRECISE=i.ERF.PRECISE;t.FDIST=o.F.DIST;t.FDISTRT=o.F.DIST.RT;t.FINVRT=o.F.INV.RT;t.FINV=o.F.INV;t.FLOOR=s(n.FLOOR.MATH,n.FLOOR);t.FLOORMATH=n.FLOOR.MATH;t.FLOORPRECISE=n.FLOOR.PRECISE;t.FTEST=o.F.TEST;t.GAMMADIST=o.GAMMA.DIST;t.GAMMAINV=o.GAMMA.INV;t.GAMMALNPRECISE=o.GAMMALN.PRECISE;t.HYPGEOMDIST=o.HYPGEOM.DIST;t.LOGINV=o.LOGNORM.INV;t.LOGNORMINV=o.LOGNORM.INV;t.LOGNORMDIST=o.LOGNORM.DIST;t.MODE=s(o.MODE.SNGL,o.MODE);t.MODEMULT=o.MODE.MULT;t.MODESNGL=o.MODE.SNGL;t.NEGBINOMDIST=o.NEGBINOM.DIST;t.NETWORKDAYSINTL=a.NETWORKDAYS.INTL;t.NORMDIST=o.NORM.DIST;t.NORMINV=o.NORM.INV;t.NORMSDIST=o.NORM.S.DIST;t.NORMSINV=o.NORM.S.INV;t.PERCENTILE=s(o.PERCENTILE.EXC,o.PERCENTILE);t.PERCENTILEEXC=o.PERCENTILE.EXC;t.PERCENTILEINC=o.PERCENTILE.INC;t.PERCENTRANK=s(o.PERCENTRANK.INC,o.PERCENTRANK);t.PERCENTRANKEXC=o.PERCENTRANK.EXC;t.PERCENTRANKINC=o.PERCENTRANK.INC;t.POISSON=s(o.POISSON.DIST,o.POISSON);t.POISSONDIST=o.POISSON.DIST;t.QUARTILE=s(o.QUARTILE.INC,o.QUARTILE);t.QUARTILEEXC=o.QUARTILE.EXC;t.QUARTILEINC=o.QUARTILE.INC;t.RANK=s(o.RANK.EQ,o.RANK);t.RANKAVG=o.RANK.AVG;t.RANKEQ=o.RANK.EQ;t.SKEWP=o.SKEW.P;t.STDEV=s(o.STDEV.S,o.STDEV);t.STDEVP=o.STDEV.P;t.STDEVS=o.STDEV.S;t.TDIST=o.T.DIST;t.TDISTRT=o.T.DIST.RT;t.TINV=o.T.INV;t.TTEST=o.T.TEST;t.VAR=s(o.VAR.S,o.VAR);t.VARP=o.VAR.P;t.VARS=o.VAR.S;t.WEIBULL=s(o.WEIBULL.DIST,o.WEIBULL);t.WEIBULLDIST=o.WEIBULL.DIST;t.WORKDAYINTL=a.WORKDAY.INTL;t.ZTEST=o.Z.TEST},function(module,exports,__webpack_require__){var error=__webpack_require__(0);var stats=__webpack_require__(5);var maths=__webpack_require__(4);var utils=__webpack_require__(2);function compact(e){var t=[];utils.arrayEach(e,function(e){if(e){t.push(e)}});return t}exports.FINDFIELD=function(e,t){var r=null;utils.arrayEach(e,function(e,n){if(e[0]===t){r=n;return false}});if(r==null){return error.value}return r};function findResultIndex(database,criterias){var matches={};for(var i=1;i<database[0].length;++i){matches[i]=true}var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i){if(criterias[i].length>maxCriteriaLength){maxCriteriaLength=criterias[i].length}}for(var k=1;k<database.length;++k){for(var l=1;l<database[k].length;++l){var currentCriteriaResult=false;var hasMatchingCriteria=false;for(var j=0;j<criterias.length;++j){var criteria=criterias[j];if(criteria.length<maxCriteriaLength){continue}var criteriaField=criteria[0];if(database[k][0]!==criteriaField){continue}hasMatchingCriteria=true;for(var p=1;p<criteria.length;++p){currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}if(hasMatchingCriteria){matches[l]=matches[l]&&currentCriteriaResult}}}var result=[];for(var n=0;n<database[0].length;++n){if(matches[n]){result.push(n-1)}}return result}exports.DAVERAGE=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=0;utils.arrayEach(n,function(e){a+=o[e]});return n.length===0?error.div0:a/n.length};exports.DCOUNT=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});return stats.COUNT(a)};exports.DCOUNTA=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t]);
}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});return stats.COUNTA(a)};exports.DGET=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}if(n.length===0){return error.value}if(n.length>1){return error.num}return o[n[0]]};exports.DMAX=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=o[n[0]];utils.arrayEach(n,function(e){if(a<o[e]){a=o[e]}});return a};exports.DMIN=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=o[n[0]];utils.arrayEach(n,function(e){if(a>o[e]){a=o[e]}});return a};exports.DPRODUCT=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});a=compact(a);var s=1;utils.arrayEach(a,function(e){s*=e});return s};exports.DSTDEV=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});a=compact(a);return stats.STDEV.S(a)};exports.DSTDEVP=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});a=compact(a);return stats.STDEV.P(a)};exports.DSUM=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});return maths.SUM(a)};exports.DVAR=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});return stats.VAR.S(a)};exports.DVARP=function(e,t,r){if(isNaN(t)&&typeof t!=="string"){return error.value}var n=findResultIndex(e,r);var o=[];if(typeof t==="string"){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else{o=utils.rest(e[t])}var a=[];utils.arrayEach(n,function(e){a.push(o[e])});return stats.VAR.P(a)}},function(e,t,r){var n=r(0);var o=r(6);var i=r(2);function a(e){return e&&e.getTime&&!isNaN(e.getTime())}function s(e){return e instanceof Date?e:new Date(e)}t.ACCRINT=function(e,t,r,i,l,u,d){e=s(e);t=s(t);r=s(r);if(!a(e)||!a(t)||!a(r)){return n.value}if(i<=0||l<=0){return n.num}if([1,2,4].indexOf(u)===-1){return n.num}if([0,1,2,3,4].indexOf(d)===-1){return n.num}if(r<=e){return n.num}l=l||0;d=d||0;return l*i*o.YEARFRAC(e,r,d)};t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")};t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")};t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")};t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")};t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")};t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")};t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")};t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")};t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")};t.CUMIPMT=function(e,r,o,a,s,l){e=i.parseNumber(e);r=i.parseNumber(r);o=i.parseNumber(o);if(i.anyIsError(e,r,o)){return n.value}if(e<=0||r<=0||o<=0){return n.num}if(a<1||s<1||a>s){return n.num}if(l!==0&&l!==1){return n.num}var u=t.PMT(e,r,o,0,l);var d=0;if(a===1){if(l===0){d=-o;a++}}for(var f=a;f<=s;f++){if(l===1){d+=t.FV(e,f-2,u,o,1)-u}else{d+=t.FV(e,f-1,u,o,0)}}d*=e;return d};t.CUMPRINC=function(e,r,o,a,s,l){e=i.parseNumber(e);r=i.parseNumber(r);o=i.parseNumber(o);if(i.anyIsError(e,r,o)){return n.value}if(e<=0||r<=0||o<=0){return n.num}if(a<1||s<1||a>s){return n.num}if(l!==0&&l!==1){return n.num}var u=t.PMT(e,r,o,0,l);var d=0;if(a===1){if(l===0){d=u+o*e}else{d=u}a++}for(var f=a;f<=s;f++){if(l>0){d+=u-(t.FV(e,f-2,u,o,1)-u)*e}else{d+=u-t.FV(e,f-1,u,o,0)*e}}return d};t.DB=function(e,t,r,o,a){a=a===undefined?12:a;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);if(i.anyIsError(e,t,r,o,a)){return n.value}if(e<0||t<0||r<0||o<0){return n.num}if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a)===-1){return n.num}if(o>r){return n.num}if(t>=e){return 0}var s=(1-Math.pow(t/e,1/r)).toFixed(3);var l=e*s*a/12;var u=l;var d=0;var f=o===r?r-1:o;for(var c=2;c<=f;c++){d=(e-u)*s;u+=d}if(o===1){return l}else if(o===r){return(e-u)*s}else{return d}};t.DDB=function(e,t,r,o,a){a=a===undefined?2:a;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);if(i.anyIsError(e,t,r,o,a)){return n.value}if(e<0||t<0||r<0||o<0||a<=0){return n.num}if(o>r){return n.num}if(t>=e){return 0}var s=0;var l=0;for(var u=1;u<=o;u++){l=Math.min((e-s)*(a/r),e-t-s);s+=l}return l};t.DISC=function(){throw new Error("DISC is not implemented")};t.DOLLARDE=function(e,t){e=i.parseNumber(e);t=i.parseNumber(t);if(i.anyIsError(e,t)){return n.value}if(t<0){return n.num}if(t>=0&&t<1){return n.div0}t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var o=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);r=Math.round(r*o)/o;return r};t.DOLLARFR=function(e,t){e=i.parseNumber(e);t=i.parseNumber(t);if(i.anyIsError(e,t)){return n.value}if(t<0){return n.num}if(t>=0&&t<1){return n.div0}t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t;return r};t.DURATION=function(){throw new Error("DURATION is not implemented")};t.EFFECT=function(e,t){e=i.parseNumber(e);t=i.parseNumber(t);if(i.anyIsError(e,t)){return n.value}if(e<=0||t<1){return n.num}t=parseInt(t,10);return Math.pow(1+e/t,t)-1};t.FV=function(e,t,r,o,a){o=o||0;a=a||0;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);if(i.anyIsError(e,t,r,o,a)){return n.value}var s;if(e===0){s=o+r*t}else{var l=Math.pow(1+e,t);if(a===1){s=o*l+r*(1+e)*(l-1)/e}else{s=o*l+r*(l-1)/e}}return-s};t.FVSCHEDULE=function(e,t){e=i.parseNumber(e);t=i.parseNumberArray(i.flatten(t));if(i.anyIsError(e,t)){return n.value}var r=t.length;var o=e;for(var a=0;a<r;a++){o*=1+t[a]}return o};t.INTRATE=function(){throw new Error("INTRATE is not implemented")};t.IPMT=function(e,r,o,a,s,l){s=s||0;l=l||0;e=i.parseNumber(e);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);s=i.parseNumber(s);l=i.parseNumber(l);if(i.anyIsError(e,r,o,a,s,l)){return n.value}var u=t.PMT(e,o,a,s,l);var d;if(r===1){if(l===1){d=0}else{d=-a}}else{if(l===1){d=t.FV(e,r-2,u,a,1)-u}else{d=t.FV(e,r-1,u,a,0)}}return d*e};t.IRR=function(e,t){t=t||0;e=i.parseNumberArray(i.flatten(e));t=i.parseNumber(t);if(i.anyIsError(e,t)){return n.value}var r=function v(e,t,r){var n=r+1;var o=e[0];for(var i=1;i<e.length;i++){o+=e[i]/Math.pow(n,(t[i]-t[0])/365)}return o};var o=function g(e,t,r){var n=r+1;var o=0;for(var i=1;i<e.length;i++){var a=(t[i]-t[0])/365;o-=a*e[i]/Math.pow(n,a+1)}return o};var a=[];var s=false;var l=false;for(var u=0;u<e.length;u++){a[u]=u===0?0:a[u-1]+365;if(e[u]>0){s=true}if(e[u]<0){l=true}}if(!s||!l){return n.num}t=t===undefined?.1:t;var d=t;var f=1e-10;var c,h,m;var p=true;do{m=r(e,a,d);c=d-m/o(e,a,d);h=Math.abs(c-d);d=c;p=h>f&&Math.abs(m)>f}while(p);return d};t.ISPMT=function(e,t,r,o){e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);if(i.anyIsError(e,t,r,o)){return n.value}return o*e*(t/r-1)};t.MDURATION=function(){throw new Error("MDURATION is not implemented")};t.MIRR=function(e,r,o){e=i.parseNumberArray(i.flatten(e));r=i.parseNumber(r);o=i.parseNumber(o);if(i.anyIsError(e,r,o)){return n.value}var a=e.length;var s=[];var l=[];for(var u=0;u<a;u++){if(e[u]<0){s.push(e[u])}else{l.push(e[u])}}var d=-t.NPV(o,l)*Math.pow(1+o,a-1);var f=t.NPV(r,s)*(1+r);return Math.pow(d/f,1/(a-1))-1};t.NOMINAL=function(e,t){e=i.parseNumber(e);t=i.parseNumber(t);if(i.anyIsError(e,t)){return n.value}if(e<=0||t<1){return n.num}t=parseInt(t,10);return(Math.pow(e+1,1/t)-1)*t};t.NPER=function(e,t,r,o,a){a=a===undefined?0:a;o=o===undefined?0:o;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);if(i.anyIsError(e,t,r,o,a)){return n.value}var s=t*(1+e*a)-o*e;var l=r*e+t*(1+e*a);return Math.log(s/l)/Math.log(1+e)};t.NPV=function(){var e=i.parseNumberArray(i.flatten(arguments));if(e instanceof Error){return e}var t=e[0];var r=0;for(var n=1;n<e.length;n++){r+=e[n]/Math.pow(1+t,n)}return r};t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")};t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")};t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")};t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")};t.PDURATION=function(e,t,r){e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);if(i.anyIsError(e,t,r)){return n.value}if(e<=0){return n.num}return(Math.log(r)-Math.log(t))/Math.log(1+e)};t.PMT=function(e,t,r,o,a){o=o||0;a=a||0;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);if(i.anyIsError(e,t,r,o,a)){return n.value}var s;if(e===0){s=(r+o)/t}else{var l=Math.pow(1+e,t);if(a===1){s=(o*e/(l-1)+r*e/(1-1/l))/(1+e)}else{s=o*e/(l-1)+r*e/(1-1/l)}}return-s};t.PPMT=function(e,r,o,a,s,l){s=s||0;l=l||0;e=i.parseNumber(e);o=i.parseNumber(o);a=i.parseNumber(a);s=i.parseNumber(s);l=i.parseNumber(l);if(i.anyIsError(e,o,a,s,l)){return n.value}return t.PMT(e,o,a,s,l)-t.IPMT(e,r,o,a,s,l)};t.PRICE=function(){throw new Error("PRICE is not implemented")};t.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")};t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")};t.PV=function(e,t,r,o,a){o=o||0;a=a||0;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);if(i.anyIsError(e,t,r,o,a)){return n.value}if(e===0){return-r*t-o}else{return((1-Math.pow(1+e,t))/e*r*(1+e*a)-o)/Math.pow(1+e,t)}};t.RATE=function(e,t,r,o,a,s){s=s===undefined?.01:s;o=o===undefined?0:o;a=a===undefined?0:a;e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);a=i.parseNumber(a);s=i.parseNumber(s);if(i.anyIsError(e,t,r,o,a,s)){return n.value}var l=1e-10;var u=50;var d,f,c,h,m=0,p=0,v=0;var g=s;if(Math.abs(g)<l){d=r*(1+e*g)+t*(1+g*a)*e+o}else{p=Math.exp(e*Math.log(1+g));d=r*p+t*(1/g+a)*(p-1)+o}f=r+t*e+o;c=r*p+t*(1/g+a)*(p-1)+o;v=h=0;m=g;while(Math.abs(f-c)>l&&v<u){g=(c*h-f*m)/(c-f);h=m;m=g;if(Math.abs(g)<l){d=r*(1+e*g)+t*(1+g*a)*e+o}else{p=Math.exp(e*Math.log(1+g));d=r*p+t*(1/g+a)*(p-1)+o}f=c;c=d;++v}return g};t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")};t.RRI=function(e,t,r){e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);if(i.anyIsError(e,t,r)){return n.value}if(e===0||t===0){return n.num}return Math.pow(r/t,1/e)-1};t.SLN=function(e,t,r){e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);if(i.anyIsError(e,t,r)){return n.value}if(r===0){return n.num}return(e-t)/r};t.SYD=function(e,t,r,o){e=i.parseNumber(e);t=i.parseNumber(t);r=i.parseNumber(r);o=i.parseNumber(o);if(i.anyIsError(e,t,r,o)){return n.value}if(r===0){return n.num}if(o<1||o>r){return n.num}o=parseInt(o,10);return(e-t)*(r-o+1)*2/(r*(r+1))};t.TBILLEQ=function(e,t,r){e=i.parseDate(e);t=i.parseDate(t);r=i.parseNumber(r);if(i.anyIsError(e,t,r)){return n.value}if(r<=0){return n.num}if(e>t){return n.num}if(t-e>365*24*60*60*1e3){return n.num}return 365*r/(360-r*o.DAYS360(e,t,false))};t.TBILLPRICE=function(e,t,r){e=i.parseDate(e);t=i.parseDate(t);r=i.parseNumber(r);if(i.anyIsError(e,t,r)){return n.value}if(r<=0){return n.num}if(e>t){return n.num}if(t-e>365*24*60*60*1e3){return n.num}return 100*(1-r*o.DAYS360(e,t,false)/360)};t.TBILLYIELD=function(e,t,r){e=i.parseDate(e);t=i.parseDate(t);r=i.parseNumber(r);if(i.anyIsError(e,t,r)){return n.value}if(r<=0){return n.num}if(e>t){return n.num}if(t-e>365*24*60*60*1e3){return n.num}return(100-r)*360/(r*o.DAYS360(e,t,false))};t.VDB=function(){throw new Error("VDB is not implemented")};t.XNPV=function(e,t,r){e=i.parseNumber(e);t=i.parseNumberArray(i.flatten(t));r=i.parseDateArray(i.flatten(r));if(i.anyIsError(e,t,r)){return n.value}var a=0;for(var s=0;s<t.length;s++){a+=t[s]/Math.pow(1+e,o.DAYS(r[s],r[0])/365)}return a};t.YIELD=function(){throw new Error("YIELD is not implemented")};t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")};t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(e,t,r){var n=r(0);var o=r(2);var i=r(7);t.AND=function(){var e=o.flatten(arguments);var t=true;for(var r=0;r<e.length;r++){if(!e[r]){t=false}}return t};t.CHOOSE=function(){if(arguments.length<2){return n.na}var e=arguments[0];if(e<1||e>254){return n.value}if(arguments.length<e+1){return n.value}return arguments[e]};t.FALSE=function(){return false};t.IF=function(e,t,r){return e?t:r};t.IFERROR=function(e,t){if(i.ISERROR(e)){return t}return e};t.IFNA=function(e,t){return e===n.na?t:e};t.NOT=function(e){return!e};t.OR=function(){var e=o.flatten(arguments);var t=false;for(var r=0;r<e.length;r++){if(e[r]){t=true}}return t};t.TRUE=function(){return true};t.XOR=function(){var e=o.flatten(arguments);var t=0;for(var r=0;r<e.length;r++){if(e[r]){t++}}return Math.floor(Math.abs(t))&1?true:false};t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0];var r=arguments.length-1;var o=Math.floor(r/2);var i=false;var a=r%2!==0;var s=r%2===0?null:arguments[arguments.length-1];if(o){for(var l=0;l<o;l++){if(t===arguments[l*2+1]){e=arguments[l*2+2];i=true;break}}}if(!i){e=a?s:n.na}}else{e=n.value}return e}},function(e,t,r){var n=r(0);t.MATCH=function(e,t,r){if(!e&&!t){return n.na}if(arguments.length===2){r=1}if(!(t instanceof Array)){return n.na}if(r!==-1&&r!==0&&r!==1){return n.na}var o;var i;for(var a=0;a<t.length;a++){if(r===1){if(t[a]===e){return a+1}else if(t[a]<e){if(!i){o=a+1;i=t[a]}else if(t[a]>i){o=a+1;i=t[a]}}}else if(r===0){if(typeof e==="string"){e=e.replace(/\?/g,".");if(t[a].toLowerCase().match(e.toLowerCase())){return a+1}}else{if(t[a]===e){return a+1}}}else if(r===-1){if(t[a]===e){return a+1}else if(t[a]>e){if(!i){o=a+1;i=t[a]}else if(t[a]<i){o=a+1;i=t[a]}}}}return o?o:n.na}},function(e,t){/*!
 * numbro.js language configuration
 * language : Czech
 * locale: Czech Republic
 * author : Anatoli Papirovski : https://github.com/apapirovski
 */
(function(){"use strict";var t={langLocaleCode:"cs-CZ",cultureCode:"cs-CZ",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function r(){return"."},currency:{symbol:"K",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Danish
 * locale: Denmark
 * author : Michael Storgaard : https://github.com/mstorgaard
 */
(function(){"use strict";var t={langLocaleCode:"da-DK",cultureCode:"da-DK",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mio",billion:"mia",trillion:"b"},ordinal:function r(){return"."},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : German
 * locale: Switzerland
 * author : Michael Piefel : https://github.com/piefel (based on work from Marco Krage : https://github.com/sinky)
 */
(function(){"use strict";var t={langLocaleCode:"de-CH",cultureCode:"de-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(){return"."},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : German
 * locale: Germany
 * author : Marco Krage : https://github.com/sinky
 *
 * Generally useful in Germany, Austria, Luxembourg, Belgium
 */
(function(){"use strict";var t={langLocaleCode:"de-DE",cultureCode:"de-DE",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix",spaceSeparated:true},defaults:{currencyFormat:",4"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : English
 * locale: Australia
 * author : Benedikt Huss : https://github.com/ben305
 */
(function(){"use strict";var t={langLocaleCode:"en-AU",cultureCode:"en-AU",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : English
 * locale: United Kingdom of Great Britain and Northern Ireland
 * author : Dan Ristic : https://github.com/dristic
 */
(function(){"use strict";var t={langLocaleCode:"en-GB",cultureCode:"en-GB",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : English
 * locale: New Zealand
 * author : Benedikt Huss : https://github.com/ben305
 */
(function(){"use strict";var t={langLocaleCode:"en-NZ",cultureCode:"en-NZ",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : English
 * locale: South Africa
 * author : Stewart Scott https://github.com/stewart42
 */
(function(){"use strict";var t={langLocaleCode:"en-ZA",cultureCode:"en-ZA",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"R",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Spanish
 * locale: Argentina
 * author : Hernan Garcia : https://github.com/hgarcia
 */
(function(){"use strict";var t={langLocaleCode:"es-AR",cultureCode:"es-AR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return t===1||t===3?"er":t===2?"do":t===7||t===0?"mo":t===8?"vo":t===9?"no":"to"},currency:{symbol:"$",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Spanish
 * locale: Spain
 * author : Hernan Garcia : https://github.com/hgarcia
 */
(function(){"use strict";var t={langLocaleCode:"es-ES",cultureCode:"es-ES",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return t===1||t===3?"er":t===2?"do":t===7||t===0?"mo":t===8?"vo":t===9?"no":"to"},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Estonian
 * locale: Estonia
 * author : Illimar Tambek : https://github.com/ragulka
 *
 * Note: in Estonian, abbreviations are always separated
 * from numbers with a space
 */
(function(){"use strict";var t={langLocaleCode:"et-EE",cultureCode:"et-EE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tuh",million:" mln",billion:" mld",trillion:" trl"},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Farsi
 * locale: Iran
 * author : neo13 : https://github.com/neo13
 */
(function(){"use strict";var t={langLocaleCode:"fa-IR",cultureCode:"fa-IR",delimiters:{thousands:"",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},ordinal:function r(){return""},currency:{symbol:""}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Finnish
 * locale: Finland
 * author : Sami Saada : https://github.com/samitheberber
 */
(function(){"use strict";var t={langLocaleCode:"fi-FI",cultureCode:"fi-FI",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Filipino (Pilipino)
 * locale: Philippines
 * author : Michael Abadilla : https://github.com/mjmaix
 */
(function(){"use strict";var t={langLocaleCode:"fil-PH",cultureCode:"fil-PH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:""}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : French
 * locale: Canada
 * author : Lo Renaud-Allaire : https://github.com/renaudleo
 */
(function(){"use strict";var t={langLocaleCode:"fr-CA",cultureCode:"fr-CA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function r(e){return e===1?"er":"me"},currency:{symbol:"$",position:"postfix",spaceSeparated:true},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : French
 * locale: Switzerland
 * author : Adam Draper : https://github.com/adamwdraper
 */
(function(){"use strict";var t={langLocaleCode:"fr-CH",cultureCode:"fr-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){return e===1?"er":"me"},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : French
 * locale: France
 * author : Adam Draper : https://github.com/adamwdraper
 */
(function(){"use strict";var t={langLocaleCode:"fr-FR",cultureCode:"fr-FR",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(e){return e===1?"er":"me"},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Hebrew
 * locale : IL
 * author : Eli Zehavi : https://github.com/eli-zehavi
 */
(function(){"use strict";var t={langLocaleCode:"he-IL",cultureCode:"he-IL",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},currency:{symbol:"",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:" ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:" ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Hungarian
 * locale: Hungary
 * author : Peter Bakondy : https://github.com/pbakondy
 */
(function(){"use strict";var t={langLocaleCode:"hu-HU",cultureCode:"hu-HU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"E",million:"M",billion:"Mrd",trillion:"T"},ordinal:function r(){return"."},currency:{symbol:" Ft",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t,r){t["cs-CZ"]=r(39);t["da-DK"]=r(40);t["de-CH"]=r(41);t["de-DE"]=r(42);t["en-AU"]=r(43);t["en-GB"]=r(44);t["en-NZ"]=r(45);t["en-ZA"]=r(46);t["es-AR"]=r(47);t["es-ES"]=r(48);t["et-EE"]=r(49);t["fa-IR"]=r(50);t["fi-FI"]=r(51);t["fil-PH"]=r(52);t["fr-CA"]=r(53);t["fr-CH"]=r(54);t["fr-FR"]=r(55);t["he-IL"]=r(56);t["hu-HU"]=r(57);t["it-IT"]=r(59);t["ja-JP"]=r(60);t["ko-KR"]=r(61);t["lv-LV"]=r(62);t["nb-NO"]=r(63);t["nl-BE"]=r(64);t["nl-NL"]=r(65);t["pl-PL"]=r(66);t["pt-BR"]=r(67);t["pt-PT"]=r(68);t["ru-RU"]=r(69);t["ru-UA"]=r(70);t["sk-SK"]=r(71);t["sv-SE"]=r(72);t["th-TH"]=r(73);t["tr-TR"]=r(74);t["uk-UA"]=r(75);t["zh-CN"]=r(76);t["zh-TW"]=r(77)},function(e,t){/*!
 * numbro.js language configuration
 * language : Italian
 * locale: Italy
 * author : Giacomo Trombi : http://cinquepunti.it
 */
(function(){"use strict";var t={langLocaleCode:"it-IT",cultureCode:"it-IT",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mila",million:"mil",billion:"b",trillion:"t"},ordinal:function r(){return""},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Japanese
 * locale: Japan
 * author : teppeis : https://github.com/teppeis
 */
(function(){"use strict";var t={langLocaleCode:"ja-JP",cultureCode:"ja-JP",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},ordinal:function r(){return"."},currency:{symbol:"",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Korean
 * author (numbro.js Version): Randy Wilander : https://github.com/rocketedaway
 * author (numeral.js Version) : Rich Daley : https://github.com/pedantic-git
 */
(function(){"use strict";var t={langLocaleCode:"ko-KR",cultureCode:"ko-KR",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},ordinal:function r(){return"."},currency:{symbol:""}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Latvian
 * locale: Latvia
 * author : Lauris Bukis-Haberkorns : https://github.com/Lafriks
 */
(function(){"use strict";var t={langLocaleCode:"lv-LV",cultureCode:"lv-LV",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tkst.",million:" milj.",billion:" mljrd.",trillion:" trilj."},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language: Norwegian Bokml
 * locale: Norway
 * author : Benjamin Van Ryseghem
 */
(function(){"use strict";var t={langLocaleCode:"nb-NO",cultureCode:"nb-NO",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"t"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Dutch
 * locale: Belgium
 * author : Dieter Luypaert : https://github.com/moeriki
 */
(function(){"use strict";var t={langLocaleCode:"nl-BE",cultureCode:"nl-BE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mld",trillion:"bln"},ordinal:function r(e){var t=e%100;return e!==0&&t<=1||t===8||t>=20?"ste":"de"},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Dutch
 * locale: Netherlands
 * author : Dave Clayton : https://github.com/davedx
 */
(function(){"use strict";var t={langLocaleCode:"nl-NL",cultureCode:"nl-NL",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mrd",trillion:"bln"},ordinal:function r(e){var t=e%100;return e!==0&&t<=1||t===8||t>=20?"ste":"de"},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Polish
 * locale : Poland
 * author : Dominik Bulaj : https://github.com/dominikbulaj
 */
(function(){"use strict";var t={langLocaleCode:"pl-PL",cultureCode:"pl-PL",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tys.",million:"mln",billion:"mld",trillion:"bln"},ordinal:function r(){return"."},currency:{symbol:" z",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Portuguese
 * locale : Brazil
 * author : Ramiro Varandas Jr : https://github.com/ramirovjr
 */
(function(){"use strict";var t={langLocaleCode:"pt-BR",cultureCode:"pt-BR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mil",million:"milhes",billion:"b",trillion:"t"},ordinal:function r(){return""},currency:{symbol:"R$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Portuguese
 * locale : Portugal
 * author : Diogo Resende : https://github.com/dresende
 */
(function(){"use strict";var t={langLocaleCode:"pt-PT",cultureCode:"pt-PT",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function r(){return""},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Russian
 * locale : Russsia
 * author : Anatoli Papirovski : https://github.com/apapirovski
 */
(function(){"use strict";var t={langLocaleCode:"ru-RU",cultureCode:"ru-RU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:".",million:"",billion:"b",trillion:"t"},ordinal:function r(){return"."},currency:{symbol:".",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Russian
 * locale : Ukraine
 * author : Anatoli Papirovski : https://github.com/apapirovski
 */
(function(){"use strict";var t={langLocaleCode:"ru-UA",cultureCode:"ru-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:".",million:"",billion:"b",trillion:"t"},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Slovak
 * locale : Slovakia
 * author : Ahmed Al Hafoudh : http://www.freevision.sk
 */
(function(){"use strict";var t={langLocaleCode:"sk-SK",cultureCode:"sk-SK",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Swedish
 * locale : Sweden
 * author : Benjamin Van Ryseghem (benjamin.vanryseghem.com)
 */
(function(){"use strict";var t={langLocaleCode:"sv-SE",cultureCode:"sv-SE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"tmd"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Thai
 * locale : Thailand
 * author : Sathit Jittanupat : https://github.com/jojosati
 */
(function(){"use strict";var t={langLocaleCode:"th-TH",cultureCode:"th-TH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},ordinal:function r(){return"."},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Turkish
 * locale : Turkey
 * author : Ecmel Ercan : https://github.com/ecmel,
 *          Erhan Gundogan : https://github.com/erhangundogan,
 *          Burak Yiit Kaya: https://github.com/BYK
 */
(function(){"use strict";var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"},r={langLocaleCode:"tr-TR",cultureCode:"tr-TR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"bin",million:"milyon",billion:"milyar",trillion:"trilyon"},ordinal:function n(e){if(e===0){return"'nc"}var r=e%10,n=e%100-r,o=e>=100?100:null;return t[r]||t[n]||t[o]},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=r}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(r.cultureCode,r)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Ukrainian
 * locale : Ukraine
 * author : Michael Piefel : https://github.com/piefel (with help from Tetyana Kuzmenko)
 */
(function(){"use strict";var t={langLocaleCode:"uk-UA",cultureCode:"uk-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:".",million:"",billion:"",trillion:""},ordinal:function r(){return""},currency:{symbol:"",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : simplified chinese
 * locale : China
 * author : badplum : https://github.com/badplum
 */
(function(){"use strict";var t={langLocaleCode:"zh-CN",cultureCode:"zh-CN",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},ordinal:function r(){return"."},currency:{symbol:"",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){/*!
 * numbro.js language configuration
 * language : Chinese (Taiwan)
 * author (numbro.js Version): Randy Wilander : https://github.com/rocketedaway
 * author (numeral.js Version) : Rich Daley : https://github.com/pedantic-git
 */
(function(){"use strict";var t={langLocaleCode:"zh-TW",cultureCode:"zh-TW",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"",million:"",billion:"",trillion:""},ordinal:function r(){return""},currency:{symbol:"NT$"}};if(typeof e!=="undefined"&&e.exports){e.exports=t}if(typeof window!=="undefined"&&window.numbro&&window.numbro.culture){window.numbro.culture(t.cultureCode,t)}}).call(typeof window==="undefined"?this:window)},function(e,t){function r(){}r.prototype={on:function n(e,t,r){var n=this.e||(this.e={});(n[e]||(n[e]=[])).push({fn:t,ctx:r});return this},once:function o(e,t,r){var n=this;function o(){n.off(e,o);t.apply(r,arguments)}o._=t;return this.on(e,o,r)},emit:function i(e){var t=[].slice.call(arguments,1);var r=((this.e||(this.e={}))[e]||[]).slice();var n=0;var o=r.length;for(n;n<o;n++){r[n].fn.apply(r[n].ctx,t)}return this},off:function a(e,t){var r=this.e||(this.e={});var n=r[e];var o=[];if(n&&t){for(var i=0,a=n.length;i<a;i++){if(n[i].fn!==t&&n[i].fn._!==t)o.push(n[i])}}o.length?r[e]=o:delete r[e];return this}};e.exports=r},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function t(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function r(){return e.i}});e.webpackPolyfill=1}return e}},function(module,exports,__webpack_require__){(function(module,process){var grammarParser=function(){var o=function e(t,r,n,o){for(n=n||{},o=t.length;o--;n[t[o]]=r){}return n},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,14],$V6=[1,15],$V7=[1,16],$V8=[1,12],$V9=[1,13],$Va=[1,17],$Vb=[1,19],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],$Vo=[5,10,11,13,14,15,16,17,29,30],$Vp=[5,10,13,14,15,16,29,30],$Vq=[5,10,11,13,14,15,16,17,18,19,29,30],$Vr=[13,29,30];var parser={trace:function t(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1;if(isNaN(this.$)){this.$=0}break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1;if(isNaN(this.$)){this.$=0}break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:var result=[];var arr=eval("["+yytext+"]");arr.forEach(function(e){result.push(e)});this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]);this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]];this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=($$[$0-2]+"."+$$[$0])*1;break;case 46:this.$=$$[$0-1]*.01;break;case 47:this.$=yy.throwError($$[$0]);break}},table:[{2:11,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{1:[3]},{5:[1,18],9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vl,[2,2],{32:[1,29]}),o($Vl,[2,3],{34:[1,30]}),o($Vl,[2,4]),{2:11,4:31,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:32,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{12:[1,34]},o($Vl,[2,23]),o($Vl,[2,24],{2:35,35:$Va}),o($Vm,[2,42]),o($Vn,[2,44],{32:[1,36]}),o($Vl,[2,26],{27:[1,37]}),o($Vl,[2,27],{27:[1,38]}),o($Vl,[2,28],{27:[1,39]}),o([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:41,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:42,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:45,6:3,7:4,8:$V0,10:[1,43],11:$V1,12:$V2,15:[1,44],17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:47,6:3,7:4,8:$V0,10:[1,46],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:49,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:50,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:51,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:52,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{31:[1,53]},o($Vn,[2,46]),{9:$Vb,10:$Vc,11:$Vd,13:[1,54],14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vo,[2,19],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,20],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,55],17:$V3,21:$V4,22:56,23:10,24:$V5,25:$V6,26:$V7,28:[1,58],31:$V8,33:$V9,35:$Va},o($Vl,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},o($Vl,[2,5]),o([5,10,13,29,30],[2,6],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,7],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:69,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:70,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,14],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:71,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,13],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o([5,10,13,16,29,30],[2,12],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,15],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vq,[2,16],{9:$Vb,20:$Vk}),o($Vq,[2,17],{9:$Vb,20:$Vk}),o([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$Vb}),o($Vm,[2,43]),o($Vl,[2,8]),o($Vl,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},o($Vr,[2,38],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,39]),o($Vn,[2,45]),o($Vl,[2,29]),o($Vl,[2,30]),o($Vl,[2,31]),o($Vl,[2,32]),o($Vl,[2,33]),o($Vl,[2,34]),o($Vl,[2,35]),o($Vl,[2,36]),o($Vl,[2,37]),o($Vp,[2,9],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,11],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,10],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vl,[2,22]),{2:11,4:75,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:76,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vr,[2,40],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,41],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk})],defaultActions:{18:[2,1]},parseError:function r(e,t){if(t.recoverable){this.trace(e)}else{var r=function n(e,t){this.message=e;this.hash=t};r.prototype=Error;throw new r(e,t)}},parse:function n(e){var t=this,r=[0],n=[],o=[null],i=[],a=this.table,s="",l=0,u=0,d=0,f=2,c=1;var h=i.slice.call(arguments,1);var m=Object.create(this.lexer);var p={yy:{}};for(var v in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,v)){p.yy[v]=this.yy[v]}}m.setInput(e,p.yy);p.yy.lexer=m;p.yy.parser=this;if(typeof m.yylloc=="undefined"){m.yylloc={}}var g=m.yylloc;i.push(g);var w=m.options&&m.options.ranges;if(typeof p.yy.parseError==="function"){this.parseError=p.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function b(e){r.length=r.length-2*e;o.length=o.length-e;i.length=i.length-e}var y=function P(){var e;e=m.lex()||c;if(typeof e!=="number"){e=t.symbols_[e]||e}return e};var C,_,E,R,M,S,O={},T,A,N,D;while(true){E=r[r.length-1];if(this.defaultActions[E]){R=this.defaultActions[E]}else{if(C===null||typeof C=="undefined"){C=y()}R=a[E]&&a[E][C]}if(typeof R==="undefined"||!R.length||!R[0]){var k=function L(e){var t=r.length-1;var n=0;for(;;){if(f.toString()in a[e]){return n}if(e===0||t<2){return false}t-=2;e=r[t];++n}};var x;var I="";if(!d){x=k(E);D=[];for(T in a[E]){if(this.terminals_[T]&&T>f){D.push("'"+this.terminals_[T]+"'")}}if(m.showPosition){I="Parse error on line "+(l+1)+":\n"+m.showPosition()+"\nExpecting "+D.join(", ")+", got '"+(this.terminals_[C]||C)+"'"}else{I="Parse error on line "+(l+1)+": Unexpected "+(C==c?"end of input":"'"+(this.terminals_[C]||C)+"'")}this.parseError(I,{text:m.match,token:this.terminals_[C]||C,line:m.yylineno,loc:g,expected:D,recoverable:x!==false})}else if(_!==c){x=k(E)}if(d==3){if(C===c||_===c){throw new Error(I||"Parsing halted while starting to recover from another error.")}u=m.yyleng;s=m.yytext;l=m.yylineno;g=m.yylloc;C=y()}if(x===false){throw new Error(I||"Parsing halted. No suitable error recovery rule available.")}b(x);_=C==f?null:C;C=f;E=r[r.length-1];R=a[E]&&a[E][f];d=3}if(R[0]instanceof Array&&R.length>1){throw new Error("Parse Error: multiple actions possible at state: "+E+", token: "+C)}switch(R[0]){case 1:r.push(C);o.push(m.yytext);i.push(m.yylloc);r.push(R[1]);C=null;if(!_){u=m.yyleng;s=m.yytext;l=m.yylineno;g=m.yylloc;if(d>0){d--}}else{C=_;_=null}break;case 2:A=this.productions_[R[1]][1];O.$=o[o.length-A];O._$={first_line:i[i.length-(A||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(A||1)].first_column,last_column:i[i.length-1].last_column};if(w){O._$.range=[i[i.length-(A||1)].range[0],i[i.length-1].range[1]]}S=this.performAction.apply(O,[s,u,l,p.yy,R[1],o,i].concat(h));if(typeof S!=="undefined"){return S}if(A){r=r.slice(0,-1*A*2);o=o.slice(0,-1*A);i=i.slice(0,-1*A)}r.push(this.productions_[R[1]][0]);o.push(O.$);i.push(O._$);N=a[r[r.length-2]][r[r.length-1]];r.push(N);break;case 3:return true}}return true}};var lexer=function(){var e={EOF:1,parseError:function t(e,r){if(this.yy.parser){this.yy.parser.parseError(e,r)}else{throw new Error(e)}},setInput:function r(e,t){this.yy=t||this.yy||{};this._input=e;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function n(){var e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);if(t){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return e},unput:function o(e){var t=e.length;var r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-t);this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(r.length-1){this.yylineno-=r.length-1}var o=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t};if(this.options.ranges){this.yylloc.range=[o[0],o[0]+this.yyleng-t]}this.yyleng=this.yytext.length;return this},more:function i(){this._more=true;return this},reject:function a(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function s(e){this.unput(this.match.slice(e))},pastInput:function l(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function u(){var e=this.match;if(e.length<20){e+=this._input.substr(0,20-e.length)}return(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function d(){var e=this.pastInput();var t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function f(e,t){var r,n,o;if(this.options.backtrack_lexer){o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){o.yylloc.range=this.yylloc.range.slice(0)}}n=e[0].match(/(?:\r\n?|\n).*/g);if(n){this.yylineno+=n.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(e[0].length);this.matched+=e[0];r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(r){return r}else if(this._backtrack){for(var i in o){this[i]=o[i]}return false}return false},next:function c(){if(this.done){return this.EOF}if(!this._input){this.done=true}var e,t,r,n;if(!this._more){this.yytext="";this.match=""}var o=this._currentRules();for(var i=0;i<o.length;i++){r=this._input.match(this.rules[o[i]]);if(r&&(!t||r[0].length>t[0].length)){t=r;n=i;if(this.options.backtrack_lexer){e=this.test_match(r,o[i]);if(e!==false){return e}else if(this._backtrack){t=false;continue}else{return false}}else if(!this.options.flex){break}}}if(t){e=this.test_match(t,o[n]);if(e!==false){return e}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function h(){var e=this.next();if(e){return e}else{return this.lex()}},begin:function m(e){this.conditionStack.push(e)},popState:function p(){var e=this.conditionStack.length-1;if(e>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function v(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions["INITIAL"].rules}},topState:function g(e){e=this.conditionStack.length-1-Math.abs(e||0);if(e>=0){return this.conditionStack[e]}else{return"INITIAL"}},pushState:function w(e){this.begin(e)},stateStackSize:function b(){return this.conditionStack.length},options:{},performAction:function y(e,t,r,n){var o=n;switch(r){case 0:break;case 1:return 8;break;case 2:return 8;break;case 3:return 21;break;case 4:return 35;break;case 5:return 24;break;case 6:return 26;break;case 7:return 26;break;case 8:return 25;break;case 9:return 21;break;case 10:return 31;break;case 11:return 31;break;case 12:return 33;break;case 13:return 28;break;case 14:return 9;break;case 15:return" ";break;case 16:return 32;break;case 17:return 27;break;case 18:return 29;break;case 19:return 30;break;case 20:return 18;break;case 21:return 19;break;case 22:return 17;break;case 23:return 11;break;case 24:return 20;break;case 25:return 12;break;case 26:return 13;break;case 27:return 15;break;case 28:return 14;break;case 29:return 16;break;case 30:return'"';break;case 31:return"'";break;case 32:return"!";break;case 33:return 10;break;case 34:return 34;break;case 35:return"#";break;case 36:return 5;break}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:true}}};return e}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();if(true){exports.parser=grammarParser;exports.Parser=grammarParser.Parser;exports.parse=function(){return grammarParser.parse.apply(grammarParser,arguments)};if(typeof module!=="undefined"&&__webpack_require__.c[__webpack_require__.s]===module){exports.main(process.argv.slice(1))}}}).call(exports,__webpack_require__(79)(module),__webpack_require__(15))},function(e,t,r){"use strict";t.__esModule=true;t.rowLabelToIndex=t.rowIndexToLabel=t.columnLabelToIndex=t.columnIndexToLabel=t.toLabel=t.extractLabel=t.error=t.Parser=t.ERROR_VALUE=t.ERROR_REF=t.ERROR_NUM=t.ERROR_NULL=t.ERROR_NOT_AVAILABLE=t.ERROR_NAME=t.ERROR_DIV_ZERO=t.ERROR=t.SUPPORTED_FORMULAS=undefined;var n=r(16);var o=d(n);var i=r(10);var a=d(i);var s=r(1);var l=d(s);var u=r(9);function d(e){return e&&e.__esModule?e:{"default":e}}t.SUPPORTED_FORMULAS=a["default"];t.ERROR=s.ERROR;t.ERROR_DIV_ZERO=s.ERROR_DIV_ZERO;t.ERROR_NAME=s.ERROR_NAME;t.ERROR_NOT_AVAILABLE=s.ERROR_NOT_AVAILABLE;t.ERROR_NULL=s.ERROR_NULL;t.ERROR_NUM=s.ERROR_NUM;t.ERROR_REF=s.ERROR_REF;t.ERROR_VALUE=s.ERROR_VALUE;t.Parser=o["default"];t.error=l["default"];t.extractLabel=u.extractLabel;t.toLabel=u.toLabel;t.columnIndexToLabel=u.columnIndexToLabel;t.columnLabelToIndex=u.columnLabelToIndex;t.rowIndexToLabel=u.rowIndexToLabel;t.rowLabelToIndex=u.rowLabelToIndex}])})},{}],jsonpatch:[function(e,t,r){/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
var n=this&&this.__extends||function(e,t){for(var r in t){if(t.hasOwnProperty(r))e[r]=t[r]}function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var o=Error;var i;(function(e){var t=function D(e){if(E(e)){var t=new Array(e.length);for(var r=0;r<t.length;r++){t[r]=""+r}return t}if(Object.keys){return Object.keys(e)}var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t};function r(e,n){switch(typeof e==="undefined"?"undefined":_typeof(e)){case"undefined":case"boolean":case"string":case"number":return e===n;case"object":if(e===null)return n===null;if(E(e)){if(!E(n)||e.length!==n.length)return false;for(var o=0,i=e.length;o<i;o++){if(!r(e[o],n[o]))return false}return true}var a=t(n);var s=a.length;if(t(e).length!==s)return false;for(var o=0;o<s;o++){if(!r(e[o],n[o]))return false}return true;default:return false}}var i={add:function k(e,t){e[t]=this.value;return true},remove:function x(e,t){delete e[t];return true},replace:function I(e,t){e[t]=this.value;return true},move:function P(e,t,r){var n={op:"_get",path:this.from};M(r,[n]);M(r,[{op:"remove",path:this.from}]);M(r,[{op:"add",path:this.path,value:n.value}]);return true},copy:function L(e,t,r){var n={op:"_get",path:this.from};M(r,[n]);M(r,[{op:"add",path:this.path,value:n.value}]);return true},test:function H(e,t){return r(e[t],this.value)},_get:function V(e,t){this.value=e[t]}};var a={add:function F(e,t){e.splice(t,0,this.value);return true},remove:function B(e,t){e.splice(t,1);return true},replace:function j(e,t){e[t]=this.value;return true},move:i.move,copy:i.copy,test:i.test,_get:i._get};var s={add:function W(e){s.remove.call(this,e);for(var t in this.value){if(this.value.hasOwnProperty(t)){e[t]=this.value[t]}}return true},remove:function $(e){for(var t in e){if(e.hasOwnProperty(t)){i.remove.call(this,e,t)}}return true},replace:function U(e){M(e,[{op:"remove",path:this.path}]);M(e,[{op:"add",path:this.path,value:this.value}]);return true},move:i.move,copy:i.copy,test:function G(e){return JSON.stringify(e)===JSON.stringify(this.value)},_get:function Y(e){this.value=e}};var l={add:function z(e,t){var r={op:"add",path:t+u(this.name),value:this.object[this.name]};e.push(r)},"delete":function K(e,t){var r={op:"remove",path:t+u(this.name)};e.push(r)},update:function q(e,t){var r={op:"replace",path:t+u(this.name),value:this.object[this.name]};e.push(r)}};function u(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function d(e,t){var r;for(var n in e){if(e.hasOwnProperty(n)){if(e[n]===t){return u(n)+"/"}else if(_typeof(e[n])==="object"){r=d(e[n],t);if(r!=""){return u(n)+"/"+r}}}}return""}function f(e,t){if(e===t){return"/"}var r=d(e,t);if(r===""){throw new o("Object not found in root")}return"/"+r}var c=[];var h=function(){function e(e){this.observers=[];this.obj=e}return e}();var m=function(){function e(e,t){this.callback=e;this.observer=t}return e}();function p(e){for(var t=0,r=c.length;t<r;t++){if(c[t].obj===e){return c[t]}}}function v(e,t){for(var r=0,n=e.observers.length;r<n;r++){if(e.observers[r].callback===t){return e.observers[r].observer}}}function g(e,t){for(var r=0,n=e.observers.length;r<n;r++){if(e.observers[r].observer===t){e.observers.splice(r,1);return}}}function w(e,t){t.unobserve()}e.unobserve=w;function b(e){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){return JSON.parse(JSON.stringify(e))}else{return e}}function y(e,t){var r=[];var n=e;var i;var a=p(e);if(!a){a=new h(e);c.push(a)}else{i=v(a,t)}if(i){return i}i={};a.value=b(e);if(t){i.callback=t;i.next=null;var s=this.intervals||[100,1e3,1e4,6e4];if(s.push===void 0){throw new o("jsonpatch.intervals must be an array")}var l=0;var u=function w(){C(i)};var d=function y(){clearTimeout(i.next);i.next=setTimeout(function(){u();l=0;i.next=setTimeout(f,s[l++])},0)};var f=function _(){u();if(l==s.length)l=s.length-1;i.next=setTimeout(_,s[l++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",d);window.addEventListener("mouseup",d);window.addEventListener("keydown",d)}else{document.documentElement.attachEvent("onmousedown",d);document.documentElement.attachEvent("onmouseup",d);document.documentElement.attachEvent("onkeydown",d)}}i.next=setTimeout(f,s[l++])}i.patches=r;i.object=e;i.unobserve=function(){C(i);clearTimeout(i.next);g(a,i);if(typeof window!=="undefined"){if(window.removeEventListener){window.removeEventListener("mousedown",d);window.removeEventListener("mouseup",d);window.removeEventListener("keydown",d)}else{document.documentElement.detachEvent("onmousedown",d);document.documentElement.detachEvent("onmouseup",d);document.documentElement.detachEvent("onkeydown",d)}}};a.observers.push(new m(t,i));return i}e.observe=y;function C(e){var t;for(var r=0,n=c.length;r<n;r++){if(c[r].obj===e.object){t=c[r];break}}_(t.value,e.object,e.patches,"");if(e.patches.length){M(t.value,e.patches)}var o=e.patches;if(o.length>0){e.patches=[];if(e.callback){e.callback(o)}}return o}e.generate=C;function _(e,r,n,o){var i=t(r);var a=t(e);var s=false;var l=false;for(var d=a.length-1;d>=0;d--){var f=a[d];var c=e[f];if(r.hasOwnProperty(f)){var h=r[f];if((typeof c==="undefined"?"undefined":_typeof(c))=="object"&&c!=null&&(typeof h==="undefined"?"undefined":_typeof(h))=="object"&&h!=null){_(c,h,n,o+"/"+u(f))}else{if(c!=h){s=true;n.push({op:"replace",path:o+"/"+u(f),value:b(h)})}}}else{n.push({op:"remove",path:o+"/"+u(f)});l=true}}if(!l&&i.length==a.length){return}for(var d=0;d<i.length;d++){var f=i[d];if(!e.hasOwnProperty(f)){n.push({op:"add",path:o+"/"+u(f),value:b(r[f])})}}}var E;if(Array.isArray){E=Array.isArray}else{E=function X(e){return e.push&&typeof e.length==="number"}}function R(e){var t=0;var r=e.length;var n;while(t<r){n=e.charCodeAt(t);if(n>=48&&n<=57){t++;continue}return false}return true}function M(e,t,r){var n=false,o=0,l=t.length,u,d;while(o<l){u=t[o];o++;var f=u.path||"";var c=f.split("/");var h=e;var m=1;var p=c.length;var v=undefined;while(true){d=c[m];if(r){if(v===undefined){if(h[d]===undefined){v=c.slice(0,m).join("/")}else if(m==p-1){v=u.path}if(v!==undefined){this.validator(u,o-1,e,v)}}}m++;if(d===undefined){if(m>=p){n=s[u.op].call(u,h,d,e);break}}if(E(h)){if(d==="-"){d=h.length}else{if(r&&!R(d)){throw new O("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o-1,u.path,u)}d=parseInt(d,10)}if(m>=p){if(r&&u.op==="add"&&d>h.length){throw new O("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o-1,u.path,u)}n=a[u.op].call(u,h,d,e);break}}else{if(d&&d.indexOf("~")!=-1)d=d.replace(/~1/g,"/").replace(/~0/g,"~");if(m>=p){n=i[u.op].call(u,h,d,e);break}}h=h[d]}}return n}e.apply=M;function S(e,t){var r=[];_(e,t,r,"");return r}e.compare=S;var O=function(e){n(t,e);function t(t,r,n,o,i){e.call(this,t);this.message=t;this.name=r;this.index=n;this.operation=o;this.tree=i}return t}(o);e.JsonPatchError=O;e.Error=O;function T(e){if(e===undefined){return true}if(typeof e=="array"||(typeof e==="undefined"?"undefined":_typeof(e))=="object"){for(var t in e){if(T(e[t])){return true}}}return false}function A(t,r,n,o){if((typeof t==="undefined"?"undefined":_typeof(t))!=="object"||t===null||E(t)){throw new O("Operation is not an object","OPERATION_NOT_AN_OBJECT",r,t,n)}else if(!i[t.op]){throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",r,t,n)}else if(typeof t.path!=="string"){throw new O("Operation `path` property is not a string","OPERATION_PATH_INVALID",r,t,n)}else if((t.op==="move"||t.op==="copy")&&typeof t.from!=="string"){throw new O("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",r,t,n)}else if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===undefined){throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",r,t,n)}else if((t.op==="add"||t.op==="replace"||t.op==="test")&&T(t.value)){throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",r,t,n)}else if(n){if(t.op=="add"){var a=t.path.split("/").length;var s=o.split("/").length;if(a!==s+1&&a!==s){throw new O("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",r,t,n)}}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==o){throw new O("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",r,t,n)}}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:undefined};var u=e.validate([l],n);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE"){throw new O("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",r,t,n)}}}}e.validator=A;function N(e,t){try{if(!E(e)){throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY")}if(t){t=JSON.parse(JSON.stringify(t));M.call(this,t,e,true)}else{for(var r=0;r<e.length;r++){this.validator(e[r],r)}}}catch(n){if(n instanceof O){return n}else{throw n}}}e.validate=N})(i||(i={}));if(typeof r!=="undefined"){r.apply=i.apply;r.observe=i.observe;r.unobserve=i.unobserve;r.generate=i.generate;r.compare=i.compare;r.validate=i.validate;r.validator=i.validator;r.JsonPatchError=i.JsonPatchError;r.Error=i.Error}},{}],moment:[function(e,t,r){(function(e,n){(typeof r==="undefined"?"undefined":_typeof(r))==="object"&&typeof t!=="undefined"?t.exports=n():typeof define==="function"&&define.amd?define(n):e.moment=n()})(this,function(){"use strict";var r;function n(){return r.apply(null,arguments)}function o(e){r=e}function i(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function a(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function s(e){var t;for(t in e){return false}return true}function l(e){return e===void 0}function u(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function d(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function f(e,t){var r=[],n;for(n=0;n<e.length;++n){r.push(t(e[n],n))}return r}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var r in t){if(c(t,r)){e[r]=t[r]}}if(c(t,"toString")){e.toString=t.toString}if(c(t,"valueOf")){e.valueOf=t.valueOf}return e}function m(e,t,r,n){return Wr(e,t,r,n,true).utc()}function p(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function v(e){if(e._pf==null){e._pf=p()}return e._pf}var g;if(Array.prototype.some){g=Array.prototype.some}else{g=function Oi(e){var t=Object(this);var r=t.length>>>0;for(var n=0;n<r;n++){if(n in t&&e.call(this,t[n],n,t)){return true}}return false}}var w=g;function b(e){if(e._isValid==null){var t=v(e);var r=w.call(t.parsedDateParts,function(e){return e!=null});var n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict){n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(e)){e._isValid=n}else{return n}}return e._isValid}function y(e){var t=m(NaN);if(e!=null){h(v(t),e)}else{v(t).userInvalidated=true}return t}var C=n.momentProperties=[];function _(e,t){var r,n,o;if(!l(t._isAMomentObject)){e._isAMomentObject=t._isAMomentObject}if(!l(t._i)){e._i=t._i}if(!l(t._f)){e._f=t._f}if(!l(t._l)){e._l=t._l}if(!l(t._strict)){e._strict=t._strict}if(!l(t._tzm)){e._tzm=t._tzm}if(!l(t._isUTC)){e._isUTC=t._isUTC}if(!l(t._offset)){e._offset=t._offset}if(!l(t._pf)){e._pf=v(t)}if(!l(t._locale)){e._locale=t._locale}if(C.length>0){for(r=0;r<C.length;r++){n=C[r];o=t[n];if(!l(o)){e[n]=o}}}return e}var E=false;function R(e){_(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(E===false){E=true;n.updateOffset(this);E=false}}function M(e){return e instanceof R||e!=null&&e._isAMomentObject!=null}function S(e){if(e<0){return Math.ceil(e)||0}else{return Math.floor(e)}}function O(e){var t=+e,r=0;if(t!==0&&isFinite(t)){r=S(t)}return r}function T(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++){if(r&&e[a]!==t[a]||!r&&O(e[a])!==O(t[a])){i++}}return i+o}function A(e){if(n.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function N(e,t){var r=true;return h(function(){if(n.deprecationHandler!=null){n.deprecationHandler(null,e)}if(r){var o=[];var i;for(var a=0;a<arguments.length;a++){i="";if(_typeof(arguments[a])==="object"){i+="\n["+a+"] ";for(var s in arguments[0]){i+=s+": "+arguments[0][s]+", "}i=i.slice(0,-2)}else{i=arguments[a]}o.push(i)}A(e+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack);r=false}return t.apply(this,arguments)},t)}var D={};function k(e,t){if(n.deprecationHandler!=null){n.deprecationHandler(e,t)}if(!D[e]){A(t);D[e]=true}}n.suppressDeprecationWarnings=false;n.deprecationHandler=null;function x(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function I(e){var t,r;for(r in e){t=e[r];if(x(t)){this[r]=t}else{this["_"+r]=t}}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function P(e,t){var r=h({},e),n;for(n in t){if(c(t,n)){if(a(e[n])&&a(t[n])){r[n]={};h(r[n],e[n]);h(r[n],t[n])}else if(t[n]!=null){r[n]=t[n]}else{delete r[n]}}}for(n in e){if(c(e,n)&&!c(t,n)&&a(e[n])){r[n]=h({},r[n])}}return r}function L(e){if(e!=null){this.set(e)}}var H;if(Object.keys){H=Object.keys}else{H=function Ti(e){var t,r=[];for(t in e){if(c(e,t)){r.push(t)}}return r}}var V=H;var F={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function B(e,t,r){var n=this._calendar[e]||this._calendar["sameElse"];return x(n)?n.call(t,r):n}var j={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function W(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];if(t||!r){return t}this._longDateFormat[e]=r.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)});return this._longDateFormat[e]}var $="Invalid date";function U(){return this._invalidDate}var G="%d";var Y=/\d{1,2}/;function z(e){return this._ordinal.replace("%d",e)}var K={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function q(e,t,r,n){var o=this._relativeTime[r];return x(o)?o(e,t,r,n):o.replace(/%d/i,e)}function X(e,t){var r=this._relativeTime[e>0?"future":"past"];return x(r)?r(t):r.replace(/%s/i,t)}var J={};function Z(e,t){var r=e.toLowerCase();J[r]=J[r+"s"]=J[t]=e}function Q(e){return typeof e==="string"?J[e]||J[e.toLowerCase()]:undefined}function ee(e){var t={},r,n;for(n in e){if(c(e,n)){r=Q(n);if(r){t[r]=e[n]}}}return t}var te={};function re(e,t){te[e]=t}function ne(e){var t=[];for(var r in e){t.push({unit:r,priority:te[r]})}t.sort(function(e,t){return e.priority-t.priority});return t}function oe(e,t){return function(r){if(r!=null){ae(this,e,r);n.updateOffset(this,t);return this}else{return ie(this,e)}}}function ie(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function ae(e,t,r){if(e.isValid()){e._d["set"+(e._isUTC?"UTC":"")+t](r)}}function se(e){e=Q(e);if(x(this[e])){return this[e]()}return this}function le(e,t){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){e=ee(e);var r=ne(e);for(var n=0;n<r.length;n++){this[r[n].unit](e[r[n].unit])}}else{e=Q(e);if(x(this[e])){return this[e](t)}}return this}function ue(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var de=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var fe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var ce={};var he={};function me(e,t,r,n){var o=n;if(typeof n==="string"){o=function i(){return this[n]()}}if(e){he[e]=o}if(t){he[t[0]]=function(){return ue(o.apply(this,arguments),t[1],t[2])}}if(r){he[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)}}}function pe(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function ve(e){var t=e.match(de),r,n;for(r=0,n=t.length;r<n;r++){if(he[t[r]]){t[r]=he[t[r]]}else{t[r]=pe(t[r])}}return function(r){var o="",i;for(i=0;i<n;i++){o+=x(t[i])?t[i].call(r,e):t[i]}return o}}function ge(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=we(t,e.localeData());ce[t]=ce[t]||ve(t);return ce[t](e)}function we(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}fe.lastIndex=0;while(r>=0&&fe.test(e)){e=e.replace(fe,n);fe.lastIndex=0;r-=1}return e}var be=/\d/;var ye=/\d\d/;var Ce=/\d{3}/;var _e=/\d{4}/;var Ee=/[+-]?\d{6}/;var Re=/\d\d?/;var Me=/\d\d\d\d?/;var Se=/\d\d\d\d\d\d?/;var Oe=/\d{1,3}/;var Te=/\d{1,4}/;var Ae=/[+-]?\d{1,6}/;var Ne=/\d+/;var De=/[+-]?\d+/;var ke=/Z|[+-]\d\d:?\d\d/gi;var xe=/Z|[+-]\d\d(?::?\d\d)?/gi;var Ie=/[+-]?\d+(\.\d{1,3})?/;var Pe=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;var Le={};function He(e,t,r){Le[e]=x(t)?t:function(e,n){return e&&r?r:t}}function Ve(e,t){if(!c(Le,e)){return new RegExp(Fe(e))}return Le[e](t._strict,t._locale)}function Fe(e){return Be(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,n,o){return t||r||n||o}))}function Be(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var je={};function We(e,t){var r,n=t;if(typeof e==="string"){e=[e]}if(u(t)){n=function o(e,r){r[t]=O(e)}}for(r=0;r<e.length;r++){je[e[r]]=n}}function $e(e,t){We(e,function(e,r,n,o){n._w=n._w||{};t(e,n._w,n,o)})}function Ue(e,t,r){if(t!=null&&c(je,e)){je[e](t,r._a,r,e)}}var Ge=0;var Ye=1;var ze=2;var Ke=3;var qe=4;var Xe=5;var Je=6;var Ze=7;var Qe=8;var et;if(Array.prototype.indexOf){et=Array.prototype.indexOf}else{et=function Ai(e){var t;for(t=0;t<this.length;++t){if(this[t]===e){return t}}return-1}}var tt=et;function rt(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}me("M",["MM",2],"Mo",function(){return this.month()+1});me("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});me("MMMM",0,0,function(e){return this.localeData().months(this,e)});Z("month","M");re("month",8);He("M",Re);He("MM",Re,ye);He("MMM",function(e,t){return t.monthsShortRegex(e)});He("MMMM",function(e,t){return t.monthsRegex(e)});We(["M","MM"],function(e,t){t[Ye]=O(e)-1});We(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);if(o!=null){t[Ye]=o}else{v(r).invalidMonth=e}});var nt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var ot="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function it(e,t){if(!e){return i(this._months)?this._months:this._months["standalone"]}return i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nt).test(t)?"format":"standalone"][e.month()]}var at="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function st(e,t){if(!e){return i(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nt.test(t)?"format":"standalone"][e.month()]}function lt(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(n=0;n<12;++n){i=m([2e3,n]);this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase();this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase()}}if(r){if(t==="MMM"){o=tt.call(this._shortMonthsParse,a);return o!==-1?o:null}else{o=tt.call(this._longMonthsParse,a);return o!==-1?o:null}}else{if(t==="MMM"){o=tt.call(this._shortMonthsParse,a);if(o!==-1){return o}o=tt.call(this._longMonthsParse,a);return o!==-1?o:null}else{o=tt.call(this._longMonthsParse,a);if(o!==-1){return o}o=tt.call(this._shortMonthsParse,a);return o!==-1?o:null}}}function ut(e,t,r){var n,o,i;if(this._monthsParseExact){return lt.call(this,e,t,r)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(n=0;n<12;n++){o=m([2e3,n]);if(r&&!this._longMonthsParse[n]){this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i");this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")}if(!r&&!this._monthsParse[n]){i="^"+this.months(o,"")+"|^"+this.monthsShort(o,"");this._monthsParse[n]=new RegExp(i.replace(".",""),"i")}if(r&&t==="MMMM"&&this._longMonthsParse[n].test(e)){return n}else if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e)){return n}else if(!r&&this._monthsParse[n].test(e)){return n}}}function dt(e,t){var r;if(!e.isValid()){return e}if(typeof t==="string"){if(/^\d+$/.test(t)){t=O(t)}else{t=e.localeData().monthsParse(t);if(!u(t)){return e}}}r=Math.min(e.date(),rt(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r);return e}function ft(e){if(e!=null){dt(this,e);n.updateOffset(this,true);return this}else{return ie(this,"Month")}}function ct(){return rt(this.year(),this.month())}var ht=Pe;function mt(e){if(this._monthsParseExact){if(!c(this,"_monthsRegex")){gt.call(this)}if(e){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!c(this,"_monthsShortRegex")){this._monthsShortRegex=ht}return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}var pt=Pe;function vt(e){if(this._monthsParseExact){if(!c(this,"_monthsRegex")){gt.call(this)}if(e){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!c(this,"_monthsRegex")){this._monthsRegex=pt}return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function gt(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++){i=m([2e3,o]);t.push(this.monthsShort(i,""));r.push(this.months(i,""));n.push(this.months(i,""));n.push(this.monthsShort(i,""))}t.sort(e);r.sort(e);n.sort(e);for(o=0;o<12;o++){t[o]=Be(t[o]);r[o]=Be(r[o])}for(o=0;o<24;o++){n[o]=Be(n[o])}this._monthsRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}me("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e});me(0,["YY",2],0,function(){return this.year()%100});me(0,["YYYY",4],0,"year");me(0,["YYYYY",5],0,"year");me(0,["YYYYYY",6,true],0,"year");Z("year","y");re("year",1);He("Y",De);He("YY",Re,ye);He("YYYY",Te,_e);He("YYYYY",Ae,Ee);He("YYYYYY",Ae,Ee);We(["YYYYY","YYYYYY"],Ge);We("YYYY",function(e,t){t[Ge]=e.length===2?n.parseTwoDigitYear(e):O(e)});We("YY",function(e,t){t[Ge]=n.parseTwoDigitYear(e)});We("Y",function(e,t){t[Ge]=parseInt(e,10)});function wt(e){return bt(e)?366:365}function bt(e){return e%4===0&&e%100!==0||e%400===0}n.parseTwoDigitYear=function(e){return O(e)+(O(e)>68?1900:2e3)};var yt=oe("FullYear",true);function Ct(){return bt(this.year())}function _t(e,t,r,n,o,i,a){var s=new Date(e,t,r,n,o,i,a);if(e<100&&e>=0&&isFinite(s.getFullYear())){s.setFullYear(e)}return s}function Et(e){var t=new Date(Date.UTC.apply(null,arguments));if(e<100&&e>=0&&isFinite(t.getUTCFullYear())){t.setUTCFullYear(e)}return t}function Rt(e,t,r){var n=7+t-r,o=(7+Et(e,0,n).getUTCDay()-t)%7;return-o+n-1}function Mt(e,t,r,n,o){var i=(7+r-n)%7,a=Rt(e,n,o),s=1+7*(t-1)+i+a,l,u;if(s<=0){l=e-1;u=wt(l)+s}else if(s>wt(e)){l=e+1;u=s-wt(e)}else{l=e;u=s}return{year:l,dayOfYear:u}}function St(e,t,r){var n=Rt(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;if(o<1){a=e.year()-1;i=o+Ot(a,t,r)}else if(o>Ot(e.year(),t,r)){i=o-Ot(e.year(),t,r);a=e.year()+1}else{a=e.year();i=o}return{week:i,year:a}}function Ot(e,t,r){var n=Rt(e,t,r),o=Rt(e+1,t,r);return(wt(e)-n+o)/7}me("w",["ww",2],"wo","week");me("W",["WW",2],"Wo","isoWeek");Z("week","w");Z("isoWeek","W");re("week",5);re("isoWeek",5);He("w",Re);He("ww",Re,ye);He("W",Re);He("WW",Re,ye);$e(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=O(e)});function Tt(e){return St(e,this._week.dow,this._week.doy).week}var At={dow:0,doy:6};function Nt(){return this._week.dow}function Dt(){return this._week.doy}function kt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function xt(e){var t=St(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}me("d",0,"do","day");me("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});me("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});me("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});me("e",0,0,"weekday");me("E",0,0,"isoWeekday");Z("day","d");Z("weekday","e");Z("isoWeekday","E");re("day",11);re("weekday",11);re("isoWeekday",11);He("d",Re);He("e",Re);He("E",Re);He("dd",function(e,t){return t.weekdaysMinRegex(e)});He("ddd",function(e,t){return t.weekdaysShortRegex(e)});He("dddd",function(e,t){return t.weekdaysRegex(e)});$e(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);if(o!=null){t.d=o}else{v(r).invalidWeekday=e}});$e(["d","e","E"],function(e,t,r,n){t[n]=O(e)});function It(e,t){if(typeof e!=="string"){return e}if(!isNaN(e)){return parseInt(e,10)}e=t.weekdaysParse(e);if(typeof e==="number"){return e}return null}function Pt(e,t){if(typeof e==="string"){return t.weekdaysParse(e)%7||7}return isNaN(e)?null:e}var Lt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Ht(e,t){if(!e){return i(this._weekdays)?this._weekdays:this._weekdays["standalone"]}return i(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}var Vt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Ft(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}var Bt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function jt(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Wt(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(n=0;n<7;++n){i=m([2e3,1]).day(n);this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase();this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase();this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase()}}if(r){if(t==="dddd"){o=tt.call(this._weekdaysParse,a);return o!==-1?o:null}else if(t==="ddd"){o=tt.call(this._shortWeekdaysParse,a);return o!==-1?o:null}else{o=tt.call(this._minWeekdaysParse,a);return o!==-1?o:null}}else{if(t==="dddd"){o=tt.call(this._weekdaysParse,a);if(o!==-1){return o}o=tt.call(this._shortWeekdaysParse,a);if(o!==-1){return o}o=tt.call(this._minWeekdaysParse,a);return o!==-1?o:null}else if(t==="ddd"){o=tt.call(this._shortWeekdaysParse,a);if(o!==-1){return o}o=tt.call(this._weekdaysParse,a);if(o!==-1){return o}o=tt.call(this._minWeekdaysParse,a);return o!==-1?o:null}else{o=tt.call(this._minWeekdaysParse,a);if(o!==-1){return o}o=tt.call(this._weekdaysParse,a);if(o!==-1){return o}o=tt.call(this._shortWeekdaysParse,a);return o!==-1?o:null}}}function $t(e,t,r){var n,o,i;if(this._weekdaysParseExact){return Wt.call(this,e,t,r)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(n=0;n<7;n++){o=m([2e3,1]).day(n);if(r&&!this._fullWeekdaysParse[n]){this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".",".?")+"$","i");this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".",".?")+"$","i");this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".",".?")+"$","i")}if(!this._weekdaysParse[n]){i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,"");this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")}if(r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e)){return n}else if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e)){return n}else if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e)){return n}else if(!r&&this._weekdaysParse[n].test(e)){return n}}}function Ut(e){if(!this.isValid()){return e!=null?this:NaN}var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=It(e,this.localeData());return this.add(e-t,"d")}else{return t}}function Gt(e){if(!this.isValid()){return e!=null?this:NaN}var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Yt(e){if(!this.isValid()){return e!=null?this:NaN}if(e!=null){var t=Pt(e,this.localeData());return this.day(this.day()%7?t:t-7)}else{return this.day()||7}}var zt=Pe;function Kt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Qt.call(this)}if(e){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!c(this,"_weekdaysRegex")){this._weekdaysRegex=zt}return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}var qt=Pe;function Xt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Qt.call(this)}if(e){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!c(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=qt}return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var Jt=Pe;function Zt(e){if(this._weekdaysParseExact){if(!c(this,"_weekdaysRegex")){Qt.call(this)}if(e){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!c(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=Jt}return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function Qt(){function e(e,t){return t.length-e.length}var t=[],r=[],n=[],o=[],i,a,s,l,u;for(i=0;i<7;i++){a=m([2e3,1]).day(i);s=this.weekdaysMin(a,"");l=this.weekdaysShort(a,"");u=this.weekdays(a,"");t.push(s);r.push(l);n.push(u);o.push(s);o.push(l);o.push(u)}t.sort(e);r.sort(e);n.sort(e);o.sort(e);for(i=0;i<7;i++){r[i]=Be(r[i]);n[i]=Be(n[i]);o[i]=Be(o[i])}this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function er(){return this.hours()%12||12}function tr(){return this.hours()||24}me("H",["HH",2],0,"hour");me("h",["hh",2],0,er);me("k",["kk",2],0,tr);me("hmm",0,0,function(){return""+er.apply(this)+ue(this.minutes(),2)});me("hmmss",0,0,function(){return""+er.apply(this)+ue(this.minutes(),2)+ue(this.seconds(),2)});me("Hmm",0,0,function(){return""+this.hours()+ue(this.minutes(),2)});me("Hmmss",0,0,function(){return""+this.hours()+ue(this.minutes(),2)+ue(this.seconds(),2)});function rr(e,t){me(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}rr("a",true);rr("A",false);Z("hour","h");re("hour",13);function nr(e,t){return t._meridiemParse}He("a",nr);He("A",nr);He("H",Re);He("h",Re);He("k",Re);He("HH",Re,ye);He("hh",Re,ye);He("kk",Re,ye);He("hmm",Me);He("hmmss",Se);He("Hmm",Me);He("Hmmss",Se);We(["H","HH"],Ke);We(["k","kk"],function(e,t,r){var n=O(e);t[Ke]=n===24?0:n});We(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e);r._meridiem=e});We(["h","hh"],function(e,t,r){
t[Ke]=O(e);v(r).bigHour=true});We("hmm",function(e,t,r){var n=e.length-2;t[Ke]=O(e.substr(0,n));t[qe]=O(e.substr(n));v(r).bigHour=true});We("hmmss",function(e,t,r){var n=e.length-4;var o=e.length-2;t[Ke]=O(e.substr(0,n));t[qe]=O(e.substr(n,2));t[Xe]=O(e.substr(o));v(r).bigHour=true});We("Hmm",function(e,t,r){var n=e.length-2;t[Ke]=O(e.substr(0,n));t[qe]=O(e.substr(n))});We("Hmmss",function(e,t,r){var n=e.length-4;var o=e.length-2;t[Ke]=O(e.substr(0,n));t[qe]=O(e.substr(n,2));t[Xe]=O(e.substr(o))});function or(e){return(e+"").toLowerCase().charAt(0)==="p"}var ir=/[ap]\.?m?\.?/i;function ar(e,t,r){if(e>11){return r?"pm":"PM"}else{return r?"am":"AM"}}var sr=oe("Hours",true);var lr={calendar:F,longDateFormat:j,invalidDate:$,ordinal:G,dayOfMonthOrdinalParse:Y,relativeTime:K,months:ot,monthsShort:at,week:At,weekdays:Lt,weekdaysMin:Bt,weekdaysShort:Vt,meridiemParse:ir};var ur={};var dr={};var fr;function cr(e){return e?e.toLowerCase().replace("_","-"):e}function hr(e){var t=0,r,n,o,i;while(t<e.length){i=cr(e[t]).split("-");r=i.length;n=cr(e[t+1]);n=n?n.split("-"):null;while(r>0){o=mr(i.slice(0,r).join("-"));if(o){return o}if(n&&n.length>=r&&T(i,n,true)>=r-1){break}r--}t++}return null}function mr(r){var n=null;if(!ur[r]&&typeof t!=="undefined"&&t&&t.exports){try{n=fr._abbr;e("./locale/"+r);pr(n)}catch(o){}}return ur[r]}function pr(e,t){var r;if(e){if(l(t)){r=wr(e)}else{r=vr(e,t)}if(r){fr=r}}return fr._abbr}function vr(e,t){if(t!==null){var r=lr;t.abbr=e;if(ur[e]!=null){k("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");r=ur[e]._config}else if(t.parentLocale!=null){if(ur[t.parentLocale]!=null){r=ur[t.parentLocale]._config}else{if(!dr[t.parentLocale]){dr[t.parentLocale]=[]}dr[t.parentLocale].push({name:e,config:t});return null}}ur[e]=new L(P(r,t));if(dr[e]){dr[e].forEach(function(e){vr(e.name,e.config)})}pr(e);return ur[e]}else{delete ur[e];return null}}function gr(e,t){if(t!=null){var r,n=lr;if(ur[e]!=null){n=ur[e]._config}t=P(n,t);r=new L(t);r.parentLocale=ur[e];ur[e]=r;pr(e)}else{if(ur[e]!=null){if(ur[e].parentLocale!=null){ur[e]=ur[e].parentLocale}else if(ur[e]!=null){delete ur[e]}}}return ur[e]}function wr(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return fr}if(!i(e)){t=mr(e);if(t){return t}e=[e]}return hr(e)}function br(){return V(ur)}function yr(e){var t;var r=e._a;if(r&&v(e).overflow===-2){t=r[Ye]<0||r[Ye]>11?Ye:r[ze]<1||r[ze]>rt(r[Ge],r[Ye])?ze:r[Ke]<0||r[Ke]>24||r[Ke]===24&&(r[qe]!==0||r[Xe]!==0||r[Je]!==0)?Ke:r[qe]<0||r[qe]>59?qe:r[Xe]<0||r[Xe]>59?Xe:r[Je]<0||r[Je]>999?Je:-1;if(v(e)._overflowDayOfYear&&(t<Ge||t>ze)){t=ze}if(v(e)._overflowWeeks&&t===-1){t=Ze}if(v(e)._overflowWeekday&&t===-1){t=Qe}v(e).overflow=t}return e}var Cr=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var _r=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var Er=/Z|[+-]\d\d(?::?\d\d)?/;var Rr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]];var Mr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]];var Sr=/^\/?Date\((\-?\d+)/i;function Or(e){var t,r,n=e._i,o=Cr.exec(n)||_r.exec(n),i,a,s,l;if(o){v(e).iso=true;for(t=0,r=Rr.length;t<r;t++){if(Rr[t][1].exec(o[1])){a=Rr[t][0];i=Rr[t][2]!==false;break}}if(a==null){e._isValid=false;return}if(o[3]){for(t=0,r=Mr.length;t<r;t++){if(Mr[t][1].exec(o[3])){s=(o[2]||" ")+Mr[t][0];break}}if(s==null){e._isValid=false;return}}if(!i&&s!=null){e._isValid=false;return}if(o[4]){if(Er.exec(o[4])){l="Z"}else{e._isValid=false;return}}e._f=a+(s||"")+(l||"");Pr(e)}else{e._isValid=false}}var Tr=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;function Ar(e){var t,r,n,o,i,a;var s={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"};var l="YXWVUTSRQPONZABCDEFGHIKLM";var u,d;t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,"");r=Tr.exec(t);if(r){n=r[1]?"ddd"+(r[1].length===5?", ":" "):"";o="D MMM "+(r[2].length>10?"YYYY ":"YY ");i="HH:mm"+(r[4]?":ss":"");if(r[1]){var f=new Date(r[2]);var c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][f.getDay()];if(r[1].substr(0,3)!==c){v(e).weekdayMismatch=true;e._isValid=false;return}}switch(r[5].length){case 2:if(d===0){u=" +0000"}else{d=l.indexOf(r[5][1].toUpperCase())-12;u=(d<0?" -":" +")+(""+d).replace(/^-?/,"0").match(/..$/)[0]+"00"}break;case 4:u=s[r[5]];break;default:u=s[" GMT"]}r[5]=u;e._i=r.splice(1).join("");a=" ZZ";e._f=n+o+i+a;Pr(e);v(e).rfc2822=true}else{e._isValid=false}}function Nr(e){var t=Sr.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}Or(e);if(e._isValid===false){delete e._isValid}else{return}Ar(e);if(e._isValid===false){delete e._isValid}else{return}n.createFromInputFallback(e)}n.createFromInputFallback=N("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Dr(e,t,r){if(e!=null){return e}if(t!=null){return t}return r}function kr(e){var t=new Date(n.now());if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}return[t.getFullYear(),t.getMonth(),t.getDate()]}function xr(e){var t,r,n=[],o,i;if(e._d){return}o=kr(e);if(e._w&&e._a[ze]==null&&e._a[Ye]==null){Ir(e)}if(e._dayOfYear!=null){i=Dr(e._a[Ge],o[Ge]);if(e._dayOfYear>wt(i)||e._dayOfYear===0){v(e)._overflowDayOfYear=true}r=Et(i,0,e._dayOfYear);e._a[Ye]=r.getUTCMonth();e._a[ze]=r.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=n[t]=o[t]}for(;t<7;t++){e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[Ke]===24&&e._a[qe]===0&&e._a[Xe]===0&&e._a[Je]===0){e._nextDay=true;e._a[Ke]=0}e._d=(e._useUTC?Et:_t).apply(null,n);if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[Ke]=24}}function Ir(e){var t,r,n,o,i,a,s,l;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){i=1;a=4;r=Dr(t.GG,e._a[Ge],St($r(),1,4).year);n=Dr(t.W,1);o=Dr(t.E,1);if(o<1||o>7){l=true}}else{i=e._locale._week.dow;a=e._locale._week.doy;var u=St($r(),i,a);r=Dr(t.gg,e._a[Ge],u.year);n=Dr(t.w,u.week);if(t.d!=null){o=t.d;if(o<0||o>6){l=true}}else if(t.e!=null){o=t.e+i;if(t.e<0||t.e>6){l=true}}else{o=i}}if(n<1||n>Ot(r,i,a)){v(e)._overflowWeeks=true}else if(l!=null){v(e)._overflowWeekday=true}else{s=Mt(r,n,o,i,a);e._a[Ge]=s.year;e._dayOfYear=s.dayOfYear}}n.ISO_8601=function(){};n.RFC_2822=function(){};function Pr(e){if(e._f===n.ISO_8601){Or(e);return}if(e._f===n.RFC_2822){Ar(e);return}e._a=[];v(e).empty=true;var t=""+e._i,r,o,i,a,s,l=t.length,u=0;i=we(e._f,e._locale).match(de)||[];for(r=0;r<i.length;r++){a=i[r];o=(t.match(Ve(a,e))||[])[0];if(o){s=t.substr(0,t.indexOf(o));if(s.length>0){v(e).unusedInput.push(s)}t=t.slice(t.indexOf(o)+o.length);u+=o.length}if(he[a]){if(o){v(e).empty=false}else{v(e).unusedTokens.push(a)}Ue(a,o,e)}else if(e._strict&&!o){v(e).unusedTokens.push(a)}}v(e).charsLeftOver=l-u;if(t.length>0){v(e).unusedInput.push(t)}if(e._a[Ke]<=12&&v(e).bigHour===true&&e._a[Ke]>0){v(e).bigHour=undefined}v(e).parsedDateParts=e._a.slice(0);v(e).meridiem=e._meridiem;e._a[Ke]=Lr(e._locale,e._a[Ke],e._meridiem);xr(e);yr(e)}function Lr(e,t,r){var n;if(r==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,r)}else if(e.isPM!=null){n=e.isPM(r);if(n&&t<12){t+=12}if(!n&&t===12){t=0}return t}else{return t}}function Hr(e){var t,r,n,o,i;if(e._f.length===0){v(e).invalidFormat=true;e._d=new Date(NaN);return}for(o=0;o<e._f.length;o++){i=0;t=_({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._f=e._f[o];Pr(t);if(!b(t)){continue}i+=v(t).charsLeftOver;i+=v(t).unusedTokens.length*10;v(t).score=i;if(n==null||i<n){n=i;r=t}}h(e,r||t)}function Vr(e){if(e._d){return}var t=ee(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});xr(e)}function Fr(e){var t=new R(yr(Br(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function Br(e){var t=e._i,r=e._f;e._locale=e._locale||wr(e._l);if(t===null||r===undefined&&t===""){return y({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(M(t)){return new R(yr(t))}else if(d(t)){e._d=t}else if(i(r)){Hr(e)}else if(r){Pr(e)}else{jr(e)}if(!b(e)){e._d=null}return e}function jr(e){var t=e._i;if(l(t)){e._d=new Date(n.now())}else if(d(t)){e._d=new Date(t.valueOf())}else if(typeof t==="string"){Nr(e)}else if(i(t)){e._a=f(t.slice(0),function(e){return parseInt(e,10)});xr(e)}else if(a(t)){Vr(e)}else if(u(t)){e._d=new Date(t)}else{n.createFromInputFallback(e)}}function Wr(e,t,r,n,o){var l={};if(r===true||r===false){n=r;r=undefined}if(a(e)&&s(e)||i(e)&&e.length===0){e=undefined}l._isAMomentObject=true;l._useUTC=l._isUTC=o;l._l=r;l._i=e;l._f=t;l._strict=n;return Fr(l)}function $r(e,t,r,n){return Wr(e,t,r,n,false)}var Ur=N("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=$r.apply(null,arguments);if(this.isValid()&&e.isValid()){return e<this?this:e}else{return y()}});var Gr=N("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=$r.apply(null,arguments);if(this.isValid()&&e.isValid()){return e>this?this:e}else{return y()}});function Yr(e,t){var r,n;if(t.length===1&&i(t[0])){t=t[0]}if(!t.length){return $r()}r=t[0];for(n=1;n<t.length;++n){if(!t[n].isValid()||t[n][e](r)){r=t[n]}}return r}function zr(){var e=[].slice.call(arguments,0);return Yr("isBefore",e)}function Kr(){var e=[].slice.call(arguments,0);return Yr("isAfter",e)}var qr=function Ni(){return Date.now?Date.now():+new Date};var Xr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Jr(e){for(var t in e){if(!(Xr.indexOf(t)!==-1&&(e[t]==null||!isNaN(e[t])))){return false}}var r=false;for(var n=0;n<Xr.length;++n){if(e[Xr[n]]){if(r){return false}if(parseFloat(e[Xr[n]])!==O(e[Xr[n]])){r=true}}}return true}function Zr(){return this._isValid}function Qr(){return _n(NaN)}function en(e){var t=ee(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,d=t.millisecond||0;this._isValid=Jr(t);this._milliseconds=+d+u*1e3+l*6e4+s*1e3*60*60;this._days=+a+i*7;this._months=+o+n*3+r*12;this._data={};this._locale=wr();this._bubble()}function tn(e){return e instanceof en}function rn(e){if(e<0){return Math.round(-1*e)*-1}else{return Math.round(e)}}function nn(e,t){me(e,0,0,function(){var e=this.utcOffset();var r="+";if(e<0){e=-e;r="-"}return r+ue(~~(e/60),2)+t+ue(~~e%60,2)})}nn("Z",":");nn("ZZ","");He("Z",xe);He("ZZ",xe);We(["Z","ZZ"],function(e,t,r){r._useUTC=true;r._tzm=an(xe,e)});var on=/([\+\-]|\d\d)/gi;function an(e,t){var r=(t||"").match(e);if(r===null){return null}var n=r[r.length-1]||[];var o=(n+"").match(on)||["-",0,0];var i=+(o[1]*60)+O(o[2]);return i===0?0:o[0]==="+"?i:-i}function sn(e,t){var r,o;if(t._isUTC){r=t.clone();o=(M(e)||d(e)?e.valueOf():$r(e).valueOf())-r.valueOf();r._d.setTime(r._d.valueOf()+o);n.updateOffset(r,false);return r}else{return $r(e).local()}}function ln(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}n.updateOffset=function(){};function un(e,t,r){var o=this._offset||0,i;if(!this.isValid()){return e!=null?this:NaN}if(e!=null){if(typeof e==="string"){e=an(xe,e);if(e===null){return this}}else if(Math.abs(e)<16&&!r){e=e*60}if(!this._isUTC&&t){i=ln(this)}this._offset=e;this._isUTC=true;if(i!=null){this.add(i,"m")}if(o!==e){if(!t||this._changeInProgress){On(this,_n(e-o,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;n.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?o:ln(this)}}function dn(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}function fn(e){return this.utcOffset(0,e)}function cn(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(ln(this),"m")}}return this}function hn(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var e=an(ke,this._i);if(e!=null){this.utcOffset(e)}else{this.utcOffset(0,true)}}return this}function mn(e){if(!this.isValid()){return false}e=e?$r(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function pn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function vn(){if(!l(this._isDSTShifted)){return this._isDSTShifted}var e={};_(e,this);e=Br(e);if(e._a){var t=e._isUTC?m(e._a):$r(e._a);this._isDSTShifted=this.isValid()&&T(e._a,t.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function gn(){return this.isValid()?!this._isUTC:false}function wn(){return this.isValid()?this._isUTC:false}function bn(){return this.isValid()?this._isUTC&&this._offset===0:false}var yn=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var Cn=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;function _n(e,t){var r=e,n=null,o,i,a;if(tn(e)){r={ms:e._milliseconds,d:e._days,M:e._months}}else if(u(e)){r={};if(t){r[t]=e}else{r.milliseconds=e}}else if(!!(n=yn.exec(e))){o=n[1]==="-"?-1:1;r={y:0,d:O(n[ze])*o,h:O(n[Ke])*o,m:O(n[qe])*o,s:O(n[Xe])*o,ms:O(rn(n[Je]*1e3))*o}}else if(!!(n=Cn.exec(e))){o=n[1]==="-"?-1:1;r={y:En(n[2],o),M:En(n[3],o),w:En(n[4],o),d:En(n[5],o),h:En(n[6],o),m:En(n[7],o),s:En(n[8],o)}}else if(r==null){r={}}else if((typeof r==="undefined"?"undefined":_typeof(r))==="object"&&("from"in r||"to"in r)){a=Mn($r(r.from),$r(r.to));r={};r.ms=a.milliseconds;r.M=a.months}i=new en(r);if(tn(e)&&c(e,"_locale")){i._locale=e._locale}return i}_n.fn=en.prototype;_n.invalid=Qr;function En(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function Rn(e,t){var r={milliseconds:0,months:0};r.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(r.months,"M").isAfter(t)){--r.months}r.milliseconds=+t-+e.clone().add(r.months,"M");return r}function Mn(e,t){var r;if(!(e.isValid()&&t.isValid())){return{milliseconds:0,months:0}}t=sn(t,e);if(e.isBefore(t)){r=Rn(e,t)}else{r=Rn(t,e);r.milliseconds=-r.milliseconds;r.months=-r.months}return r}function Sn(e,t){return function(r,n){var o,i;if(n!==null&&!isNaN(+n)){k(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");i=r;r=n;n=i}r=typeof r==="string"?+r:r;o=_n(r,n);On(this,o,e);return this}}function On(e,t,r,o){var i=t._milliseconds,a=rn(t._days),s=rn(t._months);if(!e.isValid()){return}o=o==null?true:o;if(i){e._d.setTime(e._d.valueOf()+i*r)}if(a){ae(e,"Date",ie(e,"Date")+a*r)}if(s){dt(e,ie(e,"Month")+s*r)}if(o){n.updateOffset(e,a||s)}}var Tn=Sn(1,"add");var An=Sn(-1,"subtract");function Nn(e,t){var r=e.diff(t,"days",true);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Dn(e,t){var r=e||$r(),o=sn(r,this).startOf("day"),i=n.calendarFormat(this,o)||"sameElse";var a=t&&(x(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,$r(r)))}function kn(){return new R(this)}function xn(e,t){var r=M(e)?e:$r(e);if(!(this.isValid()&&r.isValid())){return false}t=Q(!l(t)?t:"millisecond");if(t==="millisecond"){return this.valueOf()>r.valueOf()}else{return r.valueOf()<this.clone().startOf(t).valueOf()}}function In(e,t){var r=M(e)?e:$r(e);if(!(this.isValid()&&r.isValid())){return false}t=Q(!l(t)?t:"millisecond");if(t==="millisecond"){return this.valueOf()<r.valueOf()}else{return this.clone().endOf(t).valueOf()<r.valueOf()}}function Pn(e,t,r,n){n=n||"()";return(n[0]==="("?this.isAfter(e,r):!this.isBefore(e,r))&&(n[1]===")"?this.isBefore(t,r):!this.isAfter(t,r))}function Ln(e,t){var r=M(e)?e:$r(e),n;if(!(this.isValid()&&r.isValid())){return false}t=Q(t||"millisecond");if(t==="millisecond"){return this.valueOf()===r.valueOf()}else{n=r.valueOf();return this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()}}function Hn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Vn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Fn(e,t,r){var n,o,i,a;if(!this.isValid()){return NaN}n=sn(e,this);if(!n.isValid()){return NaN}o=(n.utcOffset()-this.utcOffset())*6e4;t=Q(t);if(t==="year"||t==="month"||t==="quarter"){a=Bn(this,n);if(t==="quarter"){a=a/3}else if(t==="year"){a=a/12}}else{i=this-n;a=t==="second"?i/1e3:t==="minute"?i/6e4:t==="hour"?i/36e5:t==="day"?(i-o)/864e5:t==="week"?(i-o)/6048e5:i}return r?a:S(a)}function Bn(e,t){var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;if(t-n<0){o=e.clone().add(r-1,"months");i=(t-n)/(n-o)}else{o=e.clone().add(r+1,"months");i=(t-n)/(o-n)}return-(r+i)||0}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function jn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Wn(){if(!this.isValid()){return null}var e=this.clone().utc();if(e.year()<0||e.year()>9999){return ge(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}if(x(Date.prototype.toISOString)){return this.toDate().toISOString()}return ge(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function $n(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var e="moment";var t="";if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}var r="["+e+'("]';var n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var o="-MM-DD[T]HH:mm:ss.SSS";var i=t+'[")]';return this.format(r+n+o+i)}function Un(e){if(!e){e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat}var t=ge(this,e);return this.localeData().postformat(t)}function Gn(e,t){if(this.isValid()&&(M(e)&&e.isValid()||$r(e).isValid())){return _n({to:this,from:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function Yn(e){return this.from($r(),e)}function zn(e,t){if(this.isValid()&&(M(e)&&e.isValid()||$r(e).isValid())){return _n({from:this,to:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function Kn(e){return this.to($r(),e)}function qn(e){var t;if(e===undefined){return this._locale._abbr}else{t=wr(e);if(t!=null){this._locale=t}return this}}var Xn=N("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined){return this.localeData()}else{return this.locale(e)}});function Jn(){return this._locale}function Zn(e){e=Q(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(e==="week"){this.weekday(0)}if(e==="isoWeek"){this.isoWeekday(1)}if(e==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this}function Qn(e){e=Q(e);if(e===undefined||e==="millisecond"){return this}if(e==="date"){e="day"}return this.startOf(e).add(1,e==="isoWeek"?"week":e).subtract(1,"ms")}function eo(){return this._d.valueOf()-(this._offset||0)*6e4}function to(){return Math.floor(this.valueOf()/1e3)}function ro(){return new Date(this.valueOf())}function no(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function oo(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function io(){return this.isValid()?this.toISOString():null}function ao(){return b(this)}function so(){return h({},v(this))}function lo(){return v(this).overflow}function uo(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}me(0,["gg",2],0,function(){return this.weekYear()%100});me(0,["GG",2],0,function(){return this.isoWeekYear()%100});function fo(e,t){me(0,[e,e.length],0,t)}fo("gggg","weekYear");fo("ggggg","weekYear");fo("GGGG","isoWeekYear");fo("GGGGG","isoWeekYear");Z("weekYear","gg");Z("isoWeekYear","GG");re("weekYear",1);re("isoWeekYear",1);He("G",De);He("g",De);He("GG",Re,ye);He("gg",Re,ye);He("GGGG",Te,_e);He("gggg",Te,_e);He("GGGGG",Ae,Ee);He("ggggg",Ae,Ee);$e(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=O(e)});$e(["gg","GG"],function(e,t,r,o){t[o]=n.parseTwoDigitYear(e)});function co(e){return vo.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function ho(e){return vo.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function mo(){return Ot(this.year(),1,4)}function po(){var e=this.localeData()._week;return Ot(this.year(),e.dow,e.doy)}function vo(e,t,r,n,o){var i;if(e==null){return St(this,n,o).year}else{i=Ot(e,n,o);if(t>i){t=i}return go.call(this,e,t,r,n,o)}}function go(e,t,r,n,o){var i=Mt(e,t,r,n,o),a=Et(i.year,0,i.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}me("Q",0,"Qo","quarter");Z("quarter","Q");re("quarter",7);He("Q",be);We("Q",function(e,t){t[Ye]=(O(e)-1)*3});function wo(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}me("D",["DD",2],"Do","date");Z("date","D");re("date",9);He("D",Re);He("DD",Re,ye);He("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});We(["D","DD"],ze);We("Do",function(e,t){t[ze]=O(e.match(Re)[0],10)});var bo=oe("Date",true);me("DDD",["DDDD",3],"DDDo","dayOfYear");Z("dayOfYear","DDD");re("dayOfYear",4);He("DDD",Oe);He("DDDD",Ce);We(["DDD","DDDD"],function(e,t,r){r._dayOfYear=O(e)});function yo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}me("m",["mm",2],0,"minute");Z("minute","m");re("minute",14);He("m",Re);He("mm",Re,ye);We(["m","mm"],qe);var Co=oe("Minutes",false);me("s",["ss",2],0,"second");Z("second","s");re("second",15);He("s",Re);He("ss",Re,ye);We(["s","ss"],Xe);var _o=oe("Seconds",false);me("S",0,0,function(){return~~(this.millisecond()/100)});me(0,["SS",2],0,function(){return~~(this.millisecond()/10)});me(0,["SSS",3],0,"millisecond");me(0,["SSSS",4],0,function(){return this.millisecond()*10});me(0,["SSSSS",5],0,function(){return this.millisecond()*100});me(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});me(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});me(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});me(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Z("millisecond","ms");re("millisecond",16);He("S",Oe,be);He("SS",Oe,ye);He("SSS",Oe,Ce);var Eo;for(Eo="SSSS";Eo.length<=9;Eo+="S"){He(Eo,Ne)}function Ro(e,t){t[Je]=O(("0."+e)*1e3)}for(Eo="S";Eo.length<=9;Eo+="S"){We(Eo,Ro)}var Mo=oe("Milliseconds",false);me("z",0,0,"zoneAbbr");me("zz",0,0,"zoneName");function So(){return this._isUTC?"UTC":""}function Oo(){return this._isUTC?"Coordinated Universal Time":""}var To=R.prototype;To.add=Tn;To.calendar=Dn;To.clone=kn;To.diff=Fn;To.endOf=Qn;To.format=Un;To.from=Gn;To.fromNow=Yn;To.to=zn;To.toNow=Kn;To.get=se;To.invalidAt=lo;To.isAfter=xn;To.isBefore=In;To.isBetween=Pn;To.isSame=Ln;To.isSameOrAfter=Hn;To.isSameOrBefore=Vn;To.isValid=ao;To.lang=Xn;To.locale=qn;To.localeData=Jn;To.max=Gr;To.min=Ur;To.parsingFlags=so;To.set=le;To.startOf=Zn;To.subtract=An;To.toArray=no;To.toObject=oo;To.toDate=ro;To.toISOString=Wn;To.inspect=$n;To.toJSON=io;To.toString=jn;To.unix=to;To.valueOf=eo;To.creationData=uo;To.year=yt;To.isLeapYear=Ct;To.weekYear=co;To.isoWeekYear=ho;To.quarter=To.quarters=wo;To.month=ft;To.daysInMonth=ct;To.week=To.weeks=kt;To.isoWeek=To.isoWeeks=xt;To.weeksInYear=po;To.isoWeeksInYear=mo;To.date=bo;To.day=To.days=Ut;To.weekday=Gt;To.isoWeekday=Yt;To.dayOfYear=yo;To.hour=To.hours=sr;To.minute=To.minutes=Co;To.second=To.seconds=_o;To.millisecond=To.milliseconds=Mo;To.utcOffset=un;To.utc=fn;To.local=cn;To.parseZone=hn;To.hasAlignedHourOffset=mn;To.isDST=pn;To.isLocal=gn;To.isUtcOffset=wn;To.isUtc=bn;To.isUTC=bn;To.zoneAbbr=So;To.zoneName=Oo;To.dates=N("dates accessor is deprecated. Use date instead.",bo);To.months=N("months accessor is deprecated. Use month instead",ft);To.years=N("years accessor is deprecated. Use year instead",yt);To.zone=N("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",dn);To.isDSTShifted=N("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",vn);function Ao(e){return $r(e*1e3)}function No(){return $r.apply(null,arguments).parseZone()}function Do(e){return e}var ko=L.prototype;ko.calendar=B;ko.longDateFormat=W;ko.invalidDate=U;ko.ordinal=z;ko.preparse=Do;ko.postformat=Do;ko.relativeTime=q;ko.pastFuture=X;ko.set=I;ko.months=it;ko.monthsShort=st;ko.monthsParse=ut;ko.monthsRegex=vt;ko.monthsShortRegex=mt;ko.week=Tt;ko.firstDayOfYear=Dt;ko.firstDayOfWeek=Nt;ko.weekdays=Ht;ko.weekdaysMin=jt;ko.weekdaysShort=Ft;ko.weekdaysParse=$t;ko.weekdaysRegex=Kt;ko.weekdaysShortRegex=Xt;ko.weekdaysMinRegex=Zt;ko.isPM=or;ko.meridiem=ar;function xo(e,t,r,n){var o=wr();var i=m().set(n,t);return o[r](i,e)}function Io(e,t,r){if(u(e)){t=e;e=undefined}e=e||"";if(t!=null){return xo(e,t,r,"month")}var n;var o=[];for(n=0;n<12;n++){o[n]=xo(e,n,r,"month")}return o}function Po(e,t,r,n){if(typeof e==="boolean"){if(u(t)){r=t;t=undefined}t=t||""}else{t=e;r=t;e=false;if(u(t)){r=t;t=undefined}t=t||""}var o=wr(),i=e?o._week.dow:0;if(r!=null){return xo(t,(r+i)%7,n,"day")}var a;var s=[];for(a=0;a<7;a++){s[a]=xo(t,(a+i)%7,n,"day")}return s}function Lo(e,t){return Io(e,t,"months")}function Ho(e,t){return Io(e,t,"monthsShort")}function Vo(e,t,r){return Po(e,t,r,"weekdays")}function Fo(e,t,r){return Po(e,t,r,"weekdaysShort")}function Bo(e,t,r){return Po(e,t,r,"weekdaysMin")}pr("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function Di(e){var t=e%10,r=O(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});n.lang=N("moment.lang is deprecated. Use moment.locale instead.",pr);n.langData=N("moment.langData is deprecated. Use moment.localeData instead.",wr);var jo=Math.abs;function Wo(){var e=this._data;this._milliseconds=jo(this._milliseconds);this._days=jo(this._days);this._months=jo(this._months);e.milliseconds=jo(e.milliseconds);e.seconds=jo(e.seconds);e.minutes=jo(e.minutes);e.hours=jo(e.hours);e.months=jo(e.months);e.years=jo(e.years);return this}function $o(e,t,r,n){var o=_n(t,r);e._milliseconds+=n*o._milliseconds;e._days+=n*o._days;e._months+=n*o._months;return e._bubble()}function Uo(e,t){return $o(this,e,t,1)}function Go(e,t){return $o(this,e,t,-1)}function Yo(e){if(e<0){return Math.floor(e)}else{return Math.ceil(e)}}function zo(){var e=this._milliseconds;var t=this._days;var r=this._months;var n=this._data;var o,i,a,s,l;if(!(e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0)){e+=Yo(qo(r)+t)*864e5;t=0;r=0}n.milliseconds=e%1e3;o=S(e/1e3);n.seconds=o%60;i=S(o/60);n.minutes=i%60;a=S(i/60);n.hours=a%24;t+=S(a/24);l=S(Ko(t));r+=l;t-=Yo(qo(l));s=S(r/12);r%=12;n.days=t;n.months=r;n.years=s;return this}function Ko(e){return e*4800/146097}function qo(e){return e*146097/4800}function Xo(e){if(!this.isValid()){return NaN}var t;var r;var n=this._milliseconds;e=Q(e);if(e==="month"||e==="year"){t=this._days+n/864e5;r=this._months+Ko(t);return e==="month"?r:r/12}else{t=this._days+Math.round(qo(this._months));switch(e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}}function Jo(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+O(this._months/12)*31536e6}function Zo(e){return function(){return this.as(e)}}var Qo=Zo("ms");var ei=Zo("s");var ti=Zo("m");var ri=Zo("h");var ni=Zo("d");var oi=Zo("w");var ii=Zo("M");var ai=Zo("y");function si(e){e=Q(e);return this.isValid()?this[e+"s"]():NaN}function li(e){return function(){return this.isValid()?this._data[e]:NaN}}var ui=li("milliseconds");var di=li("seconds");var fi=li("minutes");var ci=li("hours");var hi=li("days");var mi=li("months");var pi=li("years");function vi(){return S(this.days()/7)}var gi=Math.round;var wi={ss:44,s:45,m:45,h:22,d:26,M:11};function bi(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function yi(e,t,r){var n=_n(e).abs();var o=gi(n.as("s"));var i=gi(n.as("m"));var a=gi(n.as("h"));var s=gi(n.as("d"));var l=gi(n.as("M"));var u=gi(n.as("y"));var d=o<=wi.ss&&["s",o]||o<wi.s&&["ss",o]||i<=1&&["m"]||i<wi.m&&["mm",i]||a<=1&&["h"]||a<wi.h&&["hh",a]||s<=1&&["d"]||s<wi.d&&["dd",s]||l<=1&&["M"]||l<wi.M&&["MM",l]||u<=1&&["y"]||["yy",u];d[2]=t;d[3]=+e>0;d[4]=r;return bi.apply(null,d)}function Ci(e){if(e===undefined){return gi}if(typeof e==="function"){gi=e;return true}return false}function _i(e,t){if(wi[e]===undefined){return false}if(t===undefined){return wi[e]}wi[e]=t;if(e==="s"){wi.ss=t-1}return true}function Ei(e){if(!this.isValid()){return this.localeData().invalidDate()}var t=this.localeData();var r=yi(this,!e,t);if(e){r=t.pastFuture(+this,r)}return t.postformat(r)}var Ri=Math.abs;function Mi(){if(!this.isValid()){return this.localeData().invalidDate()}var e=Ri(this._milliseconds)/1e3;var t=Ri(this._days);var r=Ri(this._months);var n,o,i;n=S(e/60);o=S(n/60);e%=60;n%=60;i=S(r/12);r%=12;var a=i;var s=r;var l=t;var u=o;var d=n;var f=e;var c=this.asSeconds();if(!c){return"P0D"}return(c<0?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(l?l+"D":"")+(u||d||f?"T":"")+(u?u+"H":"")+(d?d+"M":"")+(f?f+"S":"")}var Si=en.prototype;Si.isValid=Zr;Si.abs=Wo;Si.add=Uo;Si.subtract=Go;Si.as=Xo;Si.asMilliseconds=Qo;Si.asSeconds=ei;Si.asMinutes=ti;Si.asHours=ri;Si.asDays=ni;Si.asWeeks=oi;Si.asMonths=ii;Si.asYears=ai;Si.valueOf=Jo;Si._bubble=zo;Si.get=si;Si.milliseconds=ui;Si.seconds=di;Si.minutes=fi;Si.hours=ci;Si.days=hi;Si.weeks=vi;Si.months=mi;Si.years=pi;Si.humanize=Ei;Si.toISOString=Mi;Si.toString=Mi;Si.toJSON=Mi;Si.locale=qn;Si.localeData=Jn;Si.toIsoString=N("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mi);Si.lang=Xn;me("X",0,0,"unix");me("x",0,0,"valueOf");He("x",De);He("X",Ie);We("X",function(e,t,r){r._d=new Date(parseFloat(e,10)*1e3)});We("x",function(e,t,r){r._d=new Date(O(e))});n.version="2.18.1";o($r);n.fn=To;n.min=zr;n.max=Kr;n.now=qr;n.utc=m;n.unix=Ao;n.months=Lo;n.isDate=d;n.locale=pr;n.invalid=y;n.duration=_n;n.isMoment=M;n.weekdays=Vo;n.parseZone=No;n.localeData=wr;n.isDuration=tn;n.monthsShort=Ho;n.weekdaysMin=Bo;n.defineLocale=vr;n.updateLocale=gr;n.locales=br;n.weekdaysShort=Fo;n.normalizeUnits=Q;n.relativeTimeRounding=Ci;n.relativeTimeThreshold=_i;n.calendarFormat=Nn;n.prototype=To;return n})},{}],numbro:[function(e,t,r){/*!
 * numbro.js
 * version : 1.10.1
 * author : Fretagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";var r,n="1.10.1",o=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:i,marker:"bd"},binary:{scale:1024,suffixes:o,marker:"b"},decimal:{scale:1e3,suffixes:i,marker:"d"}},s=[a.general,a.binary,a.decimal],l={},u=l,d="en-US",f=null,c="0,0",h="0$",m=typeof t!=="undefined"&&t.exports,p={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function P(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};function v(e){this._value=e}function g(e){if(e===0){return 1}return Math.floor(Math.log(Math.abs(e))/Math.LN10)+1}function w(e){var t,r="";for(t=0;t<e;t++){r+="0"}return r}function b(e,t){var r,n,o,i,a,s,l,u;u=e.toString();r=u.split("e")[0];i=u.split("e")[1];n=r.split(".")[0];o=r.split(".")[1]||"";if(+i>0){u=n+o+w(i-o.length)}else{if(+n<0){a="-0"}else{a="0"}if(t>0){a+="."}l=w(-1*i-1);s=(l+Math.abs(n)+o).substr(0,t);u=a+s}if(+i>0&&t>0){u+="."+w(t)}return u}function y(e,t,r,n){var o=Math.pow(10,t),i,a;if(e.toString().indexOf("e")>-1){a=b(e,t);if(a.charAt(0)==="-"&&+a>=0){a=a.substr(1)}}else{a=(r(e+"e+"+t)/o).toFixed(t)}if(n){i=new RegExp("0{1,"+n+"}$");a=a.replace(i,"")}return a}function C(e,t,r){var n,o=t.replace(/\{[^\{\}]*\}/g,"");if(o.indexOf("$")>-1){n=E(e,l[d].currency.symbol,t,r)}else if(o.indexOf("%")>-1){n=M(e,t,r)}else if(o.indexOf(":")>-1){n=S(e,t)}else{n=A(e._value,t,r)}return n}function _(e,t){var r=t,n,a,s,u,c=false,h;if(t.indexOf(":")>-1){e._value=O(t)}else{if(t===f){e._value=0}else{if(l[d].delimiters.decimal!=="."){t=t.replace(/\./g,"").replace(l[d].delimiters.decimal,".")}n=new RegExp("[^a-zA-Z]"+l[d].abbreviations.thousand+"(?:\\)|(\\"+l[d].currency.symbol+")?(?:\\))?)?$");a=new RegExp("[^a-zA-Z]"+l[d].abbreviations.million+"(?:\\)|(\\"+l[d].currency.symbol+")?(?:\\))?)?$");s=new RegExp("[^a-zA-Z]"+l[d].abbreviations.billion+"(?:\\)|(\\"+l[d].currency.symbol+")?(?:\\))?)?$");u=new RegExp("[^a-zA-Z]"+l[d].abbreviations.trillion+"(?:\\)|(\\"+l[d].currency.symbol+")?(?:\\))?)?$");for(h=1;h<o.length&&!c;++h){if(t.indexOf(o[h])>-1){c=Math.pow(1024,h)}else if(t.indexOf(i[h])>-1){c=Math.pow(1e3,h)}}var m=t.replace(/[^0-9\.]+/g,"");if(m===""){e._value=NaN}else{e._value=(c?c:1)*(r.match(n)?Math.pow(10,3):1)*(r.match(a)?Math.pow(10,6):1)*(r.match(s)?Math.pow(10,9):1)*(r.match(u)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(m);e._value=c?Math.ceil(e._value):e._value}}}return e._value}function E(e,t,r,n){var o=r,i=o.indexOf("$"),a=o.indexOf("("),s=o.indexOf("+"),u=o.indexOf("-"),f="",c="",h,m;if(o.indexOf("$")===-1){if(l[d].currency.position==="infix"){c=t;if(l[d].currency.spaceSeparated){c=" "+c+" "}}else if(l[d].currency.spaceSeparated){f=" "}}else{if(o.indexOf(" $")>-1){f=" ";o=o.replace(" $","")}else if(o.indexOf("$ ")>-1){f=" ";o=o.replace("$ ","")}else{o=o.replace("$","")}}m=A(e._value,o,n,c);if(r.indexOf("$")===-1){switch(l[d].currency.position){case"postfix":if(m.indexOf(")")>-1){m=m.split("");m.splice(-1,0,f+t);m=m.join("")}else{m=m+f+t}break;case"infix":break;case"prefix":if(m.indexOf("(")>-1||m.indexOf("-")>-1){m=m.split("");h=Math.max(a,u)+1;m.splice(h,0,t+f);m=m.join("")}else{m=t+f+m}break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}}else{if(i<=1){if(m.indexOf("(")>-1||m.indexOf("+")>-1||m.indexOf("-")>-1){m=m.split("");h=1;if(i<a||i<s||i<u){h=0}m.splice(h,0,t+f);m=m.join("")}else{m=t+f+m}}else{if(m.indexOf(")")>-1){m=m.split("");m.splice(-1,0,f+t);m=m.join("")}else{m=m+f+t}}}return m}function R(e,t,r,n){return E(e,t,r,n)}function M(e,t,r){var n="",o,i=e._value*100;if(t.indexOf(" %")>-1){n=" ";t=t.replace(" %","")}else{t=t.replace("%","")}o=A(i,t,r);if(o.indexOf(")")>-1){o=o.split("");o.splice(-1,0,n+"%");o=o.join("")}else{o=o+n+"%"}return o}function S(e){var t=Math.floor(e._value/60/60),r=Math.floor((e._value-t*60*60)/60),n=Math.round(e._value-t*60*60-r*60);return t+":"+(r<10?"0"+r:r)+":"+(n<10?"0"+n:n)}function O(e){var t=e.split(":"),r=0;if(t.length===3){r=r+Number(t[0])*60*60;r=r+Number(t[1])*60;r=r+Number(t[2])}else if(t.length===2){r=r+Number(t[0])*60;r=r+Number(t[1])}return Number(r)}function T(e,t,r){var n=t[0],o,i,a,s=Math.abs(e);if(s>=r){for(o=1;o<t.length;++o){i=Math.pow(r,o);a=Math.pow(r,o+1);if(s>=i&&s<a){n=t[o];e=e/i;break}}if(n===t[0]){e=e/Math.pow(r,t.length-1);n=t[t.length-1]}}return{value:e,suffix:n}}function A(e,t,r,n){var o=false,i=false,a=false,u="",c=false,h=false,m=false,p=false,v=false,b="",C,_,E="",R=Math.abs(e),M,S,O,A,N,D,k,x,I,P,L="",H=false,V=false,F,B,j="",W,$;if(e===0&&f!==null){return f}if(!isFinite(e)){return""+e}if(t.indexOf("{")===0){var U=t.indexOf("}");if(U===-1){throw Error('Format should also contain a "}"')}x=t.slice(1,U);t=t.slice(U+1)}else{x=""}if(t.indexOf("}")===t.length-1&&t.length){var G=t.indexOf("{");if(G===-1){throw Error('Format should also contain a "{"')}I=t.slice(G+1,-1);t=t.slice(0,G+1)}else{I=""}var Y;if(t.indexOf(".")===-1){Y=t.match(/([0-9]+).*/)}else{Y=t.match(/([0-9]+)\..*/)}W=Y===null?-1:Y[1].length;if(t.indexOf("-")!==-1){H=true}if(t.indexOf("(")>-1){o=true;t=t.slice(1,-1)}else if(t.indexOf("+")>-1){i=true;t=t.replace(/\+/g,"")}if(t.indexOf("a")>-1){D=t.split(".")[0].match(/[0-9]+/g)||["0"];D=parseInt(D[0],10);c=t.indexOf("aK")>=0;h=t.indexOf("aM")>=0;m=t.indexOf("aB")>=0;p=t.indexOf("aT")>=0;v=c||h||m||p;if(t.indexOf(" a")>-1){u=" ";t=t.replace(" a","")}else{t=t.replace("a","")}M=g(e);O=M%3;O=O===0?3:O;if(D&&R!==0){A=3*~~((Math.min(D,M)-O)/3);R=R/Math.pow(10,A)}if(M!==D){if(R>=Math.pow(10,12)&&!v||p){u=u+l[d].abbreviations.trillion;e=e/Math.pow(10,12)}else if(R<Math.pow(10,12)&&R>=Math.pow(10,9)&&!v||m){u=u+l[d].abbreviations.billion;e=e/Math.pow(10,9)}else if(R<Math.pow(10,9)&&R>=Math.pow(10,6)&&!v||h){u=u+l[d].abbreviations.million;e=e/Math.pow(10,6)}else if(R<Math.pow(10,6)&&R>=Math.pow(10,3)&&!v||c){u=u+l[d].abbreviations.thousand;e=e/Math.pow(10,3)}}S=g(e);if(D&&S<D&&t.indexOf(".")===-1){t+="[.]";t+=w(D-S)}}for($=0;$<s.length;++$){C=s[$];if(t.indexOf(C.marker)>-1){if(t.indexOf(" "+C.marker)>-1){b=" "}t=t.replace(b+C.marker,"");_=T(e,C.suffixes,C.scale);e=_.value;b=b+_.suffix;break}}if(t.indexOf("o")>-1){if(t.indexOf(" o")>-1){E=" ";t=t.replace(" o","")}else{t=t.replace("o","")}if(l[d].ordinal){E=E+l[d].ordinal(e)}}if(t.indexOf("[.]")>-1){a=true;t=t.replace("[.]",".")}k=t.split(".")[1];P=t.indexOf(",");if(k){var z=[];if(k.indexOf("*")!==-1){L=e.toString();z=L.split(".");if(z.length>1){L=y(e,z[1].length,r)}}else{if(k.indexOf("[")>-1){k=k.replace("]","");k=k.split("[");L=y(e,k[0].length+k[1].length,r,k[1].length)}else{L=y(e,k.length,r)}}z=L.split(".");N=z[0];if(z.length>1&&z[1].length){var K=n?u+n:l[d].delimiters.decimal;L=K+z[1]}else{L=""}if(a&&Number(L.slice(1))===0){L=""}}else{N=y(e,0,r)}if(N.indexOf("-")>-1){N=N.slice(1);V=true}if(N.length<W){N=w(W-N.length)+N}if(P>-1){N=N.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+l[d].delimiters.thousands)}if(t.indexOf(".")===0){N=""}F=t.indexOf("(");B=t.indexOf("-");if(F<B){j=(o&&V?"(":"")+(H&&V||!o&&V?"-":"")}else{j=(H&&V||!o&&V?"-":"")+(o&&V?"(":"")}return x+j+(!V&&i&&e!==0?"+":"")+N+L+(E?E:"")+(u&&!n?u:"")+(b?b:"")+(o&&V?")":"")+I}r=function L(e){if(r.isNumbro(e)){e=e.value()}else if(typeof e==="string"||typeof e==="number"){e=r.fn.unformat(e)}else{e=NaN}return new v(Number(e))};r.version=n;r.isNumbro=function(e){return e instanceof v};r.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var r=e,n=e.split("-")[0],o=null;if(!u[r]){Object.keys(u).forEach(function(e){if(!o&&e.split("-")[0]===n){o=e}});r=o||t||"en-US"}D(r)};r.setCulture=function(e,t){var r=e,n=e.split("-")[1],o=null;if(!l[r]){if(n){Object.keys(l).forEach(function(e){if(!o&&e.split("-")[1]===n){o=e}})}r=o||t||"en-US"}D(r)};r.language=function(e,t){console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead");if(!e){return d}if(e&&!t){if(!u[e]){throw new Error("Unknown language : "+e)}D(e)}if(t||!u[e]){N(e,t)}return r};r.culture=function(e,t){if(!e){return d}if(e&&!t){if(!l[e]){throw new Error("Unknown culture : "+e)}D(e)}if(t||!l[e]){N(e,t)}return r};r.languageData=function(e){console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead");if(!e){return u[d]}if(!u[e]){throw new Error("Unknown language : "+e)}return u[e]};r.cultureData=function(e){if(!e){return l[d]}if(!l[e]){throw new Error("Unknown culture : "+e)}return l[e]};r.culture("en-US",p);r.languages=function(){console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead");return u};r.cultures=function(){return l};r.zeroFormat=function(e){f=typeof e==="string"?e:null};r.defaultFormat=function(e){c=typeof e==="string"?e:"0.0"};r.defaultCurrencyFormat=function(e){h=typeof e==="string"?e:"0$"};r.validate=function(e,t){var n,o,i,a,s,l,u,d;if(typeof e!=="string"){e+="";if(console.warn){console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)}}e=e.trim();e=e.replace(/^[+-]?/,"");if(!!e.match(/^\d+$/)){return true}if(e===""){return false}try{u=r.cultureData(t)}catch(f){u=r.cultureData(r.culture())}i=u.currency.symbol;s=u.abbreviations;n=u.delimiters.decimal;if(u.delimiters.thousands==="."){o="\\."}else{o=u.delimiters.thousands}d=e.match(/^[^\d\.\,]+/);if(d!==null){e=e.substr(1);if(d[0]!==i){return false}}d=e.match(/[^\d]+$/);if(d!==null){e=e.slice(0,-1);if(d[0]!==s.thousand&&d[0]!==s.million&&d[0]!==s.billion&&d[0]!==s.trillion){return false}}l=new RegExp(o+"{2}");if(!e.match(/[^\d.,]/g)){a=e.split(n);if(a.length>2){return false}else{if(a.length<2){return!!a[0].match(/^\d+.*\d$/)&&!a[0].match(l)}else{if(a[0]===""){return!a[0].match(l)&&!!a[1].match(/^\d+$/)}else if(a[0].length===1){return!!a[0].match(/^\d+$/)&&!a[0].match(l)&&!!a[1].match(/^\d+$/)}else{return!!a[0].match(/^\d+.*\d$/)&&!a[0].match(l)&&!!a[1].match(/^\d+$/)}}}}return false};r.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead");r.loadCulturesInNode()};r.loadCulturesInNode=function(){var t=e("./languages");for(var n in t){if(n){r.culture(n,t[n])}}};function N(e,t){l[e]=t}function D(e){d=e;var t=l[e].defaults;if(t&&t.format){r.defaultFormat(t.format)}if(t&&t.currencyFormat){r.defaultCurrencyFormat(t.currencyFormat)}}function k(){return typeof process!=="undefined"&&process.browser===undefined&&process.title&&(process.title.indexOf("node")!==-1||process.title.indexOf("meteor-tool")>0||process.title==="grunt"||process.title==="gulp")&&typeof e!=="undefined"}if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(e,t){if(null===this||"undefined"===typeof this){throw new TypeError("Array.prototype.reduce called on null or undefined")}if("function"!==typeof e){throw new TypeError(e+" is not a function")}var r,n,o=this.length>>>0,i=false;if(1<arguments.length){n=t;i=true}for(r=0;o>r;++r){if(this.hasOwnProperty(r)){if(i){n=e(n,this[r],r,this)}else{n=this[r];i=true}}}if(!i){throw new TypeError("Reduce of empty array with no initial value")}return n}}function x(e){var t=e.toString().split(".");if(t.length<2){return 1}return Math.pow(10,t[1].length)}function I(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var r=x(e),n=x(t);return r>n?r:n},-Infinity)}r.fn=v.prototype={clone:function H(){return r(this)},format:function V(e,t){return C(this,e?e:c,t!==undefined?t:Math.round)},formatCurrency:function F(e,t){return E(this,l[d].currency.symbol,e?e:h,t!==undefined?t:Math.round)},formatForeignCurrency:function B(e,t,r){return R(this,e,t?t:h,r!==undefined?r:Math.round)},unformat:function j(e){if(typeof e==="number"){return e}else if(typeof e==="string"){var t=_(this,e);return isNaN(t)?undefined:t}else{return undefined}},binaryByteUnits:function W(){return T(this._value,a.binary.suffixes,a.binary.scale).suffix},byteUnits:function $(){return T(this._value,a.general.suffixes,a.general.scale).suffix},decimalByteUnits:function U(){return T(this._value,a.decimal.suffixes,a.decimal.scale).suffix},value:function G(){return this._value},valueOf:function Y(){return this._value},set:function z(e){this._value=Number(e);return this},add:function K(e){var t=I.call(null,this._value,e);function r(e,r){return e+t*r}this._value=[this._value,e].reduce(r,0)/t;return this},subtract:function q(e){var t=I.call(null,this._value,e);function r(e,r){return e-t*r}this._value=[e].reduce(r,this._value*t)/t;return this},multiply:function X(e){function t(e,t){var r=I(e,t),n=e*r;n*=t*r;n/=r*r;return n}this._value=[this._value,e].reduce(t,1);return this},divide:function J(e){function t(e,t){var r=I(e,t);return e*r/(t*r)}this._value=[this._value,e].reduce(t);return this},difference:function Z(e){return Math.abs(r(this._value).subtract(e).value())}};if(k()){r.loadCulturesInNode()}if(m){t.exports=r}else{if(typeof ender==="undefined"){this.numbro=r}if(typeof define==="function"&&define.amd){define([],function(){return r})}}}).call(typeof window==="undefined"?this:window)},{languages:1}],pikaday:[function(e,t,r){/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
(function(n,o){"use strict";var i;if((typeof r==="undefined"?"undefined":_typeof(r))==="object"){try{i=e("moment")}catch(a){}t.exports=o(i)}else if(typeof define==="function"&&define.amd){define(function(e){var t="moment";try{i=e(t)}catch(r){}return o(i)})}else{n.Pikaday=o(n.moment)}})(this,function(e){"use strict";var t=typeof e==="function",r=!!window.addEventListener,n=window.document,o=window.setTimeout,i=function D(e,t,n,o){if(r){e.addEventListener(t,n,!!o)}else{e.attachEvent("on"+t,n)}},a=function k(e,t,n,o){if(r){e.removeEventListener(t,n,!!o)}else{e.detachEvent("on"+t,n)}},s=function x(e,t,r){var o;if(n.createEvent){o=n.createEvent("HTMLEvents");o.initEvent(t,true,false);o=b(o,r);e.dispatchEvent(o)}else if(n.createEventObject){o=n.createEventObject();o=b(o,r);e.fireEvent("on"+t,o)}},l=function I(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},u=function P(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},d=function L(e,t){if(!u(e,t)){e.className=e.className===""?t:e.className+" "+t}},f=function H(e,t){e.className=l((" "+e.className+" ").replace(" "+t+" "," "))},c=function V(e){return/Array/.test(Object.prototype.toString.call(e))},h=function F(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},m=function B(e){var t=e.getDay();return t===0||t===6},p=function j(e){return e%4===0&&e%100!==0||e%400===0},v=function W(e,t){return[31,p(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},g=function $(e){if(h(e))e.setHours(0,0,0,0)},w=function U(e,t){return e.getTime()===t.getTime()},b=function G(e,t,r){var n,o;for(n in t){o=e[n]!==undefined;if(o&&_typeof(t[n])==="object"&&t[n]!==null&&t[n].nodeName===undefined){if(h(t[n])){if(r){e[n]=new Date(t[n].getTime())}}else if(c(t[n])){if(r){e[n]=t[n].slice(0)}}else{e[n]=G({},t[n],r)}}else if(r||!o){e[n]=t[n]}}return e},y=function Y(e){if(e.month<0){e.year-=Math.ceil(Math.abs(e.month)/12);e.month+=12}if(e.month>11){e.year+=Math.floor(Math.abs(e.month)/12);e.month-=12}return e},C={field:null,bound:undefined,position:"bottom left",reposition:true,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:false,firstDay:0,formatStrict:false,minDate:null,maxDate:null,yearRange:10,showWeekNumber:false,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:false,yearSuffix:"",showMonthAfterYear:false,showDaysInNextAndPreviousMonths:false,numberOfMonths:1,mainCalendar:"left",container:undefined,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},_=function z(e,t,r){t+=e.firstDay;while(t>=7){t-=7}return r?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},E=function K(e){var t=[];var r="false";if(e.isEmpty){if(e.showDaysInNextAndPreviousMonths){t.push("is-outside-current-month")}else{return'<td class="is-empty"></td>'}}if(e.isDisabled){t.push("is-disabled")}if(e.isToday){t.push("is-today")}if(e.isSelected){t.push("is-selected");r="true"}if(e.isInRange){t.push("is-inrange")}if(e.isStartRange){t.push("is-startrange")}if(e.isEndRange){t.push("is-endrange")}return'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'">'+'<button class="pika-button pika-day" type="button" '+'data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button>"+"</td>"},R=function q(e,t,r){var n=new Date(r,0,1),o=Math.ceil(((new Date(r,t,e)-n)/864e5+n.getDay()+1)/7);return'<td class="pika-week">'+o+"</td>"},M=function X(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},S=function J(e){return"<tbody>"+e.join("")+"</tbody>"},O=function Z(e){var t,r=[];if(e.showWeekNumber){r.push("<th></th>")}for(t=0;t<7;t++){r.push('<th scope="col"><abbr title="'+_(e,t)+'">'+_(e,t,true)+"</abbr></th>")}return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"},T=function Q(e,t,r,n,o,i){var a,s,l,u=e._o,d=r===u.minYear,f=r===u.maxYear,h='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',m,p,v=true,g=true;for(l=[],a=0;a<12;a++){l.push('<option value="'+(r===o?a-t:12+a-t)+'"'+(a===n?' selected="selected"':"")+(d&&a<u.minMonth||f&&a>u.maxMonth?'disabled="disabled"':"")+">"+u.i18n.months[a]+"</option>")}m='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>";if(c(u.yearRange)){a=u.yearRange[0];s=u.yearRange[1]+1}else{a=r-u.yearRange;s=1+r+u.yearRange}for(l=[];a<s&&a<=u.maxYear;a++){if(a>=u.minYear){l.push('<option value="'+a+'"'+(a===r?' selected="selected"':"")+">"+a+"</option>")}}p='<div class="pika-label">'+r+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>";if(u.showMonthAfterYear){h+=p+m}else{h+=m+p}if(d&&(n===0||u.minMonth>=n)){v=false}if(f&&(n===11||u.maxMonth<=n)){g=false}if(t===0){h+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"}if(t===e._o.numberOfMonths-1){h+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"}return h+="</div>"},A=function ee(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+O(e)+S(t)+"</table>"},N=function te(a){var s=this,l=s.config(a);s._onMouseDown=function(e){if(!s._v){return}e=e||window.event;var t=e.target||e.srcElement;if(!t){return}if(!u(t,"is-disabled")){if(u(t,"pika-button")&&!u(t,"is-empty")&&!u(t.parentNode,"is-disabled")){s.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day")));if(l.bound){o(function(){s.hide();if(l.field){l.field.blur()}},100)}}else if(u(t,"pika-prev")){s.prevMonth()}else if(u(t,"pika-next")){s.nextMonth()}}if(!u(t,"pika-select")){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false;return false}}else{s._c=true}};s._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;if(!t){return}if(u(t,"pika-select-month")){s.gotoMonth(t.value)}else if(u(t,"pika-select-year")){s.gotoYear(t.value)}};s._onKeyChange=function(e){e=e||window.event;if(s.isVisible()){switch(e.keyCode){case 13:case 27:l.field.blur();break;case 37:e.preventDefault();s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7);break}}};s._onInputChange=function(r){var n;if(r.firedBy===s){return}if(t){n=e(l.field.value,l.format,l.formatStrict);n=n&&n.isValid()?n.toDate():null}else{n=new Date(Date.parse(l.field.value))}if(h(n)){s.setDate(n)}if(!s._v){s.show()}};s._onInputFocus=function(){s.show()};s._onInputClick=function(){s.show()};s._onInputBlur=function(){var e=n.activeElement;do{if(u(e,"pika-single")){return}}while(e=e.parentNode);if(!s._c){s._b=o(function(){s.hide()},50)}s._c=false};s._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,n=t;if(!t){return}if(!r&&u(t,"pika-select")){if(!t.onchange){t.setAttribute("onchange","return;");i(t,"change",s._onChange)}}do{if(u(n,"pika-single")||n===l.trigger){return}}while(n=n.parentNode);if(s._v&&t!==l.trigger&&n!==l.trigger){s.hide()}};s.el=n.createElement("div");s.el.className="pika-single"+(l.isRTL?" is-rtl":"")+(l.theme?" "+l.theme:"");i(s.el,"mousedown",s._onMouseDown,true);i(s.el,"touchend",s._onMouseDown,true);i(s.el,"change",s._onChange);i(n,"keydown",s._onKeyChange);if(l.field){if(l.container){l.container.appendChild(s.el)}else if(l.bound){n.body.appendChild(s.el)}else{l.field.parentNode.insertBefore(s.el,l.field.nextSibling)}i(l.field,"change",s._onInputChange);if(!l.defaultDate){if(t&&l.field.value){l.defaultDate=e(l.field.value,l.format).toDate()}else{l.defaultDate=new Date(Date.parse(l.field.value))}l.setDefaultDate=true}}var d=l.defaultDate;if(h(d)){if(l.setDefaultDate){s.setDate(d,true)}else{s.gotoDate(d)}}else{s.gotoDate(new Date)}if(l.bound){this.hide();s.el.className+=" is-bound";i(l.trigger,"click",s._onInputClick);i(l.trigger,"focus",s._onInputFocus);i(l.trigger,"blur",s._onInputBlur)}else{this.show()}};N.prototype={config:function re(e){if(!this._o){this._o=b({},C,true)}var t=b(this._o,e,true);t.isRTL=!!t.isRTL;t.field=t.field&&t.field.nodeName?t.field:null;t.theme=typeof t.theme==="string"&&t.theme?t.theme:null;t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field);t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field;t.disableWeekends=!!t.disableWeekends;t.disableDayFn=typeof t.disableDayFn==="function"?t.disableDayFn:null;var r=parseInt(t.numberOfMonths,10)||1;t.numberOfMonths=r>4?4:r;if(!h(t.minDate)){t.minDate=false}if(!h(t.maxDate)){t.maxDate=false}if(t.minDate&&t.maxDate&&t.maxDate<t.minDate){t.maxDate=t.minDate=false}if(t.minDate){this.setMinDate(t.minDate)}if(t.maxDate){this.setMaxDate(t.maxDate)}if(c(t.yearRange)){var n=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||n;t.yearRange[1]=parseInt(t.yearRange[1],10)||n}else{t.yearRange=Math.abs(parseInt(t.yearRange,10))||C.yearRange;if(t.yearRange>100){t.yearRange=100}}return t},toString:function ne(r){return!h(this._d)?"":t?e(this._d).format(r||this._o.format):this._d.toDateString()},getMoment:function oe(){return t?e(this._d):null},setMoment:function ie(r,n){if(t&&e.isMoment(r)){this.setDate(r.toDate(),n)}},getDate:function ae(){return h(this._d)?new Date(this._d.getTime()):new Date},setDate:function se(e,t){if(!e){this._d=null;if(this._o.field){this._o.field.value="";s(this._o.field,"change",{firedBy:this})}return this.draw()}if(typeof e==="string"){e=new Date(Date.parse(e))}if(!h(e)){return}var r=this._o.minDate,n=this._o.maxDate;if(h(r)&&e<r){e=r}else if(h(n)&&e>n){e=n}this._d=new Date(e.getTime());g(this._d);this.gotoDate(this._d);if(this._o.field){this._o.field.value=this.toString();s(this._o.field,"change",{firedBy:this})}if(!t&&typeof this._o.onSelect==="function"){this._o.onSelect.call(this,this.getDate())}},gotoDate:function le(e){var t=true;if(!h(e)){return}if(this.calendars){var r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();n.setMonth(n.getMonth()+1);n.setDate(n.getDate()-1);t=o<r.getTime()||n.getTime()<o}if(t){this.calendars=[{month:e.getMonth(),year:e.getFullYear()}];if(this._o.mainCalendar==="right"){this.calendars[0].month+=1-this._o.numberOfMonths}}this.adjustCalendars()},adjustDate:function ue(r,n){var o=this.getDate();var i=parseInt(n)*24*60*60*1e3;var a;if(r==="add"){a=new Date(o.valueOf()+i)}else if(r==="subtract"){a=new Date(o.valueOf()-i)}if(t){if(r==="add"){a=e(o).add(n,"days").toDate()}else if(r==="subtract"){a=e(o).subtract(n,"days").toDate()}}this.setDate(a)},adjustCalendars:function de(){this.calendars[0]=y(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++){this.calendars[e]=y({month:this.calendars[0].month+e,year:this.calendars[0].year})}this.draw()},gotoToday:function fe(){this.gotoDate(new Date)},gotoMonth:function ce(e){if(!isNaN(e)){this.calendars[0].month=parseInt(e,10);this.adjustCalendars()}},nextMonth:function he(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function me(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function pe(e){if(!isNaN(e)){this.calendars[0].year=parseInt(e,10);this.adjustCalendars()}},setMinDate:function ve(e){if(e instanceof Date){g(e);this._o.minDate=e;this._o.minYear=e.getFullYear();this._o.minMonth=e.getMonth()}else{this._o.minDate=C.minDate;this._o.minYear=C.minYear;this._o.minMonth=C.minMonth;this._o.startRange=C.startRange}this.draw()},setMaxDate:function ge(e){if(e instanceof Date){g(e);this._o.maxDate=e;this._o.maxYear=e.getFullYear();this._o.maxMonth=e.getMonth()}else{this._o.maxDate=C.maxDate;this._o.maxYear=C.maxYear;this._o.maxMonth=C.maxMonth;this._o.endRange=C.endRange}this.draw()},setStartRange:function we(e){this._o.startRange=e},setEndRange:function be(e){this._o.endRange=e},draw:function ye(e){if(!this._v&&!e){return}var t=this._o,r=t.minYear,n=t.maxYear,i=t.minMonth,a=t.maxMonth,s="",l;if(this._y<=r){this._y=r;if(!isNaN(i)&&this._m<i){this._m=i}}if(this._y>=n){this._y=n;if(!isNaN(a)&&this._m>a){this._m=a}}l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<t.numberOfMonths;u++){s+='<div class="pika-lendar">'+T(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,l)+this.render(this.calendars[u].year,this.calendars[u].month,l)+"</div>"}this.el.innerHTML=s;if(t.bound){if(t.field.type!=="hidden"){o(function(){t.trigger.focus()},1)}}if(typeof this._o.onDraw==="function"){this._o.onDraw(this)}if(t.bound){t.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function Ce(){var e,t,r,o,i,a,s,l,u,d;if(this._o.container)return;this.el.style.position="absolute";e=this._o.trigger;t=e;r=this.el.offsetWidth;o=this.el.offsetHeight;i=window.innerWidth||n.documentElement.clientWidth;a=window.innerHeight||n.documentElement.clientHeight;s=window.pageYOffset||n.body.scrollTop||n.documentElement.scrollTop;if(typeof e.getBoundingClientRect==="function"){d=e.getBoundingClientRect();l=d.left+window.pageXOffset;u=d.bottom+window.pageYOffset}else{l=t.offsetLeft;u=t.offsetTop+t.offsetHeight;while(t=t.offsetParent){l+=t.offsetLeft;u+=t.offsetTop}}if(this._o.reposition&&l+r>i||this._o.position.indexOf("right")>-1&&l-r+e.offsetWidth>0){l=l-r+e.offsetWidth}if(this._o.reposition&&u+o>a+s||this._o.position.indexOf("top")>-1&&u-o-e.offsetHeight>0){u=u-o-e.offsetHeight}this.el.style.left=l+"px";this.el.style.top=u+"px"},render:function _e(e,t,r){var n=this._o,o=new Date,i=v(e,t),a=new Date(e,t,1).getDay(),s=[],l=[];g(o);if(n.firstDay>0){a-=n.firstDay;if(a<0){a+=7}}var u=t===0?11:t-1,d=t===11?0:t+1,f=t===0?e-1:e,c=t===11?e+1:e,p=v(f,u);var b=i+a,y=b;while(y>7){y-=7}b+=7-y;for(var C=0,_=0;C<b;C++){var S=new Date(e,t,1+(C-a)),O=h(this._d)?w(S,this._d):false,T=w(S,o),N=C<a||C>=i+a,D=1+(C-a),k=t,x=e,I=n.startRange&&w(n.startRange,S),P=n.endRange&&w(n.endRange,S),L=n.startRange&&n.endRange&&n.startRange<S&&S<n.endRange,H=n.minDate&&S<n.minDate||n.maxDate&&S>n.maxDate||n.disableWeekends&&m(S)||n.disableDayFn&&n.disableDayFn(S);if(N){if(C<a){D=p+D;k=u;x=f}else{D=D-i;k=d;x=c}}var V={day:D,month:k,year:x,isSelected:O,isToday:T,isDisabled:H,isEmpty:N,isStartRange:I,isEndRange:P,isInRange:L,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths};l.push(E(V));if(++_===7){if(n.showWeekNumber){l.unshift(R(C-a,t,e))}s.push(M(l,n.isRTL));l=[];_=0}}return A(n,s,r)},isVisible:function Ee(){return this._v},show:function Re(){if(!this.isVisible()){f(this.el,"is-hidden");this._v=true;this.draw();if(this._o.bound){i(n,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function"){this._o.onOpen.call(this)}}},hide:function Me(){var e=this._v;if(e!==false){if(this._o.bound){a(n,"click",this._onClick)}this.el.style.position="static";this.el.style.left="auto";this.el.style.top="auto";d(this.el,"is-hidden");this._v=false;if(e!==undefined&&typeof this._o.onClose==="function"){this._o.onClose.call(this)}}},destroy:function Se(){this.hide();a(this.el,"mousedown",this._onMouseDown,true);a(this.el,"touchend",this._onMouseDown,true);a(this.el,"change",this._onChange);if(this._o.field){a(this._o.field,"change",this._onInputChange);if(this._o.bound){a(this._o.trigger,"click",this._onInputClick);a(this._o.trigger,"focus",this._onInputFocus);a(this._o.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode){this.el.parentNode.removeChild(this.el)}}};return N})},{moment:"moment"}],zeroclipboard:[function(e,t,r){/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface
 * Copyright (c) 2009-2016 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.3.0
 */
(function(e,r){"use strict";var n=e,o=n.document,i=n.navigator,a=n.setTimeout,s=n.clearTimeout,l=n.setInterval,u=n.clearInterval,d=n.getComputedStyle,f=n.encodeURIComponent,c=n.ActiveXObject,h=n.Error,m=n.Number.parseInt||n.parseInt,p=n.Number.parseFloat||n.parseFloat,v=n.Number.isNaN||n.isNaN,g=n.Date.now,w=n.Object.keys,b=n.Object.prototype.hasOwnProperty,y=n.Array.prototype.slice,C=function(){var e=function a(e){return e};if(typeof n.wrap==="function"&&typeof n.unwrap==="function"){try{var t=o.createElement("div");var r=n.unwrap(t);if(t.nodeType===1&&r&&r.nodeType===1){e=n.unwrap}}catch(i){}}return e}();var _=function bt(e){return y.call(e,0)};var E=function yt(){var e,t,n,o,i,a,s=_(arguments),l=s[0]||{};for(e=1,t=s.length;e<t;e++){if((n=s[e])!=null){for(o in n){if(b.call(n,o)){i=l[o];a=n[o];if(l!==a&&a!==r){l[o]=a}}}}}return l};var R=function Ct(e){var t,r,n,o;if((typeof e==="undefined"?"undefined":_typeof(e))!=="object"||e==null||typeof e.nodeType==="number"){t=e}else if(typeof e.length==="number"){t=[];for(r=0,n=e.length;r<n;r++){if(b.call(e,r)){t[r]=Ct(e[r])}}}else{t={};for(o in e){if(b.call(e,o)){t[o]=Ct(e[o])}}}return t};var M=function _t(e,t){var r={};for(var n=0,o=t.length;n<o;n++){if(t[n]in e){r[t[n]]=e[t[n]]}}return r};var S=function Et(e,t){var r={};for(var n in e){if(t.indexOf(n)===-1){r[n]=e[n]}}return r};var O=function Rt(e){if(e){for(var t in e){if(b.call(e,t)){delete e[t]}}}return e};var T=function Mt(e,t){if(e&&e.nodeType===1&&e.ownerDocument&&t&&(t.nodeType===1&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||t.nodeType===9&&!t.ownerDocument&&t===e.ownerDocument)){do{if(e===t){return true}e=e.parentNode}while(e)}return false};var A=function St(e){var t;if(typeof e==="string"&&e){t=e.split("#")[0].split("?")[0];t=e.slice(0,e.lastIndexOf("/")+1)}return t};var N=function Ot(e){var t,r;if(typeof e==="string"&&e){r=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);if(r&&r[1]){t=r[1]}else{r=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);if(r&&r[1]){t=r[1]}}}return t};var D=function Tt(){var e,t;try{throw new h}catch(r){t=r}if(t){e=t.sourceURL||t.fileName||N(t.stack)}return e};var k=function At(){var e,t,n;if(o.currentScript&&(e=o.currentScript.src)){return e}t=o.getElementsByTagName("script");if(t.length===1){return t[0].src||r}if("readyState"in(t[0]||document.createElement("script"))){for(n=t.length;n--;){if(t[n].readyState==="interactive"&&(e=t[n].src)){return e}}}if(o.readyState==="loading"&&(e=t[t.length-1].src)){return e}if(e=D()){return e}return r};var x=function Nt(){var e,t,n,i=o.getElementsByTagName("script");for(e=i.length;e--;){if(!(n=i[e].src)){t=null;break}n=A(n);if(t==null){t=n}else if(t!==n){t=null;break}}return t||r};var I=function Dt(){var e=A(k())||x()||"";return e+"ZeroClipboard.swf"};var P=function kt(){var e=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;return!!i&&(e.test(i.appVersion||"")||e.test(i.platform||"")||(i.userAgent||"").indexOf("Windows")!==-1)};var L=function(){return n.opener==null&&(!!n.top&&n!=n.top||!!n.parent&&n!=n.parent)}();var H=o.documentElement.nodeName==="html";var V={bridge:null,version:"0.0.0",pluginType:"unknown",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null};var F="11.0.0";var B;var j={};var W;var $;var U={};var G=null;var Y=0;var z=0;var K={ready:"Flash communication is established",error:{"flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-insecure":"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity","browser-unsupported":"The browser does not support the required HTML DOM and JavaScript features"}};var q=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"];var X=["flash-sandboxed","flash-disabled","flash-outdated","flash-insecure","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"];var J=new RegExp("^flash-("+X.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$");var Z=new RegExp("^flash-("+X.filter(function(e){return e!=="flash-disabled"}).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$");var Q={swfPath:I(),trustedDomains:n.location.host?[n.location.host]:[],cacheBust:true,forceEnhancedClipboard:false,flashLoadTimeout:3e4,autoActivate:true,bubbleEvents:true,fixLineEndings:true,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:false,title:null,zIndex:999999999};var ee=function xt(e){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&!("length"in e)){w(e).forEach(function(t){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(t)){Q[t]=e[t]}else if(V.bridge==null){if(t==="containerId"||t==="swfObjectId"){if(ge(e[t])){Q[t]=e[t]}else{throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID")}}else{Q[t]=e[t]}}})}if(typeof e==="string"&&e){if(b.call(Q,e)){return Q[e]}return}return R(Q)};var te=function It(){Je();return{browser:E(M(i,["userAgent","platform","appName","appVersion"]),{isSupported:re()}),flash:S(V,["bridge"]),zeroclipboard:{version:Qe.version,config:Qe.config()}}};var re=function Pt(){return!!(o.addEventListener&&n.Object.keys&&n.Array.prototype.map)};var ne=function Lt(){return!!(V.sandboxed||V.disabled||V.outdated||V.unavailable||V.degraded||V.deactivated)};var oe=function Ht(e,t){var n,o,i,a={};if(typeof e==="string"&&e){i=e.toLowerCase().split(/\s+/)}else if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&!("length"in e)&&typeof t==="undefined"){w(e).forEach(function(t){var r=e[t];if(typeof r==="function"){Qe.on(t,r)}})}if(i&&i.length&&t){for(n=0,o=i.length;n<o;n++){e=i[n].replace(/^on/,"");a[e]=true;if(!j[e]){j[e]=[]}j[e].push(t)}if(a.ready&&V.ready){Qe.emit({type:"ready"})}if(a.error){if(!re()){Qe.emit({type:"error",name:"browser-unsupported"})}for(n=0,o=X.length;n<o;n++){if(V[X[n].replace(/^flash-/,"")]===true){Qe.emit({type:"error",name:X[n]});break}}if(B!==r&&Qe.version!==B){Qe.emit({type:"error",name:"version-mismatch",jsVersion:Qe.version,swfVersion:B})}}}return Qe};var ie=function Vt(e,t){var r,n,o,i,a;if(arguments.length===0){i=w(j)}else if(typeof e==="string"&&e){i=e.toLowerCase().split(/\s+/)}else if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&!("length"in e)&&typeof t==="undefined"){w(e).forEach(function(t){var r=e[t];if(typeof r==="function"){Qe.off(t,r)}})}if(i&&i.length){for(r=0,n=i.length;r<n;r++){e=i[r].replace(/^on/,"");a=j[e];if(a&&a.length){if(t){o=a.indexOf(t);while(o!==-1){a.splice(o,1);o=a.indexOf(t,o)}}else{a.length=0}}}}return Qe};var ae=function Ft(e){var t;if(typeof e==="string"&&e){t=R(j[e])||null}else{t=R(j)}return t};var se=function Bt(e){var t,r,n;e=we(e);if(!e){return}if(Me(e)){return}if(e.type==="ready"&&V.overdue===true){return Qe.emit({type:"error",name:"flash-overdue"})}t=E({},e);Ee.call(this,t);if(e.type==="copy"){n=Ie(U);r=n.data;G=n.formatMap}return r};var le=function jt(){var e=Q.swfPath||"",t=e.slice(0,2),r=e.slice(0,e.indexOf("://")+1);return t==="\\\\"?"file:":t==="//"||r===""?n.location.protocol:r};var ue=function Wt(){var e,t,r=V.sandboxed;if(!re()){V.ready=false;Qe.emit({type:"error",name:"browser-unsupported"});return}Je();if(typeof V.ready!=="boolean"){V.ready=false}if(V.sandboxed!==r&&V.sandboxed===true){V.ready=false;Qe.emit({type:"error",name:"flash-sandboxed"})}else if(!Qe.isFlashUnusable()&&V.bridge===null){t=le();if(t&&t!==n.location.protocol){Qe.emit({type:"error",name:"flash-insecure"})}else{e=Q.flashLoadTimeout;if(typeof e==="number"&&e>=0){Y=a(function(){if(typeof V.deactivated!=="boolean"){V.deactivated=true}if(V.deactivated===true){Qe.emit({type:"error",name:"flash-deactivated"})}},e)}V.overdue=false;ke()}}};var de=function $t(){Qe.clearData();Qe.blur();Qe.emit("destroy");xe();Qe.off()};var fe=function Ut(e,t){var r;if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&typeof t==="undefined"){r=e;Qe.clearData()}else if(typeof e==="string"&&e){r={};r[e]=t}else{return}for(var n in r){if(typeof n==="string"&&n&&b.call(r,n)&&typeof r[n]==="string"&&r[n]){U[n]=Xe(r[n])}}};var ce=function Gt(e){if(typeof e==="undefined"){O(U);G=null}else if(typeof e==="string"&&b.call(U,e)){delete U[e]}};var he=function Yt(e){if(typeof e==="undefined"){return R(U)}else if(typeof e==="string"&&b.call(U,e)){return U[e]}};var me=function zt(e){if(!(e&&e.nodeType===1)){return}if(W){We(W,Q.activeClass);if(W!==e){We(W,Q.hoverClass)}}W=e;je(e,Q.hoverClass);var t=e.getAttribute("title")||Q.title;if(typeof t==="string"&&t){var r=Ne(V.bridge);if(r){r.setAttribute("title",t)}}var n=Q.forceHandCursor===true||$e(e,"cursor")==="pointer";Ke(n);ze()};var pe=function Kt(){var e=Ne(V.bridge);if(e){e.removeAttribute("title");e.style.left="0px";e.style.top="-9999px";e.style.width="1px";e.style.height="1px"}if(W){We(W,Q.hoverClass);We(W,Q.activeClass);W=null}};var ve=function qt(){return W||null};var ge=function Xt(e){return typeof e==="string"&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)};var we=function Jt(e){var t;if(typeof e==="string"&&e){t=e;e={}}else if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&typeof e.type==="string"&&e.type){t=e.type}if(!t){return}t=t.toLowerCase();if(!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||t==="error"&&e.name==="clipboard-error")){e.target=$}E(e,{type:t,target:e.target||W||null,relatedTarget:e.relatedTarget||null,currentTarget:V&&V.bridge||null,timeStamp:e.timeStamp||g()||null});var r=K[e.type];if(e.type==="error"&&e.name&&r){r=r[e.name]}if(r){e.message=r}if(e.type==="ready"){E(e,{target:null,version:V.version})}if(e.type==="error"){if(J.test(e.name)){E(e,{target:null,minimumVersion:F})}if(Z.test(e.name)){E(e,{version:V.version})}if(e.name==="flash-insecure"){E(e,{pageProtocol:n.location.protocol,swfProtocol:le()})}}if(e.type==="copy"){e.clipboardData={setData:Qe.setData,clearData:Qe.clearData}}if(e.type==="aftercopy"){e=Pe(e,G)}if(e.target&&!e.relatedTarget){e.relatedTarget=be(e.target)}return ye(e)};var be=function Zt(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?o.getElementById(t):null};var ye=function Qt(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target;var i=e.type==="_mouseover"&&e.relatedTarget?e.relatedTarget:r;var a=e.type==="_mouseout"&&e.relatedTarget?e.relatedTarget:r;var s=Ue(t);var l=n.screenLeft||n.screenX||0;var u=n.screenTop||n.screenY||0;var d=o.body.scrollLeft+o.documentElement.scrollLeft;var f=o.body.scrollTop+o.documentElement.scrollTop;var c=s.left+(typeof e._stageX==="number"?e._stageX:0);var h=s.top+(typeof e._stageY==="number"?e._stageY:0);var m=c-d;var p=h-f;var v=l+m;var g=u+p;var w=typeof e.movementX==="number"?e.movementX:0;var b=typeof e.movementY==="number"?e.movementY:0;delete e._stageX;delete e._stageY;E(e,{srcElement:t,fromElement:i,toElement:a,screenX:v,screenY:g,pageX:c,pageY:h,clientX:m,clientY:p,x:m,y:p,movementX:w,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e};var Ce=function er(e){var t=e&&typeof e.type==="string"&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)};var _e=function tr(e,t,r,n){if(n){a(function(){e.apply(t,r)},0)}else{e.apply(t,r)}};var Ee=function rr(e){if(!((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&e.type)){return}var t=Ce(e);var r=j["*"]||[];var o=j[e.type]||[];var i=r.concat(o);if(i&&i.length){var a,s,l,u,d,f=this;for(a=0,s=i.length;a<s;a++){l=i[a];u=f;if(typeof l==="string"&&typeof n[l]==="function"){l=n[l]}if((typeof l==="undefined"?"undefined":_typeof(l))==="object"&&l&&typeof l.handleEvent==="function"){u=l;l=l.handleEvent}if(typeof l==="function"){d=E({},e);_e(l,u,[d],t)}}}return this};var Re=function nr(e){var t=null;if(L===false||e&&e.type==="error"&&e.name&&q.indexOf(e.name)!==-1){t=false}return t};var Me=function or(e){var t=e.target||W||null;var r=e._source==="swf";delete e._source;switch(e.type){case"error":var n=e.name==="flash-sandboxed"||Re(e);if(typeof n==="boolean"){V.sandboxed=n}if(e.name==="browser-unsupported"){E(V,{disabled:false,outdated:false,unavailable:false,degraded:false,deactivated:false,overdue:false,ready:false})}else if(X.indexOf(e.name)!==-1){E(V,{disabled:e.name==="flash-disabled",outdated:e.name==="flash-outdated",insecure:e.name==="flash-insecure",unavailable:e.name==="flash-unavailable",degraded:e.name==="flash-degraded",deactivated:e.name==="flash-deactivated",overdue:e.name==="flash-overdue",ready:false})}else if(e.name==="version-mismatch"){B=e.swfVersion;E(V,{disabled:false,outdated:false,insecure:false,unavailable:false,degraded:false,deactivated:false,overdue:false,ready:false})}Ye();break;case"ready":B=e.swfVersion;var o=V.deactivated===true;E(V,{sandboxed:false,disabled:false,outdated:false,insecure:false,unavailable:false,degraded:false,deactivated:false,overdue:o,ready:!o});Ye();break;case"beforecopy":$=t;break;case"copy":var i,a,s=e.relatedTarget;if(!(U["text/html"]||U["text/plain"])&&s&&(a=s.value||s.outerHTML||s.innerHTML)&&(i=s.value||s.textContent||s.innerText)){e.clipboardData.clearData();e.clipboardData.setData("text/plain",i);if(a!==i){e.clipboardData.setData("text/html",a)}}else if(!U["text/plain"]&&e.target&&(i=e.target.getAttribute("data-clipboard-text"))){e.clipboardData.clearData();e.clipboardData.setData("text/plain",i)}break;case"aftercopy":Se(e);Qe.clearData();if(t&&t!==Be()&&t.focus){t.focus()}break;case"_mouseover":Qe.focus(t);if(Q.bubbleEvents===true&&r){if(t&&t!==e.relatedTarget&&!T(e.relatedTarget,t)){Oe(E({},e,{type:"mouseenter",bubbles:false,cancelable:false}))}Oe(E({},e,{type:"mouseover"}))}break;case"_mouseout":Qe.blur();if(Q.bubbleEvents===true&&r){if(t&&t!==e.relatedTarget&&!T(e.relatedTarget,t)){Oe(E({},e,{type:"mouseleave",bubbles:false,cancelable:false}))}Oe(E({},e,{type:"mouseout"}))}break;case"_mousedown":je(t,Q.activeClass);if(Q.bubbleEvents===true&&r){Oe(E({},e,{type:e.type.slice(1)}))}break;case"_mouseup":We(t,Q.activeClass);if(Q.bubbleEvents===true&&r){Oe(E({},e,{type:e.type.slice(1)}))}break;case"_click":$=null;if(Q.bubbleEvents===true&&r){Oe(E({},e,{type:e.type.slice(1)}))}break;case"_mousemove":if(Q.bubbleEvents===true&&r){Oe(E({},e,{type:e.type.slice(1)}))}break}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){return true}};var Se=function ir(e){if(e.errors&&e.errors.length>0){var t=R(e);E(t,{type:"error",name:"clipboard-error"});delete t.success;a(function(){Qe.emit(t)},0)}};var Oe=function ar(e){if(!(e&&typeof e.type==="string"&&e)){return}var t,r=e.target||null,i=r&&r.ownerDocument||o,a={view:i.defaultView||n,canBubble:true,cancelable:true,detail:e.type==="click"?1:0,button:typeof e.which==="number"?e.which-1:typeof e.button==="number"?e.button:i.createEvent?0:1},s=E(a,e);if(!r){return}if(i.createEvent&&r.dispatchEvent){s=[s.type,s.canBubble,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget];t=i.createEvent("MouseEvents");if(t.initMouseEvent){t.initMouseEvent.apply(t,s);t._source="js";r.dispatchEvent(t)}}};var Te=function sr(){var e=Q.flashLoadTimeout;if(typeof e==="number"&&e>=0){var t=Math.min(1e3,e/10);var r=Q.swfObjectId+"_fallbackContent";z=l(function(){var e=o.getElementById(r);if(Ge(e)){Ye();V.deactivated=null;Qe.emit({type:"error",name:"swf-not-found"})}},t)}};var Ae=function lr(){var e=o.createElement("div");e.id=Q.containerId;e.className=Q.containerClass;e.style.position="absolute";e.style.left="0px";e.style.top="-9999px";e.style.width="1px";e.style.height="1px";e.style.zIndex=""+qe(Q.zIndex);return e};var Ne=function ur(e){var t=e&&e.parentNode;while(t&&t.nodeName==="OBJECT"&&t.parentNode){t=t.parentNode}return t||null};var De=function dr(e){if(typeof e!=="string"||!e){return e}return e.replace(/["&'<>]/g,function(e){switch(e){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"<":return"&lt;";case">":return"&gt;";default:return e}})};var ke=function fr(){var e,t=V.bridge,r=Ne(t);if(!t){var i=Fe(n.location.host,Q);var a=i==="never"?"none":"all";var s=He(E({jsVersion:Qe.version},Q));var l=Q.swfPath+Le(Q.swfPath,Q);if(H){l=De(l)}r=Ae();var u=o.createElement("div");r.appendChild(u);o.body.appendChild(r);var d=o.createElement("div");var f=V.pluginType==="activex";d.innerHTML='<object id="'+Q.swfObjectId+'" name="'+Q.swfObjectId+'" '+'width="100%" height="100%" '+(f?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+l+'"')+">"+(f?'<param name="movie" value="'+l+'"/>':"")+'<param name="allowScriptAccess" value="'+i+'"/>'+'<param name="allowNetworking" value="'+a+'"/>'+'<param name="menu" value="false"/>'+'<param name="wmode" value="transparent"/>'+'<param name="flashvars" value="'+s+'"/>'+'<div id="'+Q.swfObjectId+'_fallbackContent">&nbsp;</div>'+"</object>";t=d.firstChild;d=null;C(t).ZeroClipboard=Qe;r.replaceChild(t,u);Te()}if(!t){t=o[Q.swfObjectId];if(t&&(e=t.length)){t=t[e-1]}if(!t&&r){t=r.firstChild}}V.bridge=t||null;return t};var xe=function cr(){var e=V.bridge;if(e){var t=Ne(e);if(t){if(V.pluginType==="activex"&&"readyState"in e){e.style.display="none";(function n(){if(e.readyState===4){for(var r in e){if(typeof e[r]==="function"){e[r]=null}}if(e.parentNode){e.parentNode.removeChild(e)}if(t.parentNode){t.parentNode.removeChild(t)}}else{a(n,10)}})()}else{if(e.parentNode){e.parentNode.removeChild(e)}if(t.parentNode){t.parentNode.removeChild(t)}}}Ye();V.ready=null;V.bridge=null;V.deactivated=null;V.insecure=null;B=r}};var Ie=function hr(e){var t={},r={};if(!((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e)){return}for(var n in e){if(n&&b.call(e,n)&&typeof e[n]==="string"&&e[n]){switch(n.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[n];r.text=n;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[n];r.html=n;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[n];r.rtf=n;break;default:break}}}return{data:t,formatMap:r}};var Pe=function mr(e,t){if(!((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&(typeof t==="undefined"?"undefined":_typeof(t))==="object"&&t)){return e}var r={};for(var n in e){if(b.call(e,n)){if(n==="errors"){r[n]=e[n]?e[n].slice():[];for(var o=0,i=r[n].length;o<i;o++){r[n][o].format=t[r[n][o].format]}}else if(n!=="success"&&n!=="data"){r[n]=e[n]}else{r[n]={};var a=e[n];for(var s in a){if(s&&b.call(a,s)&&b.call(t,s)){r[n][t[s]]=a[s]}}}}}return r};var Le=function pr(e,t){var r=t==null||t&&t.cacheBust===true;if(r){return(e.indexOf("?")===-1?"?":"&")+"noCache="+g()}else{return""}};var He=function vr(e){var t,r,o,i,a="",s=[];if(e.trustedDomains){if(typeof e.trustedDomains==="string"){i=[e.trustedDomains]}else if(_typeof(e.trustedDomains)==="object"&&"length"in e.trustedDomains){i=e.trustedDomains}}if(i&&i.length){for(t=0,r=i.length;t<r;t++){if(b.call(i,t)&&i[t]&&typeof i[t]==="string"){o=Ve(i[t]);if(!o){continue}if(o==="*"){s.length=0;s.push(o);break}s.push.apply(s,[o,"//"+o,n.location.protocol+"//"+o])}}}if(s.length){a+="trustedOrigins="+f(s.join(","))}if(e.forceEnhancedClipboard===true){a+=(a?"&":"")+"forceEnhancedClipboard=true"}if(typeof e.swfObjectId==="string"&&e.swfObjectId){a+=(a?"&":"")+"swfObjectId="+f(e.swfObjectId)}if(typeof e.jsVersion==="string"&&e.jsVersion){a+=(a?"&":"")+"jsVersion="+f(e.jsVersion)}return a};var Ve=function gr(e){if(e==null||e===""){return null}e=e.replace(/^\s+|\s+$/g,"");if(e===""){return null}var t=e.indexOf("//");e=t===-1?e:e.slice(t+2);var r=e.indexOf("/");e=r===-1?e:t===-1||r===0?null:e.slice(0,r);if(e&&e.slice(-4).toLowerCase()===".swf"){return null}return e||null};var Fe=function(){var e=function t(e){var t,r,n,o=[];if(typeof e==="string"){e=[e]}if(!((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&typeof e.length==="number")){return o}for(t=0,r=e.length;t<r;t++){if(b.call(e,t)&&(n=Ve(e[t]))){if(n==="*"){o.length=0;o.push("*");break}if(o.indexOf(n)===-1){o.push(n)}}}return o};return function(t,r){var n=Ve(r.swfPath);if(n===null){n=t}var o=e(r.trustedDomains);var i=o.length;if(i>0){if(i===1&&o[0]==="*"){return"always"}if(o.indexOf(t)!==-1){if(i===1&&t===n){return"sameDomain"}return"always"}}return"never"}}();var Be=function wr(){try{return o.activeElement}catch(e){return null}};var je=function br(e,t){var r,n,o,i=[];if(typeof t==="string"&&t){i=t.split(/\s+/)}if(e&&e.nodeType===1&&i.length>0){o=(" "+(e.className||"")+" ").replace(/[\t\r\n\f]/g," ");for(r=0,n=i.length;r<n;r++){if(o.indexOf(" "+i[r]+" ")===-1){o+=i[r]+" "}}o=o.replace(/^\s+|\s+$/g,"");if(o!==e.className){e.className=o}}return e};var We=function yr(e,t){var r,n,o,i=[];if(typeof t==="string"&&t){i=t.split(/\s+/)}if(e&&e.nodeType===1&&i.length>0){if(e.className){o=(" "+e.className+" ").replace(/[\t\r\n\f]/g," ");for(r=0,n=i.length;r<n;r++){o=o.replace(" "+i[r]+" "," ")}o=o.replace(/^\s+|\s+$/g,"");if(o!==e.className){e.className=o}}}return e};var $e=function Cr(e,t){var r=d(e,null).getPropertyValue(t);if(t==="cursor"){if(!r||r==="auto"){if(e.nodeName==="A"){return"pointer"}}}return r};var Ue=function _r(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var r=e.getBoundingClientRect();var i=n.pageXOffset;var a=n.pageYOffset;var s=o.documentElement.clientLeft||0;var l=o.documentElement.clientTop||0;var u=0;var d=0;if($e(o.body,"position")==="relative"){var f=o.body.getBoundingClientRect();var c=o.documentElement.getBoundingClientRect();u=f.left-c.left||0;d=f.top-c.top||0}t.left=r.left+i-s-u;t.top=r.top+a-l-d;t.width="width"in r?r.width:r.right-r.left;t.height="height"in r?r.height:r.bottom-r.top}return t};var Ge=function Er(e){if(!e){return false}var t=d(e,null);if(!t){return false}var r=p(t.height)>0;var n=p(t.width)>0;var o=p(t.top)>=0;var i=p(t.left)>=0;var a=r&&n&&o&&i;var s=a?null:Ue(e);var l=t.display!=="none"&&t.visibility!=="collapse"&&(a||!!s&&(r||s.height>0)&&(n||s.width>0)&&(o||s.top>=0)&&(i||s.left>=0));return l};var Ye=function Rr(){s(Y);Y=0;u(z);z=0};var ze=function Mr(){var e;if(W&&(e=Ne(V.bridge))){var t=Ue(W);E(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+qe(Q.zIndex)})}};var Ke=function Sr(e){if(V.ready===true){if(V.bridge&&typeof V.bridge.setHandCursor==="function"){V.bridge.setHandCursor(e)}else{V.ready=false}}};var qe=function Or(e){if(/^(?:auto|inherit)$/.test(e)){return e}var t;if(typeof e==="number"&&!v(e)){t=e}else if(typeof e==="string"){t=Or(m(e,10))}return typeof t==="number"?t:"auto"};var Xe=function Tr(e){var t=/(\r\n|\r|\n)/g;if(typeof e==="string"&&Q.fixLineEndings===true){if(P()){if(/((^|[^\r])\n|\r([^\n]|$))/.test(e)){e=e.replace(t,"\r\n")}}else if(/\r/.test(e)){e=e.replace(t,"\n")}}return e};var Je=function Ar(t){var r,n,o,i=V.sandboxed,a=null;t=t===true;if(L===false){a=false}else{try{n=e.frameElement||null}catch(s){o={name:s.name,message:s.message}}if(n&&n.nodeType===1&&n.nodeName==="IFRAME"){try{a=n.hasAttribute("sandbox")}catch(s){a=null}}else{try{r=document.domain||null}catch(s){r=null}if(r===null||o&&o.name==="SecurityError"&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(o.message.toLowerCase())){a=true}}}V.sandboxed=a;if(i!==a&&!t){Ze(c)}return a};var Ze=function Nr(e){var t,r,n,o=false,a=false,s=false,l="";function u(e){var t=e.match(/[\d]+/g);t.length=3;return t.join(".")}function d(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||e.slice(-13)==="chrome.plugin")}function f(e){if(e){o=true;if(e.version){l=u(e.version)}if(!l&&e.description){l=u(e.description)}if(e.filename){s=d(e.filename)}}}if(i.plugins&&i.plugins.length){t=i.plugins["Shockwave Flash"];f(t);if(i.plugins["Shockwave Flash 2.0"]){o=true;l="2.0.0.11"}}else if(i.mimeTypes&&i.mimeTypes.length){n=i.mimeTypes["application/x-shockwave-flash"];t=n&&n.enabledPlugin;f(t)}else if(typeof e!=="undefined"){a=true;try{r=new e("ShockwaveFlash.ShockwaveFlash.7");o=true;l=u(r.GetVariable("$version"))}catch(c){try{r=new e("ShockwaveFlash.ShockwaveFlash.6");o=true;l="6.0.21"}catch(h){try{r=new e("ShockwaveFlash.ShockwaveFlash");o=true;l=u(r.GetVariable("$version"))}catch(m){a=false}}}}V.disabled=o!==true;V.outdated=l&&p(l)<p(F);V.version=l||"0.0.0";V.pluginType=s?"pepper":a?"activex":o?"netscape":"unknown"};Ze(c);Je(true);var Qe=function Dr(){if(!(this instanceof Dr)){return new Dr}if(typeof Dr._createClient==="function"){Dr._createClient.apply(this,_(arguments))}};Qe.version="2.3.0";Qe.config=function(){return ee.apply(this,_(arguments))};Qe.state=function(){return te.apply(this,_(arguments))};Qe.isFlashUnusable=function(){return ne.apply(this,_(arguments))};Qe.on=function(){return oe.apply(this,_(arguments))};Qe.off=function(){return ie.apply(this,_(arguments))};Qe.handlers=function(){return ae.apply(this,_(arguments))};Qe.emit=function(){return se.apply(this,_(arguments))};Qe.create=function(){return ue.apply(this,_(arguments))};Qe.destroy=function(){return de.apply(this,_(arguments))};Qe.setData=function(){return fe.apply(this,_(arguments))};Qe.clearData=function(){return ce.apply(this,_(arguments))};Qe.getData=function(){return he.apply(this,_(arguments))};Qe.focus=Qe.activate=function(){return me.apply(this,_(arguments))};Qe.blur=Qe.deactivate=function(){return pe.apply(this,_(arguments))};Qe.activeElement=function(){return ve.apply(this,_(arguments))};var et=0;var tt={};var rt=0;var nt={};var ot={};E(Q,{autoActivate:true});var it=function kr(e){var t,r=this;r.id=""+et++;t={instance:r,elements:[],handlers:{},coreWildcardHandler:function n(e){return r.emit(e)}};tt[r.id]=t;if(e){r.clip(e)}Qe.on("*",t.coreWildcardHandler);Qe.on("destroy",function(){r.destroy()});Qe.create()};var at=function xr(e,t){var n,o,i,a={},s=this,l=tt[s.id],u=l&&l.handlers;if(!l){throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance")}if(typeof e==="string"&&e){i=e.toLowerCase().split(/\s+/)}else if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&!("length"in e)&&typeof t==="undefined"){w(e).forEach(function(t){var r=e[t];if(typeof r==="function"){s.on(t,r)}})}if(i&&i.length&&t){for(n=0,o=i.length;n<o;n++){e=i[n].replace(/^on/,"");a[e]=true;if(!u[e]){u[e]=[]}u[e].push(t)}if(a.ready&&V.ready){this.emit({type:"ready",client:this})}if(a.error){for(n=0,o=X.length;n<o;n++){if(V[X[n].replace(/^flash-/,"")]){this.emit({type:"error",name:X[n],client:this});break}}if(B!==r&&Qe.version!==B){this.emit({type:"error",name:"version-mismatch",jsVersion:Qe.version,swfVersion:B})}}}return s};var st=function Ir(e,t){var r,n,o,i,a,s=this,l=tt[s.id],u=l&&l.handlers;if(!u){return s}if(arguments.length===0){i=w(u)}else if(typeof e==="string"&&e){i=e.split(/\s+/)}else if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&!("length"in e)&&typeof t==="undefined"){w(e).forEach(function(t){var r=e[t];if(typeof r==="function"){s.off(t,r)}})}if(i&&i.length){for(r=0,n=i.length;r<n;r++){e=i[r].toLowerCase().replace(/^on/,"");a=u[e];if(a&&a.length){if(t){o=a.indexOf(t);while(o!==-1){a.splice(o,1);o=a.indexOf(t,o)}}else{a.length=0}}}}return s};var lt=function Pr(e){var t=null,r=tt[this.id]&&tt[this.id].handlers;if(r){if(typeof e==="string"&&e){t=r[e]?r[e].slice(0):[]}else{t=R(r)}}return t};var ut=function Lr(e){var t,r=this;if(mt.call(r,e)){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&typeof e.type==="string"&&e.type){e=E({},e)}t=E({},we(e),{client:r});pt.call(r,t)}return r};var dt=function Hr(e){if(!tt[this.id]){throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance")}e=vt(e);for(var t=0;t<e.length;t++){if(b.call(e,t)&&e[t]&&e[t].nodeType===1){if(!e[t].zcClippingId){e[t].zcClippingId="zcClippingId_"+rt++;nt[e[t].zcClippingId]=[this.id];if(Q.autoActivate===true){gt(e[t])}}else if(nt[e[t].zcClippingId].indexOf(this.id)===-1){nt[e[t].zcClippingId].push(this.id)}var r=tt[this.id]&&tt[this.id].elements;if(r.indexOf(e[t])===-1){r.push(e[t])}}}return this};var ft=function Vr(e){var t=tt[this.id];if(!t){return this}var r=t.elements;var n;if(typeof e==="undefined"){e=r.slice(0)}else{e=vt(e)}for(var o=e.length;o--;){if(b.call(e,o)&&e[o]&&e[o].nodeType===1){n=0;while((n=r.indexOf(e[o],n))!==-1){r.splice(n,1)}var i=nt[e[o].zcClippingId];if(i){n=0;while((n=i.indexOf(this.id,n))!==-1){i.splice(n,1)}if(i.length===0){if(Q.autoActivate===true){wt(e[o])}delete e[o].zcClippingId}}}}return this};var ct=function Fr(){var e=tt[this.id];return e&&e.elements?e.elements.slice(0):[]};var ht=function Br(){var e=tt[this.id];if(!e){return}this.unclip();this.off();Qe.off("*",e.coreWildcardHandler);delete tt[this.id]};var mt=function jr(e){if(!(e&&e.type)){return false}if(e.client&&e.client!==this){return false}var t=tt[this.id];var r=t&&t.elements;var n=!!r&&r.length>0;var o=!e.target||n&&r.indexOf(e.target)!==-1;var i=e.relatedTarget&&n&&r.indexOf(e.relatedTarget)!==-1;var a=e.client&&e.client===this;if(!t||!(o||i||a)){return false}return true};var pt=function Wr(e){var t=tt[this.id];if(!((typeof e==="undefined"?"undefined":_typeof(e))==="object"&&e&&e.type&&t)){return}var r=Ce(e);var o=t&&t.handlers["*"]||[];var i=t&&t.handlers[e.type]||[];var a=o.concat(i);if(a&&a.length){var s,l,u,d,f,c=this;for(s=0,l=a.length;s<l;s++){u=a[s];d=c;if(typeof u==="string"&&typeof n[u]==="function"){u=n[u]}if((typeof u==="undefined"?"undefined":_typeof(u))==="object"&&u&&typeof u.handleEvent==="function"){d=u;u=u.handleEvent}if(typeof u==="function"){f=E({},e);_e(u,d,[f],r)}}}};var vt=function $r(e){if(typeof e==="string"){e=[]}return typeof e.length!=="number"?[e]:e};var gt=function Ur(e){if(!(e&&e.nodeType===1)){return}var t=function o(e){if(!(e||(e=n.event))){return}if(e._source!=="js"){e.stopImmediatePropagation();e.preventDefault()}delete e._source};var r=function i(r){if(!(r||(r=n.event))){return}t(r);Qe.focus(e)};e.addEventListener("mouseover",r,false);e.addEventListener("mouseout",t,false);e.addEventListener("mouseenter",t,false);e.addEventListener("mouseleave",t,false);e.addEventListener("mousemove",t,false);ot[e.zcClippingId]={mouseover:r,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}};var wt=function Gr(e){if(!(e&&e.nodeType===1)){return}var t=ot[e.zcClippingId];if(!((typeof t==="undefined"?"undefined":_typeof(t))==="object"&&t)){return}var r,n,o=["move","leave","enter","out","over"];for(var i=0,a=o.length;i<a;i++){r="mouse"+o[i];n=t[r];if(typeof n==="function"){
e.removeEventListener(r,n,false)}}delete ot[e.zcClippingId]};Qe._createClient=function(){it.apply(this,_(arguments))};Qe.prototype.on=function(){return at.apply(this,_(arguments))};Qe.prototype.off=function(){return st.apply(this,_(arguments))};Qe.prototype.handlers=function(){return lt.apply(this,_(arguments))};Qe.prototype.emit=function(){return ut.apply(this,_(arguments))};Qe.prototype.clip=function(){return dt.apply(this,_(arguments))};Qe.prototype.unclip=function(){return ft.apply(this,_(arguments))};Qe.prototype.elements=function(){return ct.apply(this,_(arguments))};Qe.prototype.destroy=function(){return ht.apply(this,_(arguments))};Qe.prototype.setText=function(e){if(!tt[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}Qe.setData("text/plain",e);return this};Qe.prototype.setHtml=function(e){if(!tt[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}Qe.setData("text/html",e);return this};Qe.prototype.setRichText=function(e){if(!tt[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}Qe.setData("application/rtf",e);return this};Qe.prototype.setData=function(){if(!tt[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}Qe.setData.apply(this,_(arguments));return this};Qe.prototype.clearData=function(){if(!tt[this.id]){throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance")}Qe.clearData.apply(this,_(arguments));return this};Qe.prototype.getData=function(){if(!tt[this.id]){throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance")}return Qe.getData.apply(this,_(arguments))};if(typeof define==="function"&&define.amd){define(function(){return Qe})}else if((typeof t==="undefined"?"undefined":_typeof(t))==="object"&&t&&_typeof(t.exports)==="object"&&t.exports){t.exports=Qe}else{e.ZeroClipboard=Qe}})(function(){return this||window}())},{}]},{},[141,64,66,67,65,68,111,112,113,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,100,101,102,103,104,106,107,108,109,110,114,115,116,117,135,136,137,138,120,121,122,123,124,125,32,36,33,34,41,35,37,38,39,40,142,143,144,145,146,217,218,211,212,213,147,148,149,150,151,152,154,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,198,199,200,201,202,203,204,205,206,207,208,209,210,214,215,216,219,220,222,223,224,225,226])(141)})}).call(exports,__webpack_require__(2),__webpack_require__(25),__webpack_require__(23))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(){this.events={}}e.prototype.registerEvent=function(e){var t=new o(e);this.events[e]=t};e.prototype.addEventListener=function(e,t){if(this.events[e]!=null){this.events[e].registerCallback(t)}else{console.log("Error!! The event "+this.events[e]+" is not registered yet. Please register this event before adding the listner")}};e.prototype.removeAllEvents=function(){this.events={}};e.prototype.removeEventListener=function(e,t){if(this.events[e]!=null){this.events[e].deregisterCallback(t)}else{console.log("Error!! The event "+this.events[e]+" is not registered yet. Please register this event before adding the listner")}};e.prototype.dispatchEvent=function(e,t){if(this.events[e]!=null){this.events[e].callbacks.forEach(function(e){e(t)})}else{console.log("Error!! The event "+this.events[e]+" is not registered yet. Please register this event before triggering the event")}};return e}();t.EventController=n;var o=function(){function e(e){this.name=e;this.payload={};this.callbacks=[]}e.prototype.registerCallback=function(e){this.callbacks.push(e)};e.prototype.deregisterCallback=function(e){this.callbacks.splice(this.callbacks.indexOf(e),1)};return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(14);var o=r(3);var i=r(0);var a='<div id="spreadSheet" class="DLSLeonardo"><div id = "leoContainer" ><div id="buttonGroup"><button id="hintBtn">Hint</button><button id="checkMyAnswer">Check My Answer</button><button id="resetGridBtn">Reset Grid</button><button id="exportConfigBtn">Export Config</button><button id="exportCorrectDataBtn">Export Correct Data</button></div><div id="SIMArea" style="width:100%"></div><div class="formulaToolbar"><input type="text" id="nameBox" ondrop="return false;" spellcheck="false"/><div class="formulaBarContainer"><button id="fx" ondrag="return false;"><img src="/assets/fx.png" draggable="false"></img></button><input type="text" id="formulaBar" spellcheck="false" ondrop="return false;"/></div></div><div id="grid"></div><div id="sheetTabBar" class="sheetTabContainer"><div class="contentarea"><ul role="tablist" class="tablist" id="TabsContainerlist"></ul></div></div></div></div>';var s=function(){function e(){this.spreadsheets={};this.init();this.sheetNameIdMap={}}e.prototype.init=function(){this.eventController=new o.EventController;this.registerEvents();this.registerEventListeners()};e.prototype.destroy=function(){for(var e in this.spreadsheets){this.spreadsheets[e].destroy()}};e.prototype.registerEvents=function(){this.eventController.registerEvent(i.Events.SpreadsheetEvents.MANAGER_BROADCAST_EVENT);for(var e in i.Events.LeonardoManagerEvents){this.eventController.registerEvent(i.Events.LeonardoManagerEvents[e])}};e.prototype.registerEventListeners=function(){this.eventController.addEventListener(i.Events.SpreadsheetEvents.MANAGER_BROADCAST_EVENT,this.manageSpreadsheetcommunication.bind(this))};e.prototype.addLeonardo=function(e,t,r,n){if(r===void 0){r=[]}e.innerHTML+=a;var o=e.querySelector(".DLSLeonardo");var i=Date.now().toString();var s=i;o.setAttribute("guid",s);var l=this.initLeonardo(e,t,r,this.eventController,s,this.spreadsheets,n);this.spreadsheets[i]=l};e.prototype.initLeonardo=function(e,t,r,o,i,a,s){if(t.sheetNames){this.sheetNameIdMap[t.sheetNames[0].toUpperCase()]=i}else{this.sheetNameIdMap[i]=i}var l=new n.SpreadsheetController(e,t,r,o,i,this.spreadsheets,this.sheetNameIdMap,s);l.init();return l};e.prototype.checkAnswer=function(e,t){var r=this.getInstance(e);if(r!=null){r.checkMyAnswer(t)}};e.prototype.displayHint=function(e){var t=this.getInstance(e);if(t!=null){return t.displayHint()}};e.prototype.getInstance=function(e){var t=e.querySelector(".DLSLeonardo");var r=t.getAttribute("guid");try{return this.spreadsheets[r]}catch(n){console.log("LeoIntegration - not able to access instance - "+n.msg);return null}};e.prototype.manageSpreadsheetcommunication=function(e){if(e.type=="FormulaModeOpen"){this.eventController.dispatchEvent(i.Events.LeonardoManagerEvents.FORMULAMODE_OPEN_EVENT,e)}else if(e.type=="FormulaModeClose"){this.eventController.dispatchEvent(i.Events.LeonardoManagerEvents.FORMULAMODE_CLOSE_EVENT,e)}else if(e.type=="cellClicked"){this.eventController.dispatchEvent(i.Events.LeonardoManagerEvents.FORMULAMODE_CHANGE_EVENT,e)}else if(e.type=="RemoteCellValChanged"){this.eventController.dispatchEvent(i.Events.LeonardoManagerEvents.REMOTECELLVAL_CHANGED_EVENT,e)}};e.prototype.reset=function(e){var t=this.getInstance(e);if(t!=null){t.reset()}};e.prototype.tryAgain=function(e){var t=this.getInstance(e);if(t!=null){t.tryAgain()}};e.prototype.getData=function(e){var t=this.getInstance(e);if(t!=null){return t.getData()}return null};e.prototype.updateData=function(e,t){var r=this.getInstance(e);if(r!=null){return r.updateData(t)}return null};return e}();t.LeoIntegration=new s},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(4);function o(e,t,r,o){n.LeoIntegration.addLeonardo(e,t,r,o)}t.add=o;function i(e,t){n.LeoIntegration.checkAnswer(e,t)}t.checkAnswer=i;function a(e){return n.LeoIntegration.displayHint(e)}t.displayHint=a;function s(e,t){for(var r in e){var o=e[r];n.LeoIntegration.addLeonardo(o["container"],o["config"],o["correctData"],t)}}t.addMultiple=s;function l(){n.LeoIntegration.destroy()}t.destroyGrids=l;function u(e){n.LeoIntegration.reset(e)}t.reset=u;function d(e){n.LeoIntegration.tryAgain(e)}t.tryAgain=d;function f(e){return n.LeoIntegration.getData(e)}t.getData=f;function c(e,t){return n.LeoIntegration.updateData(e,t)}t.updateData=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(0);var o=function(){function e(e,t,r,n,o,i){this.checkMyAnswer=e;this.dataModel=t;this.eventController=r;this.correctData=n;this.Spreadsheet=o;this.getData=i;this.tolerance=0;this.precision=2;this.validationObj=null;this.setCorrectData(n)}e.prototype.init=function(){if(!this.dataModel.getButtonVisibility("checkAnswerButton")){this.checkMyAnswer.hidden="hidden";this.checkMyAnswer.style.height=0}else{this.attachEvents()}this.registerEvents();this.tolerance=this.dataModel.getValidationTolerance();this.precision=this.dataModel.getValidationPrecision()};e.prototype.attachEvents=function(){this.checkMyAnswer.addEventListener("click",this.handleCheckAnswerClick.bind(this))};e.prototype.registerEvents=function(){this.eventController.registerEvent(n.Events.GradingEvents.RENDER_RESULT);this.eventController.registerEvent(n.Events.GradingEvents.TRY_AGAIN)};e.prototype.getCellGrade=function(e,t){if(typeof e==="string")e=e.trim();if(typeof t==="string")t=t.trim();if(t===""||e===""){if(e===""&&t===""){return n.GRADINGCODES.CORRECT}else if(e===""){return n.GRADINGCODES.MISSING}else{return n.GRADINGCODES.INCORRECT}}else{if(isNaN(Number(t))){if(e===t){return n.GRADINGCODES.CORRECT}else{return n.GRADINGCODES.INCORRECT}}else{if(isNaN(Number(e))){return n.GRADINGCODES.INCORRECT}else{var r=Number(t);var o=Number(Number(e).toFixed(this.precision));var i=this.tolerance/100*r;var a=Number((r+i).toFixed(this.precision));var s=Number((r-i).toFixed(this.precision));if(o>=s&&o<=a){return n.GRADINGCODES.CORRECT}else{return n.GRADINGCODES.INCORRECT}}}}};e.prototype.updateCellArrayFromRange=function(e,t){var r=e["from"]["row"];var n=e["from"]["col"];var o=e["to"]["row"];var i=e["to"]["col"];for(var a=r;a<=o;++a){for(var s=n;s<=i;++s){t.push({row:a,col:s})}}};e.prototype.createCellGradingObject=function(e,t,r){if(!r[e])r[e]={};r[e][t]={grade:{}}};e.prototype.runValidationFromnJson=function(e,t,r){for(var o=0;o<e.length;++o){var i=void 0;var a=void 0;var s=void 0;var l=void 0;var u=[];if(e[o]["cells"])u=e[o]["cells"];if(e[o]["cellRange"]){this.updateCellArrayFromRange(e[o]["cellRange"],u)}for(var d=0;d<u.length;++d){i=u[d]["row"];a=u[d]["col"];this.createCellGradingObject(i,a,r);s=t[i][a];l=this.correctData[i][a];r[i][a]["grade"]=this.getCellGrade(s,l);if(e[o]["rule"]=="all"){if(r[i][a]["grade"]==n.GRADINGCODES.INCORRECT||r[i][a]["grade"]==n.GRADINGCODES.MISSING){for(var f=0;f<u.length;++f){i=u[f]["row"];a=u[f]["col"];this.createCellGradingObject(i,a,r);r[i][a]["grade"]=n.GRADINGCODES.INCORRECT}if(e[o]["errorDetails"]){var c=e[o]["errorDetails"]["row"];var h=e[o]["errorDetails"]["col"];r[c][h]["comment"]=e[o]["errorDetails"]["comment"]}break}}}}};e.prototype.handleCheckAnswerClick=function(){var e={};var t=this.dataModel.getUserData();var r=this.getData.call(this.Spreadsheet);if(this.validationObj!=null){this.runValidationFromnJson(this.validationObj,r,e)}else{for(var o=0;o<r.length;o++){e[o]={};for(var i=0;i<r[o].length;i++){var a=this.dataModel.isReadOnly({row:o,column:i});if(a===false){e[o][i]={};e[o][i]["grade"]={};e[o][i]["comment"]={};var s=r[o][i];if(typeof s==="string")s=s.trim();var l=this.correctData[o][i];if(typeof l==="string")l=l.trim();if(l===""||s===""){if(s===""&&l===""){e[o][i].grade=n.GRADINGCODES.BLANK}else if(s===""){e[o][i].grade=n.GRADINGCODES.MISSING}else{e[o][i].grade=n.GRADINGCODES.INCORRECT}}else{if(isNaN(Number(l))){if(s===l){e[o][i].grade=n.GRADINGCODES.CORRECT}else{e[o][i].grade=n.GRADINGCODES.INCORRECT}}else{if(isNaN(Number(s))){e[o][i].grade=n.GRADINGCODES.INCORRECT}else{var u=Number(l);var d=Number(Number(s).toFixed(this.precision));var f=Math.abs(this.tolerance/100*u);var c=Number((u+f).toFixed(this.precision));var h=Number((u-f).toFixed(this.precision));if(d>=h&&d<=c){e[o][i].grade=n.GRADINGCODES.CORRECT}else{e[o][i].grade=n.GRADINGCODES.INCORRECT}}}}e[o][i].comment=this.getComment(s,l,e[o][i].grade)}else{continue}}}}this.dataModel.setGradingResult(e)};e.prototype.getComment=function(e,t,r){if(r==n.GRADINGCODES.CORRECT){return"Your value is correct"}else if(r==n.GRADINGCODES.INCORRECT){if(t==""){return"This cell should be Empty."}else{return"Correct value is: "+t}}else if(r==n.GRADINGCODES.MISSING){return"You did not enter a value. Correct value is : "+t}else if(r==n.GRADINGCODES.BLANK){return"Your value is correct."}};e.prototype.setCorrectData=function(e){if(e instanceof Array){this.correctData=e}else{if(e.correctData){this.correctData=e.correctData}if(e.validationJson){this.validationObj=e.validationJson}}};return e}();t.CheckAnswer=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(){this.data=[[""]];this.styles={};this.columns={};this.rows={};this.mergedranges=[];this.hints=[];this.feedbacks=[];this.options={};this.modeconfig={}}return e}();t.Config=n;var o=function(){function e(e,t){this.cell=new i(e,t)}return e}();t.currentState=o;var i=function(){function e(e,t){this.row=e;this.col=t}return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t,r){this.exportConfigBtn=e;this.exportCorrectDataBtn=t;this.dataModel=r}e.prototype.init=function(){var e=this.dataModel.getUserRole();if(e==="student"){this.exportConfigBtn.hidden="hidden";this.exportCorrectDataBtn.hidden="hidden";this.exportConfigBtn.style.height=0;this.exportCorrectDataBtn.style.height=0}else{this.attachEvents()}};e.prototype.attachEvents=function(){this.exportConfigBtn.addEventListener("click",this.handleExportConfigClick.bind(this));this.exportCorrectDataBtn.addEventListener("click",this.handleExportCorrectDataClick.bind(this))};e.prototype.handleExportConfigClick=function(e){var t=this.dataModel.getdataJsonForStudent();this.downloadData(t)};e.prototype.handleExportCorrectDataClick=function(e){var t=this.dataModel.getdataJsonForStudent().data;this.downloadData(t)};e.prototype.downloadData=function(e){var t="data:application/octet-stream;charset=utf-8,"+encodeURIComponent(JSON.stringify(e));var r=document.createElement("a");r.setAttribute("href",t);r.setAttribute("download","leonardoData.json");r.click()};return e}();t.ExportData=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(0);var o=function(){function e(e,t,r,n,o,i){this.hintBtn=e;this.hints=t;this.dataModel=r;this.eventController=n;this.spreadsheet=o;this.getDataAtCell=i}e.prototype.init=function(){if(!this.dataModel.getButtonVisibility("hintButton")){this.hintBtn.hidden="hidden";this.hintBtn.style.height=0}else{this.attachEvents();this.registerEvents()}};e.prototype.attachEvents=function(){this.hintBtn.addEventListener("click",this.handleHintBtnClick.bind(this))};e.prototype.registerEvents=function(){this.eventController.registerEvent(n.Events.HintEvents.RENDER_HINT)};e.prototype.handleHintBtnClick=function(){for(var e=0;e<this.hints.length;e++){var t=this.hints[e];var r=this.isHintRequired(t);if(r){this.dataModel.updateHintData(t.from,t.to,t.expectedvalues,t);var n=e===this.hints.length-1?true:false;return{isLastHint:n}}}return{isLastHint:true}};e.prototype.isHintRequired=function(e){var t=e.from,r=e.to;var n=false;for(var o=0;o<=r.row-t.row&&!n;o++){for(var i=0;i<=r.col-t.col&&!n;i++){if(this.getUserDataAtCell(t.row+o,t.col+i)!=e.expectedvalues[o][i]){n=true}}}return n};e.prototype.getUserDataAtCell=function(e,t){return this.getDataAtCell.call(this.spreadsheet,e,t)};return e}();t.Hints=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(0);var o=r(9);var i=function(){function e(e,t,r,n){this.guid=e;this.dataJson=t;this.spreadsheetEventController=r;this.spreadsheetsData=n;this.bRibbonCollapsed=false;this.RationalizeDataJson();this.initialConfig=JSON.parse(JSON.stringify(this.dataJson));if(this.dataJson.options==null){this.dataJson.options={}}this.init()}e.prototype.RationalizeDataJson=function(){var e=this.dataJson.data[0].length;for(var t=0;t<this.dataJson.data.length;t++){var r=this.dataJson.data[t];var n=r.length;if(n<e){for(var o=n;o<e;o++){r[o]=""}}}};e.prototype.init=function(){this.registerEvents();this.setCurrentSelectedCell()};e.prototype.registerEvents=function(){for(var e in n.Events.DataModelEvents){this.spreadsheetEventController.registerEvent(n.Events.DataModelEvents[e])}};e.prototype.checkValidCurrentRef=function(){var e=this.dataJson.currentState;if(e&&e.cell&&(!isNaN(e.cell.row)&&e.cell.row.toString()!=="")&&(!isNaN(e.cell.col)&&e.cell.col.toString()!=="")){e.cell.row=Number(e.cell.row);e.cell.col=Number(e.cell.col);return true}else return false};e.prototype.setCurrentSelectedCell=function(){if(!this.checkValidCurrentRef()){this.dataJson["currentState"]=new o.currentState(0,0)}};e.prototype.getSelectedCellVal=function(){var e=this.getSelectedCell();return this.getCellValue(e.row,e.column)};e.prototype.getSelectedCell=function(){return{row:this.dataJson.currentState.cell.row,column:this.dataJson.currentState.cell.col}};e.prototype.getCellValue=function(e,t){return this.dataJson.data[e][t]};e.prototype.setSelectedCellVal=function(e,t,r){var o=this.getSelectedCell();this.setCellValue(o,t);var i={eventName:n.Events.ViewEvents.SELECTED_CELL_VALUE_CHANGED,viewId:e,type:r.type};this.dispatchEvent(i)};e.prototype.setCellValue=function(e,t){this.dataJson.data[e.row][e.column]=t};e.prototype.setMultipleCellValue=function(e,t,r,o){var i=Math.abs(t.endRow-t.startRow);var a=Math.abs(t.endCol-t.startCol);for(var s=t.startRow,l=0;s<=t.endRow;s++,l++){for(var u=t.startCol,d=0;u<=t.endCol;u++,d++){var f=l>=r.length?l%r.length:l;var c=l>=r[f].length?d%r[f].length:d;if(!this.isReadOnly({row:s,column:u})){this.setCellValue({row:s,column:u},r[f][c])}}}var h={eventName:n.Events.ViewEvents.SELECTED_CELL_VALUE_CHANGED,viewId:e,type:o.type};this.dispatchEvent(h)};e.prototype.setSelectedCell=function(e,t,r){if(this.dataJson.currentState.cell.row!==t||this.dataJson.currentState.cell.col!==r){this.setCellSelection(t,r);var o={eventName:n.Events.ViewEvents.SELECTED_CELL_CHANGED,viewId:e};this.dispatchEvent(o)}};e.prototype.setCellSelection=function(e,t){if(!this.dataJson.data){this.dataJson["data"]=[]}var r=this.dataJson.data;if(+e>r.length-1){for(var n=r.length;n<=+e;n++){r[n]=[]}}if(+t>r[+e].length){for(var o=r[+e].length;o<=+t;o++){r[+e][o]=""}}this.dataJson.currentState.cell.row=e;this.dataJson.currentState.cell.col=t;for(var i=0;i<r.length;i++){if(+t>=r[i].length){for(var n=r[i].length;n<=+t;n++){r[i].push("")}}}};e.prototype.incorrectCellRef=function(e){this.dataJson.currentState.cell.row=0;this.dataJson.currentState.cell.col=0;var t={eventName:n.Events.ViewEvents.INCORRECT_CELL_REFERENCE,viewId:e};this.dispatchEvent(t)};e.prototype.dispatchEvent=function(e){this.spreadsheetEventController.dispatchEvent(n.Events.DataModelEvents.BROADCAST_EVENT,e)};e.prototype.countRows=function(){return this.dataJson.data.length};e.prototype.countCols=function(){return this.dataJson.data[0].length};e.prototype.getUserData=function(){return JSON.parse(JSON.stringify(this.dataJson.data))};e.prototype.updateData=function(e){this.dataJson.data=JSON.parse(JSON.stringify(e));var t={eventName:n.Events.ViewEvents.UPDATE_DATA};this.dispatchEvent(t)};e.prototype.getRowsConfig=function(){return this.dataJson.rows};e.prototype.getCellProps=function(e,t){if(this.dataJson.rows){var r=this.dataJson.rows;if(r[e]){if(r[e].cells){return r[e].cells[t]||{}}}}return{}};e.prototype.getdataJsonForStudent=function(){var e=this.getUserRole();if(e&&e==="instructor"){this.dataJson.modeconfig["role"]="student";this.dataJson.options["contextMenu"]=false;this.dataJson.options["minSpareRows"]=0;delete this.dataJson.currentState}return this.dataJson};e.prototype.getdataJSON=function(){return JSON.parse(JSON.stringify(this.dataJson))};e.prototype.getButtonVisibility=function(e){return this.dataJson.modeconfig[{hintButton:"showHintsBtn",checkAnswerButton:"showCheckAnswerBtn",resetButton:"showResetBtn"}[e]]};e.prototype.getUserRole=function(){return this.dataJson.modeconfig["role"]?this.dataJson.modeconfig["role"]:"student"};e.prototype.isTopBarHidden=function(){return this.dataJson.modeconfig["hideTopBar"]?this.dataJson.modeconfig["hideTopBar"]:false};e.prototype.isRibbonVisible=function(){return this.dataJson.modeconfig["showRibbon"]?this.dataJson.modeconfig["showRibbon"]:false};e.prototype.getHostAppRootPath=function(){return this.dataJson.modeconfig["hostAppRootPath"]?this.dataJson.modeconfig["hostAppRootPath"]:""};e.prototype.pushMergedRange=function(e,t){if(!this.dataJson.mergedranges){this.dataJson["mergedranges"]=[]}var r=this.getMergeStateInfo(e.row,e.col);if(r.status==="true"){if(t==null||t===false){this.dataJson["mergedranges"].splice(r["index"],1)}}else{this.dataJson.mergedranges.push(e)}};e.prototype.getDefaultROVal=function(){return this.dataJson.options["readOnly"]!==undefined?this.dataJson.options["readOnly"]:false};e.prototype.getLeoGUID=function(){return this.guid};e.prototype.getSheetNames=function(){return this.dataJson.sheetNames};e.prototype.getContainerStyles=function(){return this.dataJson["options"]["containerStyles"]};e.prototype.isHeadersPresent=function(e){return this.dataJson.options[e]===true};e.prototype.getValidationTolerance=function(){return this.dataJson.options["tolerance"]||0};e.prototype.getValidationPrecision=function(){return this.dataJson.options["precision"]||2};e.prototype.updateHintData=function(e,t,r,o){this.updateHintStyles(o);this.updateCellData(e,t,r);var i={eventName:n.Events.HintEvents.RENDER_HINT,hintMeta:o,viewId:n.VIEWIDs.DEFAULT};this.dispatchEvent(i)};e.prototype.setGradingResult=function(e){if(this.dataJson.options["preventEditingOnCheckAnswer"]!=false){this.setTableReadOnly()}var t={eventName:n.Events.GradingEvents.RENDER_RESULT,gradingResult:e};this.dispatchEvent(t)};e.prototype.resetGradingResult=function(){var e=false;if(this.dataJson.options["preventEditingOnCheckAnswer"]!=false){this.setReadOnlyProptoOriginalState();e=true}var t={eventName:n.Events.GradingEvents.TRY_AGAIN,readOnlyStateChanged:e};this.dispatchEvent(t)};e.prototype.updateCellData=function(e,t,r){for(var n=0;n<=t.row-e.row;n++){for(var o=0;o<=t.col-e.col;o++){var i={row:e.row+n,column:e.col+o};this.setCellValue(i,r[n][o])}}};e.prototype.updateCellProperties=function(e,t,r,n){var o=t.from,i=t.to;var a=this.dataJson.rows;if(a==null){a={}}for(var s=o.col;s<=i.col;s++){for(var l=o.row;l<=i.row;l++){if(a[l]==null){a[l]={}}if(a[l].cells==null){a[l]["cells"]={}}if(a[l].cells[s]==null){a[l].cells[s]={}}var u=a[l].cells[s];if(u[e.name]){if(n==null||n===false){delete u[e.name]}}else{u[e.name]=e.value}}}};e.prototype.handleRibbonEvents=function(e,t){var r=n.RIBBON_OPTIONS[e],o=r.property,i=r.type;if(i==="cellStyle"){this.updateCellProperties(o,t,i)}else if(i==="other"){if(o.name==="mergedranges"){var a=void 0,s=void 0;var l=t.from;var u=t.to;if(l.row===u.row){a=l.col<=u.col?l:u;s=l.col<=u.col?u:l}else if(l.col===u.col){a=l.row<=u.row?l:u;s=l.row<=u.row?u:l}else{a=l.row<=u.row&&l.col<=u.col?l:u;s=l.row<=u.row&&l.col<=u.col?u:l}var d=a.row,f=a.col;var c=s.row-a.row+1;var h=s.col-a.col+1;this.pushMergedRange({row:d,col:f,rowspan:c,colspan:h})}}var m={eventName:n.Events.RIBBON_EVENTS.RENDER_GRID,eventData:{property:o,selectedRange:t,type:i}};this.dispatchEvent(m)};e.prototype.getMergedRanges=function(){return this.dataJson.mergedranges||[]};e.prototype.getCellMetaDataForRibbon=function(e,t){var r=this.getCellProps(e,t);var n=this.getMergeStateInfo(e,t);r["mergedranges"]=n.status;return r};e.prototype.getMergeStateInfo=function(e,t){var r=this.getMergedRanges();for(var n=0;n<r.length;n++){if(r[n].row<=e&&r[n].row+r[n].rowspan-1>=e&&r[n].col<=t&&r[n].col+r[n].colspan-1>=t){return{status:"true",index:n}}}return{status:"false"}};e.prototype.setRibbonCollapsedState=function(e,t){this.bRibbonCollapsed=t;var r={eventName:n.Events.RIBBON_EVENTS.RIBBON_COLLAPSED,viewId:e};this.dispatchEvent(r)};e.prototype.isRibbonCollapsed=function(){return this.bRibbonCollapsed};e.prototype.getRefCellValue=function(e,t,r){if(this.spreadsheetsData[e]&&this.spreadsheetsData[e].model.dataJson.data[r]&&this.spreadsheetsData[e].model.dataJson.data[r][t]!=null){return this.spreadsheetsData[e].model.dataJson.data[r][t]}return"#REF!"};e.prototype.getLeoAlignment=function(){return this.dataJson.modeconfig["LeoHorizontalAlignment"]};e.prototype.updateHintStyles=function(e){var t=this;if(e.mergedranges){e.mergedranges.forEach(function(e){t.pushMergedRange(e,true)})}if(e.styles&&e.styles.fontWeight){this.updateCellProperties({name:"fontWeight",value:"bold"},{from:e.from,to:e.to},"cellStyle",true)}};e.prototype.isReadOnly=function(e){var t=e.row,r=e.column;var n=this.getDefaultROVal();var o=this.getRowsConfig();var i=n;if(o[t]!=null&&o[t].cells!=null&&o[t].cells[r]!=null){var a=this.getCellProps(t,r);if(a.readOnly!=null){i=a.readOnly}}if(i===false){return false}else{return true}};e.prototype.isOriginallyReadOnly=function(e){var t=e.row,r=e.column;var n=this.initialConfig.options["readOnly"]||false;var o=this.initialConfig.rows;var i=n;if(o[t]!=null&&o[t].cells!=null&&o[t].cells[r]!=null){var a=o[t].cells[r];if(a.readOnly!=null){i=a.readOnly}}return i};e.prototype.setTableReadOnly=function(){if(this.dataJson.options["readOnly"]!==undefined){this.dataJson.options["readOnly"]=true}this.updateCellProperties({name:"readOnly",value:true},{from:{row:0,col:0},to:{row:this.dataJson.data.length-1,col:this.dataJson.data[0].length-1}},"checkanwser",true)};e.prototype.setReadOnlyProptoOriginalState=function(){if(this.initialConfig.options["readOnly"]){this.dataJson.options["readOnly"]=this.initialConfig.options["readOnly"]}else{this.dataJson.options["readOnly"]=false}var e={row:0,col:0};var t={row:this.initialConfig.data.length-1,col:this.initialConfig.data[0].length-1};var r=this.initialConfig.rows;if(r!=null){for(var n=e.row;n<=t.row;n++){for(var o=e.col;o<=t.col;o++){if(!this.isOriginallyReadOnly({row:n,column:o})){this.dataJson.rows[n].cells[o]["readOnly"]=false}}}}};e.prototype.resetGrid=function(){var e=this.getCloneObj(this.dataJson.currentState);this.dataJson=this.getCloneObj(this.initialConfig);this.dataJson.currentState=e;this.setCellSelection(e.cell.row,e.cell.col);var t={eventName:n.Events.ViewEvents.RESET_GRID};this.dispatchEvent(t)};e.prototype.getCloneObj=function(e){return JSON.parse(JSON.stringify(e))};return e}();t.DataModel=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});var o=r(0);var i=r(1);var a=function(e){n(t,e);function t(t,r,n){var o=e.call(this)||this;o.resetGridBtn=t;o.dataModel=r;o.eventController=n;return o}t.prototype.init=function(){if(!this.dataModel.getButtonVisibility("resetButton")){this.resetGridBtn.hidden="hidden";this.resetGridBtn.style.height=0}else{this.attachEvents()}this.registerEvents()};t.prototype.attachEvents=function(){this.resetGridBtn.addEventListener("click",this.handleResetGridClick.bind(this))};t.prototype.registerEvents=function(){this.eventController.registerEvent(o.Events.ViewEvents.RESET_GRID)};t.prototype.handleResetGridClick=function(e){this.dataModel.resetGrid()};return t}(i.BaseView);t.Reset=a},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var n=r(3);var o=r(12);var i=r(15);var a=r(17);var s=r(19);var l=r(11);var u=r(8);var d=r(10);var f=r(18);var c=r(0);var h=r(13);r(27);var m=function(){function t(e,t,r,c,m,p,v,g){this.container=e;this.scrollBaroffset=2;this.managerEventController=c;this.spreadsheetId=m;this.eventController=new n.EventController;var w=e.querySelector(".DLSLeonardo").getAttribute("guid");this.model=new o.DataModel(w,t,this.eventController,p);this.sheetTabBar=new f.SheetTabBar(e.querySelector("#sheetTabBar"),this.model);this.resetGrid=new h.Reset(e.querySelector("#resetGridBtn"),this.model,this.eventController);this.grid=new i.Grid(e.querySelector("#grid"),t,this.model,this.eventController,v,g);this.topBar=new s.TopBar(e.querySelector(".formulaToolbar"),this.model,this.eventController);this.ribbon=new a.Ribbon(e,this.model,this.eventController);this.hints=new l.Hints(e.querySelector("#hintBtn"),t.hints,this.model,this.eventController,this,this.getDataAtCell);this.checkAnswer=new u.CheckAnswer(e.querySelector("#checkMyAnswer"),this.model,this.eventController,r,this,this.getUserData);this.exportData=new d.ExportData(e.querySelector("#exportConfigBtn"),e.querySelector("#exportCorrectDataBtn"),this.model)}t.prototype.init=function(){this.registerEvents();this.hints.init();this.checkAnswer.init();this.resetGrid.init();this.ribbon.init();this.topBar.init();this.grid.init();this.exportData.init();this.sheetTabBar.init();this.registerEventListeners();this.handleButtonGroupVisibility();this.resetGridDimensions();this.addCssPRopertiesTocontainer();e.refresh()};t.prototype.addCssPRopertiesTocontainer=function(){var e=this.model.getContainerStyles();if(e){var t=document.createElement("style");t.type="text/css";var r=document.createTextNode(".ContainerClass"+e);t.appendChild(r);document.head.appendChild(t);var n=this.container.querySelector("#leoContainer");n.classList.add("ContainerClass")}};t.prototype.destroy=function(){this.deregisterEventListeners()};t.prototype.registerEvents=function(){var e=this;for(var t in c.Events.ViewEvents){this.eventController.registerEvent(c.Events.ViewEvents[t])}for(var r in c.Events.HintEvents){this.eventController.registerEvent(c.Events.HintEvents[r])}for(var n in c.Events.GRID_EVENTS){this.eventController.registerEvent(c.Events.GRID_EVENTS[n])}addResizeListener(this.container.querySelector(".DLSLeonardo"),function(){e.resetGridDimensions()})};t.prototype.registerEventListeners=function(){this.managerEventController.addEventListener(c.Events.LeonardoManagerEvents.FORMULAMODE_OPEN_EVENT,this.enableFormulaMode.bind(this));this.managerEventController.addEventListener(c.Events.LeonardoManagerEvents.FORMULAMODE_CLOSE_EVENT,this.disableFormulaMode.bind(this));this.managerEventController.addEventListener(c.Events.LeonardoManagerEvents.FORMULAMODE_CHANGE_EVENT,this.changeFullEditConfig.bind(this));this.managerEventController.addEventListener(c.Events.LeonardoManagerEvents.REMOTECELLVAL_CHANGED_EVENT,this.handleRemoteGridRender.bind(this));this.eventController.addEventListener(c.Events.ViewEvents.EDITING_EVENTt,this.handleGridFormulaModeEvent.bind(this));this.eventController.addEventListener(c.Events.DataModelEvents.BROADCAST_EVENT,this.BroadcastEvent.bind(this));this.eventController.addEventListener(c.Events.RIBBON_EVENTS.STYLE_EVENT,this.handleRibbonEvents.bind(this));this.eventController.addEventListener(c.Events.RIBBON_EVENTS.RIBBON_COLLAPSED,this.resetGridDimensions.bind(this));this.eventController.addEventListener(c.Events.GRID_EVENTS.COL_RESIZE,this.resetGridDimensions.bind(this))};t.prototype.deregisterEventListeners=function(){this.managerEventController.removeEventListener(c.Events.LeonardoManagerEvents.FORMULAMODE_OPEN_EVENT,this.enableFormulaMode);this.managerEventController.removeEventListener(c.Events.LeonardoManagerEvents.FORMULAMODE_CLOSE_EVENT,this.disableFormulaMode);this.managerEventController.removeEventListener(c.Events.LeonardoManagerEvents.FORMULAMODE_CHANGE_EVENT,this.changeFullEditConfig);
this.managerEventController.removeEventListener(c.Events.LeonardoManagerEvents.REMOTECELLVAL_CHANGED_EVENT,this.handleRemoteGridRender);this.eventController.removeAllEvents()};t.prototype.BroadcastEvent=function(e){this.eventController.dispatchEvent(e.eventName,e)};t.prototype.getUserData=function(e){return this.grid.getData()};t.prototype.getDataAtCell=function(e,t){return this.grid.getDataAtCell(e,t)};t.prototype.checkMyAnswer=function(e){if(e){this.checkAnswer.setCorrectData(e)}this.checkAnswer.handleCheckAnswerClick()};t.prototype.showButtonGroup=function(){var e=this.model.getUserRole();var t=this.model.getButtonVisibility("checkAnswerButton");var r=this.model.getButtonVisibility("hintButton");var n=this.model.getButtonVisibility("resetButton");if(e=="instructor"||t||r||n)return true;else return false};t.prototype.handleButtonGroupVisibility=function(){if(this.showButtonGroup()===false){this.container.querySelector("#buttonGroup").hidden="hidden"}};t.prototype.displayHint=function(){return this.hints.handleHintBtnClick()};t.prototype.reset=function(){return this.resetGrid.handleResetGridClick()};t.prototype.tryAgain=function(){this.model.resetGradingResult()};t.prototype.getData=function(){return this.model.getUserData()};t.prototype.updateData=function(e){return this.model.updateData(e)};t.prototype.getAvailableDimensions=function(){var e=this.container.querySelector(".DLSLeonardo");var t=e.offsetWidth;var r=e.offsetHeight;if(this.showButtonGroup()){r-=35}if(!this.model.isTopBarHidden()){r-=25}if(this.model.isRibbonVisible()){if(this.model.isRibbonCollapsed()){r-=30}else{r-=121}}if(this.model.getSheetNames()!=null){r-=25}return{width:t,height:r}};t.prototype.getrequiredContainerHeight=function(e){var t=e;if(this.showButtonGroup()){t+=35}if(!this.model.isTopBarHidden()){t+=25}if(this.model.isRibbonVisible()){if(this.model.isRibbonCollapsed()){t+=30}else{t+=121}}if(this.model.getSheetNames()!=null){t+=25}return t};t.prototype.resetGridDimensions=function(){var e=this.getAvailableDimensions();var t=this.grid.getDimensions();t.height+=this.scrollBaroffset;t.width+=this.scrollBaroffset;var r=e.height<t.height?e.height:t.height+16;var n=e.width<t.width?e.width:t.width+16;this.grid.updateSettings({height:r,width:n});var o=this.grid.hasHorizontalScroll();var i=this.grid.hasVericalScroll();var a=this.container.querySelector(".DLSLeonardo");if(o){a.classList.add("hasHorizontalScroll")}else{a.classList.remove("hasHorizontalScroll")}if(i){a.classList.add("hasVerticalScroll")}else{a.classList.remove("hasVerticalScroll")}var s=a.querySelector(".formulaToolbar");var l=a.querySelector("#buttonGroup");var u=a.querySelector("#sheetTabBar");var d=a.querySelector("#SIMArea");var f=a.querySelector("#grid");var c=a.querySelector("#leoContainer");f.style.height=r+"px";f.style.width=n+"px";var h=n;var m=this.getrequiredContainerHeight(r);if(o||i){this.scrollBaroffset=5}else{this.scrollBaroffset=2;h-=15;m-=15}h+="px";s.style.width=h;l.style.width=h;u.style.width=h;d.style.width=parseInt(h)>814?h:"814px";c.style.width=parseInt(h)+"px";c.style.height=m+"px";if(this.model.isRibbonVisible()&&parseInt(h)<814){c.style.width="818px"}if(this.model.getLeoAlignment()=="center"){if(this.model.isRibbonVisible()){if(e.width>814){var p=Math.round((e.width-814)/2)+"px";c.style.left=p}else{c.style.left="0px"}}else{if(e.width>n){var p=Math.round((e.width-n)/2)+"px";c.style.left=p}else{c.style.left="0px"}}}};t.prototype.handleRibbonEvents=function(e){var t=e.eventID;var r=this.grid.getSelected();if(r){var n={row:r[0],col:r[1]};var o={row:r[2],col:r[3]};this.model.handleRibbonEvents(t,{from:n,to:o})}else{console.log("No Cell or Range selected")}};t.prototype.enableFormulaMode=function(e){if(e.sheetId!=this.spreadsheetId){this.grid.enableRemoteGridFormulaMode()}};t.prototype.disableFormulaMode=function(e){if(e.sheetId!=this.spreadsheetId){this.grid.disableRemoteGridFormulaMode()}};t.prototype.changeFullEditConfig=function(e){if(e.sheetId!=this.spreadsheetId){this.grid.changeFulledit(e.sheetId,e.value,e.sheetName)}};t.prototype.handleGridFormulaModeEvent=function(e){e["sheetId"]=this.spreadsheetId;if(e.type=="gridKeyPressed"){this.handleGridKeyDown(e)}else{this.managerEventController.dispatchEvent(c.Events.SpreadsheetEvents.MANAGER_BROADCAST_EVENT,e)}};t.prototype.handleRemoteGridRender=function(e){if(e.sheetId!=this.spreadsheetId){this.grid.handleRemoteGridChange()}};t.prototype.handleGridKeyDown=function(e){var t={eventName:c.Events.ViewEvents.GRIDKEYPRESSED,event:e};this.BroadcastEvent(t)};return t}();t.SpreadsheetController=m}).call(t,r(22))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});var o=r(0);var i=r(1);var a=r(16);var s=function(e){n(t,e);function t(t,r,n,i,a,s){var l=e.call(this)||this;l.container=t;l.dataModel=n;l.eventController=i;l.sheetNameIdMap=a;l.viewId=o.VIEWIDs.GRID;l.leoConfig={sheets:[]};l.leoConfig["sheets"].push(JSON.parse(JSON.stringify(r)));l.sheets=l.InitializeSheets(l.leoConfig,t,n,l.eventController,l.sheetNameIdMap,s);return l}t.prototype.init=function(){e.prototype.init.call(this)};t.prototype.registerEventListeners=function(){this.eventController.addEventListener(o.Events.ViewEvents.SELECTED_CELL_VALUE_CHANGED,this.updateCurrentCellValue.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.SELECTED_CELL_CHANGED,this.updateCurrentSelectedCell.bind(this));this.eventController.addEventListener(o.Events.HintEvents.RENDER_HINT,this.renderHint.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.GRIDKEYPRESSED,this.updateGridText.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.INCORRECT_CELL_REFERENCE,this.updateGridSelection.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.UPDATE_DATA,this.updataGridData.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.RESET_GRID,this.resetGrid.bind(this));this.eventController.addEventListener(o.Events.RIBBON_EVENTS.RENDER_GRID,this.renderRibbonStyles.bind(this));this.eventController.addEventListener(o.Events.GRID_EVENTS.MESSAGE,this.handleGridWrapperMessages.bind(this));this.eventController.addEventListener(o.Events.GradingEvents.RENDER_RESULT,this.renderGradingResults.bind(this));this.eventController.addEventListener(o.Events.GradingEvents.TRY_AGAIN,this.tryAgain.bind(this))};t.prototype.InitializeSheets=function(e,t,r,n,o,i){var s=this;var l={};var u=0;var d=function(t){var d=e.sheets[t];var c=f.createSheetContainer(f.container,t);var h=f.getGUID()+"_"+t;l[t]=new a.HotWrapper(c,d,r,n,o,h,i);c.addEventListener("click",function(){s.setFocus(c,10)});c.addEventListener("keydown",function(e){if(e.ctrlKey||e.metaKey){s.setFocus(c,50)}else{s.setFocus(c,0)}});if(d.active=true){u=t}};var f=this;for(var c=0;c<e.sheets.length;c++){d(c)}this.ActivateSheet(u);return l};t.prototype.setFocus=function(e,t){var r=this;setTimeout(function(){if(document.activeElement===document.body){var t=-1;var n=r.container.parentElement;while(n=n.parentElement){if(n.scrollTop!=0){t=n.scrollTop;break}else if(n===document.body){break}}e.focus();if(t!=-1){n.scrollTop=t}else{n=r.container.parentElement;while(n=n.parentElement){if(n.scrollTop!=0){n.scrollTop=0;break}else if(n===document.body){break}}}}},t)};t.prototype.ActivateSheet=function(e){this.activeSheetIndex=e};t.prototype.getActiveSheet=function(){return this.activeSheetIndex};t.prototype.createSheetContainer=function(e,t){var r=document.createElement("div");r.setAttribute("id","grid_"+(t+1));r.setAttribute("tabindex","-1");r.classList.add("hotHost");e.appendChild(r);return r};t.prototype.updateCurrentCellValue=function(e,t){if(t===void 0){t=this.getActiveSheet()}if(e.viewId==this.getViewId()){return}else{this.sheets[t].updateCurrentCellValue(e)}};t.prototype.updateCurrentSelectedCell=function(e,t){if(t===void 0){t=this.getActiveSheet()}if(e.viewId==this.getViewId()){return}else{this.sheets[t].updateCurrentSelectedCell(e)}};t.prototype.selectCell=function(e,t,r,n,o,i,a){if(a===void 0){a=this.getActiveSheet()}return this.sheets[a].selectCell(e,t,r,n,o,i)};t.prototype.setDataAtCell=function(e,t,r,n,o){if(o===void 0){o=this.getActiveSheet()}return this.sheets[o].setDataAtCell(e,t,r,n)};t.prototype.getSourceDataAtCell=function(e,t,r){if(r===void 0){r=this.getActiveSheet()}return this.sheets[r].getSourceDataAtCell(e,t)};t.prototype.getSelected=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].getSelected()};t.prototype.getSelectedCell=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].getSelectedCell()};t.prototype.render=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].render()};t.prototype.getDataAtCell=function(e,t,r){if(r===void 0){r=this.getActiveSheet()}return this.sheets[r].getDataAtCell(e,t)};t.prototype.setCellMeta=function(e,t,r,n,o){if(o===void 0){o=this.getActiveSheet()}return this.sheets[o].setCellMeta(e,t,r,n)};t.prototype.getPlugin=function(e,t){if(t===void 0){t=this.getActiveSheet()}return this.sheets[t].getPlugin(e)};t.prototype.countRows=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].countRows()};t.prototype.countCols=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].countCols()};t.prototype.getCellMeta=function(e,t,r){if(r===void 0){r=this.getActiveSheet()}return this.sheets[r].getCellMeta(e,t)};t.prototype.getData=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].getData()};t.prototype.getGUID=function(e){if(e===void 0){e=this.getActiveSheet()}return this.dataModel.getLeoGUID()};t.prototype.getGridGUID=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].getGridGUID()};t.prototype.handleGridRendering=function(e,t,r){if(r===void 0){r=this.getActiveSheet()}if(e){this.sheets[r].handleGridRendering(e,t)}};t.prototype.setCellTooltip=function(e,t,r){if(r===void 0){r=this.getActiveSheet()}this.sheets[r].setCellTooltip(e,t)};t.prototype.updateSettings=function(e,t,r){if(r===void 0){r=this.getActiveSheet()}this.sheets[r].updateSettings(e,t)};t.prototype.getDimensions=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].getDimensions()};t.prototype.getGridWidth=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].gridWidth()};t.prototype.getGridHeight=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].getGridHeight()};t.prototype.renderGradingResults=function(e){this.renderGrading(e.gradingResult,o.GRADINGCODES,o.GradingUIConfig)};t.prototype.renderGrading=function(e,t,r,n){if(n===void 0){n=this.getActiveSheet()}var o;var i;this.sheets[n].updateSettings({cell:this.sheets[n].getAllCellProps()});this.gradObj=e;for(o in e){for(i in e[o]){var a=e[o][i].grade;if((a==t.INCORRECT||a==t.MISSING)&&e[o][i].comment){this.sheets[n].setCommentAtCell(o,i,e[o][i].comment)}else{this.sheets[n].removeCommentAtCell(o,i)}var s=this.sheets[n].getCellMeta(o,i);if(s.originalProp==null&&s.renderingProps!=null){this.sheets[n].setOriginalRenderingProps(o,i,JSON.parse(JSON.stringify(s.renderingProps)))}switch(a){case t.BLANK:{var l=s.originalProp;this.sheets[n].renderOriginal(o,i,l);break}default:{this.sheets[n].renderGrade(o,i,a,r)}}}}this.render(this.getActiveSheet())};t.prototype.tryAgain=function(e,t){if(t===void 0){t=this.getActiveSheet()}var r;var n;for(r in this.gradObj){for(n in this.gradObj[r]){var o=this.sheets[t].getCellMeta(r,n);if(o.originalProp){this.sheets[t].renderOriginal(r,n,o.originalProp)}this.sheets[t].removeCommentAtCell(r,n)}}if(e.readOnlyStateChanged){this.sheets[t].updateSettings({cell:this.sheets[t].getAllCellProps()})}this.render(this.getActiveSheet())};t.prototype.renderHint=function(e,t){if(t===void 0){t=this.getActiveSheet()}return this.sheets[t].setCellHint(e)};t.prototype.renderRibbonStyles=function(e,t){if(t===void 0){t=this.getActiveSheet()}return this.sheets[t].renderRibbonStyles(e)};t.prototype.getRefValue=function(e,t,r,n){if(n===void 0){n=this.getActiveSheet()}return this.sheets[n].getRefValue(e,t,r)};t.prototype.handleRemoteGridChange=function(e){if(e===void 0){e=this.getActiveSheet()}this.render(e)};t.prototype.updateGridText=function(e,t){if(t===void 0){t=this.getActiveSheet()}if(e.event.viewId==this.getViewId()){return}this.sheets[t].updateTempCellValue(e,e.event.data)};t.prototype.handleGridWrapperMessages=function(e){this.eventController.dispatchEvent(e.name,e)};t.prototype.enableRemoteGridFormulaMode=function(e){if(e===void 0){e=this.getActiveSheet()}this.sheets[e].enableRemoteGridFormulaMode()};t.prototype.disableRemoteGridFormulaMode=function(e){if(e===void 0){e=this.getActiveSheet()}this.sheets[e].disableRemoteGridFormulaMode()};t.prototype.hasHorizontalScroll=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].hasHorizontalScroll()};t.prototype.hasVericalScroll=function(e){if(e===void 0){e=this.getActiveSheet()}return this.sheets[e].hasVericalScroll()};t.prototype.changeFulledit=function(e,t,r,n){if(n===void 0){n=this.getActiveSheet()}this.sheets[n].changeFulledit(e,t,r)};t.prototype.updateGridSelection=function(e,t){if(t===void 0){t=this.getActiveSheet()}this.sheets[t].updateGridSelection(e)};t.prototype.resetGrid=function(e,t){if(t===void 0){t=this.getActiveSheet()}this.sheets[t].resetGrid(e)};t.prototype.updataGridData=function(e,t){if(t===void 0){t=this.getActiveSheet()}this.sheets[t].updataGridData(e)};return t}(i.BaseView);t.Grid=s},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var n=r(20);var o=r(0);var i=function(){function t(e,t,r,o,i,a,s){this.container=e;this.config=t;this.dataModel=r;this.eventController=o;this.sheetNameIdMap=i;this.eventHandlers=s;this.GridID=a;this.eventHandlerCallbacks=s;this.getCustomEditor();this.hotConfig=new n.hotConfig(this.config,this);this.handsontableGrid=this.initializeGrid();this.updateGridSelection();this.remoteGridFormulaMode=false;this.genFormulaSelBordersHolder();this.gridReference={};this.getCommentsPlugin();this.registerColResizeHook()}t.prototype.initializeGrid=function(){var e=this.InitializeHOT();return e};t.prototype.InitializeHOT=function(){var t=this.hotConfig.getHotConfig();this.handleHotConfigParams(t);return new e(this.container,t,this)};t.prototype.handleHotConfigParams=function(e){if(e.colHeaders!==true){this.container.classList.add("noColHeaders")}};t.prototype.registerColResizeHook=function(){this.handsontableGrid.addHook("afterColumnResize",this.handleColResize.bind(this))};t.prototype.handleColResize=function(){this.eventController.dispatchEvent(o.Events.GRID_EVENTS.COL_RESIZE,{})};t.prototype.getCommentsPlugin=function(){this.commentsPlugin=this.getPlugin("comments");this.commentsPlugin.editor.editor.classList.add("leoCommentTextArea")};t.prototype.updateCurrentCellValue=function(e,t){if(t===void 0){t=this.dataModel.getSelectedCellVal()}var r=this.dataModel.getSelectedCell();this.setDataAtCell(r.row,r.column,t,"Program");if(e.type){switch(e.type){case"Enter_Key_Pressed":this.handleEnterKeyPressedEvent(r);break;case"Tab_Key_Pressed":this.handleTabKeyPressedEvent(r);break;case"Focus_Out":break;default:this.selectCell(r.row,r.column);this.container.focus();break}}};t.prototype.updateTempCellValue=function(e,t){if(t===void 0){t=this.dataModel.getSelectedCellVal()}var r=this.dataModel.getSelectedCell();this.handsontableGrid.getCell(r.row,r.column).innerText=t};t.prototype.handleEnterKeyPressedEvent=function(e){this.selectCell(+e.row+1,e.column);this.container.focus()};t.prototype.handleTabKeyPressedEvent=function(e){this.selectCell(e.row,+e.column+1);this.container.focus()};t.prototype.updateCurrentSelectedCell=function(e){var t=this.dataModel.getSelectedCell();var r=this.selectCell(t.row,t.column);if(r==true){this.render()}else{this.dataModel.incorrectCellRef(o.VIEWIDs.GRID)}this.container.focus()};t.prototype.selectCell=function(e,t,r,n,o,i){return this.handsontableGrid.selectCell(e,t,r,n,o,i)};t.prototype.setDataAtCell=function(e,t,r,n){return this.handsontableGrid.setDataAtCell(e,t,r,n)};t.prototype.getSourceDataAtCell=function(e,t){return this.handsontableGrid.getSourceDataAtCell(e,t)};t.prototype.getSelected=function(){return this.handsontableGrid.getSelected()};t.prototype.render=function(){return this.handsontableGrid.render()};t.prototype.getDataAtCell=function(e,t){return this.handsontableGrid.getDataAtCell(e,t)};t.prototype.setCellMeta=function(e,t,r,n){return this.handsontableGrid.setCellMeta(e,t,r,n)};t.prototype.getPlugin=function(e){return this.handsontableGrid.getPlugin(e)};t.prototype.countRows=function(){return this.handsontableGrid.countRows()};t.prototype.countCols=function(){return this.handsontableGrid.countCols()};t.prototype.getCellMeta=function(e,t){return this.handsontableGrid.getCellMeta(e,t)};t.prototype.handleGridChange=function(e,t){this.dataModel.setSelectedCell(o.VIEWIDs.GRID,e,t)};t.prototype.getData=function(){return this.handsontableGrid.getData()};t.prototype.populateFromArray=function(e,t,r){this.handsontableGrid.populateFromArray(e,t,r)};t.prototype.getGUID=function(){return this.dataModel.getLeoGUID()};t.prototype.getActiveEditor=function(){return this.handsontableGrid.getActiveEditor()};t.prototype.getGridGUID=function(){return this.GridID};t.prototype.getLeoGUID=function(){return this.dataModel.getLeoGUID()};t.prototype.handleGridRendering=function(e,t){if(e){if(t==="edit"){var r=e[0][3];this.dataModel.setSelectedCellVal(o.VIEWIDs.GRID,r,{type:"Editing"})}else if(t==="Autofill.fill"){for(var n=0;n<e.length;n++){var i={row:e[n][0],column:e[n][1]};this.dataModel.setCellValue(i,e[n][3])}}this.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.getGridGUID(),type:"RemoteCellValChanged"})}};t.prototype.DefaultCellRenderer=function(e){return this.TextRenderer(e)};t.prototype.setCommentAtCell=function(e,t,r){this.commentsPlugin.setCommentAtCell(e,t,r);this.commentsPlugin.updateCommentMeta(e,t,{readOnly:true})};t.prototype.removeCommentAtCell=function(e,t){this.commentsPlugin.removeCommentAtCell(e,t,false)};t.prototype.setOriginalRenderingProps=function(e,t,r){this.handsontableGrid.setCellMeta(e,t,"originalProp",r)};t.prototype.renderOriginal=function(e,t,r){this.handsontableGrid.setCellMeta(e,t,"renderer",this.getRenderer(this.getCellMeta(e,t),r))};t.prototype.renderGrade=function(e,t,r,n){this.handsontableGrid.setCellMeta(e,t,"renderer",this.getRenderingProps(this.getCellMeta(e,t),r,n))};t.prototype.getRenderingProps=function(e,t,r){var n={};if(e.renderingProps!=null){n=e.renderingProps}n["color"]=r[Object.keys(r)[t]].color;n["border"]=r[Object.keys(r)[t]].border;return this.getRenderer(e,n)};t.prototype.getRenderer=function(e,t){if(e.leoType==="text"){return this.TextRenderer(t)}else if(e.leoType==="numeric"){return this.NumericRenderer(t)}else if(e.leoType==="number"){return this.NumericRenderer(t)}};t.prototype.setCellProperties=function(e,t,r){if(r.color)e.style.backgroundColor=r.color;if(r.size)e.style.fontSize=r.size+"pt";if(r.fontWeight)e.style.fontWeight=r.fontWeight;if(r.border)e.style.border=r.border;this.setCellTooltip(e,r)};t.prototype.NumericRenderer=function(t){var r=this;return function(n,o,i,a,s,l,u){e.renderers.NumericRenderer.apply(this,arguments);r.setCellProperties(o,l,t)}};t.prototype.setCellTooltip=function(e,t){if(t.tooltip!=null){e.setAttribute("data-tooltip",t.tooltip["text"]);e.setAttribute("data-tooltip-stickto",t.tooltip["orientation"])}};t.prototype.TextRenderer=function(t){var r=this;return function(n,o,i,a,s,l,u){e.renderers.TextRenderer.apply(this,arguments);r.setCellProperties(o,l,t);if(l&&r.hotConfig.getHotConfig().renderer==="html"){o.innerHTML=l}}};t.prototype.handleContextMenuEvents=function(e,t){switch(e){case"mergeCells":this.handleMergeCellClick(t);break}};t.prototype.handleMergeCellClick=function(e){var t=e.start,r=t.row,n=t.col;var o=e.end.row-r+1;var i=e.end.col-n+1;this.dataModel.pushMergedRange({row:r,col:n,rowspan:o,colspan:i})};t.prototype.updateSettings=function(e,t){this.handsontableGrid.updateSettings(e,t);this.handsontableGrid.render()};t.prototype.getDimensions=function(){return{width:this.getGridWidth(),height:this.getGridHeight()}};t.prototype.getGridWidth=function(){var e=this.dataModel.getUserData();var t=0;for(var r=0;r<e[0].length;r++){t+=this.handsontableGrid.getColWidth(r)}if(this.dataModel.isHeadersPresent("rowheaders")){t+=26}return t};t.prototype.getGridHeight=function(e){var t=this.dataModel.getUserData();var r=0;for(var n=0;n<t.length;n++){r+=this.handsontableGrid.getRowHeight(n,e)}if(this.dataModel.isHeadersPresent("colheaders")){r+=26}return r};t.prototype.hasHorizontalScroll=function(){var e=false;var t=this.container.querySelector(".ht_master .wtHolder");if(t.scrollWidth>t.clientWidth){e=true}return e};t.prototype.hasVericalScroll=function(){var e=false;var t=this.container.querySelector(".ht_master .wtHolder");if(t.scrollHeight>t.clientHeight){e=true}return e};t.prototype.getAllCellProps=function(){return this.hotConfig.getCellProps(this.dataModel.getRowsConfig())};t.prototype.setCellHint=function(e){var t=e.hintMeta,r=t.from,n=t.to,o=t.expectedvalues,i=t.comment;if(e.hintMeta.mergedranges){var a=this.dataModel.getMergedRanges();this.updateSettings({mergeCells:a})}if(e.hintMeta.styles){var s=this.getAllCellProps();this.updateSettings({cell:s})}this.populateFromArray(r.row,r.col,o);this.selectCell(r.row,r.col,n.row,n.col)};t.prototype.renderRibbonStyles=function(e){var t=e.eventData,r=t.property,n=t.selectedRange,o=t.type;var i={};if(o==="cellStyle"){var a=this.getAllCellProps();i["cell"]=a}else if(o==="other"){if(r.name==="mergedranges"){i["mergeCells"]=this.dataModel.getMergedRanges()}}this.updateSettings(i)};t.prototype.getCustomEditor=function(){var t=e.editors.TextEditor.prototype.extend();var r=this;t.prototype.open=function(t){this.instance.addHook("beforeKeyDown",u);e.editors.TextEditor.prototype.open.apply(this,arguments);if(t!=null){e.hooks.run(this.instance,"beforeKeyDown",t)}};t.prototype.bindEvents=function(){this.eventManager.addEventListener(r.container.querySelector("textarea.handsontableInput"),"keyup",s.bind(this));e.editors.TextEditor.prototype.bindEvents.apply(this,arguments)};t.prototype.close=function(t){this.formulaMode=false;this.instance.initialFormulaSelCellCoord=null;this.instance.finalSelectedCellCoord=null;a(this.instance);this.instance.removeHook("beforeKeyDown",u);this.tempVal=null;s({key:"Escape",eventRef:this});this.instance.removeHook("beforeOnCellMouseDown",g);this.instance.removeHook("beforeOnCellMouseOver",b);this.instance.removeHook("afterOnCellMouseUp",y);r.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.instance.gridRef.getGridGUID(),type:"FormulaModeClose"});e.editors.TextEditor.prototype.close.apply(this,arguments)};e.editors.registerEditor("leo",t)};t.prototype.genFormulaSelBordersHolder=function(){var e=this.getGridGUID();this.tableContainer=this.container.querySelector(".ht_master .wtSpreader");this.formulaSelBordersHolder=document.createElement("div");this.formulaSelBordersHolder.className="FormulaSelBordersHolder";var t="position: absolute; top: 0px; left: 0px;";this.formulaSelBordersHolder.style.cssText=t;this.tableContainer.appendChild(this.formulaSelBordersHolder)};t.prototype.getSelectedCell=function(){return this.dataModel.getSelectedCell()};t.prototype.enableRemoteGridFormulaMode=function(){this.remoteGridFormulaMode=true;this.handsontableGrid.getInstance().addHook("beforeOnCellMouseDown",R);this.handsontableGrid.getInstance().addHook("beforeOnCellMouseOver",M);this.handsontableGrid.getInstance().addHook("afterOnCellMouseUp",y)};t.prototype.disableRemoteGridFormulaMode=function(){this.remoteGridFormulaMode=false;a(this.handsontableGrid);this.handsontableGrid.getInstance().removeHook("beforeOnCellMouseDown",R);this.handsontableGrid.getInstance().removeHook("beforeOnCellMouseOver",M);this.handsontableGrid.getInstance().removeHook("afterOnCellMouseUp",y)};t.prototype.changeFulledit=function(e,t,r){if(this.handsontableGrid.getActiveEditor().state=="STATE_EDITING"){var n=r.toUpperCase();console.log("sheetNameIdMap: ",this.sheetNameIdMap);if(!this.gridReference[n]){this.gridReference[n]=e}var o=this.getActiveEditor();o.setValue(o.initialFormula+n+"!"+t);this.handsontableGrid.listen()}};t.prototype.getRefValue=function(e,t,r){var n;var o=e.split("!");n=this.dataModel.getRefCellValue(this.sheetNameIdMap[o[0]],k(o[1].substr(0,1)),+o[1].slice(1,o[1].length)-1);return n};t.prototype.handleRemoteGridChange=function(){this.render()};t.prototype.handleCopyToGrid=function(e){var t=this.getSelected();var r={startRow:t[0],startCol:t[1],endRow:t[2],endCol:t[3]};this.dataModel.setMultipleCellValue(o.VIEWIDs.GRID,r,e,{type:"Copy"})};t.prototype.handleGridUndo=function(e,t){if(e.actionType=="change"){var r=this.dataModel.getSelectedCell();var n=t=="Undo"?2:3;for(var i=0;i<e.changes.length;i++){if(r.row==e.changes[i][0]&&r.column==e.changes[i][1]){this.dataModel.setSelectedCellVal(o.VIEWIDs.GRID,e.changes[i][n],{type:"UNDO"})}else{this.dataModel.setCellValue({row:e.changes[i][0],column:e.changes[i][1]},e.changes[i][n])}}}};t.prototype.checkifEditingMode=function(e){if(this.getActiveEditor().state=="STATE_EDITING"){return false}else{return true}};t.prototype.onBeforeValueRenderCallback=function(e,t,r){if(this.eventHandlerCallbacks&&this.eventHandlerCallbacks.beforeValueRender){return this.eventHandlerCallbacks.beforeValueRender(e,t,r)}else{return e}};t.prototype.updateGridSelection=function(e){var t=this.dataModel.getSelectedCell();this.selectCell(+t.row,+t.column)};t.prototype.resetGrid=function(e){var t=new n.hotConfig(this.dataModel.getdataJSON(),this);var r=t.getHotConfig();var o=JSON.parse(JSON.stringify(r["data"]));delete r["data"];this.updateSettings(r);this.populateFromArray(0,0,o)};t.prototype.updataGridData=function(e){var t=new n.hotConfig(this.dataModel.getdataJSON(),this);var r=t.getHotConfig();this.populateFromArray(0,0,r["data"])};return t}();t.HotWrapper=i;var a=function(e){e.gridRef.formulaSelBordersHolder.innerHTML=""};var s=function(e){if(e.eventRef){e.eventRef.instance.gridRef.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:e.eventRef.instance.gridRef.getGridGUID(),type:"gridKeyPressed",viewId:o.VIEWIDs.GRID,data:{value:e.eventRef.originalValue}});return}var t=this.instance.getActiveEditor();if(t!=null){if(e.key=="Escape"||e.key=="Enter"){this.instance.gridRef.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.instance.gridRef.getGridGUID(),type:"gridKeyPressed",viewId:o.VIEWIDs.GRID,data:{value:t.originalValue}})}else{this.instance.gridRef.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.instance.gridRef.getGridGUID(),type:"gridKeyPressed",viewId:o.VIEWIDs.GRID,data:{value:t.getValue()}})}}};var l=function(e,t){var r;var n=false;e.instance.newFormulaCharEntered=false;var i=e.getValue();if(t.keyCode==o.KEYCODES.enterKey&&i.indexOf("=")==0){var a=/[(]/g;var s=i.match(a);a=/[)]/g;var l=i.match(a);var u=void 0;var d=void 0;u=s?s.length:0;d=l?l.length:0;if(u==d+1){e.setValue(i+")")}}if(i[0]=="="||!i&&(t.keyCode==o.KEYCODES._equalKey||t.keyCode==o.KEYCODES._equalKeyChrome)){if(t.keyCode==o.KEYCODES.f2Key){n=true;r=i[i.length-1]}else{if(t.shiftKey){r=O[t.keyCode]}else{r=S[t.keyCode]}if(T.indexOf(r)!=-1){e.initialFormula=i+r;n=true;e.instance.newFormulaCharEntered=true}}}console.log("checkText: ",r);return n};var u=function(e){var t=true;var r=[o.KEYCODES.shiftKey,o.KEYCODES.leftKey,o.KEYCODES.upKey,o.KEYCODES.rightKey,o.KEYCODES.downKey];if(r.indexOf(e.keyCode)!=-1){t=false}var n=this.getActiveEditor();if(e.key=="z"&&e.ctrlKey==true){e.stopImmediatePropagation();e.preventDefault();if(n.TEXTAREA.value!=n.originalValue){n.tempVal=n.TEXTAREA.value;n.TEXTAREA.value=n.originalValue}else{if(n.tempVal){n.TEXTAREA.value=n.tempVal}}}if(!t&&n.formulaMode){c.call(this,e)}if(t){n.formulaMode=l(n,e);if(n.formulaMode){this.gridRef.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.gridRef.getGridGUID(),type:"FormulaModeOpen"});this.getInstance().addHook("beforeOnCellMouseDown",g);this.getInstance().addHook("beforeOnCellMouseOver",b);this.getInstance().addHook("afterOnCellMouseUp",y)}else{this.getInstance().removeHook("beforeOnCellMouseDown",g);this.getInstance().removeHook("beforeOnCellMouseOver",b);this.getInstance().removeHook("afterOnCellMouseUp",y)}}};function d(e,t){switch(e){case 37:if(this.finalSelectedCellCoord.col>0){this.finalSelectedCellCoord.col-=1}break;case 38:if(this.finalSelectedCellCoord.row>0){this.finalSelectedCellCoord.row-=1}break;case 39:if(this.finalSelectedCellCoord.col<this.countCols()-1&&this.initialFormulaSelCellCoord.col>=0){this.finalSelectedCellCoord.col+=1}break;case 40:if(this.finalSelectedCellCoord.row<this.countRows()-1&&this.initialFormulaSelCellCoord.row>=0){this.finalSelectedCellCoord.row+=1}break;default:return}m(this.initialFormulaSelCellCoord,this.finalSelectedCellCoord,this);t.setValue(_(t.initialFormula,this.initialFormulaSelCellCoord,this.finalSelectedCellCoord))}function f(e,t){switch(e){case 37:if(this.initialFormulaSelCellCoord.col>0){this.initialFormulaSelCellCoord.col-=1}break;case 38:if(this.initialFormulaSelCellCoord.row>0){this.initialFormulaSelCellCoord.row-=1}break;case 39:if(this.initialFormulaSelCellCoord.col<this.countCols()-1){this.initialFormulaSelCellCoord.col+=1}break;case 40:if(this.initialFormulaSelCellCoord.row<this.countRows()-1){this.initialFormulaSelCellCoord.row+=1}break;default:break}this.finalSelectedCellCoord=JSON.parse(JSON.stringify(this.initialFormulaSelCellCoord));if(!w(t.getValue())&&this.getInstance().gridRef.currFormulaSelBorder){this.getInstance().gridRef.currFormulaSelBorder.remove()}h({row:this.initialFormulaSelCellCoord.row,col:this.initialFormulaSelCellCoord.col},this);t.setValue(_(t.initialFormula,this.initialFormulaSelCellCoord))}var c=function(e){e.preventDefault();e.stopImmediatePropagation();var t=this.getActiveEditor();if(!this.initialFormulaSelCellCoord){var r=this.getSelected();this.initialFormulaSelCellCoord={row:r[0],col:r[1]}}if(!this.finalSelectedCellCoord){this.finalSelectedCellCoord=JSON.parse(JSON.stringify(this.initialFormulaSelCellCoord))}if(e.shiftKey){d.call(this,e.keyCode,t)}else{f.call(this,e.keyCode,t)}};var h=function(e,t){var r=document.createElement("div");var n="height:100%; width:100%; background-color:rgb(181, 209, 255); opacity:0.3;";r.style.cssText=n;var o=document.createElement("div");o.className="FormulaSelBorder";var i=t.getCell(e.row,e.col);var a=i.offsetTop;var s=i.offsetLeft;var l=i.offsetWidth-1;var u=i.offsetHeight-1;var d="top: "+a+"px; left: "+s+"px; height:"+u+"px; width:"+l+"px;";o.style.cssText=d;o.appendChild(r);t.gridRef.currFormulaSelBorder=o;t.gridRef.formulaSelBordersHolder.appendChild(o)};var m=function(e,t,r){var n=r.getCell(Math.min(e.row,t.row),Math.min(e.col,t.col));if(n){r.gridRef.currFormulaSelBorder.style.left=n.offsetLeft+"px";r.gridRef.currFormulaSelBorder.style.top=n.offsetTop+"px";r.gridRef.currFormulaSelBorder.style.height=v(e,t,r)-1+"px";r.gridRef.currFormulaSelBorder.style.width=p(e,t,r)-1+"px"}};var p=function(e,t,r){var n=0;var o=Math.min(e.col,t.col);var i=Math.max(e.col,t.col);for(var a=o;a<=i;a++){n+=r.getCell(e.row,a).offsetWidth}return n};var v=function(e,t,r){var n=0;var o=Math.min(e.row,t.row);var i=Math.max(e.row,t.row);for(var a=o;a<=i;a++){n+=r.getCell(a,e.col).offsetHeight;
}return n};var g=function(e,t){e.preventDefault();e.stopImmediatePropagation();var r=this.getActiveEditor();this.isFormulaSelMouseDown=true;if(e.shiftKey===true&&this.getInstance().gridRef.currFormulaSelBorder){this.finalSelectedCellCoord=JSON.parse(JSON.stringify(t));m(this.initialFormulaSelCellCoord,this.finalSelectedCellCoord,this);r.setValue(_(r.initialFormula,this.initialFormulaSelCellCoord,this.finalSelectedCellCoord))}else{this.initialFormulaSelCellCoord=JSON.parse(JSON.stringify(t));this.finalSelectedCellCoord=JSON.parse(JSON.stringify(t));if(!w(r.getValue())&&this.getInstance().gridRef.currFormulaSelBorder){this.getInstance().gridRef.currFormulaSelBorder.remove()}h(t,this.getInstance());r.initialFormula=C(r.getValue());r.setValue(_(r.initialFormula,this.initialFormulaSelCellCoord))}};var w=function(e){if(e.trim().match(/(^=)(.*)([\/\-,+<>(*=]$)|^=$/gi)!=null){return true}else{return false}};var b=function(e,t){if(this.isFormulaSelMouseDown){var r=this.getActiveEditor();e.preventDefault();e.stopImmediatePropagation();this.finalSelectedCellCoord=t;m(this.initialFormulaSelCellCoord,this.finalSelectedCellCoord,this.getInstance());r.setValue(_(r.initialFormula,this.initialFormulaSelCellCoord,this.finalSelectedCellCoord))}};var y=function(e,t){e.preventDefault();e.stopImmediatePropagation();this.isFormulaSelMouseDown=false;this.newFormulaCharEntered=false;console.log(" in mouseup, this.isFormulaSelMouseDown: ",this.isFormulaSelMouseDown)};var C=function(e){if(e!=""){var t=/[=,+-\/*(]/g;var r=e.match(t);var n=r.map(function(t){return e.lastIndexOf(t)});var o=n.reduce(function(e,t){return Math.max(e,t)});var i=e.substring(0,o+1);return i}else return""};var _=function(e,t,r){if(r===void 0){r=null}var n=e+E(t,r);return n};var E=function(e,t){if(t===void 0){t=null}var r;if(t&&(e.row!=t.row||e.col!=t.col)){var n=Math.min(e.row,t.row),o=Math.min(e.col,t.col),i=Math.max(e.row,t.row),a=Math.max(e.col,t.col);r=D(o)+(n+1)+":"+D(a)+(i+1)}else{r=D(e.col)+(e.row+1)}return r};var R=function(e,t){e.stopImmediatePropagation();e.preventDefault();this.isFormulaSelMouseDown=true;this.initialFormulaSelCellCoord=t;if(!this.newFormulaCharEntered&&this.gridRef.currFormulaSelBorder){this.gridRef.currFormulaSelBorder.remove()}h(t,this.getInstance());this.gridRef.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.gridRef.getGridGUID(),type:"cellClicked",value:E(t),sheetName:this.gridRef.dataModel.getSheetNames()[0]})};var M=function(e,t){if(this.isFormulaSelMouseDown){e.stopImmediatePropagation();e.preventDefault();this.finalSelectedCellCoord=t;m(this.initialFormulaSelCellCoord,this.finalSelectedCellCoord,this.getInstance());this.gridRef.eventController.dispatchEvent(o.Events.GRID_EVENTS.MESSAGE,{name:o.Events.ViewEvents.EDITING_EVENTt,sheetID:this.gridRef.getGridGUID(),type:"cellClicked",value:E(this.initialFormulaSelCellCoord,t),sheetName:this.gridRef.dataModel.getSheetNames()[0]})}};var S={187:"=",191:"/",188:",",189:"-",106:"*",107:"+",109:"+",111:"/"};var O={187:"+",188:"<",190:">",57:"(",48:")",56:"*"};var T=["=",",","+","-","/","*","("];var A="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var N=A.length;var D=function(e){var t=e+1;var r="";var n;while(t>0){n=(t-1)%N;r=String.fromCharCode(65+n)+r;t=Math.floor((t-n)/N)}return r};var k=function(e){var t=0;if(e){for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1){t+=Math.pow(N,n)*(A.indexOf(e[r])+1)}}--t;return t}}).call(t,r(2))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});var o=r(0);var i=r(1);var a=r(0);var s=function(e){n(t,e);function t(t,r,n){var i=e.call(this)||this;i.leonardoContainer=t;i.dataModel=r;i.eventController=n;i.viewId=o.VIEWIDs.RIBBON;i.compID=1;return i}t.prototype.init=function(){if(this.dataModel.isRibbonVisible()){namespace("SIMS.Objects");namespace("SIMS.Objects.DOMElements");namespace("SIMS.Components2016.Excel");SIMS.Objects.Utils=new SIMS.Common.UtilityFunctions;SIMS.Objects.DOMElements.SIMArea=jQuery(this.leonardoContainer.querySelector("#SIMArea"));SIMS.Objects.DOMElements.LeonardoArea=jQuery(this.leonardoContainer);var e=this.dataModel.getHostAppRootPath()+"RibbonAssets/excel-ribbon.xml";var t={"@id":"1","@mode":"new",sizeandpos:{attr:[{"@name":"left","@value":"0"},{"@name":"top","@value":"0"},{"@name":"width","@value":"*"},{"@name":"height","@value":"121"}]},initialattrs:{attr:[{"@name":"APP","@value":"excel"},{"@name":"RIBBON_PATH","@value":e},{"@name":"FONT_NAME","@value":"Calibri light"},{"@name":"BOTTOM_ALIGN","@value":"true"},{"@name":"ENABLE_COLLAPSE_EXPAND_BUTTON","@value":"true"},{"@name":"CENTER_ALIGN","@value":"true"},{"@name":"FONT_SIZE","@value":"18"},{"@name":"MERGE_AND_CENTER","@value":"false"}]},events:{event:[{"@id":"51","@desc":"Insert Cells",validate:[{"@followup":"3",comp:{"@id":"2","@validation-set":"Selected_cell1"}},{"@followup":"2",comp:{"@id":"2","@validation-set":"Selected_cell2"}}]},{"@id":"52","@desc":"click Insert Sheet Rows.",validate:{"@followup":"3","@operator":"any",comp:[{"@id":"2","@validation-set":"Selected_cell2"},{"@id":"2","@validation-set":"Selected_cell1"}]}},{"@id":"82","@desc":"Cells group Insert",validate:{"@followup":"3",comp:{"@id":"2","@validation-set":"Selected_cell1"}}}]},compName:"SIMS.Components.Excel.Ribbon",className:"SIMS.Components2016.Excel.Ribbon",compType:"default",taskbarImage:{}};this.compJS=new SIMS.Components2016.Excel.Ribbon;this.compJS.AddComponentUI(t,"<div class='compDiv SIMS_Ribbon_Excel' id='1' tabindex='1'></div>");this.compJS.Initialize(t);REGISTER_MSG("COMP_ACTION",this,this.HandleRibbonEvents,this.compJS.msgHandler);this.compJS.SetCompState(t);this.compJS.ShowComponent(t["@id"],true,t);this.compJS.UpdateComponentState(t,"default");this.compJS.GenerateHTML();this.registerEvents();this.registerEventListeners()}};t.prototype.toggleCellStyleButtons=function(e,t,r){if(r==null){this.compJS.SetAttribute(this.compID,t,"true")}else{this.compJS.SetAttribute(this.compID,t,"false")}};t.prototype.toggleOtherStyleButtons=function(e,t,r){if(r==="true"){this.compJS.SetAttribute(this.compID,t,"false")}else{this.compJS.SetAttribute(this.compID,t,"true")}};t.prototype.HandleRibbonEvents=function(e,t){var r=e._eventId;if(a.RIBBON_OPTIONS[r]){var n=a.RIBBON_OPTIONS[r].type;var i=a.RIBBON_OPTIONS[r].attribute;var s=a.PROPERTY_ATTRIBUTE_MAP[i];var l=this.dataModel.getSelectedCell();var u=this.dataModel.getCellMetaDataForRibbon(l.row,l.column);if(n==="cellStyle"){this.toggleCellStyleButtons(r,i,u[s])}else if(n==="other"){this.toggleOtherStyleButtons(r,i,u[s])}var d={eventName:o.Events.RIBBON_EVENTS.STYLE_EVENT,eventID:r};this.eventController.dispatchEvent(o.Events.RIBBON_EVENTS.STYLE_EVENT,d)}else{if(r=="3057"){this.dataModel.setRibbonCollapsedState(this.viewId,true)}else if(r=="3058"){this.dataModel.setRibbonCollapsedState(this.viewId,false)}return}};t.prototype.registerEvents=function(){for(var e in o.Events.RIBBON_EVENTS){this.eventController.registerEvent(o.Events.RIBBON_EVENTS[e])}};t.prototype.registerEventListeners=function(){this.eventController.addEventListener(o.Events.ViewEvents.SELECTED_CELL_CHANGED,this.updateRibbon.bind(this))};t.prototype.updateRibbon=function(e){if(e.viewId==this.getViewId()){return}else{var t=this.dataModel.getSelectedCell();var r=this.dataModel.getCellMetaDataForRibbon(t.row,t.column);var n=[{name:"fontWeight",handler:this.handleCellBold},{name:"mergedranges",handler:this.handleMergeCell}];for(var o=0,i=void 0;i=n[o];o++){i.handler.call(this,r[i.name])}}};t.prototype.handleCellBold=function(e){if(e==="bold"){this.compJS.SetAttribute(this.compID,"HIGHLIGHT_BOLD","true")}else{this.compJS.SetAttribute(this.compID,"HIGHLIGHT_BOLD","false")}};t.prototype.handleMergeCell=function(e){if(e==="true"){this.compJS.SetAttribute(this.compID,"MERGE_AND_CENTER","true")}else{this.compJS.SetAttribute(this.compID,"MERGE_AND_CENTER","false")}};return t}(i.BaseView);t.Ribbon=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});var o=r(1);var i=function(e){n(t,e);function t(t,r){var n=e.call(this)||this;n.sheetTab=t;n.dataModel=r;return n}t.prototype.init=function(){e.prototype.init.call(this);var t=this.getSheetNames();if(t==null){this.sheetTab.hidden="hidden"}else{this.addTabs(t)}};t.prototype.addTabs=function(e){for(var t=0;t<e.length;t++){var r=false;var n=this.createLiElement(e[t],t==0);this.sheetTab.querySelector("#TabsContainerlist").appendChild(n)}};t.prototype.getSheetNames=function(){return this.dataModel.getSheetNames()};t.prototype.createLiElement=function(e,t){var r=document.createElement("li");var n=t?"sheet-tab tab-active":"sheet-tab";r.setAttribute("class",n);var o=document.createElement("span");o.setAttribute("class","tab-content-container");o.setAttribute("id","spanSheetName");o.innerText=e;r.appendChild(o);var i=this;r.addEventListener("click",function(){i.sheetTab.querySelector(".tab-active").classList.remove("tab-active");r.className+=" tab-active"});return r};return t}(o.BaseView);t.SheetTabBar=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:true});var o=r(0);var i=r(1);var a=r(0);var s=function(e){n(t,e);function t(t,r,n){var i=e.call(this)||this;i.formulaToolbar=t;i.dataModel=r;i.eventController=n;i.viewId=o.VIEWIDs.TOPBAR;i.formulaBar=i.formulaToolbar.querySelector("#formulaBar");i.nameBox=i.formulaToolbar.querySelector("#nameBox");i.fx=i.formulaToolbar.querySelector("#fx");i.isSelectedCellEditable=true;i.selectedCellValue=i.dataModel.getSelectedCellVal();return i}t.prototype.init=function(){e.prototype.init.call(this);this.updateTopbar({viewId:o.VIEWIDs.DEFAULT})};t.prototype.registerEventListeners=function(){if(this.dataModel.isTopBarHidden()){this.formulaToolbar.hidden="hidden"}else{this.eventController.addEventListener(o.Events.ViewEvents.GRIDKEYPRESSED,this.updateFormulabarForCellEditing.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.SELECTED_CELL_VALUE_CHANGED,this.updateFormulabar.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.RESET_GRID,this.updateTopbar.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.UPDATE_DATA,this.updateTopbar.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.SELECTED_CELL_CHANGED,this.updateTopbar.bind(this));this.eventController.addEventListener(o.Events.ViewEvents.INCORRECT_CELL_REFERENCE,this.updateTopbar.bind(this))}};t.prototype.attachDOMEvents=function(){if(!this.dataModel.isTopBarHidden()){e.prototype.attachDOMEvents.call(this);this.formulaBar.addEventListener("keydown",this.handleFBKeyDown.bind(this));this.formulaBar.addEventListener("keyup",this.handleFBKeyUp.bind(this));this.formulaBar.addEventListener("focusout",this.handleFBFocusOut.bind(this));this.nameBox.addEventListener("keyup",this.handleNameBoxKeyUp.bind(this))}};t.prototype.handleFBFocusOut=function(e){if(this.FBValueChanged()){this.updateSelectedCellValue({type:"Focus_Out"})}};t.prototype.updateSelectedCellValue=function(e){var t=this.escapeHTML(this.formulaBar.value);var r=this.dataModel.getSelectedCell();this.dataModel.setSelectedCellVal(this.getViewId(),t,e)};t.prototype.FBValueChanged=function(){return this.selectedCellValue===this.formulaBar.value?false:true};t.prototype.notifyGridManager=function(e){this.eventController.dispatchEvent(e.eventName,e)};t.prototype.handleFBKeyUp=function(e){if(this.isSelectedCellEditable==true){if(e.keyCode===a.KEYCODES.enterKey){var t=e.ctrlKey?"CTRL_Enter_Key_Pressed":"Enter_Key_Pressed";if(this.FBValueChanged()){this.updateSelectedCellValue({type:t})}else{var r={eventName:o.Events.ViewEvents.SELECTED_CELL_VALUE_CHANGED,viewId:this.viewId,type:t};this.notifyGridManager(r)}}else if(e.keyCode===a.KEYCODES.tabKey){if(this.FBValueChanged()){this.updateSelectedCellValue({type:"Tab_Key_Pressed"})}else{var t="Tab_Key_Pressed";var r={eventName:o.Events.ViewEvents.SELECTED_CELL_VALUE_CHANGED,viewId:this.viewId,type:t};this.notifyGridManager(r)}}else if(e.keyCode===a.KEYCODES.escKey){var n=this.escapeHTML(this.dataModel.getSelectedCellVal());this.formulaBar.value=n;this.eventController.dispatchEvent("EditingEvent",{type:"gridKeyPressed",viewId:this.getViewId(),data:this.formulaBar.value,keyEvent:e})}else{this.eventController.dispatchEvent("EditingEvent",{type:"gridKeyPressed",viewId:this.getViewId(),data:this.formulaBar.value,keyEvent:e})}}};t.prototype.handleFBKeyDown=function(e){if(this.isSelectedCellEditable==false||e.keyCode===a.KEYCODES.tabKey){e.preventDefault()}};t.prototype.handleNameBoxKeyUp=function(e){var t=this.dataModel.getSelectedCell();var r=this.spreadsheetColumnLabel(t.column)+(+t.row+1);if(e.keyCode===a.KEYCODES.enterKey){var n=this.nameBox.value.toUpperCase();if(r!=n&&n.match(/(^[A-Z]+)([\d]+)$/g)!==null){var o=this.spreadsheetColumnIndex(n.substr(0,n.search(/\d/)));var i=n.substr(n.search(/\d/))-1;this.dataModel.setSelectedCell(this.getViewId(),i,o)}}if(e.keyCode===a.KEYCODES.escKey){this.nameBox.value=r}};t.prototype.updateNamebox=function(e){var t=this.dataModel.getSelectedCell();this.isSelectedCellEditable=this.dataModel.isReadOnly(t)?false:true;if(e.viewId==this.getViewId()){return}else{this.nameBox.value=this.spreadsheetColumnLabel(t.column)+(+t.row+1)}};t.prototype.updateFormulabar=function(e){if(e.viewId==this.getViewId()){return}else{this.updateFormulabarText(e)}};t.prototype.updateTopbar=function(e){this.updateFormulabarText(e);this.updateNamebox(e)};t.prototype.updateFormulabarText=function(e){var t=this.escapeHTML(this.dataModel.getSelectedCellVal());this.formulaBar.value=t;this.selectedCellValue=t};t.prototype.updateFormulabarForCellEditing=function(e){if(e.event.viewId==this.getViewId()){return}this.formulaBar.value=this.escapeHTML(e.event.data.value)};t.prototype.escapeHTML=function(e){return isNaN(e)?e.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,""):e};return t}(i.BaseView);t.TopBar=s},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var n=r(26);var o=function(){function t(e,t){this.config=e;this.gridRef=t;this.themeMap={cosmattThemeGreen:"cosmatt-theme-green",leonardoThemeGreen:"leonardo-theme-green"};this.hotConfig=this.generateHotConfig()}t.prototype.getHotConfig=function(){return this.hotConfig};t.prototype.getReadOnlyClass=function(e){if(e.readOnlyCellStyles){var t=document.createElement("style");t.type="text/css";var r=this.gridRef.getLeoGUID();var n=document.createTextNode('div[guid="'+r+'"] '+" .handsontable table.htCore tr .customDim.readOnly "+e.readOnlyCellStyles);t.appendChild(n);document.head.appendChild(t);return"customDim readOnly"}else{return"customDim"}};t.prototype.generateHotConfig=function(){var t=this;var r={outsideClickDeselects:false,editor:e.editors.LeoEditor,enterBeginsEditing:false,colWidths:this.getColumnWidths(),rowHeights:this.getRowHeights(),className:this.getDefaultHorizontalAlignment()+" "+this.getDefaultVerticalAlignment(),comments:true,formulas:true,fillHandle:{autoInsertRow:false},renderer:this.config.options["defaultRenderer"]||"html",readOnlyCellClassName:this.getReadOnlyClass(this.config.options),selectedCellBorderColor:"#217346",selectedAreaBorderColor:"#217346",selectedFillBorderColor:"#217346",rowHeaderWidth:25,afterSelectionEnd:function(e,r,n,o){t.gridRef.handleGridChange(e,r)},afterChange:function(e,r){t.gridRef.handleGridRendering(e,r)},beforeAutofillInsidePopulate:function(e,t,r,o,i,a){return n.beforeAutofillInsidePopulate(e,t,r,o,{},a,this)},afterPaste:function(e,r){t.gridRef.handleCopyToGrid(e)},afterUndo:function(e){t.gridRef.handleGridUndo(e,"Undo")},afterRedo:function(e){t.gridRef.handleGridUndo(e,"Redo")},beforeUndo:function(e){return t.gridRef.checkifEditingMode(e)},beforeValueRender:function(e,r,n){return t.gridRef.onBeforeValueRenderCallback(e,r,n)}};if(this.config.options["setUniformCustomProperties"]==null){r["customBorders"]=this.getCustomBorders()}if(this.config.data){r["data"]=this.config.data}if(this.config.options["rowheaders"]){r["rowHeaders"]=this.config.options["rowheaders"]}if(this.config.options["colheaders"]){r["colHeaders"]=this.config.options["colheaders"]}if(this.config.options["width"]){r["width"]=this.config.options["width"]}if(this.config.options["readOnly"]!==undefined){r["readOnly"]=this.config.options["readOnly"]}if(this.config.options["manualcolumnresize"]){r["manualColumnResize"]=this.config.options["manualcolumnresize"]}if(this.config.mergedranges){r["mergeCells"]=this.config.mergedranges}if(this.config.options["minSpareRows"]){r["minSpareRows"]=this.config.options["minSpareRows"]}if(this.config.options["contextMenu"]){r["contextMenu"]={callback:this.gridRef.handleContextMenuEvents.bind(this.gridRef),items:{row_above:{},row_below:{},remove_row:{},mergeCells:{name:"Merge cells"}}}}if(this.config.options["allowInsertRow"]||this.config.modeconfig["role"]==="instructor"){r["allowInsertRow"]=this.config.options["allowInsertRow"]}if(this.config.options["maxRows"]){r["maxRows"]=this.config.options["maxRows"]}if(this.config.options["minRows"]){r["minRows"]=this.config.options["minRows"]}if(this.config.options["maxCols"]){r["maxCols"]=this.config.options["maxCols"]}if(this.config.options["minCols"]){r["minCols"]=this.config.options["minCols"]}if(this.config.options["startRows"]){r["startRows"]=this.config.options["startRows"]}if(this.config.options["startCols"]){r["startCols"]=this.config.options["startCols"]}var o=this.getTableClassNames();if(o!==""){r["tableClassName"]=o}if(this.config.rows){r["cell"]=this.getCellProps(this.config.rows)}return r};t.prototype.getColumnWidths=function(){var e;var t=this.config.options["defaultColWidth"]||150;if(this.config.columns){e=[];var r=this.config.columns;for(var n=0;n<=this.config.data[0].length;n++){var o=r[n]&&r[n].width?r[n].width:t;e.push(o)}}else{e=t}return e};t.prototype.getDefaultHorizontalAlignment=function(){if(this.config.options["defaultAlign"]){return this.getHorizontalClassName(this.config.options["defaultAlign"])}else{return"htCenter"}};t.prototype.getDefaultVerticalAlignment=function(){if(this.config.options["defaultAlign"]){return this.getVerticalClassName(this.config.options["defaultAlign"])}else{return"htMiddle"}};t.prototype.getHorizontalClassName=function(e){return{general:"htJustify",left:"htLeft",center:"htCenter",right:"htRight"}[e.horizontal.toLowerCase()]};t.prototype.getVerticalClassName=function(e){return{middle:"htMiddle",bottom:"htBottom",top:"htTop"}[e.vertical.toLowerCase()]};t.prototype.getCustomBorders=function(){var e=[];if(this.config.rows&&this.config.styles&&this.config.styles["borders"]){var t=this.config.rows;var r=this.config.styles["borders"];for(var n in t){for(var o in t[n].cells){if(r[t[n].cells[o].border]){e.push({row:n,col:o,left:r[t[n].cells[o].border].border.left,right:r[t[n].cells[o].border].border.right,bottom:r[t[n].cells[o].border].border.bottom,top:r[t[n].cells[o].border].border.top})}}}}return e};t.prototype.getNumberFormatType=function(e){return{General:"text",Accounting:"numeric",Number:"number"}[e]};t.prototype.getAccountingFormat=function(e){var t="$0,0.";for(var r=0;r<e;r++){t=t+"0"}return t};t.prototype.getNumberFormat=function(e){if(e==0){return"0"}var t="0.";for(var r=0;r<e;r++){t=t+"0"}return t};t.prototype.getLanguage=function(e){return{$:"en-US"}[e]};t.prototype.getCellProps=function(e){if(e){var t=[];for(var r in e){for(var n in e[r].cells){var o={row:r,col:n,renderingProps:{}};var i=e[r].cells[n];this.setColorFill(i.colorfill,o);this.setAlignment(i.alignment,o);if(this.config.options["setUniformCustomProperties"]!=null)this.setUniformBorder(i.border,this.config.options["setUniformCustomProperties"]["border"],o);this.setRenderingProps(i,o);this.setReadOnlyCell(i,o);this.setCellTooltip(i,o);t.push(o)}}return t}};t.prototype.setCellTooltip=function(e,t){if(e.tooltip!=null){t.renderingProps["tooltip"]=e.tooltip}};t.prototype.setUniformBorder=function(e,t,r){if(e!=null)r.renderingProps["border"]=t};t.prototype.setColorFill=function(e,t){var r=this.config.styles["colorfills"]||[];if(e!=null){for(var n=0;n<r.length;n++){if(r[n].id==e){t.renderingProps["color"]=r[n].color;break}}}};t.prototype.setAlignment=function(e,t){var r=this.config.styles["alignments"]||[];var n=[];if(e!=null){for(var o=0;o<r.length;o++){if(r[o].id==e){if(r[o].horizontal){var i=this.getHorizontalClassName(r[o])||"";n.push(i)}if(r[o].vertical){var a=this.getVerticalClassName(r[o])||"";n.push(a)}if(n.length>0)t["className"]=n.join(" ");break}}}};t.prototype.setNumberFormat=function(e,t){var r=this.config.styles["numberFormats"]||[];var n=false;if(e!=null){for(var o=0;o<r.length;o++){if(r[o].id==e){n=true;var i=this.getNumberFormatType(r[o].cat)||"text";t["leoType"]=i;if(i==="numeric"){t["format"]=this.getAccountingFormat(r[o].decimal)||"$0,0.00";t["language"]=this.getLanguage(r[o].symbol)||"en-US";t["renderer"]=this.gridRef.NumericRenderer(t.renderingProps)}else if(i==="number"){t["format"]=this.getNumberFormat(r[o].decimal)||"0.00";t["renderer"]=this.gridRef.NumericRenderer(t.renderingProps)}else{t["renderer"]=this.gridRef.TextRenderer(t.renderingProps)}break}}}if(!n){t["renderer"]=this.gridRef.DefaultCellRenderer(t.renderingProps);t["leoType"]="text"}};t.prototype.setRenderingProps=function(e,t){var r=["size","fontWeight"];r.forEach(function(r){if(e[r]){t.renderingProps[r]=e[r]}});this.setNumberFormat(e.numberFormat,t)};t.prototype.setReadOnlyCell=function(e,t){if(e.readOnly!=null){t["readOnly"]=e.readOnly}};t.prototype.getRowHeights=function(){var e;var t=this.config.options["defaultRowHeight"]||30;var r=23;if(t<r)t=r;if(this.config.rows){e=[];var n=this.config.rows;for(var o=0;o<=this.config.data.length;o++){var i=void 0;if(n[o]&&n[o].height){if(n[o].height<r){i=r}else{i=n[o].height}}else{i=t}e.push(i)}}else{e=t}return e};t.prototype.getTableClassNames=function(){var e=[];e.push("LeonardoTable");if(this.config.modeconfig["theme"]&&this.themeMap[this.config.modeconfig["theme"]]){e.push(this.themeMap[this.config.modeconfig["theme"]]);if(this.config.modeconfig["tableContainsRowHeaders"]){e.push("table-row-header")}if(this.config.modeconfig["tableContainsColumnHeaders"]){e.push("table-column-header")}}return e.join(" ")};return t}();t.hotConfig=o}).call(t,r(2))},,function(e,t,r){"use strict";var n,o,i;var a=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(r,s){if(true){!(o=[],n=s,i=typeof n==="function"?n.apply(t,o):n,i!==undefined&&(e.exports=i))}else if((typeof e==="undefined"?"undefined":a(e))==="object"&&e.exports){e.exports=s()}else{r.html5tooltips=s()}})(undefined,function(){"use strict";var e='<div class="html5tooltip" style="box-sizing:border-box;position:fixed;z-index:2147483647">  <div class="html5tooltip-box" box>    <div class="html5tooltip-text" text></div>    <div class="html5tooltip-more" style="overflow:hidden;" more>      <div class="html5tooltip-text" more-text></div>    </div>  </div></div>',t={animateFunction:{fadeIn:"fadein",foldIn:"foldin",foldOut:"foldout",roll:"roll",scaleIn:"scalein",slideIn:"slidein",spin:"spin"},color:{daffodil:{r:255,g:230,b:23},daisy:{r:250,g:211,b:28},mustard:{r:253,g:183,b:23},"citrus zest":{r:250,g:170,b:33},pumpkin:{r:241,g:117,b:63},tangerine:{r:237,g:87,b:36},salmon:{r:240,g:70,b:57},persimmon:{r:234,g:40,b:48},rouge:{r:188,g:35,b:38},scarlet:{r:140,g:12,b:3},"hot pink":{r:229,g:24,b:93},princess:{r:243,g:132,b:174},petal:{r:250,g:198,b:210},lilac:{r:178,g:150,b:199},lavender:{r:123,g:103,b:174},violet:{r:95,g:53,b:119},cloud:{r:195,g:222,b:241},dream:{r:85,g:190,b:237},gulf:{r:49,g:168,b:224},turquoise:{r:35,g:138,b:204},sky:{r:13,g:96,b:174},indigo:{r:20,g:59,b:134},navy:{r:0,g:27,b:74},"sea foam":{r:125,g:205,b:194},teal:{r:0,g:168,b:168},peacock:{r:18,g:149,b:159},ceadon:{r:193,g:209,b:138},olive:{r:121,g:145,b:85},bamboo:{r:128,g:188,b:66},grass:{r:74,g:160,b:63},kelly:{r:22,g:136,b:74},forrest:{r:0,g:63,b:46},chocolate:{r:56,g:30,b:17},"terra cotta":{r:192,g:92,b:32},camel:{r:191,g:155,b:107},linen:{r:233,g:212,b:167},stone:{r:231,g:230,b:225},smoke:{r:207,g:208,b:210},steel:{r:138,g:139,b:143},slate:{r:119,g:133,b:144},charcoal:{r:71,g:77,b:77},black:{r:5,g:6,b:8},white:{r:255,g:255,b:255},"metalic silver":{r:152,g:162,b:171},"metalic gold":{r:159,g:135,b:89},"metalic copper":{r:140,g:102,b:65}},stickTo:{bottom:"bottom",left:"left",right:"right",top:"top"}},r={animateDuration:300,animateFunction:t.animateFunction.fadeIn,delay:500,disableAnimation:false,hideDelay:300,persistent:false,stickTo:t.stickTo.bottom,stickDistance:10};function n(e,t){function r(e,t){return Array.prototype.slice.call(e,t)}function n(e){var t=r(e).map(function(e){return typeof e==="undefined"?"undefined":a(e)});var n={};if(t[0]==="object")n=e[0];else if(t[0]==="string"){var o=e[0].split(" ");for(var i in o){n[o[i]]=e[1]}}else if(t[0]==="function")n={"":e[0]};return n}function o(e,t){var r;for(var n=0;n<e.length;n++){for(var i=0;i<e[n].attributes.length;i++){r=e[n].attributes.item(i).name.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()});t[r]=t[r]||[];t[r].push(e[n])}o(e[n].children,t)}}function i(e){clearTimeout(d[e]);d[e]=setTimeout(function(){for(var t in u[e]){u[e][t](s.model[e])}if(u[""])for(var t in u[""]){u[""][t]()}})}var s=this,l={},u={},d={};s.anchors=[];s.elements=[];s.model={};s.publ=e||{};s.destroy=function(){if(typeof window!=="undefined"){window.removeEventListener("resize",moveTooltip);window.removeEventListener("scroll",moveTooltip)}s.unmount()};s.dispatch=function(e){var t=r(arguments,1);setTimeout(function(){for(var r in l[e]){l[e][r].apply(s.publ,t)}})};s.onModelUpdate=function(){var e=n(arguments);for(var t in e){s.model[t]=s.model[t]||null;u[t]=u[t]||[];u[t].push(e[t]);i(t)}};s.mount=function(e){e=e||document.body;try{var t,r=0;while(t=s.elements[r++]){e.appendChild(t)}}catch(n){throw"Could not mount component: "+n.message}};s.set=function(){var e=n(arguments);for(var t in e){s.model[t]=e[t];i(t)}};s.unmount=function(){var e,t=0;while(e=s.elements[t++]){e.parentNode&&e.parentNode.removeChild(e)}};Object.defineProperty(s,"element",{configurable:true,enumerable:true,get:function c(){return s.elements[0]},set:function h(e){s.elements[0]=e}});["element","elements","model","set"].forEach(function(e){Object.defineProperty(s.publ,e,{configurable:true,enumerable:true,get:function t(){return s[e]},set:function r(t){s[e]=t}})});s.publ.destroy=function(){s.destroy()};s.publ.mount=function(e){s.mount(e)};s.publ.on=function(){var e=n(arguments);for(var t in e){l[t]=l[t]||[];l[t].push(e[t])}};s.publ.unmount=function(){s.unmount()};if(t&&document){var f=document.createElement("div");f.innerHTML=t;s.elements=r(f.children);o(s.elements,s.anchors)}}function o(){function o(e,t){if(!w.disableAnimation){e.getBoundingClientRect();e.classList.add("animating");t&&t();setTimeout(function(){e.classList.remove("animating")},w.animateDuration)}else t()}function i(e,t,r,n){if(!w.disableAnimation){e.classList.add(t);e.getBoundingClientRect();e.classList.add("animating");e.classList.remove(t);e.classList.add(r);setTimeout(function(){e.classList.remove("animating");e.classList.remove(r);if(n)n()},w.animateDuration)}else if(n)n()}function a(){if(v.style.visibility!=="collapse")v.style.visibility="collapse";v.style.left="-9999px";v.style.top="-9999px";if(m.style.display!=="none"){m.style.display="none";m.style.visibility="collapse";m.style.height="auto"}}function s(e){g=true;i(c,w.animateFunction+"-to",w.animateFunction+"-from",function(){if(!g)return;a();e&&e()});return this}function l(){var e,r;if(!f.model.target||v.style.visibility!=="visible")return;v.style.width="auto";r=v.getBoundingClientRect();var n=parseInt(w.maxWidth);if(n)v.style.width=r.width>n?n+"px":"auto";e=f.model.target.getBoundingClientRect();r=v.getBoundingClientRect();switch(w.stickTo){case t.stickTo.bottom:v.style.left=e.left+parseInt((e.width-r.width)/2)+"px";v.style.top=e.top+e.height+parseInt(w.stickDistance)+"px";break;case t.stickTo.left:v.style.left=e.left-r.width-parseInt(w.stickDistance)+"px";v.style.top=e.top+(e.height-r.height)/2+"px";break;case t.stickTo.right:v.style.left=e.left+e.width+parseInt(w.stickDistance)+"px";v.style.top=e.top+(e.height-r.height)/2+"px";break;case t.stickTo.top:v.style.left=e.left+(e.width-r.width)/2+"px";v.style.top=e.top-r.height-parseInt(w.stickDistance)+"px";break}}function u(){g=false;if(v.style.visibility!=="visible"){v.style.visibility="visible";setTimeout(function(){l();i(c,w.animateFunction+"-from",w.animateFunction+"-to")})}return this}function d(){if(v.style.visibility!=="visible"){v.style.visibility="visible";i(c,w.animateFunction+"-from",w.animateFunction+"-to");if(w.contentMore){m.style.display="block";m.style.visibility="visible"}l()}else if(m.style.display!=="block"&&w.contentMore){m.style.display="block";o(v);l();var e=m.getBoundingClientRect().height;m.style.visibility="visible";m.style.height="0px";o(m,function(){m.style.height=e>0?e+"px":"auto"})}return this}var f=new n(this,e),c=f.anchors.box[0],h=f.anchors.text[0],m=f.anchors.more[0],p=f.anchors.moreText[0],v=f.elements[0],g=false;a();if(typeof window!=="undefined"){window.addEventListener("resize",l,false);window.addEventListener("scroll",l,false)}f.set(r);var w=f.model;f.onModelUpdate({color:function b(e){if(t.color[e]){e=t.color[e];e="rgb("+e.r+", "+e.g+", "+e.b+")"}c.style.backgroundColor=e},contentText:function y(e){f.anchors.text[0].innerHTML=e},contentMore:function C(e){f.anchors.moreText[0].innerHTML=e},stickTo:function _(e){f.elements[0].className="html5tooltip-"+e}});this.hide=s;this.show=u;this.showMore=d;this.moveTooltip=l;f.publ.unmount=function(){a();f.unmount()}}var i=[],s=[];function l(e,t,r){var n;for(var i=r.length;i--;){if(r[i].model.target===e){n=r[i];break}}if(!n){n=new o;r.push(n)}n.set(t);n.set("target",e);var a,s;function l(){if(e===a||n.element===a)return;if(n.model.persistent)n.hide(function(){n.unmount()});else n.unmount()}function u(){a=null;if(e===s)return;if(n.model.persistent)setTimeout(l,n.model.hideDelay);else l()}e.addEventListener("mouseenter",function(){if(this===a||this===s)return;a=this;setTimeout(function(){if(this===a){n.mount();n.show()}}.bind(this),n.model.delay)});e.addEventListener("mouseleave",u);e.addEventListener("focus",function(){if(["INPUT","TEXTAREA"].indexOf(this.tagName)===-1&&this.getAttribute("contenteditable")===null)return;s=this;n.mount();n.showMore()});e.addEventListener("blur",function(){s=null;if(a!==n.element){n.unmount()}});n.element.addEventListener("mouseenter",function(){a=this});n.element.addEventListener("mouseleave",u)}function u(e,t){var r=(t||document).getElementsByTagName("*"),n=[];for(var o=0,i;i=r[o];o++){if(i.getAttribute(e))n.push(i)}return n}function d(e,t,r){var n=e.getAttribute(t),o=e;while(!n&&(o=o.parentNode)&&o.getAttribute){n=o.getAttribute(t)}return n||r}function f(){u("data-tooltip").forEach(function(e){var t={animateFunction:d(e,"data-tooltip-animate-function",r.animateFunction),
color:d(e,"data-tooltip-color",""),contentMore:d(e,"data-tooltip-more",""),contentText:d(e,"data-tooltip",""),delay:d(e,"data-tooltip-delay",r.delay),hideDelay:d(e,"data-tooltip-hide-delay",r.delay),maxWidth:d(e,"data-tooltip-maxwidth","auto"),persistent:d(e,"data-tooltip-persistent",r.persistent),stickTo:d(e,"data-tooltip-stickto",r.stickTo)};l(e,t,s)})}function c(e,t){var r=[];try{r=Array.prototype.slice.call((t||document).querySelectorAll(e))}catch(n){}return r}function h(e){e.forEach(function(e){var t=[];if(e.targetSelector)t=c(e.targetSelector);t.forEach(function(t){l(t,e,i)})})}var m=function v(e){if(!Array.isArray(e))e=[e];h(e)};m.autoinit=m.refresh=function(){f()};m.getTooltipByTarget=function(e){for(var t=i.length;t--;){if(i[t].model.target===e)return i[t]}for(var t=s.length;t--;){if(s[t].model.target===e)return s[t]}};function p(){document.removeEventListener("DOMContentLoaded",p,false);window.removeEventListener("load",p,false);m.refresh()}if(typeof window!=="undefined"){if(document.readyState==="complete"){p()}else{document.addEventListener("DOMContentLoaded",p,false);window.addEventListener("load",p,false)}if(!window.html5tooltipsPredefined){window.html5tooltipsPredefined=t;window.HTML5TooltipUIComponent=o}}return m})},function(e,t,r){"use strict";var n=e.exports={};var o;var i;function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){o=setTimeout}else{o=a}}catch(e){o=a}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=s}}catch(e){i=s}})();function l(e){if(o===setTimeout){return setTimeout(e,0)}if((o===a||!o)&&setTimeout){o=setTimeout;return setTimeout(e,0)}try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}function u(e){if(i===clearTimeout){return clearTimeout(e)}if((i===s||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var d=[];var f=false;var c;var h=-1;function m(){if(!f||!c){return}f=false;if(c.length){d=c.concat(d)}else{h=-1}if(d.length){p()}}function p(){if(f){return}var e=l(m);f=true;var t=d.length;while(t){c=d;d=[];while(++h<t){if(c){c[h].run()}}h=-1;t=d.length}c=null;f=false;u(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}d.push(new v(e,t));if(d.length===1&&!f){l(p)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function g(){}n.on=g;n.addListener=g;n.once=g;n.off=g;n.removeListener=g;n.removeAllListeners=g;n.emit=g;n.prependListener=g;n.prependOnceListener=g;n.listeners=function(e){return[]};n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},,function(e,t,r){"use strict";var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o;o=function(){return this}();try{o=o||Function("return this")()||(1,eval)("this")}catch(i){if((typeof window==="undefined"?"undefined":n(window))==="object")o=window}e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.beforeAutofillInsidePopulate=a;function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function i(e){if(e==null)throw new TypeError("Cannot destructure undefined")}function a(e,t,r,n,a,f,c){i(a);var c=c;r=c.getSourceData.apply(c,o(c.getSelected()));var h=c;var m=g(e,t,r);var p=e.row,w=e.col,b=v(p,w,r),y=0,C=r.length,_=r?r[0].length:0;var E=void 0;if(b[0]==="="){var R=b.split("!");if(R.length>1){E=R[0];b="="+R[1]}if(["down","up"].indexOf(t)!==-1){y=C*m.row}else if(["right","left"].indexOf(t)!==-1){y=_*m.col}return{value:s(d(b,t,y),E),iterators:m}}else{if(C>=2||_>=2){var M=l(b),S,O;if(u(M)){if(["down","up"].indexOf(t)!==-1){y=n[0][w];if(t==="down"){M+=y*C*m.row}else{S=(f.row-p)%C;O=S>0?C-S:0;M=l(r[O][w]);M+=y*C*m.row;if(m.row>1&&O+1===C){m.row--}}}else if(["right","left"].indexOf(t)!==-1){y=n[p][0];if(t==="right"){M+=y*_*m.col}else{S=(f.col-w)%_;O=S>0?_-S:0;M=l(r[p][O]);M+=y*_*(m.col||1);if(m.col>1&&O+1===_){m.col--}}}return{value:s(M,E)}}}}return{value:s(b,E)}}function s(e,t){if(t){e=t+"!"+e.slice(1)}return e}function l(e){switch(typeof e==="undefined"?"undefined":n(e)){case"number":return e;case"string":if(!isNaN(e)){return e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)}}return e}function u(e){return Object.prototype.toString.call(e)==="[object Number]"}function d(e,t,r){var n,o;if(["left","right"].indexOf(t)!==-1){n="col"}else if(["up","down"].indexOf(t)!==-1){n="row"}if(["down","right"].indexOf(t)!==-1){o=r*1}else if(["up","left"].indexOf(t)!==-1){o=r*-1}if(n&&o){return e.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(e){var t=f(e).alpha;var r=t[0]==="$"||false,i=t[t.length-1]==="$"||false;if(n==="row"&&i){return e}if(n==="col"&&r){return e}return n==="row"?c(e,o):h(e,o)})}return e}function f(e){var t=e.match(/\d+$/),r=e.replace(t,"");return{alpha:r,num:parseInt(t[0],10)}}function c(e,t){var r=f(e),n=r.alpha,o=n,i=parseInt(r.num+t,10);if(i<1){i=1}return o+""+i}function h(e,t){var r=f(e),n=r.alpha,o=m(parseInt(p(n)+t,10)),i=r.num;if(!o||o.length===0){o="A"}var a=n[0]==="$"||false,s=n[n.length-1]==="$"||false;o=(a?"$":"")+o;i=(s?"$":"")+i;return o+""+i}function m(e){var t="";while(e>=0){t=String.fromCharCode(e%26+97)+t;e=Math.floor(e/26)-1}return t.toUpperCase()}function p(e){e=e.replace(/\$/g,"");var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r,n,o=0;for(r=0,n=e.length-1;r<e.length;r+=1,n-=1){o+=Math.pow(t.length,n)*(t.indexOf(e[r])+1)}if(o){--o}return o}function v(e){var t=arguments[2];var r=arguments[1]!==void 0?arguments[1]:null;var n=t[e%t.length];if(r!==null){return n[r%n.length]}return n}function g(e,t,r){var n;if(["up","left"].indexOf(t)!==-1){n={row:Math.floor(e.row/r.length)+1>1?Math.floor(e.row/r.length)+1:1,col:Math.floor(e.col/r.length)+1>1?Math.floor(e.col/r.length)+1:1}}else if(["down","right"].indexOf(t)!==-1){n={row:Math.floor(e.row/r.length)+1>1?Math.floor(e.row/r.length)+1:1,col:Math.floor(e.col/r.length)+1>1?Math.floor(e.col/r.length)+1:1}}return n}},function(e,t,r){"use strict";(function(){var e=document.attachEvent,t=false;var r={};if(!e){var n=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}();var o=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}();r.resetTriggers=function(e){var t=e.__resizeTriggers__,r=t.firstElementChild,n=t.lastElementChild,o=r.firstElementChild;n.scrollLeft=n.scrollWidth;n.scrollTop=n.scrollHeight;o.style.width=r.offsetWidth+1+"px";o.style.height=r.offsetHeight+1+"px";r.scrollLeft=r.scrollWidth;r.scrollTop=r.scrollHeight};r.scrollListener=function(e){var t=this;r.resetTriggers(this);if(this.__resizeRAF__)o(this.__resizeRAF__);this.__resizeRAF__=n(function(){if(r.checkTriggers(t)){t.__resizeLast__.width=t.offsetWidth;t.__resizeLast__.height=t.offsetHeight;t.__resizeListeners__.forEach(function(r){r.call(t,e)})}})};r.checkTriggers=function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height};var i=false,a="animation",s="",l="animationstart",u="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),f="";{var c=document.createElement("fakeelement");if(c.style.animationName!==undefined){i=true}if(i===false){for(var h=0;h<u.length;h++){if(c.style[u[h]+"AnimationName"]!==undefined){f=u[h];a=f+"Animation";s="-"+f.toLowerCase()+"-";l=d[h];i=true;break}}}}var m="resizeanim";var p="@"+s+"keyframes "+m+" { from { opacity: 0; } to { opacity: 0; } } ";var v=s+"animation: 1ms "+m+"; "}function g(){if(!t){var e=(p?p:"")+".resize-triggers { "+(v?v:"")+"visibility: hidden; opacity: 0; } "+'.resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css";if(n.styleSheet){n.styleSheet.cssText=e}else{n.appendChild(document.createTextNode(e))}r.appendChild(n);t=true}}window.addResizeListener=function(t,n){if(e)t.attachEvent("onresize",n);else{if(!t.__resizeTriggers__){if(getComputedStyle(t).position=="static")t.style.position="relative";g();t.__resizeLast__={};t.__resizeListeners__=[];(t.__resizeTriggers__=document.createElement("div")).className="resize-triggers";t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div>'+'<div class="contract-trigger"></div>';t.appendChild(t.__resizeTriggers__);r.resetTriggers(t);t.addEventListener("scroll",r.scrollListener,true);l&&t.__resizeTriggers__.addEventListener(l,function(e){if(e.animationName==m)r.resetTriggers(t)})}t.__resizeListeners__.push(n)}};window.removeResizeListener=function(t,n){if(e)t.detachEvent("onresize",n);else{t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(n),1);if(!t.__resizeListeners__.length){t.removeEventListener("scroll",r.scrollListener);t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)}}}})()}]);